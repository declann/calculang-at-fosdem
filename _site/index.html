<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.543">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>calculang-at-fosdem</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-dashboard/quarto-dashboard.js"></script>
<script src="site_libs/quarto-dashboard/stickythead.js"></script>
<script src="site_libs/quarto-dashboard/datatables.min.js" kdttablesentinel="true"></script>
<script src="site_libs/quarto-dashboard/pdfmake.min.js" kdttablesentinel="true"></script>
<script src="site_libs/quarto-dashboard/vfs_fonts.js" kdttablesentinel="true"></script>
<script src="site_libs/quarto-dashboard/web-components.js" type="module"></script>
<script src="site_libs/quarto-dashboard/components.js"></script>
<link href="site_libs/quarto-dashboard/datatables.min.css" rel="stylesheet" kdttablesentinel="true">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<link rel="stylesheet" href="./resources/cookieconsent-2.9.1/dist/cookieconsent.css" media="print" onload="this.media='all'">
<script type="module"> if (!("anchorName" in document.documentElement.style)) { import("https://unpkg.com/@oddbird/css-anchor-positioning");  }</script>


<meta name="twitter:title" content="calculang-at-fosdem">
<meta name="twitter:card" content="summary">
</head>

<body class="quarto-dashboard dashboard-fill fullcontent">

<header id="quarto-dashboard-header">
<nav class="navbar navbar-expand-md slim" data-bs-theme="dark">
  <div class="navbar-container container-fluid">
    <button class="navbar-toggler hidden" type="button" data-bs-toggle="collapse" data-bs-target="#dashboard-collapse" aria-controls="dashboard-collapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>    


<div class="quarto-dashboard-links"><a class="quarto-dashboard-link" href="https://github.com/declann/calculang-at-fosdem"><i class="bi bi-github"></i></a><a class="quarto-dashboard-link" href="/slides.html"><span class="quarto-dashboard-link-text">Slides</span></a><a class="quarto-dashboard-link" href="https://calculang.dev"><span class="quarto-dashboard-link-text">calculang.dev</span></a><a class="quarto-dashboard-link" href="/reactive-workings-notes.html"><span class="quarto-dashboard-link-text">Reactive Workings</span></a><a class="quarto-dashboard-link" href="https://twitter.com/calculang"><i class="bi bi-twitter"></i></a><a class="quarto-dashboard-link" href="https://fosstodon.org/@calculang"><i class="bi bi-mastodon"></i></a></div></div></nav>
</header>
<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-layout-custom quarto-dashboard-content bslib-gap-spacing html-fill-container bslib-page-fill">
<!-- sidebar -->
<!-- margin-sidebar -->
<!-- main -->

<div class="cell hidden bslib-grid-item html-fill-item">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="38" data-source-offset="-15"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 37;"><span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>viewof player_x_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="fl">1.7</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>viewof player_y_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="fl">5.5</span>)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>viewof ray_angle_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="dv">999</span>)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>viewof fisheye_correction_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="kw">true</span>)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>viewof step_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="dv">0</span>)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>viewof x_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="fl">3.5</span>)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>viewof y_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="fl">3.5</span>)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>viewof f_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="dv">0</span>)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>viewof key_stream_version_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="dv">0</span>)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>viewof keys_stream_version_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="st">"hi"</span>)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="co">// emissions-savings interactions using year for different meanings destroys eachother</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>viewof emissions_year_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="dv">2024</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="co">// savings</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>viewof annual_payment_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="dv">1000</span>)</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>viewof duration_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="dv">5</span>)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>viewof interest_rate_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="op">.</span><span class="bn">02</span>)</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>viewof year_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(modelname <span class="op">==</span> <span class="st">'simple_loan'</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">5</span>)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>viewof i_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(modelname <span class="op">==</span> <span class="st">'fizzbuzz'</span> <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span> <span class="op">+</span>(q<span class="op">.</span><span class="fu">get</span>(<span class="st">'i_in'</span>)<span class="op">??</span><span class="dv">4</span>)<span class="op">/</span><span class="dv">100</span>) <span class="co">// vs 2 for fizzbuzz!!</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>viewof date_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="kw">new</span> <span class="bu">Date</span>())</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>viewof now_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="kw">new</span> <span class="bu">Date</span>())</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>viewof timing_in <span class="op">=</span>  Inputs<span class="op">.</span><span class="fu">input</span>(modelname <span class="op">==</span> <span class="st">'emissions_my_lifetime'</span> <span class="op">?</span> <span class="st">"start of birthyear"</span> <span class="op">:</span> <span class="st">"start of today"</span>)</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="co">// starfield</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>viewof star_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="dv">3</span>)</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>viewof speed_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="dv">3</span>)</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>viewof frame_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="dv">2</span>)</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>viewof random_seed_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="st">"hello"</span>)</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a><span class="co">// loan bad. i_in problem?</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>viewof d_i_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="fl">0.02</span>)</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>viewof d_i_year_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="dv">99</span>)</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>viewof missed_repayment_year_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="op">-</span><span class="dv">99</span>)</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>viewof skip_interest_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="kw">false</span>)</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>viewof principal_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="op">+</span>(q<span class="op">.</span><span class="fu">get</span>(<span class="st">'principal_in'</span>) <span class="op">??</span> <span class="dv">100000</span>))</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>viewof term_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="op">+</span>(q<span class="op">.</span><span class="fu">get</span>(<span class="st">'term_in'</span>)<span class="op">??</span><span class="dv">10</span>))</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="co">// snowflakes</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>viewof height_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="dv">200</span>)</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>viewof p_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="dv">1</span>)</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>viewof w_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="op">.</span><span class="dv">6</span>)</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>viewof width_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="dv">400</span>)</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>viewof age_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="dv">25</span>)</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a><span class="co">// savings-rec</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>viewof actual_interest_rate_co_in <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="dv">0</span>)</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>mini_binds <span class="op">=</span> {</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ({</span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>    <span class="dt">fisheye_correction_in</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span><span class="st">'üêüüëÄ correct'</span>})<span class="op">,</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>    <span class="dt">duration_in</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span><span class="dv">20</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span><span class="st">'duration'</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">disabled</span><span class="op">:</span> modelname <span class="op">==</span> <span class="st">'savings_rec'</span>})<span class="op">,</span></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>    <span class="dt">term_in</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">select</span>([<span class="dv">25</span><span class="op">,</span> <span class="dv">15</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">30</span><span class="op">,</span> <span class="dv">35</span><span class="op">,</span> <span class="dv">40</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">480</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"Term (years)"</span>})<span class="op">,</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>    <span class="dt">year_in</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="dv">1</span><span class="op">,</span>modelname <span class="op">==</span> <span class="st">'simple_loan'</span> <span class="op">?</span> term_in <span class="op">:</span> duration_in]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span><span class="st">'year'</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})<span class="op">,</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>    <span class="dt">emissions_year_in</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">1750</span><span class="op">,</span><span class="dv">2024</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span><span class="st">'emissions year'</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})<span class="op">,</span></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>    <span class="dt">age_in</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">18</span><span class="op">,</span><span class="dv">100</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span><span class="st">'your age'</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})<span class="op">,</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>    <span class="dt">annual_payment_in</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">20000</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span><span class="st">'annual_payment_in'</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">100</span><span class="op">,</span> <span class="dt">disabled</span><span class="op">:</span> modelname <span class="op">==</span> <span class="st">'savings_rec'</span>})<span class="op">,</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>    <span class="dt">interest_rate_in</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="fl">0.1</span><span class="op">,</span> <span class="fl">0.1</span>]<span class="op">,</span> {<span class="dt">format</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">'.3f'</span>)<span class="op">,</span> <span class="dt">label</span><span class="op">:</span><span class="st">'interest_rate_in'</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span><span class="fl">0.001</span><span class="op">,</span> <span class="dt">disabled</span><span class="op">:</span> modelname <span class="op">==</span> <span class="st">'savings_rec'</span>}) <span class="co">// precision how?</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="dt">actual_interest_rate_co_in</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="dv">1</span><span class="op">,</span> <span class="dv">20</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span><span class="st">'actual_interest_rate_co_in'</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span><span class="dv">1</span>})</span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="dt">f_in</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">200</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span><span class="st">'f_in'</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span><span class="dv">1</span>})</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="dt">principal_in</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">500000</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span><span class="st">'principal_in'</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span><span class="dv">1000</span>})</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>    <span class="co">//, keys_stream_function_in: md`(keys_stream_function_in)`</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>    <span class="co">//, step_in: Tangle({min: -1, max: 20, label:'step_in'})</span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>    <span class="co">//, x_in: Tangle({min: -1, max: 200, label:'x_in'})</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>    <span class="co">//, y_in: Tangle({min: -1, max: 200, label:'y_in'})</span></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>    <span class="co">//, player_x_in: Tangle({min: -1, max: 10,format: d3.format('.2f'), label:'player_x_in'})</span></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>    <span class="co">//, player_y_in: Tangle({min: -1, max: 10, format: d3.format('.2f'),label:'player_y_in'})</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a>    <span class="co">// off to check perf impact, ray_angle_in: Inputs.range([-20,20], {label:'ray_angle_in'})//Tangle({min: -1, max: 10, format: d3.format('.2f'),label:'ray_angle_in'})</span></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="dt">i_in</span><span class="op">:</span> modelname <span class="op">==</span> <span class="st">'fizzbuzz'</span> <span class="op">?</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="dv">10</span><span class="op">,</span> <span class="dv">200</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span><span class="st">'i_in'</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span><span class="dv">1</span>}) <span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="fl">0.1</span><span class="op">,</span> <span class="fl">0.1</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span><span class="st">'i_in'</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span><span class="fl">0.001</span>})</span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="dt">d_i_in</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="fl">0.1</span><span class="op">,</span> <span class="fl">0.1</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span><span class="st">'Œî i_in'</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span><span class="fl">0.001</span>})</span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="dt">d_i_year_in</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="dv">1</span><span class="op">,</span><span class="dv">99</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span><span class="st">'Œî i_in year'</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span>})</span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="dt">step_in</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">10</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span><span class="st">'step_in'</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span><span class="dv">1</span>})</span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="dt">date_in</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">date</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"date"</span>})</span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="dt">now_in</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">date</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">"now"</span>})</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="dt">timing_in</span><span class="op">:</span> modelname <span class="op">==</span> <span class="st">'emissions_my_lifetime'</span> <span class="op">?</span>  Inputs<span class="op">.</span><span class="fu">select</span>([<span class="st">"start of birthyear"</span><span class="op">,</span> <span class="st">"end of birthyear"</span>]) <span class="op">:</span> Inputs<span class="op">.</span><span class="fu">select</span>([<span class="st">"start of today"</span><span class="op">,</span> <span class="st">"start of tomorrow"</span>])</span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="dt">random_seed_in</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">text</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">'random seed'</span>})</span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="dt">frame_in</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span><span class="dv">200</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span><span class="st">'frame_in'</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span><span class="dv">1</span>})</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="dt">star_in</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span><span class="dv">200</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span><span class="st">'star_in'</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span><span class="dv">1</span>})</span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a>    <span class="op">,</span> <span class="dt">speed_in</span><span class="op">:</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="dv">1</span><span class="op">,</span><span class="dv">10</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span><span class="st">'speed_in'</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span><span class="fl">0.1</span>})</span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">fisheye_correction_in</span><span class="op">,</span> viewof fisheye_correction_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-14" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-15" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-16" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-17" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-18" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-19" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-20" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-21" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-22" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-23" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-24" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-25" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-26" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-27" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-28" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-29" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-30" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-31" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-32" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-33" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-34" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-35" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-36" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-37" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="130" data-source-offset="-4423"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 129;"><span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">duration_in</span><span class="op">,</span> viewof duration_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-38" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="131" data-source-offset="-4479"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 130;"><span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">year_in</span><span class="op">,</span> viewof year_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-39" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="132" data-source-offset="-4527"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 131;"><span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">emissions_year_in</span><span class="op">,</span> viewof emissions_year_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-40" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb5" data-startfrom="133" data-source-offset="-4595"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 132;"><span id="cb5-133"><a href="#cb5-133" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">annual_payment_in</span><span class="op">,</span> viewof annual_payment_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-41" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb6" data-startfrom="134" data-source-offset="-4663"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 133;"><span id="cb6-134"><a href="#cb6-134" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">interest_rate_in</span><span class="op">,</span> viewof interest_rate_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-42" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb7" data-startfrom="135" data-source-offset="-4729"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 134;"><span id="cb7-135"><a href="#cb7-135" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">actual_interest_rate_co_in</span><span class="op">,</span> viewof actual_interest_rate_co_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-43" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb8" data-startfrom="136" data-source-offset="-4815"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 135;"><span id="cb8-136"><a href="#cb8-136" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">f_in</span><span class="op">,</span> viewof f_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-44" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb9" data-startfrom="137" data-source-offset="-4857"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 136;"><span id="cb9-137"><a href="#cb9-137" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">x_in</span><span class="op">,</span> viewof x_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-45" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb10" data-startfrom="138" data-source-offset="-4899"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 137;"><span id="cb10-138"><a href="#cb10-138" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">y_in</span><span class="op">,</span> viewof y_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-46" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb11" data-startfrom="139" data-source-offset="-4941"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 138;"><span id="cb11-139"><a href="#cb11-139" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">player_x_in</span><span class="op">,</span> viewof player_x_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-47" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb12" data-startfrom="140" data-source-offset="-4997"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 139;"><span id="cb12-140"><a href="#cb12-140" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">player_y_in</span><span class="op">,</span> viewof player_y_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-48" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb13" data-startfrom="141" data-source-offset="-5053"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 140;"><span id="cb13-141"><a href="#cb13-141" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">step_in</span><span class="op">,</span> viewof step_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-49" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb14" data-startfrom="142" data-source-offset="-5101"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 141;"><span id="cb14-142"><a href="#cb14-142" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">ray_angle_in</span><span class="op">,</span> viewof ray_angle_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-50" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb15" data-startfrom="143" data-source-offset="-5159"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 142;"><span id="cb15-143"><a href="#cb15-143" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">i_in</span><span class="op">,</span> viewof i_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-51" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb16" data-startfrom="144" data-source-offset="-5201"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 143;"><span id="cb16-144"><a href="#cb16-144" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">date_in</span><span class="op">,</span> viewof date_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-52" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb17" data-startfrom="145" data-source-offset="-5249"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 144;"><span id="cb17-145"><a href="#cb17-145" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">timing_in</span><span class="op">,</span> viewof timing_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-53" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb18" data-startfrom="146" data-source-offset="-5301"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 145;"><span id="cb18-146"><a href="#cb18-146" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">random_seed_in</span><span class="op">,</span> viewof random_seed_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-54" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb19" data-startfrom="147" data-source-offset="-5363"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 146;"><span id="cb19-147"><a href="#cb19-147" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">frame_in</span><span class="op">,</span> viewof frame_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-55" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb20" data-startfrom="148" data-source-offset="-5413"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 147;"><span id="cb20-148"><a href="#cb20-148" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">speed_in</span><span class="op">,</span> viewof speed_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-56" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb21" data-startfrom="149" data-source-offset="-5463"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 148;"><span id="cb21-149"><a href="#cb21-149" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">star_in</span><span class="op">,</span> viewof star_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-57" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb22" data-startfrom="150" data-source-offset="-5511"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 149;"><span id="cb22-150"><a href="#cb22-150" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">principal_in</span><span class="op">,</span> viewof principal_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-58" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb23" data-startfrom="151" data-source-offset="-5569"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 150;"><span id="cb23-151"><a href="#cb23-151" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">term_in</span><span class="op">,</span> viewof term_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-59" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb24" data-startfrom="152" data-source-offset="-5617"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 151;"><span id="cb24-152"><a href="#cb24-152" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">age_in</span><span class="op">,</span> viewof age_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-60" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb25" data-startfrom="153" data-source-offset="-5663"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 152;"><span id="cb25-153"><a href="#cb25-153" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">d_i_in</span><span class="op">,</span> viewof d_i_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-61" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb26" data-startfrom="154" data-source-offset="-5709"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 153;"><span id="cb26-154"><a href="#cb26-154" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">d_i_year_in</span><span class="op">,</span> viewof d_i_year_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-62" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb27" data-startfrom="155" data-source-offset="-5765"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 154;"><span id="cb27-155"><a href="#cb27-155" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(mini_binds<span class="op">.</span><span class="at">now_in</span><span class="op">,</span> viewof now_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-1-63" data-nodetype="expression">

</div>
</div>
</div>
</div>
<div class="cell hidden bslib-grid-item html-fill-item">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb28" data-startfrom="164" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 163;"><span id="cb28-164"><a href="#cb28-164" aria-hidden="true" tabindex="-1"></a><span class="co">// working interactivity</span></span>
<span id="cb28-165"><a href="#cb28-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-166"><a href="#cb28-166" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;style&gt;</span></span>
<span id="cb28-167"><a href="#cb28-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-168"><a href="#cb28-168" aria-hidden="true" tabindex="-1"></a><span class="vs">.inputs {</span></span>
<span id="cb28-169"><a href="#cb28-169" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 20px;</span></span>
<span id="cb28-170"><a href="#cb28-170" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb28-171"><a href="#cb28-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-172"><a href="#cb28-172" aria-hidden="true" tabindex="-1"></a><span class="vs">button.btn {</span></span>
<span id="cb28-173"><a href="#cb28-173" aria-hidden="true" tabindex="-1"></a><span class="vs">  background-color: antiquewhite;</span></span>
<span id="cb28-174"><a href="#cb28-174" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: blue;</span></span>
<span id="cb28-175"><a href="#cb28-175" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding:0;</span></span>
<span id="cb28-176"><a href="#cb28-176" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb28-177"><a href="#cb28-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-178"><a href="#cb28-178" aria-hidden="true" tabindex="-1"></a><span class="vs">.calculang {</span></span>
<span id="cb28-179"><a href="#cb28-179" aria-hidden="true" tabindex="-1"></a><span class="vs">  line-height: 40px;</span></span>
<span id="cb28-180"><a href="#cb28-180" aria-hidden="true" tabindex="-1"></a><span class="vs">    -webkit-transition: all 0.2s linear;</span></span>
<span id="cb28-181"><a href="#cb28-181" aria-hidden="true" tabindex="-1"></a><span class="vs">    -moz-transition: all 0.2s linear;</span></span>
<span id="cb28-182"><a href="#cb28-182" aria-hidden="true" tabindex="-1"></a><span class="vs">    -o-transition: all 0.2s linear;</span></span>
<span id="cb28-183"><a href="#cb28-183" aria-hidden="true" tabindex="-1"></a><span class="vs">    transition: all 0.2s linear;</span></span>
<span id="cb28-184"><a href="#cb28-184" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span></span>
<span id="cb28-185"><a href="#cb28-185" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb28-186"><a href="#cb28-186" aria-hidden="true" tabindex="-1"></a><span class="vs">div.calculang.cm-line:has(span.calculang_title) {</span></span>
<span id="cb28-187"><a href="#cb28-187" aria-hidden="true" tabindex="-1"></a><span class="vs">  margin-top:20px;</span></span>
<span id="cb28-188"><a href="#cb28-188" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb28-189"><a href="#cb28-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-190"><a href="#cb28-190" aria-hidden="true" tabindex="-1"></a><span class="vs">.calculang.calculang_overwritten {</span></span>
<span id="cb28-191"><a href="#cb28-191" aria-hidden="true" tabindex="-1"></a><span class="vs">  text-decoration: line-through;</span></span>
<span id="cb28-192"><a href="#cb28-192" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: bold;</span></span>
<span id="cb28-193"><a href="#cb28-193" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb28-194"><a href="#cb28-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-195"><a href="#cb28-195" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>formulae_hidden<span class="op">.</span><span class="at">length</span> <span class="op">?</span> <span class="vs">`.calculang {</span></span>
<span id="cb28-196"><a href="#cb28-196" aria-hidden="true" tabindex="-1"></a><span class="vs">    background: #aaf3;</span></span>
<span id="cb28-197"><a href="#cb28-197" aria-hidden="true" tabindex="-1"></a><span class="vs">}`</span> <span class="op">:</span> <span class="st">''</span><span class="sc">}</span></span>
<span id="cb28-198"><a href="#cb28-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-199"><a href="#cb28-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-200"><a href="#cb28-200" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>formulae_hidden<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> <span class="vs">`.calculang_f_</span><span class="sc">${</span>d<span class="sc">}</span><span class="vs"> + .calculang_f_</span><span class="sc">${</span>d<span class="sc">}</span><span class="vs">`</span>)<span class="op">.</span><span class="fu">join</span>(<span class="st">', '</span>)<span class="sc">}</span><span class="vs"> {</span></span>
<span id="cb28-201"><a href="#cb28-201" aria-hidden="true" tabindex="-1"></a><span class="vs">  filter: blur(7px);</span></span>
<span id="cb28-202"><a href="#cb28-202" aria-hidden="true" tabindex="-1"></a><span class="vs">  line-height: 5px;</span></span>
<span id="cb28-203"><a href="#cb28-203" aria-hidden="true" tabindex="-1"></a><span class="vs">  opacity: 0.5;</span></span>
<span id="cb28-204"><a href="#cb28-204" aria-hidden="true" tabindex="-1"></a><span class="vs">} /* + selector to exclude first! https://coderwall.com/p/uugurw/css-selector-trick-select-all-elements-except-the-first */</span></span>
<span id="cb28-205"><a href="#cb28-205" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>formulae_hidden<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> <span class="vs">`.calculang_f_</span><span class="sc">${</span>d<span class="sc">}</span><span class="vs">`</span>)<span class="op">.</span><span class="fu">join</span>(<span class="st">', '</span>)<span class="sc">}</span><span class="vs"> {</span></span>
<span id="cb28-206"><a href="#cb28-206" aria-hidden="true" tabindex="-1"></a><span class="vs">  opacity: 0.5;</span></span>
<span id="cb28-207"><a href="#cb28-207" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: white;</span></span>
<span id="cb28-208"><a href="#cb28-208" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span><span class="sc">${</span>formulae_hidden<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> <span class="vs">`.calculang_f_</span><span class="sc">${</span>d<span class="sc">}</span><span class="vs"> .calculang_tooltip`</span>)<span class="op">.</span><span class="fu">join</span>(<span class="st">', '</span>)<span class="sc">}</span><span class="vs"> {</span></span>
<span id="cb28-209"><a href="#cb28-209" aria-hidden="true" tabindex="-1"></a><span class="vs">  opacity: 0.1;</span></span>
<span id="cb28-210"><a href="#cb28-210" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: white;</span></span>
<span id="cb28-211"><a href="#cb28-211" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb28-212"><a href="#cb28-212" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>formulae_hidden<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> <span class="vs">`.calculang_f_</span><span class="sc">${</span>d<span class="sc">}</span><span class="vs"> &gt; .calculang_title`</span>)<span class="op">.</span><span class="fu">join</span>(<span class="st">', '</span>)<span class="sc">}</span><span class="vs"> {</span></span>
<span id="cb28-213"><a href="#cb28-213" aria-hidden="true" tabindex="-1"></a><span class="vs">  background-color: lightgreen;</span></span>
<span id="cb28-214"><a href="#cb28-214" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-size: 0.5em;</span></span>
<span id="cb28-215"><a href="#cb28-215" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb28-216"><a href="#cb28-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-217"><a href="#cb28-217" aria-hidden="true" tabindex="-1"></a><span class="vs">span.calculang_call { </span></span>
<span id="cb28-218"><a href="#cb28-218" aria-hidden="true" tabindex="-1"></a><span class="vs">  white-space:nowrap;</span></span>
<span id="cb28-219"><a href="#cb28-219" aria-hidden="true" tabindex="-1"></a><span class="vs">  cursor: zoom-in;</span></span>
<span id="cb28-220"><a href="#cb28-220" aria-hidden="true" tabindex="-1"></a><span class="vs">  background-color: lightblue;</span></span>
<span id="cb28-221"><a href="#cb28-221" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb28-222"><a href="#cb28-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-223"><a href="#cb28-223" aria-hidden="true" tabindex="-1"></a><span class="vs">.tooltiptext {/* not all tooltiptexts go under a calculang call span! (single-length ones dont) */</span></span>
<span id="cb28-224"><a href="#cb28-224" aria-hidden="true" tabindex="-1"></a><span class="vs">  /*color: red;*/</span></span>
<span id="cb28-225"><a href="#cb28-225" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: bold;</span></span>
<span id="cb28-226"><a href="#cb28-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-227"><a href="#cb28-227" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb28-228"><a href="#cb28-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-229"><a href="#cb28-229" aria-hidden="true" tabindex="-1"></a><span class="vs">.calculang_call.calculang_call_input {</span></span>
<span id="cb28-230"><a href="#cb28-230" aria-hidden="true" tabindex="-1"></a><span class="vs">  /*cursor: none;*/</span></span>
<span id="cb28-231"><a href="#cb28-231" aria-hidden="true" tabindex="-1"></a><span class="vs">  background-color: pink;</span></span>
<span id="cb28-232"><a href="#cb28-232" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb28-233"><a href="#cb28-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-234"><a href="#cb28-234" aria-hidden="true" tabindex="-1"></a><span class="vs">.calculang_call.calculang_call_input .tooltiptext {</span></span>
<span id="cb28-235"><a href="#cb28-235" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: #f53 !important;;</span></span>
<span id="cb28-236"><a href="#cb28-236" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb28-237"><a href="#cb28-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-238"><a href="#cb28-238" aria-hidden="true" tabindex="-1"></a><span class="vs">.calculang .calculang_title span {</span></span>
<span id="cb28-239"><a href="#cb28-239" aria-hidden="true" tabindex="-1"></a><span class="vs">  padding: 3px;</span></span>
<span id="cb28-240"><a href="#cb28-240" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: #af54;</span></span>
<span id="cb28-241"><a href="#cb28-241" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-size: 1.5em;</span></span>
<span id="cb28-242"><a href="#cb28-242" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-weight: bold;</span></span>
<span id="cb28-243"><a href="#cb28-243" aria-hidden="true" tabindex="-1"></a><span class="vs">  border: 1px solid grey;</span></span>
<span id="cb28-244"><a href="#cb28-244" aria-hidden="true" tabindex="-1"></a><span class="vs">    -webkit-transition: all 0.2s linear;</span></span>
<span id="cb28-245"><a href="#cb28-245" aria-hidden="true" tabindex="-1"></a><span class="vs">    -moz-transition: all 0.2s linear;</span></span>
<span id="cb28-246"><a href="#cb28-246" aria-hidden="true" tabindex="-1"></a><span class="vs">    -o-transition: all 0.2s linear;</span></span>
<span id="cb28-247"><a href="#cb28-247" aria-hidden="true" tabindex="-1"></a><span class="vs">    transition: all 0.2s linear;</span></span>
<span id="cb28-248"><a href="#cb28-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-249"><a href="#cb28-249" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb28-250"><a href="#cb28-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-251"><a href="#cb28-251" aria-hidden="true" tabindex="-1"></a><span class="vs">.calculang_title.calculang_title_renamed {</span></span>
<span id="cb28-252"><a href="#cb28-252" aria-hidden="true" tabindex="-1"></a><span class="vs">  text-decoration: line-through;</span></span>
<span id="cb28-253"><a href="#cb28-253" aria-hidden="true" tabindex="-1"></a><span class="vs">  text-decoration-style: dashed;</span></span>
<span id="cb28-254"><a href="#cb28-254" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb28-255"><a href="#cb28-255" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/style&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div id="ojs-cell-2" data-nodetype="expression">

</div>
</div>
</div>
<div class="cell hidden bslib-grid-item html-fill-item">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb29" data-startfrom="269" data-source-offset="-237"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 268;"><span id="cb29-269"><a href="#cb29-269" aria-hidden="true" tabindex="-1"></a>fizzbuzz <span class="op">=</span> <span class="cf">await</span> <span class="pp">require</span>(<span class="vs">`https://calculang.dev/models/fizzbuzz/fizzbuzz.js`</span>)</span>
<span id="cb29-270"><a href="#cb29-270" aria-hidden="true" tabindex="-1"></a>year_remaining <span class="op">=</span> <span class="cf">await</span> <span class="pp">require</span>(<span class="vs">`https://calculang.dev/models/year-remaining/year-remaining.js`</span>)</span>
<span id="cb29-271"><a href="#cb29-271" aria-hidden="true" tabindex="-1"></a>starfield <span class="op">=</span> <span class="cf">await</span> <span class="pp">require</span>(<span class="vs">`https://calculang.dev/models/starfield/starfield.js`</span>)</span>
<span id="cb29-272"><a href="#cb29-272" aria-hidden="true" tabindex="-1"></a><span class="co">// UPDATE1 LOAD MODEL USING CORRECT REF</span></span>
<span id="cb29-273"><a href="#cb29-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-274"><a href="#cb29-274" aria-hidden="true" tabindex="-1"></a>savings <span class="op">=</span> <span class="cf">await</span> <span class="pp">require</span>(<span class="vs">`https://calculang.dev/models/savings/savings.js`</span>)<span class="op">;</span></span>
<span id="cb29-275"><a href="#cb29-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-276"><a href="#cb29-276" aria-hidden="true" tabindex="-1"></a>savings_rec <span class="op">=</span> <span class="cf">await</span> <span class="pp">require</span>(<span class="vs">`https://calculang.dev/models/savings/savings-rec.js`</span>)</span>
<span id="cb29-277"><a href="#cb29-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-278"><a href="#cb29-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-279"><a href="#cb29-279" aria-hidden="true" tabindex="-1"></a>introspection_fetch <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>entrypoint_no_cul_js<span class="sc">}</span><span class="vs">.introspection.json`</span>)</span>
<span id="cb29-280"><a href="#cb29-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-281"><a href="#cb29-281" aria-hidden="true" tabindex="-1"></a>introspection <span class="op">=</span> <span class="cf">await</span> introspection_fetch<span class="op">.</span><span class="fu">json</span>({<span class="dt">typed</span><span class="op">:</span><span class="kw">true</span>})</span>
<span id="cb29-282"><a href="#cb29-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-283"><a href="#cb29-283" aria-hidden="true" tabindex="-1"></a>introspection_nomemo_fetch <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="vs">`</span><span class="sc">${</span>entrypoint_no_cul_js<span class="sc">}${</span>calculang_source_nomemo<span class="op">.</span><span class="at">length</span> <span class="op">?</span> <span class="st">'-nomemo'</span> <span class="op">:</span> <span class="st">''</span><span class="sc">}</span><span class="vs">.introspection.json`</span>)</span>
<span id="cb29-284"><a href="#cb29-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-285"><a href="#cb29-285" aria-hidden="true" tabindex="-1"></a>introspection_nomemo <span class="op">=</span> <span class="cf">await</span> introspection_nomemo_fetch<span class="op">.</span><span class="fu">json</span>({<span class="dt">typed</span><span class="op">:</span><span class="kw">true</span>})</span>
<span id="cb29-286"><a href="#cb29-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-287"><a href="#cb29-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-288"><a href="#cb29-288" aria-hidden="true" tabindex="-1"></a>calculang_source_introspection <span class="op">=</span> calculang_source_nomemo<span class="op">.</span><span class="at">length</span> <span class="op">?</span> introspection_nomemo <span class="op">:</span> introspection</span>
<span id="cb29-289"><a href="#cb29-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-290"><a href="#cb29-290" aria-hidden="true" tabindex="-1"></a>formulae_objs <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(calculang_source_introspection<span class="op">.</span><span class="at">cul_functions</span>)<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">reason</span> <span class="op">==</span> <span class="st">'definition'</span> <span class="op">&amp;&amp;</span> inputs<span class="op">.</span><span class="fu">indexOf</span>(d<span class="op">.</span><span class="at">name</span><span class="op">+</span><span class="st">'_in'</span>) <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb29-291"><a href="#cb29-291" aria-hidden="true" tabindex="-1"></a>input_formulae_objs <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(calculang_source_introspection<span class="op">.</span><span class="at">cul_functions</span>)<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">reason</span> <span class="op">==</span> <span class="st">'definition'</span> <span class="op">&amp;&amp;</span> inputs<span class="op">.</span><span class="fu">indexOf</span>(d<span class="op">.</span><span class="at">name</span><span class="op">+</span><span class="st">'_in'</span>) <span class="op">!=</span> <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb29-292"><a href="#cb29-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-293"><a href="#cb29-293" aria-hidden="true" tabindex="-1"></a>inputs <span class="op">=</span> _<span class="op">.</span><span class="fu">uniq</span>(<span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(calculang_source_introspection<span class="op">.</span><span class="at">cul_functions</span>)<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">reason</span> <span class="op">==</span> <span class="st">'input definition'</span>)<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">name</span>)<span class="op">.</span><span class="fu">sort</span>())</span>
<span id="cb29-294"><a href="#cb29-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-295"><a href="#cb29-295" aria-hidden="true" tabindex="-1"></a>fns0 <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(calculang_source_introspection<span class="op">.</span><span class="at">cul_functions</span>)<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">cul_scope_id</span> <span class="op">==</span> <span class="dv">0</span>)<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">inputs</span>)<span class="op">.</span><span class="fu">flat</span>()</span>
<span id="cb29-296"><a href="#cb29-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-297"><a href="#cb29-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-298"><a href="#cb29-298" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { CodeMirror<span class="op">,</span> loadCodeMirrorModules } <span class="im">from</span> <span class="st">"@jmatsushita/codemirror@670"</span><span class="op">;</span></span>
<span id="cb29-299"><a href="#cb29-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-300"><a href="#cb29-300" aria-hidden="true" tabindex="-1"></a>cmImports <span class="op">=</span> <span class="fu">loadCodeMirrorModules</span>([</span>
<span id="cb29-301"><a href="#cb29-301" aria-hidden="true" tabindex="-1"></a>  <span class="st">"view@6.22.2"</span><span class="op">,</span> <span class="co">// chk versions?</span></span>
<span id="cb29-302"><a href="#cb29-302" aria-hidden="true" tabindex="-1"></a>  <span class="st">"state@6.3.3"</span><span class="op">,</span></span>
<span id="cb29-303"><a href="#cb29-303" aria-hidden="true" tabindex="-1"></a>  <span class="st">"language@6.9.3"</span><span class="op">,</span></span>
<span id="cb29-304"><a href="#cb29-304" aria-hidden="true" tabindex="-1"></a>  <span class="st">"lang-javascript"</span></span>
<span id="cb29-305"><a href="#cb29-305" aria-hidden="true" tabindex="-1"></a>  <span class="co">//"commands@6.3.2",</span></span>
<span id="cb29-306"><a href="#cb29-306" aria-hidden="true" tabindex="-1"></a>])<span class="op">;</span></span>
<span id="cb29-307"><a href="#cb29-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-308"><a href="#cb29-308" aria-hidden="true" tabindex="-1"></a>EditorView <span class="op">=</span> cmImports<span class="op">.</span><span class="at">view</span><span class="op">.</span><span class="at">EditorView</span></span>
<span id="cb29-309"><a href="#cb29-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-310"><a href="#cb29-310" aria-hidden="true" tabindex="-1"></a>EditorState <span class="op">=</span> cmImports<span class="op">.</span><span class="at">state</span><span class="op">.</span><span class="at">EditorState</span></span>
<span id="cb29-311"><a href="#cb29-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-312"><a href="#cb29-312" aria-hidden="true" tabindex="-1"></a>Decoration <span class="op">=</span> cmImports<span class="op">.</span><span class="at">view</span><span class="op">.</span><span class="at">Decoration</span></span>
<span id="cb29-313"><a href="#cb29-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-314"><a href="#cb29-314" aria-hidden="true" tabindex="-1"></a><span class="kw">set</span> <span class="op">=</span> (input<span class="op">,</span> value) <span class="kw">=&gt;</span> {</span>
<span id="cb29-315"><a href="#cb29-315" aria-hidden="true" tabindex="-1"></a>  input<span class="op">.</span><span class="at">value</span> <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb29-316"><a href="#cb29-316" aria-hidden="true" tabindex="-1"></a>  input<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">Event</span>(<span class="st">"input"</span><span class="op">,</span> {<span class="dt">bubbles</span><span class="op">:</span> <span class="kw">true</span>}))<span class="op">;</span></span>
<span id="cb29-317"><a href="#cb29-317" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-318"><a href="#cb29-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-319"><a href="#cb29-319" aria-hidden="true" tabindex="-1"></a><span class="co">//////////// plugin 1: decoration &amp; cul navigation for function-level</span></span>
<span id="cb29-320"><a href="#cb29-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-321"><a href="#cb29-321" aria-hidden="true" tabindex="-1"></a>syntaxTree <span class="op">=</span> cmImports<span class="op">.</span><span class="at">language</span><span class="op">.</span><span class="at">syntaxTree</span></span>
<span id="cb29-322"><a href="#cb29-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-323"><a href="#cb29-323" aria-hidden="true" tabindex="-1"></a>formulaDecorations <span class="op">=</span> {</span>
<span id="cb29-324"><a href="#cb29-324" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (options) <span class="kw">=&gt;</span> {</span>
<span id="cb29-325"><a href="#cb29-325" aria-hidden="true" tabindex="-1"></a>    <span class="co">//set(options.formulae_visible, [""]) // this was doing a lot of jank!!</span></span>
<span id="cb29-326"><a href="#cb29-326" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> formulaDecorations <span class="op">=</span> cmImports<span class="op">.</span><span class="at">view</span><span class="op">.</span><span class="at">ViewPlugin</span><span class="op">.</span><span class="fu">fromClass</span>(</span>
<span id="cb29-327"><a href="#cb29-327" aria-hidden="true" tabindex="-1"></a>      <span class="kw">class</span> {</span>
<span id="cb29-328"><a href="#cb29-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-329"><a href="#cb29-329" aria-hidden="true" tabindex="-1"></a>        <span class="fu">constructor</span>(view) {</span>
<span id="cb29-330"><a href="#cb29-330" aria-hidden="true" tabindex="-1"></a>          <span class="kw">this</span><span class="op">.</span><span class="at">decorations</span> <span class="op">=</span> <span class="fu">formulaDecoration</span>(view)<span class="op">;</span></span>
<span id="cb29-331"><a href="#cb29-331" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb29-332"><a href="#cb29-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-333"><a href="#cb29-333" aria-hidden="true" tabindex="-1"></a>        <span class="fu">update</span>(update) {</span>
<span id="cb29-334"><a href="#cb29-334" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (update<span class="op">.</span><span class="at">docChanged</span> <span class="op">||</span> update<span class="op">.</span><span class="at">viewportChanged</span>)</span>
<span id="cb29-335"><a href="#cb29-335" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">decorations</span> <span class="op">=</span> <span class="fu">formulaDecoration</span>(update<span class="op">.</span><span class="at">view</span>)<span class="op">;</span></span>
<span id="cb29-336"><a href="#cb29-336" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb29-337"><a href="#cb29-337" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb29-338"><a href="#cb29-338" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb29-339"><a href="#cb29-339" aria-hidden="true" tabindex="-1"></a>        <span class="dt">decorations</span><span class="op">:</span> (v) <span class="kw">=&gt;</span> v<span class="op">.</span><span class="at">decorations</span><span class="op">,</span></span>
<span id="cb29-340"><a href="#cb29-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-341"><a href="#cb29-341" aria-hidden="true" tabindex="-1"></a>        <span class="dt">eventHandlers</span><span class="op">:</span> {</span>
<span id="cb29-342"><a href="#cb29-342" aria-hidden="true" tabindex="-1"></a>          <span class="dt">mousedown</span><span class="op">:</span> (e<span class="op">,</span> view) <span class="kw">=&gt;</span> { <span class="co">// HMMM I'll need to resolve that calls get precedence!!! Should be working:</span></span>
<span id="cb29-343"><a href="#cb29-343" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> classList <span class="op">=</span> [<span class="op">...</span>e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">classList</span><span class="op">,</span> <span class="op">...</span>e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">parentElement</span><span class="op">.</span><span class="at">classList</span>] <span class="co">// very open, be aware of bugs ?!</span></span>
<span id="cb29-344"><a href="#cb29-344" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">contains</span>(<span class="st">"cul_call"</span>)) <span class="co">// </span><span class="al">TODO</span></span>
<span id="cb29-345"><a href="#cb29-345" aria-hidden="true" tabindex="-1"></a>              <span class="dv">1</span><span class="op">;</span><span class="co">//set(viewof formulae_shown, [target.textContent]); </span><span class="al">TODO</span></span>
<span id="cb29-346"><a href="#cb29-346" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="cf">if</span> (</span>
<span id="cb29-347"><a href="#cb29-347" aria-hidden="true" tabindex="-1"></a>              <span class="co">//e.target.classList.contains("deposits") ||</span></span>
<span id="cb29-348"><a href="#cb29-348" aria-hidden="true" tabindex="-1"></a>              <span class="co">//e.target.parentElement.classList.contains("deposits")</span></span>
<span id="cb29-349"><a href="#cb29-349" aria-hidden="true" tabindex="-1"></a>              classList<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">includes</span>(<span class="st">"calculang_f_"</span>))<span class="op">.</span><span class="at">length</span></span>
<span id="cb29-350"><a href="#cb29-350" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb29-351"><a href="#cb29-351" aria-hidden="true" tabindex="-1"></a>              <span class="kw">set</span>(options<span class="op">.</span><span class="at">formulae_visible</span><span class="op">,</span> [classList<span class="op">.</span><span class="fu">find</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">includes</span>(<span class="st">"calculang_f_"</span>))<span class="op">.</span><span class="fu">slice</span>(<span class="st">"calculang_f_"</span><span class="op">.</span><span class="at">length</span>)])<span class="op">;</span></span>
<span id="cb29-352"><a href="#cb29-352" aria-hidden="true" tabindex="-1"></a>              <span class="co">/////// causes unnecessary jitter when we already see f document.querySelector('.'+classList.find(d =&gt; d.includes("calculang_f_"))).scrollIntoView(scrollIntoViewOpts)</span></span>
<span id="cb29-353"><a href="#cb29-353" aria-hidden="true" tabindex="-1"></a>              <span class="co">//trying it </span></span>
<span id="cb29-354"><a href="#cb29-354" aria-hidden="true" tabindex="-1"></a>              <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'.'</span><span class="op">+</span>classList<span class="op">.</span><span class="fu">find</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">includes</span>(<span class="st">"calculang_f_"</span>)))<span class="op">.</span><span class="fu">scrollIntoView</span>(scrollIntoViewOpts)</span>
<span id="cb29-355"><a href="#cb29-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-356"><a href="#cb29-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-357"><a href="#cb29-357" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb29-358"><a href="#cb29-358" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb29-359"><a href="#cb29-359" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb29-360"><a href="#cb29-360" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb29-361"><a href="#cb29-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-362"><a href="#cb29-362" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [formulaDecorations]<span class="op">;</span></span>
<span id="cb29-363"><a href="#cb29-363" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-364"><a href="#cb29-364" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-365"><a href="#cb29-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-366"><a href="#cb29-366" aria-hidden="true" tabindex="-1"></a><span class="co">// Decoration.lines</span></span>
<span id="cb29-367"><a href="#cb29-367" aria-hidden="true" tabindex="-1"></a>formulaDecoration <span class="op">=</span> (view) <span class="kw">=&gt;</span> Decoration<span class="op">.</span><span class="fu">set</span>(</span>
<span id="cb29-368"><a href="#cb29-368" aria-hidden="true" tabindex="-1"></a>  formula_line_details</span>
<span id="cb29-369"><a href="#cb29-369" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span></span>
<span id="cb29-370"><a href="#cb29-370" aria-hidden="true" tabindex="-1"></a>      _<span class="op">.</span><span class="fu">range</span>(d<span class="op">.</span><span class="at">lineStart</span><span class="op">,</span> d<span class="op">.</span><span class="at">lineEnd</span> <span class="op">+</span> <span class="fl">0.1</span>)<span class="op">.</span><span class="fu">map</span>((e) <span class="kw">=&gt;</span></span>
<span id="cb29-371"><a href="#cb29-371" aria-hidden="true" tabindex="-1"></a>        Decoration<span class="op">.</span><span class="fu">line</span>({</span>
<span id="cb29-372"><a href="#cb29-372" aria-hidden="true" tabindex="-1"></a>          <span class="dt">attributes</span><span class="op">:</span> {</span>
<span id="cb29-373"><a href="#cb29-373" aria-hidden="true" tabindex="-1"></a>            <span class="dt">class</span><span class="op">:</span> <span class="st">"calculang"</span> <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> <span class="st">"calculang_f_"</span><span class="op">+</span>d<span class="op">.</span><span class="at">name</span> <span class="op">+</span> (d<span class="op">.</span><span class="at">overwritten</span> <span class="op">?</span> <span class="st">' calculang_overwritten'</span> <span class="op">:</span> <span class="st">''</span>) <span class="co">/* +style available */</span> <span class="co">// leaving scope and other potential conflicts out</span></span>
<span id="cb29-374"><a href="#cb29-374" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb29-375"><a href="#cb29-375" aria-hidden="true" tabindex="-1"></a>        })<span class="op">.</span><span class="fu">range</span>(view<span class="op">.</span><span class="at">state</span><span class="op">.</span><span class="at">doc</span><span class="op">.</span><span class="fu">line</span>(e)<span class="op">.</span><span class="at">from</span>)</span>
<span id="cb29-376"><a href="#cb29-376" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb29-377"><a href="#cb29-377" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-378"><a href="#cb29-378" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">flat</span>())</span>
<span id="cb29-379"><a href="#cb29-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-380"><a href="#cb29-380" aria-hidden="true" tabindex="-1"></a>formula_line_details <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(calculang_source_introspection<span class="op">.</span><span class="at">cul_functions</span>)</span>
<span id="cb29-381"><a href="#cb29-381" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">reason</span><span class="op">.</span><span class="fu">includes</span>(<span class="st">"definition"</span>) <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">name</span><span class="op">.</span><span class="fu">slice</span>(<span class="op">-</span><span class="dv">3</span>) <span class="op">!=</span> <span class="st">'_in'</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">cul_scope_id</span> <span class="op">==</span> cul_scope_id)</span>
<span id="cb29-382"><a href="#cb29-382" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>(({ name<span class="op">,</span> loc<span class="op">,</span> reason }) <span class="kw">=&gt;</span> ({</span>
<span id="cb29-383"><a href="#cb29-383" aria-hidden="true" tabindex="-1"></a>    name<span class="op">,</span></span>
<span id="cb29-384"><a href="#cb29-384" aria-hidden="true" tabindex="-1"></a>    <span class="dt">lineStart</span><span class="op">:</span> loc<span class="op">?.</span><span class="at">start</span><span class="op">.</span><span class="at">line</span><span class="op">,</span></span>
<span id="cb29-385"><a href="#cb29-385" aria-hidden="true" tabindex="-1"></a>    <span class="dt">lineEnd</span><span class="op">:</span> loc<span class="op">?.</span><span class="at">end</span><span class="op">.</span><span class="at">line</span><span class="op">,</span></span>
<span id="cb29-386"><a href="#cb29-386" aria-hidden="true" tabindex="-1"></a>    <span class="dt">overwritten</span><span class="op">:</span> name<span class="op">.</span><span class="fu">slice</span>(<span class="op">-</span><span class="dv">1</span>) <span class="op">==</span> <span class="st">'_'</span> <span class="op">&amp;&amp;</span> <span class="op">!</span>(<span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(calculang_source_introspection<span class="op">.</span><span class="at">cul_functions</span>)<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">imported</span> <span class="op">==</span> name <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">cul_source_scope_id</span> <span class="op">==</span> cul_scope_id))<span class="op">.</span><span class="at">length</span> <span class="co">// and not explicit imported/used in parent defn</span></span>
<span id="cb29-387"><a href="#cb29-387" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb29-388"><a href="#cb29-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-389"><a href="#cb29-389" aria-hidden="true" tabindex="-1"></a>formula_line_details_0 <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(calculang_source_introspection<span class="op">.</span><span class="at">cul_functions</span>)</span>
<span id="cb29-390"><a href="#cb29-390" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">reason</span><span class="op">.</span><span class="fu">includes</span>(<span class="st">"definition"</span>) <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">name</span><span class="op">.</span><span class="fu">slice</span>(<span class="op">-</span><span class="dv">3</span>) <span class="op">!=</span> <span class="st">'_in'</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">cul_scope_id</span> <span class="op">==</span> <span class="dv">0</span>)</span>
<span id="cb29-391"><a href="#cb29-391" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>(({ name<span class="op">,</span> loc<span class="op">,</span> reason }) <span class="kw">=&gt;</span> ({</span>
<span id="cb29-392"><a href="#cb29-392" aria-hidden="true" tabindex="-1"></a>    name<span class="op">,</span></span>
<span id="cb29-393"><a href="#cb29-393" aria-hidden="true" tabindex="-1"></a>    <span class="dt">lineStart</span><span class="op">:</span> loc<span class="op">?.</span><span class="at">start</span><span class="op">.</span><span class="at">line</span><span class="op">,</span></span>
<span id="cb29-394"><a href="#cb29-394" aria-hidden="true" tabindex="-1"></a>    <span class="dt">lineEnd</span><span class="op">:</span> loc<span class="op">?.</span><span class="at">end</span><span class="op">.</span><span class="at">line</span><span class="op">,</span></span>
<span id="cb29-395"><a href="#cb29-395" aria-hidden="true" tabindex="-1"></a>    <span class="dt">overwritten</span><span class="op">:</span> name<span class="op">.</span><span class="fu">slice</span>(<span class="op">-</span><span class="dv">1</span>) <span class="op">==</span> <span class="st">'_'</span> <span class="op">&amp;&amp;</span> <span class="op">!</span>(<span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(calculang_source_introspection<span class="op">.</span><span class="at">cul_functions</span>)<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">imported</span> <span class="op">==</span> name))<span class="op">.</span><span class="at">length</span> <span class="co">// and not explicit imported/used in parent defn</span></span>
<span id="cb29-396"><a href="#cb29-396" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb29-397"><a href="#cb29-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-398"><a href="#cb29-398" aria-hidden="true" tabindex="-1"></a><span class="co">//////////// plugin 2: decoration &amp; cul navigation for call-level, also decoration for titles. By syntax tree analysis</span></span>
<span id="cb29-399"><a href="#cb29-399" aria-hidden="true" tabindex="-1"></a><span class="co">// uses formulae_all, inputs: should derive from entrypoint/introspection before splitting up</span></span>
<span id="cb29-400"><a href="#cb29-400" aria-hidden="true" tabindex="-1"></a><span class="co">// also sets formae_visible</span></span>
<span id="cb29-401"><a href="#cb29-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-402"><a href="#cb29-402" aria-hidden="true" tabindex="-1"></a><span class="co">// inconsistent naming !</span></span>
<span id="cb29-403"><a href="#cb29-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-404"><a href="#cb29-404" aria-hidden="true" tabindex="-1"></a>formulae_hidden <span class="op">=</span> formulae_all<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> <span class="op">!</span>formulae_visible<span class="op">.</span><span class="fu">includes</span>(d))</span>
<span id="cb29-405"><a href="#cb29-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-406"><a href="#cb29-406" aria-hidden="true" tabindex="-1"></a>formulae_all <span class="op">=</span> formula_line_details<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">name</span>) <span class="co">// poor?</span></span>
<span id="cb29-407"><a href="#cb29-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-408"><a href="#cb29-408" aria-hidden="true" tabindex="-1"></a>viewof hover <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">text</span>(<span class="st">""</span>)</span>
<span id="cb29-409"><a href="#cb29-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-410"><a href="#cb29-410" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb29-411"><a href="#cb29-411" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">'eee'</span><span class="op">,</span> hover)</span>
<span id="cb29-412"><a href="#cb29-412" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (hover <span class="op">==</span> <span class="st">'rv_hit_distance'</span>) {</span>
<span id="cb29-413"><a href="#cb29-413" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span>(viewof show_ray_v<span class="op">,</span> <span class="kw">true</span>)</span>
<span id="cb29-414"><a href="#cb29-414" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span>(viewof show_ray_h<span class="op">,</span> <span class="kw">false</span>)</span>
<span id="cb29-415"><a href="#cb29-415" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-416"><a href="#cb29-416" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (hover <span class="op">==</span> <span class="st">'rh_hit_distance'</span>) {</span>
<span id="cb29-417"><a href="#cb29-417" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span>(viewof show_ray_v<span class="op">,</span> <span class="kw">false</span>)</span>
<span id="cb29-418"><a href="#cb29-418" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span>(viewof show_ray_h<span class="op">,</span> <span class="kw">true</span>)</span>
<span id="cb29-419"><a href="#cb29-419" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-420"><a href="#cb29-420" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-4" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-5" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-6" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-7" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-8" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-9" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-10" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-11" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-12" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-13" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-14" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-15" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-16" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-17" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-18" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-19" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-20" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-21" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-22" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-23" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-24" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-25" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-26" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-27" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-28" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-29" data-nodetype="expression">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden" id="cb30" data-startfrom="424" data-source-offset="-6296"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 423;"><span id="cb30-424"><a href="#cb30-424" aria-hidden="true" tabindex="-1"></a>calculang_identifier_decorations <span class="op">=</span> {</span>
<span id="cb30-425"><a href="#cb30-425" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (options) <span class="kw">=&gt;</span> {</span>
<span id="cb30-426"><a href="#cb30-426" aria-hidden="true" tabindex="-1"></a>    <span class="co">//set(options.formulae_visible, formulae_all) // WHERE DOES THIS NEED TO GO?</span></span>
<span id="cb30-427"><a href="#cb30-427" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> decorations <span class="op">=</span> cmImports<span class="op">.</span><span class="at">view</span><span class="op">.</span><span class="at">ViewPlugin</span><span class="op">.</span><span class="fu">fromClass</span>(</span>
<span id="cb30-428"><a href="#cb30-428" aria-hidden="true" tabindex="-1"></a>      <span class="kw">class</span> {</span>
<span id="cb30-429"><a href="#cb30-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-430"><a href="#cb30-430" aria-hidden="true" tabindex="-1"></a>        <span class="fu">constructor</span>(view) {</span>
<span id="cb30-431"><a href="#cb30-431" aria-hidden="true" tabindex="-1"></a>          <span class="kw">this</span><span class="op">.</span><span class="at">decorations</span> <span class="op">=</span> <span class="fu">identifier_decorations</span>(view)<span class="op">;</span></span>
<span id="cb30-432"><a href="#cb30-432" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb30-433"><a href="#cb30-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-434"><a href="#cb30-434" aria-hidden="true" tabindex="-1"></a>        <span class="fu">update</span>(update) {</span>
<span id="cb30-435"><a href="#cb30-435" aria-hidden="true" tabindex="-1"></a>          <span class="co">//debugger; this is called a LOT!!</span></span>
<span id="cb30-436"><a href="#cb30-436" aria-hidden="true" tabindex="-1"></a>          <span class="co">//if (update.docChanged || update.focusChanged|| update.viewportChanged || update.geometryChanged || update.heightChanged) // expensive things on scroll, but didn't run on full doc for some reason?!</span></span>
<span id="cb30-437"><a href="#cb30-437" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">decorations</span> <span class="op">=</span> <span class="fu">identifier_decorations</span>(update<span class="op">.</span><span class="at">view</span>)<span class="op">;</span></span>
<span id="cb30-438"><a href="#cb30-438" aria-hidden="true" tabindex="-1"></a>            <span class="co">// why </span></span>
<span id="cb30-439"><a href="#cb30-439" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb30-440"><a href="#cb30-440" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb30-441"><a href="#cb30-441" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb30-442"><a href="#cb30-442" aria-hidden="true" tabindex="-1"></a>        <span class="dt">decorations</span><span class="op">:</span> (v) <span class="kw">=&gt;</span> v<span class="op">.</span><span class="at">decorations</span><span class="op">,</span></span>
<span id="cb30-443"><a href="#cb30-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-444"><a href="#cb30-444" aria-hidden="true" tabindex="-1"></a>        <span class="dt">eventHandlers</span><span class="op">:</span> {</span>
<span id="cb30-445"><a href="#cb30-445" aria-hidden="true" tabindex="-1"></a>          <span class="dt">mousemove</span><span class="op">:</span> (e<span class="op">,</span> view) <span class="kw">=&gt;</span> {</span>
<span id="cb30-446"><a href="#cb30-446" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> classList <span class="op">=</span> [<span class="op">...</span>e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">classList</span><span class="op">,</span> <span class="op">...</span>e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">parentElement</span><span class="op">.</span><span class="at">classList</span>] <span class="co">// very open, be aware of bugs ?!</span></span>
<span id="cb30-447"><a href="#cb30-447" aria-hidden="true" tabindex="-1"></a>                        <span class="kw">let</span> c <span class="op">=</span> classList<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">includes</span>(<span class="st">"calculang_call_"</span>))</span>
<span id="cb30-448"><a href="#cb30-448" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> cc<span class="op">=</span> <span class="st">'badvalue'</span><span class="op">;</span></span>
<span id="cb30-449"><a href="#cb30-449" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (c<span class="op">.</span><span class="at">length</span>) cc <span class="op">=</span> c[<span class="dv">0</span>]<span class="op">.</span><span class="fu">slice</span>(<span class="st">"calculang_call_"</span><span class="op">.</span><span class="at">length</span>)</span>
<span id="cb30-450"><a href="#cb30-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-451"><a href="#cb30-451" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">contains</span>(<span class="st">"calculang_call"</span>) <span class="op">||</span> classList<span class="op">.</span><span class="fu">includes</span>(<span class="st">"calculang_title"</span>)) { <span class="co">// </span><span class="al">TODO</span><span class="co"> only if the containing formula is visible, I have options.formulae_visible:</span></span>
<span id="cb30-452"><a href="#cb30-452" aria-hidden="true" tabindex="-1"></a>            <span class="co">//console.log('HIHIHIEE')</span></span>
<span id="cb30-453"><a href="#cb30-453" aria-hidden="true" tabindex="-1"></a>            <span class="co">//debugger;</span></span>
<span id="cb30-454"><a href="#cb30-454" aria-hidden="true" tabindex="-1"></a>              <span class="kw">set</span>(viewof hover<span class="op">,</span> cc) <span class="co">// too many triggers !</span></span>
<span id="cb30-455"><a href="#cb30-455" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb30-456"><a href="#cb30-456" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb30-457"><a href="#cb30-457" aria-hidden="true" tabindex="-1"></a>          }<span class="op">,</span></span>
<span id="cb30-458"><a href="#cb30-458" aria-hidden="true" tabindex="-1"></a>          <span class="dt">mousedown</span><span class="op">:</span> (e<span class="op">,</span> view) <span class="kw">=&gt;</span> {</span>
<span id="cb30-459"><a href="#cb30-459" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> classList <span class="op">=</span> [<span class="op">...</span>e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">classList</span><span class="op">,</span> <span class="op">...</span>e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">parentElement</span><span class="op">.</span><span class="at">classList</span>] <span class="co">// very open, be aware of bugs ?!</span></span>
<span id="cb30-460"><a href="#cb30-460" aria-hidden="true" tabindex="-1"></a>                        <span class="kw">let</span> c <span class="op">=</span> classList<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">includes</span>(<span class="st">"calculang_call_"</span>) <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="st">"calculang_call_input"</span>)</span>
<span id="cb30-461"><a href="#cb30-461" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> cc<span class="op">=</span> <span class="st">'badvalue'</span><span class="op">;</span></span>
<span id="cb30-462"><a href="#cb30-462" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (c<span class="op">.</span><span class="at">length</span>) cc <span class="op">=</span> c[<span class="dv">0</span>]<span class="op">.</span><span class="fu">slice</span>(<span class="st">"calculang_call_"</span><span class="op">.</span><span class="at">length</span>)</span>
<span id="cb30-463"><a href="#cb30-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-464"><a href="#cb30-464" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (e<span class="op">.</span><span class="at">target</span><span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">contains</span>(<span class="st">"calculang_call"</span>) <span class="op">||</span> classList<span class="op">.</span><span class="fu">includes</span>(<span class="st">"calculang_title"</span>)) { <span class="co">// </span><span class="al">TODO</span><span class="co"> only if the containing formula is visible, I have options.formulae_visible:</span></span>
<span id="cb30-465"><a href="#cb30-465" aria-hidden="true" tabindex="-1"></a>            <span class="co">//console.log('HIHIHIEE')</span></span>
<span id="cb30-466"><a href="#cb30-466" aria-hidden="true" tabindex="-1"></a>            <span class="co">//debugger;</span></span>
<span id="cb30-467"><a href="#cb30-467" aria-hidden="true" tabindex="-1"></a>              <span class="kw">set</span>(options<span class="op">.</span><span class="at">formulae_visible</span><span class="op">,</span> [cc])</span>
<span id="cb30-468"><a href="#cb30-468" aria-hidden="true" tabindex="-1"></a>              <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'.calculang_f_'</span><span class="op">+</span>cc)<span class="op">.</span><span class="fu">scrollIntoView</span>(scrollIntoViewOpts)</span>
<span id="cb30-469"><a href="#cb30-469" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb30-470"><a href="#cb30-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-471"><a href="#cb30-471" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="cf">if</span> (</span>
<span id="cb30-472"><a href="#cb30-472" aria-hidden="true" tabindex="-1"></a>              <span class="co">//e.target.classList.contains("deposits") ||</span></span>
<span id="cb30-473"><a href="#cb30-473" aria-hidden="true" tabindex="-1"></a>              <span class="co">//e.target.parentElement.classList.contains("deposits")</span></span>
<span id="cb30-474"><a href="#cb30-474" aria-hidden="true" tabindex="-1"></a>              classList<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">includes</span>(<span class="st">"calculang_f_"</span>))<span class="op">.</span><span class="at">length</span></span>
<span id="cb30-475"><a href="#cb30-475" aria-hidden="true" tabindex="-1"></a>            ) { <span class="co">// this is setting when you click in the area of a formula - no need to scroll</span></span>
<span id="cb30-476"><a href="#cb30-476" aria-hidden="true" tabindex="-1"></a>              <span class="kw">set</span>(options<span class="op">.</span><span class="at">formulae_visible</span><span class="op">,</span> [classList<span class="op">.</span><span class="fu">find</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">includes</span>(<span class="st">"calculang_f_"</span>))<span class="op">.</span><span class="fu">slice</span>(<span class="st">"calculang_f_"</span><span class="op">.</span><span class="at">length</span>)])<span class="op">;</span></span>
<span id="cb30-477"><a href="#cb30-477" aria-hidden="true" tabindex="-1"></a>              <span class="co">//document.querySelector('.'+classList.find(d =&gt; d.includes("calculang_f_"))).scrollIntoView(scrollIntoViewOpts)</span></span>
<span id="cb30-478"><a href="#cb30-478" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb30-479"><a href="#cb30-479" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb30-480"><a href="#cb30-480" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb30-481"><a href="#cb30-481" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb30-482"><a href="#cb30-482" aria-hidden="true" tabindex="-1"></a>    )<span class="op">;</span></span>
<span id="cb30-483"><a href="#cb30-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-484"><a href="#cb30-484" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [decorations]<span class="op">;</span></span>
<span id="cb30-485"><a href="#cb30-485" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-486"><a href="#cb30-486" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-487"><a href="#cb30-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-488"><a href="#cb30-488" aria-hidden="true" tabindex="-1"></a><span class="co">// Decoration.marks specified by ranges</span></span>
<span id="cb30-489"><a href="#cb30-489" aria-hidden="true" tabindex="-1"></a>identifier_decorations <span class="op">=</span> view <span class="kw">=&gt;</span> {</span>
<span id="cb30-490"><a href="#cb30-490" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> decorations <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb30-491"><a href="#cb30-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-492"><a href="#cb30-492" aria-hidden="true" tabindex="-1"></a>  <span class="co">//for (let { from, to } of view.visibleRanges) {</span></span>
<span id="cb30-493"><a href="#cb30-493" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(view<span class="op">.</span><span class="at">state</span>)</span>
<span id="cb30-494"><a href="#cb30-494" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(view<span class="op">.</span><span class="at">visibleRanges</span>)</span>
<span id="cb30-495"><a href="#cb30-495" aria-hidden="true" tabindex="-1"></a>  <span class="co">//for (let { from, to } of [{from: 0, to: 1000}]) {</span></span>
<span id="cb30-496"><a href="#cb30-496" aria-hidden="true" tabindex="-1"></a>    <span class="co">//debugger;</span></span>
<span id="cb30-497"><a href="#cb30-497" aria-hidden="true" tabindex="-1"></a>    <span class="co">//debugger;</span></span>
<span id="cb30-498"><a href="#cb30-498" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">let</span> { <span class="im">from</span><span class="op">,</span> to } <span class="kw">of</span> view<span class="op">.</span><span class="at">visibleRanges</span>) {</span>
<span id="cb30-499"><a href="#cb30-499" aria-hidden="true" tabindex="-1"></a>    <span class="co">//for (let { from, to } of [{from:0, to:5000}]) {</span></span>
<span id="cb30-500"><a href="#cb30-500" aria-hidden="true" tabindex="-1"></a>      <span class="co">//cmImports.language.syntaxTreeAvailable(view.state, )</span></span>
<span id="cb30-501"><a href="#cb30-501" aria-hidden="true" tabindex="-1"></a>      <span class="co">//cmImports.language.forceParsing(view, )</span></span>
<span id="cb30-502"><a href="#cb30-502" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb30-503"><a href="#cb30-503" aria-hidden="true" tabindex="-1"></a>    cmImports<span class="op">.</span><span class="at">language</span><span class="op">.</span><span class="fu">syntaxTree</span>(view<span class="op">.</span><span class="at">state</span>)<span class="op">.</span><span class="fu">iterate</span>({</span>
<span id="cb30-504"><a href="#cb30-504" aria-hidden="true" tabindex="-1"></a>      <span class="im">from</span><span class="op">,</span></span>
<span id="cb30-505"><a href="#cb30-505" aria-hidden="true" tabindex="-1"></a>      to<span class="op">,</span></span>
<span id="cb30-506"><a href="#cb30-506" aria-hidden="true" tabindex="-1"></a>      <span class="dt">enter</span><span class="op">:</span> (node) <span class="kw">=&gt;</span> {</span>
<span id="cb30-507"><a href="#cb30-507" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (node<span class="op">.</span><span class="at">name</span> <span class="op">==</span> <span class="st">"VariableDefinition"</span>) {</span>
<span id="cb30-508"><a href="#cb30-508" aria-hidden="true" tabindex="-1"></a>          <span class="kw">let</span> name <span class="op">=</span> view<span class="op">.</span><span class="at">state</span><span class="op">.</span><span class="at">doc</span><span class="op">.</span><span class="fu">sliceString</span>(node<span class="op">.</span><span class="at">from</span><span class="op">,</span> node<span class="op">.</span><span class="at">to</span>)<span class="op">;</span></span>
<span id="cb30-509"><a href="#cb30-509" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (formulae_all<span class="op">.</span><span class="fu">includes</span>(name)) {</span>
<span id="cb30-510"><a href="#cb30-510" aria-hidden="true" tabindex="-1"></a>            decorations<span class="op">.</span><span class="fu">push</span>(</span>
<span id="cb30-511"><a href="#cb30-511" aria-hidden="true" tabindex="-1"></a>              Decoration<span class="op">.</span><span class="fu">mark</span>({ <span class="dt">class</span><span class="op">:</span> <span class="st">"calculang_title"</span> })<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb30-512"><a href="#cb30-512" aria-hidden="true" tabindex="-1"></a>                node<span class="op">.</span><span class="at">from</span><span class="op">,</span></span>
<span id="cb30-513"><a href="#cb30-513" aria-hidden="true" tabindex="-1"></a>                node<span class="op">.</span><span class="at">to</span></span>
<span id="cb30-514"><a href="#cb30-514" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb30-515"><a href="#cb30-515" aria-hidden="true" tabindex="-1"></a>            )<span class="op">;</span></span>
<span id="cb30-516"><a href="#cb30-516" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb30-517"><a href="#cb30-517" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (formulae_all<span class="op">.</span><span class="fu">includes</span>(name <span class="op">+</span> <span class="st">'_'</span>)) {</span>
<span id="cb30-518"><a href="#cb30-518" aria-hidden="true" tabindex="-1"></a>            decorations<span class="op">.</span><span class="fu">push</span>(</span>
<span id="cb30-519"><a href="#cb30-519" aria-hidden="true" tabindex="-1"></a>              Decoration<span class="op">.</span><span class="fu">mark</span>({ <span class="dt">class</span><span class="op">:</span> <span class="st">"calculang_title calculang_title_renamed"</span> })<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb30-520"><a href="#cb30-520" aria-hidden="true" tabindex="-1"></a>                node<span class="op">.</span><span class="at">from</span><span class="op">,</span></span>
<span id="cb30-521"><a href="#cb30-521" aria-hidden="true" tabindex="-1"></a>                node<span class="op">.</span><span class="at">to</span></span>
<span id="cb30-522"><a href="#cb30-522" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb30-523"><a href="#cb30-523" aria-hidden="true" tabindex="-1"></a>            )<span class="op">;</span></span>
<span id="cb30-524"><a href="#cb30-524" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb30-525"><a href="#cb30-525" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb30-526"><a href="#cb30-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-527"><a href="#cb30-527" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (node<span class="op">.</span><span class="at">name</span> <span class="op">==</span> <span class="st">"VariableName"</span>) {</span>
<span id="cb30-528"><a href="#cb30-528" aria-hidden="true" tabindex="-1"></a>          <span class="kw">let</span> name <span class="op">=</span> view<span class="op">.</span><span class="at">state</span><span class="op">.</span><span class="at">doc</span><span class="op">.</span><span class="fu">sliceString</span>(node<span class="op">.</span><span class="at">from</span><span class="op">,</span> node<span class="op">.</span><span class="at">to</span>)<span class="op">;</span></span>
<span id="cb30-529"><a href="#cb30-529" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (formulae_all<span class="op">.</span><span class="fu">includes</span>(name)) {</span>
<span id="cb30-530"><a href="#cb30-530" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (inputs<span class="op">.</span><span class="fu">includes</span>(name <span class="op">+</span> <span class="st">"_in"</span>))</span>
<span id="cb30-531"><a href="#cb30-531" aria-hidden="true" tabindex="-1"></a>              decorations<span class="op">.</span><span class="fu">push</span>(</span>
<span id="cb30-532"><a href="#cb30-532" aria-hidden="true" tabindex="-1"></a>                Decoration<span class="op">.</span><span class="fu">mark</span>({ <span class="dt">class</span><span class="op">:</span> <span class="vs">`calculang_call calculang_call_input calculang_call_</span><span class="sc">${</span>name<span class="sc">}</span><span class="vs">`</span> })<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb30-533"><a href="#cb30-533" aria-hidden="true" tabindex="-1"></a>                  node<span class="op">.</span><span class="at">from</span><span class="op">,</span></span>
<span id="cb30-534"><a href="#cb30-534" aria-hidden="true" tabindex="-1"></a>                  node<span class="op">.</span><span class="at">to</span></span>
<span id="cb30-535"><a href="#cb30-535" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb30-536"><a href="#cb30-536" aria-hidden="true" tabindex="-1"></a>              )<span class="op">;</span></span>
<span id="cb30-537"><a href="#cb30-537" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb30-538"><a href="#cb30-538" aria-hidden="true" tabindex="-1"></a>              decorations<span class="op">.</span><span class="fu">push</span>(</span>
<span id="cb30-539"><a href="#cb30-539" aria-hidden="true" tabindex="-1"></a>                Decoration<span class="op">.</span><span class="fu">mark</span>({ <span class="dt">class</span><span class="op">:</span> <span class="vs">`calculang_call calculang_call_</span><span class="sc">${</span>name<span class="sc">}</span><span class="vs">`</span> })<span class="op">.</span><span class="fu">range</span>(node<span class="op">.</span><span class="at">from</span><span class="op">,</span> node<span class="op">.</span><span class="at">to</span>)</span>
<span id="cb30-540"><a href="#cb30-540" aria-hidden="true" tabindex="-1"></a>              )<span class="op">;</span></span>
<span id="cb30-541"><a href="#cb30-541" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb30-542"><a href="#cb30-542" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb30-543"><a href="#cb30-543" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb30-544"><a href="#cb30-544" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb30-545"><a href="#cb30-545" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-546"><a href="#cb30-546" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Decoration<span class="op">.</span><span class="fu">set</span>(decorations)<span class="op">;</span></span>
<span id="cb30-547"><a href="#cb30-547" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-30" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden">
<div>
<div id="ojs-cell-3-31" data-nodetype="declaration">

</div>
</div>
</div>
</div>
<!--## Row {height=50%}-->
<div class="bslib-grid-item html-fill-item bslib-grid" data-layout="fill" style="display: grid; grid-template-columns: minmax(3em, 1fr) minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<div class="bslib-grid" style="display: grid; grid-template-rows: minmax(3em, max-content); grid-auto-columns: minmax(0, 1fr);">
<div class="card bslib-card html-fill-container" data-fill="false" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<!--## formulas üïµüèº‚Äç‚ôÄÔ∏è {width=800px}-->
<div id="left" class="fill html-fill-item html-fill-container">
<div class="fill html-fill-item html-fill-container">

</div>
<style>
  .card:has(#left) {
    background-color: #69ff6111;
  }
  #left {
    /*background-color: ;*/
    border: 0;
  }
  #left * .card-body {
    background-color: white;
    padding: 0;
    border: 0;
  }
  #left .observablehq {
    background-color: white;
  }
  .card:has(.modeldept) {
    background-color: #D81B6011;
  }
</style>
<!-- hassle for modularity => tabs (so pretty in Quarto) need to become select box or buttons. Style later -->
<div class="cell hidden html-fill-item html-fill-container">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb31" data-startfrom="597" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 596;"><span id="cb31-597"><a href="#cb31-597" aria-hidden="true" tabindex="-1"></a>viewof x <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(<span class="dv">0</span>)</span>
<span id="cb31-598"><a href="#cb31-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-599"><a href="#cb31-599" aria-hidden="true" tabindex="-1"></a>formulae_visible</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-1" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-2" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb32" data-startfrom="601" data-source-offset="-46"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 600;"><span id="cb32-601"><a href="#cb32-601" aria-hidden="true" tabindex="-1"></a>formulae_all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-3" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb33" data-startfrom="603" data-source-offset="-60"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 602;"><span id="cb33-603"><a href="#cb33-603" aria-hidden="true" tabindex="-1"></a>inputs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-4" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb34" data-startfrom="605" data-source-offset="-68"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 604;"><span id="cb34-605"><a href="#cb34-605" aria-hidden="true" tabindex="-1"></a>formulae_hidden</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-5" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb35" data-startfrom="607" data-source-offset="-85"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 606;"><span id="cb35-607"><a href="#cb35-607" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`---`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-6" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb36" data-startfrom="611" data-source-offset="-136"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 610;"><span id="cb36-611"><a href="#cb36-611" aria-hidden="true" tabindex="-1"></a>examples_yaml <span class="op">=</span> <span class="cf">await</span> (<span class="cf">await</span> <span class="fu">fetch</span>(<span class="st">'/gallery.yml'</span>))<span class="op">.</span><span class="fu">text</span>()</span>
<span id="cb36-612"><a href="#cb36-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-613"><a href="#cb36-613" aria-hidden="true" tabindex="-1"></a>yaml <span class="op">=</span> <span class="pp">require</span>(<span class="st">'js-yaml@4.1.0/dist/js-yaml.min.js'</span>)</span>
<span id="cb36-614"><a href="#cb36-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-615"><a href="#cb36-615" aria-hidden="true" tabindex="-1"></a>examples <span class="op">=</span> yaml<span class="op">.</span><span class="fu">load</span>(examples_yaml)</span>
<span id="cb36-616"><a href="#cb36-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-617"><a href="#cb36-617" aria-hidden="true" tabindex="-1"></a>selected_model <span class="op">=</span> Generators<span class="op">.</span><span class="fu">input</span>(a_thing2)</span>
<span id="cb36-618"><a href="#cb36-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-619"><a href="#cb36-619" aria-hidden="true" tabindex="-1"></a>example_details <span class="op">=</span> examples<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">tiles</span>)<span class="op">.</span><span class="fu">flat</span>()<span class="op">.</span><span class="fu">find</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">==</span> selected_model)</span>
<span id="cb36-620"><a href="#cb36-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-621"><a href="#cb36-621" aria-hidden="true" tabindex="-1"></a>modelname <span class="op">=</span> example_details<span class="op">.</span><span class="at">id</span><span class="op">.</span><span class="fu">replaceAll</span>(<span class="st">'-'</span><span class="op">,</span><span class="st">'_'</span>) <span class="co">// replace due to object lookups</span></span>
<span id="cb36-622"><a href="#cb36-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-623"><a href="#cb36-623" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> <span class="kw">new</span> <span class="fu">URLSearchParams</span>(location<span class="op">.</span><span class="at">search</span>)</span>
<span id="cb36-624"><a href="#cb36-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-625"><a href="#cb36-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-626"><a href="#cb36-626" aria-hidden="true" tabindex="-1"></a>default_example_id <span class="op">=</span> q<span class="op">.</span><span class="fu">get</span>(<span class="st">'id'</span>) <span class="op">??</span> <span class="st">''</span></span>
<span id="cb36-627"><a href="#cb36-627" aria-hidden="true" tabindex="-1"></a>show_hidden <span class="op">=</span> <span class="kw">true</span><span class="co">// q.get('hidden') == 'hidden' ?? true</span></span>
<span id="cb36-628"><a href="#cb36-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-629"><a href="#cb36-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-630"><a href="#cb36-630" aria-hidden="true" tabindex="-1"></a>dir <span class="op">=</span> <span class="fu">dirname</span>(example_entrypoint)</span>
<span id="cb36-631"><a href="#cb36-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-632"><a href="#cb36-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-633"><a href="#cb36-633" aria-hidden="true" tabindex="-1"></a><span class="co">//https://www.abeautifulsite.net/posts/javascript-functions-for-basename-and-dirname/</span></span>
<span id="cb36-634"><a href="#cb36-634" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">dirname</span>(path) {</span>
<span id="cb36-635"><a href="#cb36-635" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> path<span class="op">.</span><span class="fu">match</span>(<span class="ss">/.</span><span class="sc">*\/</span><span class="ss">/</span>)<span class="op">;</span></span>
<span id="cb36-636"><a href="#cb36-636" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-637"><a href="#cb36-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-638"><a href="#cb36-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-639"><a href="#cb36-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-640"><a href="#cb36-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-641"><a href="#cb36-641" aria-hidden="true" tabindex="-1"></a>example_entrypoint <span class="op">=</span> entrypoint</span>
<span id="cb36-642"><a href="#cb36-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-643"><a href="#cb36-643" aria-hidden="true" tabindex="-1"></a>entrypoint <span class="op">=</span> (example_details<span class="op">.</span><span class="at">entrypoint</span>[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"/"</span> <span class="op">?</span> <span class="st">"https://calculang.dev"</span> <span class="op">:</span> <span class="st">""</span>) <span class="op">+</span></span>
<span id="cb36-644"><a href="#cb36-644" aria-hidden="true" tabindex="-1"></a>  example_details<span class="op">.</span><span class="at">entrypoint</span></span>
<span id="cb36-645"><a href="#cb36-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-646"><a href="#cb36-646" aria-hidden="true" tabindex="-1"></a>entrypoint_no_cul_js <span class="op">=</span> entrypoint<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,-</span><span class="dv">7</span>)</span>
<span id="cb36-647"><a href="#cb36-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-648"><a href="#cb36-648" aria-hidden="true" tabindex="-1"></a><span class="co">//viewof entrypoint = Inputs.select(new Map(entrypoints_all.map((d,i) =&gt; [d[1],i])), {label:'model üëÄ', value:1}) // leaving on simple-climate as it breaks if not default :o</span></span>
<span id="cb36-649"><a href="#cb36-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-650"><a href="#cb36-650" aria-hidden="true" tabindex="-1"></a><span class="co">// hacky, do qs parsing?</span></span>
<span id="cb36-651"><a href="#cb36-651" aria-hidden="true" tabindex="-1"></a><span class="co">// I should view .mjs instead of .cul.js for memo case?</span></span>
<span id="cb36-652"><a href="#cb36-652" aria-hidden="true" tabindex="-1"></a>cul_resources <span class="op">=</span> {</span>
<span id="cb36-653"><a href="#cb36-653" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (cul_js_cul)</span>
<span id="cb36-654"><a href="#cb36-654" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(introspection_nomemo<span class="op">.</span><span class="at">cul_scope_ids_to_resource</span>)<span class="op">.</span><span class="fu">map</span>(loc <span class="kw">=&gt;</span> loc<span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span>)<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span>loc<span class="op">.</span><span class="fu">indexOf</span>(<span class="st">'?'</span>) <span class="op">!=</span> <span class="op">-</span><span class="dv">1</span> <span class="op">?</span> loc<span class="op">.</span><span class="fu">indexOf</span>(<span class="st">'?'</span>)<span class="op">-</span><span class="dv">2</span> <span class="op">:</span> <span class="dv">999</span>))<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d <span class="op">+</span> ((d<span class="op">.</span><span class="fu">slice</span>(<span class="op">-</span><span class="dv">3</span>) <span class="op">!=</span> <span class="st">'.js'</span>) <span class="op">?</span> <span class="st">'.js'</span> <span class="op">:</span> <span class="st">''</span>))<span class="op">.</span><span class="fu">map</span>(loc <span class="kw">=&gt;</span> dir<span class="op">+</span> loc)</span>
<span id="cb36-655"><a href="#cb36-655" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">return</span> [<span class="op">...</span><span class="bu">Array</span>(<span class="bu">Object</span><span class="op">.</span><span class="fu">keys</span>(introspection_nomemo<span class="op">.</span><span class="at">cul_scope_ids_to_resource</span>)<span class="op">.</span><span class="at">length</span>)]<span class="op">.</span><span class="fu">map</span>((_<span class="op">,</span> i) <span class="kw">=&gt;</span> entrypoint_no_cul_js <span class="co">/* this is not modelname! this should be related to entrypoit, not id */</span><span class="op">+</span>(calculang_source_nomemo<span class="op">.</span><span class="at">length</span><span class="op">?</span> <span class="st">'-nomemo'</span> <span class="op">:</span> <span class="st">''</span>) <span class="op">+</span><span class="st">'_esm/'</span><span class="op">+</span><span class="st">'cul_scope_'</span><span class="op">+</span>i<span class="op">+</span><span class="st">'.mjs'</span>)</span>
<span id="cb36-656"><a href="#cb36-656" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-657"><a href="#cb36-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-658"><a href="#cb36-658" aria-hidden="true" tabindex="-1"></a><span class="co">//cul_resources</span></span>
<span id="cb36-659"><a href="#cb36-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-660"><a href="#cb36-660" aria-hidden="true" tabindex="-1"></a>output <span class="op">=</span> {</span>
<span id="cb36-661"><a href="#cb36-661" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> o <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb36-662"><a href="#cb36-662" aria-hidden="true" tabindex="-1"></a>  cul_resources<span class="op">.</span><span class="fu">forEach</span>(loc <span class="kw">=&gt;</span> {</span>
<span id="cb36-663"><a href="#cb36-663" aria-hidden="true" tabindex="-1"></a>    o<span class="op">.</span><span class="fu">push</span>(<span class="fu">fetch</span>(loc)<span class="op">.</span><span class="fu">then</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">text</span>()))</span>
<span id="cb36-664"><a href="#cb36-664" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb36-665"><a href="#cb36-665" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> o</span>
<span id="cb36-666"><a href="#cb36-666" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-667"><a href="#cb36-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-668"><a href="#cb36-668" aria-hidden="true" tabindex="-1"></a><span class="co">// </span><span class="al">TODO</span><span class="co"> replace duplicate (source) code by a message</span></span>
<span id="cb36-669"><a href="#cb36-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-670"><a href="#cb36-670" aria-hidden="true" tabindex="-1"></a>calculang <span class="op">=</span> [<span class="cf">await</span> output[<span class="dv">0</span>]<span class="op">,</span> cul_resources<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">1</span> <span class="op">?</span> <span class="cf">await</span> output[<span class="dv">1</span>] <span class="op">:</span> <span class="st">''</span></span>
<span id="cb36-671"><a href="#cb36-671" aria-hidden="true" tabindex="-1"></a><span class="op">,</span> cul_resources<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">2</span> <span class="op">?</span> <span class="cf">await</span> output[<span class="dv">2</span>] <span class="op">:</span> <span class="st">''</span></span>
<span id="cb36-672"><a href="#cb36-672" aria-hidden="true" tabindex="-1"></a><span class="op">,</span> cul_resources<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">3</span> <span class="op">?</span> <span class="cf">await</span> output[<span class="dv">3</span>] <span class="op">:</span> <span class="st">''</span></span>
<span id="cb36-673"><a href="#cb36-673" aria-hidden="true" tabindex="-1"></a><span class="op">,</span> cul_resources<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">4</span> <span class="op">?</span> <span class="cf">await</span> output[<span class="dv">4</span>] <span class="op">:</span> <span class="st">''</span></span>
<span id="cb36-674"><a href="#cb36-674" aria-hidden="true" tabindex="-1"></a><span class="op">,</span> cul_resources<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">5</span> <span class="op">?</span> <span class="cf">await</span> output[<span class="dv">5</span>] <span class="op">:</span> <span class="st">''</span></span>
<span id="cb36-675"><a href="#cb36-675" aria-hidden="true" tabindex="-1"></a><span class="op">,</span> cul_resources<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">6</span> <span class="op">?</span> <span class="cf">await</span> output[<span class="dv">6</span>] <span class="op">:</span> <span class="st">''</span> <span class="co">// </span><span class="al">TODO</span><span class="co"> warn when overflows</span></span>
<span id="cb36-676"><a href="#cb36-676" aria-hidden="true" tabindex="-1"></a><span class="op">,</span> cul_resources<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">7</span> <span class="op">?</span> <span class="cf">await</span> output[<span class="dv">7</span>] <span class="op">:</span> <span class="st">''</span>]<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d <span class="op">!=</span> <span class="st">''</span>)</span>
<span id="cb36-677"><a href="#cb36-677" aria-hidden="true" tabindex="-1"></a><span class="co">//calculang</span></span>
<span id="cb36-678"><a href="#cb36-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-679"><a href="#cb36-679" aria-hidden="true" tabindex="-1"></a><span class="co">// "x.cul.js formulae?"</span></span>
<span id="cb36-680"><a href="#cb36-680" aria-hidden="true" tabindex="-1"></a>fff <span class="op">=</span> calculang<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">split</span>(<span class="st">'</span><span class="sc">\n</span><span class="st">'</span>))<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> [d<span class="op">.</span><span class="fu">findIndex</span>(e <span class="kw">=&gt;</span> e<span class="op">.</span><span class="fu">indexOf</span>(<span class="st">'inputs:'</span> <span class="op">+</span> (options<span class="op">.</span><span class="fu">includes</span>(<span class="st">'inputs'</span>) <span class="op">?</span> <span class="st">'BLAH'</span> <span class="op">:</span> <span class="st">''</span>)) <span class="op">!=</span> <span class="op">-</span><span class="dv">1</span>) <span class="op">??</span> <span class="dv">999</span><span class="op">,</span> <span class="op">...</span>d])<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">filter</span>((e<span class="op">,</span>i) <span class="kw">=&gt;</span> i <span class="op">&lt;=</span> d[<span class="dv">0</span>] <span class="op">||</span> d[<span class="dv">0</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>))<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span>))<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">join</span>(<span class="st">'</span><span class="sc">\n</span><span class="st">'</span>))<span class="op">.</span><span class="fu">map</span>((d<span class="op">,</span>i) <span class="kw">=&gt;</span> <span class="vs">`***[</span><span class="sc">${</span>introspection<span class="op">.</span><span class="at">cul_scope_ids_to_resource</span>[i]<span class="op">.</span><span class="fu">split</span>(<span class="st">'?'</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="fu">replaceAll</span>(<span class="st">'-nomemo'</span><span class="op">,</span> <span class="st">''</span>)<span class="sc">}</span><span class="vs">](</span><span class="sc">${</span>cul_resources[i]<span class="op">.</span><span class="fu">replaceAll</span>(<span class="st">'-nomemo'</span><span class="op">,</span><span class="st">''</span>)<span class="sc">}</span><span class="vs">) </span><span class="sc">${</span>cul_js_cul <span class="op">?</span> <span class="vs">`-&gt; [js](</span><span class="sc">${</span>entrypoint_no_cul_js<span class="sc">}</span><span class="vs">_esm/cul_scope_</span><span class="sc">${</span>i<span class="sc">}</span><span class="vs">.mjs)`</span> <span class="op">:</span> <span class="vs">``</span><span class="sc">}</span><span class="vs">***</span></span>
<span id="cb36-681"><a href="#cb36-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-682"><a href="#cb36-682" aria-hidden="true" tabindex="-1"></a><span class="vs">~~~js</span></span>
<span id="cb36-683"><a href="#cb36-683" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>d<span class="op">.</span><span class="fu">replaceAll</span>(<span class="st">'export const '</span> <span class="op">+</span> (options<span class="op">.</span><span class="fu">includes</span>(<span class="st">'export consts'</span>)</span>
<span id="cb36-684"><a href="#cb36-684" aria-hidden="true" tabindex="-1"></a> <span class="op">?</span> <span class="st">'BLAH'</span> <span class="op">:</span> <span class="st">''</span>)<span class="op">,</span> <span class="st">''</span>)<span class="sc">}</span></span>
<span id="cb36-685"><a href="#cb36-685" aria-hidden="true" tabindex="-1"></a><span class="vs">~~~</span></span>
<span id="cb36-686"><a href="#cb36-686" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span>
<span id="cb36-687"><a href="#cb36-687" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-688"><a href="#cb36-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-689"><a href="#cb36-689" aria-hidden="true" tabindex="-1"></a>fff2 <span class="op">=</span> calculang<span class="op">.</span><span class="fu">filter</span>((d<span class="op">,</span>i) <span class="kw">=&gt;</span> i <span class="op">==</span> cul_scope_id)<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">split</span>(<span class="st">'</span><span class="sc">\n</span><span class="st">'</span>))<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> [d<span class="op">.</span><span class="fu">findIndex</span>(e <span class="kw">=&gt;</span> e<span class="op">.</span><span class="fu">indexOf</span>(<span class="st">'inputs:'</span> <span class="op">+</span> (options<span class="op">.</span><span class="fu">includes</span>(<span class="st">'inputs'</span>) <span class="op">?</span> <span class="st">'BLAH'</span> <span class="op">:</span> <span class="st">''</span>)) <span class="op">!=</span> <span class="op">-</span><span class="dv">1</span>) <span class="op">??</span> <span class="dv">999</span><span class="op">,</span> <span class="op">...</span>d])<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">filter</span>((e<span class="op">,</span>i) <span class="kw">=&gt;</span> i <span class="op">&lt;=</span> d[<span class="dv">0</span>] <span class="op">||</span> d[<span class="dv">0</span>] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>))<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">slice</span>(<span class="dv">1</span>))<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="fu">join</span>(<span class="st">'</span><span class="sc">\n</span><span class="st">'</span>))</span>
<span id="cb36-690"><a href="#cb36-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-691"><a href="#cb36-691" aria-hidden="true" tabindex="-1"></a><span class="op">.</span><span class="fu">map</span>((d<span class="op">,</span>i) <span class="kw">=&gt;</span> <span class="vs">`</span><span class="sc">${</span>d<span class="op">.</span><span class="fu">replaceAll</span>(<span class="st">'export const '</span> <span class="op">+</span> (options<span class="op">.</span><span class="fu">includes</span>(<span class="st">'export consts'</span>)</span>
<span id="cb36-692"><a href="#cb36-692" aria-hidden="true" tabindex="-1"></a> <span class="op">?</span> <span class="st">'BLAH'</span> <span class="op">:</span> <span class="st">''</span>)<span class="op">,</span> <span class="st">''</span>)<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb36-693"><a href="#cb36-693" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-694"><a href="#cb36-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-695"><a href="#cb36-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-696"><a href="#cb36-696" aria-hidden="true" tabindex="-1"></a>fff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-7" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-8" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-9" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-10" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-11" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-12" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-13" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-14" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-15" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-16" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-17" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-18" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-19" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-20" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-21" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-22" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-23" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-24" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-25" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-4-26" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<style>
  #fdsa {
    background-color: lightgreen;
    padding: 10px;
    margin-bottom:20px;
    border-radius: 0 20px 20px 20px;
    min-height: fit-content;
  }

</style>
<div id="fdsa" class="html-fill-item html-fill-container">
<p><img src="./logo4.svg" class="img-fluid" width="40"> <strong style="font-size:1.5em;">calculang model</strong></p>
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb37" data-startfrom="720" data-source-offset="-27"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 719;"><span id="cb37-720"><a href="#cb37-720" aria-hidden="true" tabindex="-1"></a>enabled <span class="op">=</span> [<span class="st">"raycasting2"</span><span class="op">,</span> <span class="st">"savings"</span><span class="op">,</span> <span class="st">"savings_rec"</span><span class="op">,</span> <span class="st">"starfield"</span><span class="op">,</span> <span class="st">"fizzbuzz"</span><span class="op">,</span> <span class="st">"year_remaining"</span><span class="op">,</span> <span class="st">"simple_loan"</span><span class="co">/*, "emissions_my_lifetime"*/</span>]</span>
<span id="cb37-721"><a href="#cb37-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-722"><a href="#cb37-722" aria-hidden="true" tabindex="-1"></a>a_thing2 <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;select style="font-size: 1.5em"&gt;</span></span>
<span id="cb37-723"><a href="#cb37-723" aria-hidden="true" tabindex="-1"></a><span class="sc">${</span>examples<span class="op">.</span><span class="fu">map</span>(category <span class="kw">=&gt;</span> <span class="vs">`&lt;optgroup label="</span><span class="sc">${</span>category<span class="op">.</span><span class="at">category</span><span class="sc">}</span><span class="vs">"&gt;</span></span>
<span id="cb37-724"><a href="#cb37-724" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span><span class="sc">${</span>category<span class="op">.</span><span class="at">tiles</span><span class="op">.</span><span class="fu">filter</span>(tile <span class="kw">=&gt;</span> ((<span class="op">!</span>tile<span class="op">.</span><span class="at">disabled</span>) <span class="op">||</span> show_hidden))<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> enabled<span class="op">.</span><span class="fu">includes</span>(d<span class="op">.</span><span class="at">id</span><span class="op">.</span><span class="fu">replaceAll</span>(<span class="st">'-'</span><span class="op">,</span><span class="st">'_'</span>)))<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> <span class="vs">`&lt;option value="</span><span class="sc">${</span>d<span class="op">.</span><span class="at">id</span><span class="sc">}</span><span class="vs">"</span><span class="sc">${</span>d<span class="op">.</span><span class="at">id</span> <span class="op">==</span> default_example_id <span class="op">?</span> <span class="st">' selected="selected"'</span> <span class="op">:</span> <span class="st">''</span><span class="sc">}</span><span class="vs">}&gt;</span><span class="sc">${</span>d<span class="op">.</span><span class="at">title</span><span class="sc">}</span><span class="vs">&lt;/option&gt;`</span>)<span class="sc">}</span></span>
<span id="cb37-725"><a href="#cb37-725" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span><span class="sc">${</span>category<span class="op">.</span><span class="at">tiles</span><span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">==</span> default_example_id <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">disabled</span> <span class="op">&amp;&amp;</span> (<span class="op">!</span>show_hidden))<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> <span class="vs">`&lt;option value="</span><span class="sc">${</span>d<span class="op">.</span><span class="at">id</span><span class="sc">}</span><span class="vs">"</span><span class="sc">${</span>d<span class="op">.</span><span class="at">id</span> <span class="op">==</span> default_example_id <span class="op">?</span> <span class="st">' selected="selected"'</span> <span class="op">:</span> <span class="st">''</span><span class="sc">}</span><span class="vs">}&gt;</span><span class="sc">${</span>d<span class="op">.</span><span class="at">title</span><span class="sc">}</span><span class="vs">&lt;/option&gt;`</span>)<span class="sc">}</span></span>
<span id="cb37-726"><a href="#cb37-726" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/optgroup&gt;</span></span>
<span id="cb37-727"><a href="#cb37-727" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span>)<span class="sc">}</span><span class="vs">&lt;/select&gt;`</span></span>
<span id="cb37-728"><a href="#cb37-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-729"><a href="#cb37-729" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`</span><span class="sc">${</span>example_details<span class="op">.</span><span class="at">modular</span> <span class="op">?</span> <span class="st">'‚ôªÔ∏è'</span> <span class="op">:</span> <span class="st">''</span><span class="sc">}</span><span class="vs"> *</span><span class="sc">${</span>example_details<span class="op">.</span><span class="at">subtitle</span><span class="sc">}</span><span class="vs">*`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-5-1" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-5-2" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-5-3" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb38" data-startfrom="731" data-source-offset="-836"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 730;"><span id="cb38-731"><a href="#cb38-731" aria-hidden="true" tabindex="-1"></a>viewof cul_scope_id <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span><span class="dv">15</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">'cul scope id'</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span><span class="dv">0</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span><span class="dv">1</span>})</span>
<span id="cb38-732"><a href="#cb38-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-733"><a href="#cb38-733" aria-hidden="true" tabindex="-1"></a>viewof form <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">form</span>(mini_binds<span class="op">,</span> {</span>
<span id="cb38-734"><a href="#cb38-734" aria-hidden="true" tabindex="-1"></a>  <span class="dt">template</span><span class="op">:</span> inputs2 <span class="kw">=&gt;</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;details id="inputs_details" open&gt;&lt;summary&gt;inputs ‚öôÔ∏è&lt;/summary&gt;&lt;div class="styled"&gt;</span><span class="sc">${</span><span class="bu">Object</span><span class="op">.</span><span class="fu">entries</span>(inputs2)<span class="co">/*.filter(([k,v]) =&gt; inputs.includes(k))*/</span><span class="op">.</span><span class="fu">map</span>(([k<span class="op">,</span>v]) <span class="kw">=&gt;</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;div id="mini-bind-</span><span class="sc">${</span>k<span class="sc">}</span><span class="vs">" class="mini-bind"&gt;</span><span class="sc">${</span>v<span class="sc">}</span><span class="vs">`</span>)<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb38-735"><a href="#cb38-735" aria-hidden="true" tabindex="-1"></a>  <span class="co">//template: inputs2 =&gt; htl.html`${Object.entries(inputs2)/*.filter(([k,v]) =&gt; inputs.includes(k))*/.map(([k,v]) =&gt; htl.html`&lt;div id="mini-bind-${k}" class="mini-bind styled"&gt;${v}`)}`</span></span>
<span id="cb38-736"><a href="#cb38-736" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb38-737"><a href="#cb38-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-738"><a href="#cb38-738" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb38-739"><a href="#cb38-739" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;style&gt;</span></span>
<span id="cb38-740"><a href="#cb38-740" aria-hidden="true" tabindex="-1"></a><span class="vs">  #inputs_details {</span></span>
<span id="cb38-741"><a href="#cb38-741" aria-hidden="true" tabindex="-1"></a><span class="vs">      background: #66ddc155;</span></span>
<span id="cb38-742"><a href="#cb38-742" aria-hidden="true" tabindex="-1"></a><span class="vs">      margin-bottom:0;</span></span>
<span id="cb38-743"><a href="#cb38-743" aria-hidden="true" tabindex="-1"></a><span class="vs">      }</span></span>
<span id="cb38-744"><a href="#cb38-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-745"><a href="#cb38-745" aria-hidden="true" tabindex="-1"></a><span class="vs">  div.styled {</span></span>
<span id="cb38-746"><a href="#cb38-746" aria-hidden="true" tabindex="-1"></a><span class="vs">    text-align: right;</span></span>
<span id="cb38-747"><a href="#cb38-747" aria-hidden="true" tabindex="-1"></a><span class="vs">    column-count: 2;</span></span>
<span id="cb38-748"><a href="#cb38-748" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb38-749"><a href="#cb38-749" aria-hidden="true" tabindex="-1"></a><span class="vs">  div.styled {</span></span>
<span id="cb38-750"><a href="#cb38-750" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-weight: bold;</span></span>
<span id="cb38-751"><a href="#cb38-751" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-size: 0.7em;</span></span>
<span id="cb38-752"><a href="#cb38-752" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb38-753"><a href="#cb38-753" aria-hidden="true" tabindex="-1"></a><span class="vs">  div.styled label {</span></span>
<span id="cb38-754"><a href="#cb38-754" aria-hidden="true" tabindex="-1"></a><span class="vs">    /*width: 50px !important;*/</span></span>
<span id="cb38-755"><a href="#cb38-755" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb38-756"><a href="#cb38-756" aria-hidden="true" tabindex="-1"></a><span class="vs">  div.styled label:not(div&gt;label):after {</span></span>
<span id="cb38-757"><a href="#cb38-757" aria-hidden="true" tabindex="-1"></a><span class="vs">    content: ":";</span></span>
<span id="cb38-758"><a href="#cb38-758" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb38-759"><a href="#cb38-759" aria-hidden="true" tabindex="-1"></a><span class="vs">  div.mini-bind {</span></span>
<span id="cb38-760"><a href="#cb38-760" aria-hidden="true" tabindex="-1"></a><span class="vs">    display:none;</span></span>
<span id="cb38-761"><a href="#cb38-761" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb38-762"><a href="#cb38-762" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span><span class="sc">${</span>inputs<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> <span class="vs">`div#mini-bind-</span><span class="sc">${</span>d<span class="sc">}</span><span class="vs"> {</span></span>
<span id="cb38-763"><a href="#cb38-763" aria-hidden="true" tabindex="-1"></a><span class="vs">    display: block;</span></span>
<span id="cb38-764"><a href="#cb38-764" aria-hidden="true" tabindex="-1"></a><span class="vs">  }`</span>)<span class="op">.</span><span class="fu">join</span>(<span class="st">'</span><span class="sc">\n\n</span><span class="st">'</span>)<span class="sc">}</span></span>
<span id="cb38-765"><a href="#cb38-765" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/style&gt;</span></span>
<span id="cb38-766"><a href="#cb38-766" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-5-4" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-5-5" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-5-6" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<!-- details here is nice to collapse the editor, but alters layout when open -->
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb39" data-startfrom="792" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 791;"><span id="cb39-792"><a href="#cb39-792" aria-hidden="true" tabindex="-1"></a>show <span class="op">=</span> _<span class="op">.</span><span class="fu">uniq</span>(<span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(calculang_source_introspection<span class="op">.</span><span class="at">cul_functions</span>)<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">reason</span> <span class="op">==</span> <span class="st">'input definition'</span>)<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">name</span>)<span class="op">.</span><span class="fu">sort</span>())<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> formula_line_details_0<span class="op">.</span><span class="fu">filter</span>(e <span class="kw">=&gt;</span> e<span class="op">.</span><span class="at">name</span> <span class="op">+</span> <span class="st">'_in'</span> <span class="op">==</span> d <span class="op">&amp;&amp;</span> (e<span class="op">.</span><span class="at">overwritten</span> <span class="op">==</span> <span class="kw">undefined</span> <span class="op">||</span> e<span class="op">.</span><span class="at">overwritten</span> <span class="op">==</span> <span class="kw">false</span>))<span class="op">.</span><span class="at">length</span>)</span>
<span id="cb39-793"><a href="#cb39-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-794"><a href="#cb39-794" aria-hidden="true" tabindex="-1"></a>st <span class="op">=</span> {</span>
<span id="cb39-795"><a href="#cb39-795" aria-hidden="true" tabindex="-1"></a>  entrypoint_no_cul_js<span class="op">;</span></span>
<span id="cb39-796"><a href="#cb39-796" aria-hidden="true" tabindex="-1"></a>  <span class="co">// I cannot fetch !!!</span></span>
<span id="cb39-797"><a href="#cb39-797" aria-hidden="true" tabindex="-1"></a>  <span class="co">//fetch(`${entrypoint_no_cul_js}${1 ? '-nomemo' : ''}.introspection.json`);</span></span>
<span id="cb39-798"><a href="#cb39-798" aria-hidden="true" tabindex="-1"></a>  <span class="co">//await introspection_nomemo; // I can depend on modelname but NOT inputs or introspection !</span></span>
<span id="cb39-799"><a href="#cb39-799" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [<span class="st">'year_in'</span><span class="op">,</span> <span class="st">'duration_in'</span><span class="op">,</span> <span class="st">'f_in'</span>] <span class="co">// "annual_payment_in", "duration_in", "interest_rate_in", "year_in"</span></span>
<span id="cb39-800"><a href="#cb39-800" aria-hidden="true" tabindex="-1"></a>  <span class="co">// not working</span></span>
<span id="cb39-801"><a href="#cb39-801" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-802"><a href="#cb39-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-803"><a href="#cb39-803" aria-hidden="true" tabindex="-1"></a><span class="co">//fff2.join('\n\n')</span></span>
<span id="cb39-804"><a href="#cb39-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-805"><a href="#cb39-805" aria-hidden="true" tabindex="-1"></a><span class="co">/*mjs_q_eval</span></span>
<span id="cb39-806"><a href="#cb39-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-807"><a href="#cb39-807" aria-hidden="true" tabindex="-1"></a><span class="co">aa</span></span>
<span id="cb39-808"><a href="#cb39-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-809"><a href="#cb39-809" aria-hidden="true" tabindex="-1"></a><span class="co">model*/</span></span>
<span id="cb39-810"><a href="#cb39-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-811"><a href="#cb39-811" aria-hidden="true" tabindex="-1"></a>viewof editor <span class="op">=</span> <span class="fu">CodeMirror</span>(</span>
<span id="cb39-812"><a href="#cb39-812" aria-hidden="true" tabindex="-1"></a>  <span class="co">// This needs to be entrypoint scopeid?</span></span>
<span id="cb39-813"><a href="#cb39-813" aria-hidden="true" tabindex="-1"></a>  fff2<span class="op">.</span><span class="fu">join</span>(<span class="st">'</span><span class="sc">\n\n</span><span class="st">'</span>)<span class="op">,</span></span>
<span id="cb39-814"><a href="#cb39-814" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb39-815"><a href="#cb39-815" aria-hidden="true" tabindex="-1"></a>    <span class="dt">extensions</span><span class="op">:</span> [ <span class="co">// wrap indicators would be nice</span></span>
<span id="cb39-816"><a href="#cb39-816" aria-hidden="true" tabindex="-1"></a>      <span class="co">// myDefaultTheme, // </span><span class="al">TODO</span><span class="co"> bring this in, + dark version</span></span>
<span id="cb39-817"><a href="#cb39-817" aria-hidden="true" tabindex="-1"></a>      cmImports[<span class="st">"lang-javascript"</span>]<span class="op">.</span><span class="fu">javascript</span>()<span class="op">,</span></span>
<span id="cb39-818"><a href="#cb39-818" aria-hidden="true" tabindex="-1"></a>      <span class="co">//cmImports["language"].foldGutter(),</span></span>
<span id="cb39-819"><a href="#cb39-819" aria-hidden="true" tabindex="-1"></a>      <span class="co">//EditorView.decorations.of(Decoration.set(yellow.range(r)))</span></span>
<span id="cb39-820"><a href="#cb39-820" aria-hidden="true" tabindex="-1"></a>      <span class="co">/* BUILDING cmCheckboxPluginViewof, // does cul code annotation and navigation, depending on showStripes</span></span>
<span id="cb39-821"><a href="#cb39-821" aria-hidden="true" tabindex="-1"></a><span class="co">      cmOverlayPluginViewof,*/</span></span>
<span id="cb39-822"><a href="#cb39-822" aria-hidden="true" tabindex="-1"></a>      overlay <span class="op">?</span> overlay_answers <span class="op">:</span> EditorState<span class="op">.</span><span class="at">readOnly</span><span class="op">.</span><span class="fu">of</span>(<span class="kw">true</span>)<span class="op">,</span></span>
<span id="cb39-823"><a href="#cb39-823" aria-hidden="true" tabindex="-1"></a>      overlay <span class="op">?</span> overlay_workings <span class="op">:</span> EditorState<span class="op">.</span><span class="at">readOnly</span><span class="op">.</span><span class="fu">of</span>(<span class="kw">true</span>)<span class="op">,</span></span>
<span id="cb39-824"><a href="#cb39-824" aria-hidden="true" tabindex="-1"></a>      <span class="fu">formulaDecorations</span>({<span class="dt">formulae_visible</span><span class="op">:</span> viewof formulae_visible})<span class="op">,</span> <span class="co">// https://codemirror.net/examples/zebra/</span></span>
<span id="cb39-825"><a href="#cb39-825" aria-hidden="true" tabindex="-1"></a>      <span class="co">/* </span><span class="al">TODO</span><span class="co"> don't process Import/Exports for now */</span> <span class="fu">calculang_identifier_decorations</span>({<span class="dt">formulae_visible</span><span class="op">:</span> viewof formulae_visible})<span class="op">,</span></span>
<span id="cb39-826"><a href="#cb39-826" aria-hidden="true" tabindex="-1"></a>      EditorView<span class="op">.</span><span class="at">lineWrapping</span><span class="op">,</span></span>
<span id="cb39-827"><a href="#cb39-827" aria-hidden="true" tabindex="-1"></a>      EditorView<span class="op">.</span><span class="at">editable</span><span class="op">.</span><span class="fu">of</span>(<span class="kw">true</span>)<span class="op">,</span></span>
<span id="cb39-828"><a href="#cb39-828" aria-hidden="true" tabindex="-1"></a>      EditorState<span class="op">.</span><span class="at">readOnly</span><span class="op">.</span><span class="fu">of</span>(<span class="kw">true</span>)</span>
<span id="cb39-829"><a href="#cb39-829" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb39-830"><a href="#cb39-830" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb39-831"><a href="#cb39-831" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-6-1" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-6-2" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-6-3" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
<div class="cell hidden html-fill-item html-fill-container">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb40" data-startfrom="841" data-source-offset="-81"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 840;"><span id="cb40-841"><a href="#cb40-841" aria-hidden="true" tabindex="-1"></a>interest_rate_expected <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="dv">0</span> <span class="co">// still needed, </span><span class="al">TODO</span><span class="co"> fix!</span></span>
<span id="cb40-842"><a href="#cb40-842" aria-hidden="true" tabindex="-1"></a><span class="co">//interest_rate_expected = () =&gt; 0</span></span>
<span id="cb40-843"><a href="#cb40-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-844"><a href="#cb40-844" aria-hidden="true" tabindex="-1"></a><span class="co">///// COPY EVALS</span></span>
<span id="cb40-845"><a href="#cb40-845" aria-hidden="true" tabindex="-1"></a>mjs_q_eval <span class="op">=</span>  { <span class="cf">return</span> ({<span class="st">"raycasting2"</span><span class="op">:</span>[[{<span class="dt">name</span><span class="op">:</span> <span class="st">"ray_angle"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">ray_angle</span>({ ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"tan_ray_angle"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">tan_ray_angle</span>({ ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"ray_angle"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">ray_angle</span>({ ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"ray_angle"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">ray_angle</span>({ ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">y</span>({ y_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">x</span>({ x_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">x</span>({ x_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">y</span>({ y_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"map"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">map</span>({})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">y</span>({ y_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">x</span>({ x_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"map"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">map</span>({})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">y</span>({ y_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">x</span>({ x_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"step"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"player_x"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_x</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"player_y"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_y</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rhy"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rhy</span>({ ray_angle_in<span class="op">,</span> step_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"inverse_tan_ray_angle"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">inverse_tan_ray_angle</span>({ ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rhx"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rhx</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> ray_angle_in<span class="op">,</span> <span class="dt">step_in</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof step_in<span class="op">,</span> raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"step"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"ray_looking_up"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">ray_looking_up</span>({ ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"inverse_tan_ray_angle"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">inverse_tan_ray_angle</span>({ ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"ray_looking_up"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">ray_looking_up</span>({ ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"step"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"player_y"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_y</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rhy"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rhy</span>({ ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> <span class="dt">step_in</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof step_in<span class="op">,</span> raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"step"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"step"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"player_y"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_y</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rhy"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rhy</span>({ ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> <span class="dt">step_in</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof step_in<span class="op">,</span> raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"step"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"map_lookup"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">map_lookup</span>({ <span class="dt">x_in</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rhx</span>({ step_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> ray_angle_in })<span class="op">,</span> <span class="dt">y_in</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rhy</span>({ ray_angle_in<span class="op">,</span> step_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in }) })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof x_in<span class="op">,</span> raycasting2<span class="op">.</span><span class="fu">rhx</span>({ step_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> ray_angle_in }))<span class="op">;</span> <span class="kw">set</span>(viewof y_in<span class="op">,</span> raycasting2<span class="op">.</span><span class="fu">rhy</span>({ ray_angle_in<span class="op">,</span> step_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in }))}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rhx"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rhx</span>({ step_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rhy"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rhy</span>({ ray_angle_in<span class="op">,</span> step_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rhv"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rhv</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> ray_angle_in<span class="op">,</span> step_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rhx"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rhx</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> ray_angle_in<span class="op">,</span> step_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rhy"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rhy</span>({ ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> step_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rhv"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rhv</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> ray_angle_in<span class="op">,</span> step_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rh_hit_object"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rh_hit_object</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rh_hit_object"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rh_hit_object</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rh_hit_object"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rh_hit_object</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rh_hit_object"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rh_hit_object</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rh_hit_x"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rh_hit_x</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"player_x"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_x</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rh_hit_y"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rh_hit_y</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"player_y"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_y</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"ray_looking_right"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">ray_looking_right</span>({ ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"step"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"player_x"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_x</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rvx"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rvx</span>({ ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> <span class="dt">step_in</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof step_in<span class="op">,</span> raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"step"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"step"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"player_x"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_x</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rvx"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rvx</span>({ ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> <span class="dt">step_in</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof step_in<span class="op">,</span> raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"step"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"step"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"player_y"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_y</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"player_x"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_x</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rvx"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rvx</span>({ ray_angle_in<span class="op">,</span> step_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"tan_ray_angle"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">tan_ray_angle</span>({ ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rvy"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rvy</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> ray_angle_in<span class="op">,</span> <span class="dt">step_in</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof step_in<span class="op">,</span> raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"step"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">step</span>({ step_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"ray_looking_right"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">ray_looking_right</span>({ ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"tan_ray_angle"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">tan_ray_angle</span>({ ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"map_lookup"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">map_lookup</span>({ <span class="dt">x_in</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rvx</span>({ ray_angle_in<span class="op">,</span> step_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })<span class="op">,</span> <span class="dt">y_in</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rvy</span>({ step_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> ray_angle_in }) })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof x_in<span class="op">,</span> raycasting2<span class="op">.</span><span class="fu">rvx</span>({ ray_angle_in<span class="op">,</span> step_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in }))<span class="op">;</span> <span class="kw">set</span>(viewof y_in<span class="op">,</span> raycasting2<span class="op">.</span><span class="fu">rvy</span>({ step_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> ray_angle_in }))}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rvx"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rvx</span>({ ray_angle_in<span class="op">,</span> step_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rvy"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rvy</span>({ step_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rvv"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rvv</span>({ ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> step_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rvx"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rvx</span>({ ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> step_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rvy"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rvy</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> ray_angle_in<span class="op">,</span> step_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rvv"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rvv</span>({ ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> step_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rv_hit_object"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rv_hit_object</span>({ ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rv_hit_object"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rv_hit_object</span>({ ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rv_hit_object"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rv_hit_object</span>({ ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rv_hit_object"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rv_hit_object</span>({ ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rv_hit_x"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rv_hit_x</span>({ ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"player_x"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_x</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rv_hit_y"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rv_hit_y</span>({ ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"player_y"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_y</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rv_hit_distance"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rv_hit_distance</span>({ y_in<span class="op">,</span> x_in<span class="op">,</span> ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rh_hit_distance"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rh_hit_distance</span>({ y_in<span class="op">,</span> x_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"r_hit_h_or_v"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">r_hit_h_or_v</span>({ y_in<span class="op">,</span> x_in<span class="op">,</span> ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rv_hit_object"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rv_hit_object</span>({ ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rh_hit_object"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rh_hit_object</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"r_hit_object"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">r_hit_object</span>({ y_in<span class="op">,</span> x_in<span class="op">,</span> ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"r_hit_object"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">r_hit_object</span>({ y_in<span class="op">,</span> x_in<span class="op">,</span> ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"r_hit_object"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">r_hit_object</span>({ y_in<span class="op">,</span> x_in<span class="op">,</span> ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"r_hit_object"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">r_hit_object</span>({ y_in<span class="op">,</span> x_in<span class="op">,</span> ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rv_hit_distance"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rv_hit_distance</span>({ y_in<span class="op">,</span> x_in<span class="op">,</span> ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"rh_hit_distance"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rh_hit_distance</span>({ y_in<span class="op">,</span> x_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"fisheye_correction"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">fisheye_correction</span>({ fisheye_correction_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"player_angle"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_angle</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"ray_angle"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">ray_angle</span>({ ray_angle_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"ray_distance"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">ray_distance</span>({ y_in<span class="op">,</span> x_in<span class="op">,</span> ray_angle_in<span class="op">,</span> f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> fisheye_correction_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"keys_stream_version"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">keys_stream_version</span>({ keys_stream_version_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"keys_stream_function"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">keys_stream_function</span>({ keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"f"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">f</span>({ f_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"keys"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">keys</span>({ keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> f_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"keys"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">keys</span>({ keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> f_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"keys"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">keys</span>({ keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> f_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"keys"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">keys</span>({ keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> f_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"keys"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">keys</span>({ keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> f_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"keys"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">keys</span>({ keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> f_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"keys"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">keys</span>({ keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> f_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"keys"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">keys</span>({ keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> f_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"key_up"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">key_up</span>({ keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> f_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"key_down"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">key_down</span>({ keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> f_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"key_left"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">key_left</span>({ keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> f_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"key_right"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">key_right</span>({ keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> f_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"f"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">f</span>({ f_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"player_angle"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_angle</span>({ keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> <span class="dt">f_in</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">f</span>({ f_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof f_in<span class="op">,</span> raycasting2<span class="op">.</span><span class="fu">f</span>({ f_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"f"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">f</span>({ f_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"leftness"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">leftness</span>({ keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> f_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"f"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">f</span>({ f_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"player_x"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_x</span>({ keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> <span class="dt">f_in</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">f</span>({ f_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof f_in<span class="op">,</span> raycasting2<span class="op">.</span><span class="fu">f</span>({ f_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"f"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">f</span>({ f_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"forwardness"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">forwardness</span>({ keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> f_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"speed"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">speed</span>({})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"player_angle"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_angle</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"f"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">f</span>({ f_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"player_y"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_y</span>({ keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> <span class="dt">f_in</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">f</span>({ f_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof f_in<span class="op">,</span> raycasting2<span class="op">.</span><span class="fu">f</span>({ f_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"f"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">f</span>({ f_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"forwardness"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">forwardness</span>({ keys_stream_version_in<span class="op">,</span> keys_stream_function_in<span class="op">,</span> f_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"speed"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">speed</span>({})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"player_angle"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_angle</span>({ f_in<span class="op">,</span> keys_stream_version_in<span class="op">,</span> keys_stream_function_in })}]]<span class="op">,</span><span class="st">"savings"</span><span class="op">:</span>[[{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"deposits"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">deposits</span>({ year_in<span class="op">,</span> duration_in<span class="op">,</span> annual_payment_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"balance"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">balance</span>({ duration_in<span class="op">,</span> annual_payment_in<span class="op">,</span> interest_rate_in<span class="op">,</span> <span class="dt">year_in</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">year</span>({ year_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof year_in<span class="op">,</span> savings<span class="op">.</span><span class="fu">year</span>({ year_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"deposits"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">deposits</span>({ year_in<span class="op">,</span> duration_in<span class="op">,</span> annual_payment_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"interest"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">interest</span>({ year_in<span class="op">,</span> duration_in<span class="op">,</span> annual_payment_in<span class="op">,</span> interest_rate_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"duration"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">duration</span>({ duration_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"annual_payment"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">annual_payment</span>({ annual_payment_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"balance"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">balance</span>({ duration_in<span class="op">,</span> annual_payment_in<span class="op">,</span> interest_rate_in<span class="op">,</span> <span class="dt">year_in</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">year</span>({ year_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof year_in<span class="op">,</span> savings<span class="op">.</span><span class="fu">year</span>({ year_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"interest_rate"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">interest_rate</span>({ interest_rate_in })}]]<span class="op">,</span><span class="st">"savings_rec"</span><span class="op">:</span>[[{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"actual_interest_rate_co"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">actual_interest_rate_co</span>({ actual_interest_rate_co_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"interest_rate_expected"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span><span class="fu">interest_rate_expected</span>({})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"actual_interest_rates"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">actual_interest_rates</span>({})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">year</span>({ year_in })}]<span class="op">,</span>[]<span class="op">,</span>[{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"deposits"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">deposits</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"balance"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">balance</span>({ actual_interest_rate_co_in<span class="op">,</span> <span class="dt">year_in</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">year</span>({ year_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof year_in<span class="op">,</span> savings_rec<span class="op">.</span><span class="fu">year</span>({ year_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"deposits"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">deposits</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"interest"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">interest</span>({ year_in<span class="op">,</span> actual_interest_rate_co_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"duration"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">duration</span>({})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"annual_payment"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">annual_payment</span>({})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"balance"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">balance</span>({ actual_interest_rate_co_in<span class="op">,</span> <span class="dt">year_in</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">year</span>({ year_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof year_in<span class="op">,</span> savings_rec<span class="op">.</span><span class="fu">year</span>({ year_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"interest_rate"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">interest_rate</span>({ year_in<span class="op">,</span> actual_interest_rate_co_in })}]]<span class="op">,</span><span class="st">"starfield"</span><span class="op">:</span>[[{<span class="dt">name</span><span class="op">:</span> <span class="st">"random_seed"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">random_seed</span>({ random_seed_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"seeded"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">seeded</span>({ <span class="dt">random_seed_in</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">random_seed</span>({ random_seed_in }) })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof random_seed_in<span class="op">,</span> starfield<span class="op">.</span><span class="fu">random_seed</span>({ random_seed_in }))}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"random_seed"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">random_seed</span>({ random_seed_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"random"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">random</span>({ random_seed_in<span class="op">,</span> <span class="dt">star_in</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">star</span>({ star_in })<span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">"x"</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof star_in<span class="op">,</span> starfield<span class="op">.</span><span class="fu">star</span>({ star_in }))}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"star"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">star</span>({ star_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"random"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">random</span>({ random_seed_in<span class="op">,</span> <span class="dt">star_in</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">star</span>({ star_in })<span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">"y"</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof star_in<span class="op">,</span> starfield<span class="op">.</span><span class="fu">star</span>({ star_in }))}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"star"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">star</span>({ star_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"random"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">random</span>({ random_seed_in<span class="op">,</span> <span class="dt">star_in</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">star</span>({ star_in })<span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">"z"</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof star_in<span class="op">,</span> starfield<span class="op">.</span><span class="fu">star</span>({ star_in }))}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"star"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">star</span>({ star_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"frame"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">frame</span>({ frame_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"z0"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">z0</span>({ random_seed_in<span class="op">,</span> star_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"z"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">z</span>({ random_seed_in<span class="op">,</span> star_in<span class="op">,</span> speed_in<span class="op">,</span> <span class="dt">frame_in</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">frame</span>({ frame_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof frame_in<span class="op">,</span> starfield<span class="op">.</span><span class="fu">frame</span>({ frame_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"frame"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">frame</span>({ frame_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"speed"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">speed</span>({ speed_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"z"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">z</span>({ random_seed_in<span class="op">,</span> star_in<span class="op">,</span> speed_in<span class="op">,</span> <span class="dt">frame_in</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">frame</span>({ frame_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof frame_in<span class="op">,</span> starfield<span class="op">.</span><span class="fu">frame</span>({ frame_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"frame"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">frame</span>({ frame_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"speed"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">speed</span>({ speed_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"z"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">z</span>({ frame_in<span class="op">,</span> random_seed_in<span class="op">,</span> star_in<span class="op">,</span> speed_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"frame"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">frame</span>({ frame_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"x0"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">x0</span>({ random_seed_in<span class="op">,</span> star_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"visible"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">visible</span>({ random_seed_in<span class="op">,</span> star_in<span class="op">,</span> speed_in<span class="op">,</span> <span class="dt">frame_in</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">frame</span>({ frame_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof frame_in<span class="op">,</span> starfield<span class="op">.</span><span class="fu">frame</span>({ frame_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"frame"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">frame</span>({ frame_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"x0"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">x0</span>({ random_seed_in<span class="op">,</span> star_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"x0"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">x0</span>({ random_seed_in<span class="op">,</span> star_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"z"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">z</span>({ frame_in<span class="op">,</span> random_seed_in<span class="op">,</span> star_in<span class="op">,</span> speed_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"frame"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">frame</span>({ frame_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"y0"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">y0</span>({ random_seed_in<span class="op">,</span> star_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"visible"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">visible</span>({ random_seed_in<span class="op">,</span> star_in<span class="op">,</span> speed_in<span class="op">,</span> <span class="dt">frame_in</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">frame</span>({ frame_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof frame_in<span class="op">,</span> starfield<span class="op">.</span><span class="fu">frame</span>({ frame_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"frame"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">frame</span>({ frame_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"y0"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">y0</span>({ random_seed_in<span class="op">,</span> star_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"y0"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">y0</span>({ random_seed_in<span class="op">,</span> star_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"z"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">z</span>({ frame_in<span class="op">,</span> random_seed_in<span class="op">,</span> star_in<span class="op">,</span> speed_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">x</span>({ frame_in<span class="op">,</span> random_seed_in<span class="op">,</span> star_in<span class="op">,</span> speed_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"x0"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">x0</span>({ random_seed_in<span class="op">,</span> star_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"x0"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">x0</span>({ random_seed_in<span class="op">,</span> star_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">x</span>({ random_seed_in<span class="op">,</span> star_in<span class="op">,</span> speed_in<span class="op">,</span> <span class="dt">frame_in</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">frame</span>({ frame_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof frame_in<span class="op">,</span> starfield<span class="op">.</span><span class="fu">frame</span>({ frame_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"frame"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">frame</span>({ frame_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">y</span>({ frame_in<span class="op">,</span> random_seed_in<span class="op">,</span> star_in<span class="op">,</span> speed_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"y0"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">y0</span>({ random_seed_in<span class="op">,</span> star_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"y0"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">y0</span>({ random_seed_in<span class="op">,</span> star_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">y</span>({ random_seed_in<span class="op">,</span> star_in<span class="op">,</span> speed_in<span class="op">,</span> <span class="dt">frame_in</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">frame</span>({ frame_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof frame_in<span class="op">,</span> starfield<span class="op">.</span><span class="fu">frame</span>({ frame_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"frame"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">frame</span>({ frame_in })}]]<span class="op">,</span><span class="st">"fizzbuzz"</span><span class="op">:</span>[[{<span class="dt">name</span><span class="op">:</span> <span class="st">"i"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>fizzbuzz<span class="op">.</span><span class="fu">i</span>({ i_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"i"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>fizzbuzz<span class="op">.</span><span class="fu">i</span>({ i_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"fizz"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>fizzbuzz<span class="op">.</span><span class="fu">fizz</span>({ i_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"buzz"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>fizzbuzz<span class="op">.</span><span class="fu">buzz</span>({ i_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"fizz"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>fizzbuzz<span class="op">.</span><span class="fu">fizz</span>({ i_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"buzz"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>fizzbuzz<span class="op">.</span><span class="fu">buzz</span>({ i_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"i"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>fizzbuzz<span class="op">.</span><span class="fu">i</span>({ i_in })}]]<span class="op">,</span><span class="st">"year_remaining"</span><span class="op">:</span>[[{<span class="dt">name</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">date</span>({ date_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">year</span>({ date_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"isLeap"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">isLeap</span>({ date_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">date</span>({ date_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">date</span>({ date_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">date</span>({ date_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"date"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">date</span>({ date_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"daysIntoYearStartTomorrow"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">daysIntoYearStartTomorrow</span>({ date_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"timing"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">timing</span>({ timing_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"daysIntoYearStartToday"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">daysIntoYearStartToday</span>({ date_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"daysIntoYearStartTomorrow"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">daysIntoYearStartTomorrow</span>({ date_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"daysIntoYear"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">daysIntoYear</span>({ timing_in<span class="op">,</span> date_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"daysInYear"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">daysInYear</span>({ date_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"fractionIntoYear"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">fractionIntoYear</span>({ timing_in<span class="op">,</span> date_in })}]]<span class="op">,</span><span class="st">"simple_loan"</span><span class="op">:</span>[[{<span class="dt">name</span><span class="op">:</span> <span class="st">"interest_rate"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">interest_rate</span>({ year_in<span class="op">,</span> d_i_year_in<span class="op">,</span> i_in<span class="op">,</span> d_i_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"v"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">v</span>({ year_in<span class="op">,</span> d_i_year_in<span class="op">,</span> i_in<span class="op">,</span> d_i_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"term"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">term</span>({ term_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"balance"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">balance</span>({ principal_in<span class="op">,</span> d_i_year_in<span class="op">,</span> i_in<span class="op">,</span> d_i_in<span class="op">,</span> missed_repayment_year_in<span class="op">,</span> skip_interest_in<span class="op">,</span> term_in<span class="op">,</span> <span class="dt">year_in</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof year_in<span class="op">,</span> simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"interest_rate"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">interest_rate</span>({ year_in<span class="op">,</span> d_i_year_in<span class="op">,</span> i_in<span class="op">,</span> d_i_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"balance"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">balance</span>({ principal_in<span class="op">,</span> d_i_year_in<span class="op">,</span> i_in<span class="op">,</span> d_i_in<span class="op">,</span> missed_repayment_year_in<span class="op">,</span> skip_interest_in<span class="op">,</span> term_in<span class="op">,</span> <span class="dt">year_in</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof year_in<span class="op">,</span> simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"term"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">term</span>({ term_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"balance"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">balance</span>({ principal_in<span class="op">,</span> d_i_year_in<span class="op">,</span> i_in<span class="op">,</span> d_i_in<span class="op">,</span> missed_repayment_year_in<span class="op">,</span> skip_interest_in<span class="op">,</span> term_in<span class="op">,</span> <span class="dt">year_in</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof year_in<span class="op">,</span> simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"interest_rate"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">interest_rate</span>({ year_in<span class="op">,</span> d_i_year_in<span class="op">,</span> i_in<span class="op">,</span> d_i_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"v_pow_term_left"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">v_pow_term_left</span>({ year_in<span class="op">,</span> d_i_year_in<span class="op">,</span> i_in<span class="op">,</span> d_i_in<span class="op">,</span> term_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"balance"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">balance</span>({ principal_in<span class="op">,</span> d_i_year_in<span class="op">,</span> i_in<span class="op">,</span> d_i_in<span class="op">,</span> missed_repayment_year_in<span class="op">,</span> skip_interest_in<span class="op">,</span> term_in<span class="op">,</span> <span class="dt">year_in</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof year_in<span class="op">,</span> simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"interest_rate"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">interest_rate</span>({ year_in<span class="op">,</span> d_i_year_in<span class="op">,</span> i_in<span class="op">,</span> d_i_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"repayment"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">repayment</span>({ year_in<span class="op">,</span> missed_repayment_year_in<span class="op">,</span> skip_interest_in<span class="op">,</span> principal_in<span class="op">,</span> d_i_year_in<span class="op">,</span> i_in<span class="op">,</span> d_i_in<span class="op">,</span> term_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"interest_repayment"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">interest_repayment</span>({ year_in<span class="op">,</span> missed_repayment_year_in<span class="op">,</span> skip_interest_in<span class="op">,</span> principal_in<span class="op">,</span> d_i_year_in<span class="op">,</span> i_in<span class="op">,</span> d_i_in<span class="op">,</span> term_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"repayment"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">repayment</span>({ year_in<span class="op">,</span> missed_repayment_year_in<span class="op">,</span> skip_interest_in<span class="op">,</span> principal_in<span class="op">,</span> d_i_year_in<span class="op">,</span> i_in<span class="op">,</span> d_i_in<span class="op">,</span> term_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"interest"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">interest</span>({ year_in<span class="op">,</span> principal_in<span class="op">,</span> missed_repayment_year_in<span class="op">,</span> skip_interest_in<span class="op">,</span> term_in<span class="op">,</span> d_i_year_in<span class="op">,</span> i_in<span class="op">,</span> d_i_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"term"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">term</span>({ term_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"missed_repayment_year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">missed_repayment_year</span>({ missed_repayment_year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"skip_interest"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">skip_interest</span>({ skip_interest_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"interest"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">interest</span>({ year_in<span class="op">,</span> principal_in<span class="op">,</span> missed_repayment_year_in<span class="op">,</span> skip_interest_in<span class="op">,</span> term_in<span class="op">,</span> d_i_year_in<span class="op">,</span> i_in<span class="op">,</span> d_i_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"repayment_due"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">repayment_due</span>({ year_in<span class="op">,</span> term_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"repayment_amount"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">repayment_amount</span>({ year_in<span class="op">,</span> principal_in<span class="op">,</span> d_i_year_in<span class="op">,</span> i_in<span class="op">,</span> d_i_in<span class="op">,</span> missed_repayment_year_in<span class="op">,</span> skip_interest_in<span class="op">,</span> term_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"principal"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">principal</span>({ principal_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"balance"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">balance</span>({ principal_in<span class="op">,</span> d_i_year_in<span class="op">,</span> i_in<span class="op">,</span> d_i_in<span class="op">,</span> missed_repayment_year_in<span class="op">,</span> skip_interest_in<span class="op">,</span> term_in<span class="op">,</span> <span class="dt">year_in</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in }) <span class="op">-</span> <span class="dv">1</span> })<span class="op">,</span> <span class="dt">handler</span><span class="op">:</span> () <span class="kw">=&gt;</span> {<span class="kw">set</span>(viewof year_in<span class="op">,</span> simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in }) <span class="op">-</span> <span class="dv">1</span>)}}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"interest"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">interest</span>({ year_in<span class="op">,</span> principal_in<span class="op">,</span> missed_repayment_year_in<span class="op">,</span> skip_interest_in<span class="op">,</span> term_in<span class="op">,</span> d_i_year_in<span class="op">,</span> i_in<span class="op">,</span> d_i_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"repayment"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">repayment</span>({ year_in<span class="op">,</span> missed_repayment_year_in<span class="op">,</span> skip_interest_in<span class="op">,</span> principal_in<span class="op">,</span> d_i_year_in<span class="op">,</span> i_in<span class="op">,</span> d_i_in<span class="op">,</span> term_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">year</span>({ year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"d_i_year"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">d_i_year</span>({ d_i_year_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"i"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">i</span>({ i_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"d_i"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">d_i</span>({ d_i_in })}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span> <span class="st">"i"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span>i}]]}</span>
<span id="cb40-846"><a href="#cb40-846" aria-hidden="true" tabindex="-1"></a>)}</span>
<span id="cb40-847"><a href="#cb40-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-848"><a href="#cb40-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-849"><a href="#cb40-849" aria-hidden="true" tabindex="-1"></a>fns_with_mjs_q_eval <span class="op">=</span>{ <span class="cf">return</span> (</span>
<span id="cb40-850"><a href="#cb40-850" aria-hidden="true" tabindex="-1"></a>{<span class="st">"raycasting2"</span><span class="op">:</span>[[{<span class="dt">name</span><span class="op">:</span><span class="st">"tan_ray_angle"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">tan_ray_angle</span>({ray_angle_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"inverse_tan_ray_angle"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">inverse_tan_ray_angle</span>({ray_angle_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"ray_looking_up"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">ray_looking_up</span>({ray_angle_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"ray_looking_right"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">ray_looking_right</span>({ray_angle_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"map"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">map</span>({})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"map_lookup"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">map_lookup</span>({y_in<span class="op">,</span>x_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"rhx"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rhx</span>({step_in<span class="op">,</span>f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in<span class="op">,</span>ray_angle_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"rhy"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rhy</span>({ray_angle_in<span class="op">,</span>step_in<span class="op">,</span>f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"rhv"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rhv</span>({step_in<span class="op">,</span>f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in<span class="op">,</span>ray_angle_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"rh_hit_object"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rh_hit_object</span>({f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in<span class="op">,</span>ray_angle_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"rh_hit_x"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rh_hit_x</span>({f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in<span class="op">,</span>ray_angle_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"rh_hit_y"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rh_hit_y</span>({f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in<span class="op">,</span>ray_angle_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"rh_hit_v"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rh_hit_v</span>({f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in<span class="op">,</span>ray_angle_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"rh_hit_step"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rh_hit_step</span>({f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in<span class="op">,</span>ray_angle_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"rh_hit_distance"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rh_hit_distance</span>({y_in<span class="op">,</span>x_in<span class="op">,</span>f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in<span class="op">,</span>ray_angle_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"rvx"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rvx</span>({ray_angle_in<span class="op">,</span>step_in<span class="op">,</span>f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"rvy"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rvy</span>({step_in<span class="op">,</span>f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in<span class="op">,</span>ray_angle_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"rvv"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rvv</span>({ray_angle_in<span class="op">,</span>step_in<span class="op">,</span>f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"rv_hit_object"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rv_hit_object</span>({ray_angle_in<span class="op">,</span>f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"rv_hit_x"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rv_hit_x</span>({ray_angle_in<span class="op">,</span>f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"rv_hit_y"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rv_hit_y</span>({ray_angle_in<span class="op">,</span>f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"rv_hit_v"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rv_hit_v</span>({ray_angle_in<span class="op">,</span>f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"rv_hit_step"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rv_hit_step</span>({ray_angle_in<span class="op">,</span>f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"rv_hit_distance"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rv_hit_distance</span>({y_in<span class="op">,</span>x_in<span class="op">,</span>ray_angle_in<span class="op">,</span>f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"r_hit_h_or_v"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">r_hit_h_or_v</span>({y_in<span class="op">,</span>x_in<span class="op">,</span>ray_angle_in<span class="op">,</span>f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"r_hit_object"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">r_hit_object</span>({y_in<span class="op">,</span>x_in<span class="op">,</span>ray_angle_in<span class="op">,</span>f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"r_hit_x"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">r_hit_x</span>({y_in<span class="op">,</span>x_in<span class="op">,</span>ray_angle_in<span class="op">,</span>f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"r_hit_y"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">r_hit_y</span>({y_in<span class="op">,</span>x_in<span class="op">,</span>ray_angle_in<span class="op">,</span>f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"r_hit_v"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">r_hit_v</span>({y_in<span class="op">,</span>x_in<span class="op">,</span>ray_angle_in<span class="op">,</span>f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"r_hit_step"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">r_hit_step</span>({y_in<span class="op">,</span>x_in<span class="op">,</span>ray_angle_in<span class="op">,</span>f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"fisheye_correction"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">fisheye_correction</span>({fisheye_correction_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"ray_distance"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">ray_distance</span>({y_in<span class="op">,</span>x_in<span class="op">,</span>ray_angle_in<span class="op">,</span>f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in<span class="op">,</span>fisheye_correction_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"ray_inverse_distance"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">ray_inverse_distance</span>({y_in<span class="op">,</span>x_in<span class="op">,</span>ray_angle_in<span class="op">,</span>f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in<span class="op">,</span>fisheye_correction_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"keys_stream_function"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">keys_stream_function</span>({keys_stream_function_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"keys_stream_version"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">keys_stream_version</span>({keys_stream_version_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"keys"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">keys</span>({keys_stream_version_in<span class="op">,</span>keys_stream_function_in<span class="op">,</span>f_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"key_up"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">key_up</span>({keys_stream_version_in<span class="op">,</span>keys_stream_function_in<span class="op">,</span>f_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"key_down"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">key_down</span>({keys_stream_version_in<span class="op">,</span>keys_stream_function_in<span class="op">,</span>f_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"key_left"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">key_left</span>({keys_stream_version_in<span class="op">,</span>keys_stream_function_in<span class="op">,</span>f_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"key_right"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">key_right</span>({keys_stream_version_in<span class="op">,</span>keys_stream_function_in<span class="op">,</span>f_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"forwardness"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">forwardness</span>({keys_stream_version_in<span class="op">,</span>keys_stream_function_in<span class="op">,</span>f_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"leftness"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">leftness</span>({keys_stream_version_in<span class="op">,</span>keys_stream_function_in<span class="op">,</span>f_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"player_angle"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_angle</span>({f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"player_x"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_x</span>({f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"player_y"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_y</span>({f_in<span class="op">,</span>keys_stream_version_in<span class="op">,</span>keys_stream_function_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"speed"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">speed</span>({})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"f"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">f</span>({f_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"ray_angle"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">ray_angle</span>({ray_angle_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"step"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">step</span>({step_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"x"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">x</span>({x_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"y"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">y</span>({y_in})}]]<span class="op">,</span><span class="st">"savings"</span><span class="op">:</span>[[{<span class="dt">name</span><span class="op">:</span><span class="st">"balance"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">balance</span>({year_in<span class="op">,</span>duration_in<span class="op">,</span>annual_payment_in<span class="op">,</span>interest_rate_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"deposits"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">deposits</span>({year_in<span class="op">,</span>duration_in<span class="op">,</span>annual_payment_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"interest"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">interest</span>({year_in<span class="op">,</span>duration_in<span class="op">,</span>annual_payment_in<span class="op">,</span>interest_rate_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"year"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">year</span>({year_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"annual_payment"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">annual_payment</span>({annual_payment_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"duration"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">duration</span>({duration_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"interest_rate"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>savings<span class="op">.</span><span class="fu">interest_rate</span>({interest_rate_in})}]]<span class="op">,</span><span class="st">"savings_rec"</span><span class="op">:</span>[[{<span class="dt">name</span><span class="op">:</span><span class="st">"year"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">year</span>({year_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"actual_interest_rates"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">actual_interest_rates</span>({})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"actual_interest_rate_co"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">actual_interest_rate_co</span>({actual_interest_rate_co_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"interest_rate"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">interest_rate</span>({year_in<span class="op">,</span>actual_interest_rate_co_in})}]<span class="op">,</span>[{<span class="dt">name</span><span class="op">:</span><span class="st">"annual_payment"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">annual_payment</span>({})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"duration"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">duration</span>({})}]<span class="op">,</span>[{<span class="dt">name</span><span class="op">:</span><span class="st">"balance"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">balance</span>({year_in<span class="op">,</span>actual_interest_rate_co_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"deposits"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">deposits</span>({year_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"interest"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>savings_rec<span class="op">.</span><span class="fu">interest</span>({year_in<span class="op">,</span>actual_interest_rate_co_in})}]]<span class="op">,</span><span class="st">"starfield"</span><span class="op">:</span>[[{<span class="dt">name</span><span class="op">:</span><span class="st">"random_seed"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">random_seed</span>({random_seed_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"seeded"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">seeded</span>({random_seed_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"random"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">random</span>({random_seed_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"frame"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">frame</span>({frame_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"star"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">star</span>({star_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"x0"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">x0</span>({random_seed_in<span class="op">,</span>star_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"y0"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">y0</span>({random_seed_in<span class="op">,</span>star_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"z0"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">z0</span>({random_seed_in<span class="op">,</span>star_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"speed"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">speed</span>({speed_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"z"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">z</span>({frame_in<span class="op">,</span>random_seed_in<span class="op">,</span>star_in<span class="op">,</span>speed_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"visible"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">visible</span>({frame_in<span class="op">,</span>random_seed_in<span class="op">,</span>star_in<span class="op">,</span>speed_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"x"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">x</span>({frame_in<span class="op">,</span>random_seed_in<span class="op">,</span>star_in<span class="op">,</span>speed_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"y"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">y</span>({frame_in<span class="op">,</span>random_seed_in<span class="op">,</span>star_in<span class="op">,</span>speed_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"px"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">px</span>({frame_in<span class="op">,</span>random_seed_in<span class="op">,</span>star_in<span class="op">,</span>speed_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"py"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>starfield<span class="op">.</span><span class="fu">py</span>({frame_in<span class="op">,</span>random_seed_in<span class="op">,</span>star_in<span class="op">,</span>speed_in})}]]<span class="op">,</span><span class="st">"fizzbuzz"</span><span class="op">:</span>[[{<span class="dt">name</span><span class="op">:</span><span class="st">"fizz"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>fizzbuzz<span class="op">.</span><span class="fu">fizz</span>({i_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"buzz"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>fizzbuzz<span class="op">.</span><span class="fu">buzz</span>({i_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"fizzbuzz"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>fizzbuzz<span class="op">.</span><span class="fu">fizzbuzz</span>({i_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"i"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>fizzbuzz<span class="op">.</span><span class="fu">i</span>({i_in})}]]<span class="op">,</span><span class="st">"year_remaining"</span><span class="op">:</span>[[{<span class="dt">name</span><span class="op">:</span><span class="st">"date"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">date</span>({date_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"year"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">year</span>({date_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"isLeap"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">isLeap</span>({date_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"daysInYear"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">daysInYear</span>({date_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"daysIntoYearStartTomorrow"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">daysIntoYearStartTomorrow</span>({date_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"daysIntoYearStartToday"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">daysIntoYearStartToday</span>({date_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"daysIntoYear"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">daysIntoYear</span>({timing_in<span class="op">,</span>date_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"fractionIntoYear"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">fractionIntoYear</span>({timing_in<span class="op">,</span>date_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"fractionLeftInYear"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">fractionLeftInYear</span>({timing_in<span class="op">,</span>date_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"timing"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>year_remaining<span class="op">.</span><span class="fu">timing</span>({timing_in})}]]<span class="op">,</span><span class="st">"simple_loan"</span><span class="op">:</span>[[{<span class="dt">name</span><span class="op">:</span><span class="st">"v"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">v</span>({year_in<span class="op">,</span>d_i_year_in<span class="op">,</span>i_in<span class="op">,</span>d_i_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"v_pow_term_left"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">v_pow_term_left</span>({year_in<span class="op">,</span>d_i_year_in<span class="op">,</span>i_in<span class="op">,</span>d_i_in<span class="op">,</span>term_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"repayment_amount"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">repayment_amount</span>({year_in<span class="op">,</span>principal_in<span class="op">,</span>d_i_year_in<span class="op">,</span>i_in<span class="op">,</span>d_i_in<span class="op">,</span>missed_repayment_year_in<span class="op">,</span>skip_interest_in<span class="op">,</span>term_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"interest"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">interest</span>({year_in<span class="op">,</span>principal_in<span class="op">,</span>missed_repayment_year_in<span class="op">,</span>skip_interest_in<span class="op">,</span>term_in<span class="op">,</span>d_i_year_in<span class="op">,</span>i_in<span class="op">,</span>d_i_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"capital_repayment"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">capital_repayment</span>({year_in<span class="op">,</span>missed_repayment_year_in<span class="op">,</span>skip_interest_in<span class="op">,</span>principal_in<span class="op">,</span>d_i_year_in<span class="op">,</span>i_in<span class="op">,</span>d_i_in<span class="op">,</span>term_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"interest_repayment"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">interest_repayment</span>({year_in<span class="op">,</span>missed_repayment_year_in<span class="op">,</span>skip_interest_in<span class="op">,</span>principal_in<span class="op">,</span>d_i_year_in<span class="op">,</span>i_in<span class="op">,</span>d_i_in<span class="op">,</span>term_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"repayment_due"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">repayment_due</span>({year_in<span class="op">,</span>term_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"repayment"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">repayment</span>({year_in<span class="op">,</span>missed_repayment_year_in<span class="op">,</span>skip_interest_in<span class="op">,</span>principal_in<span class="op">,</span>d_i_year_in<span class="op">,</span>i_in<span class="op">,</span>d_i_in<span class="op">,</span>term_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"balance"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">balance</span>({year_in<span class="op">,</span>principal_in<span class="op">,</span>d_i_year_in<span class="op">,</span>i_in<span class="op">,</span>d_i_in<span class="op">,</span>missed_repayment_year_in<span class="op">,</span>skip_interest_in<span class="op">,</span>term_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"interest_rate"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">interest_rate</span>({year_in<span class="op">,</span>d_i_year_in<span class="op">,</span>i_in<span class="op">,</span>d_i_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"principal"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">principal</span>({principal_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"i"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">i</span>({i_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"term"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">term</span>({term_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"year"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">year</span>({year_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"missed_repayment_year"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">missed_repayment_year</span>({missed_repayment_year_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"skip_interest"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">skip_interest</span>({skip_interest_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"d_i_year"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">d_i_year</span>({d_i_year_in})}<span class="op">,</span>{<span class="dt">name</span><span class="op">:</span><span class="st">"d_i"</span><span class="op">,</span><span class="dt">value</span><span class="op">:</span>simple_loan<span class="op">.</span><span class="fu">d_i</span>({d_i_in})}]]}</span>
<span id="cb40-851"><a href="#cb40-851" aria-hidden="true" tabindex="-1"></a>)}</span>
<span id="cb40-852"><a href="#cb40-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-853"><a href="#cb40-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-854"><a href="#cb40-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-855"><a href="#cb40-855" aria-hidden="true" tabindex="-1"></a><span class="co">/////////// end copy, don't delete the following:</span></span>
<span id="cb40-856"><a href="#cb40-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-857"><a href="#cb40-857" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">0</span> <span class="co">// allows for bug processing simple_loan</span></span>
<span id="cb40-858"><a href="#cb40-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-859"><a href="#cb40-859" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb40-860"><a href="#cb40-860" aria-hidden="true" tabindex="-1"></a> <span class="bu">window</span><span class="op">.</span><span class="at">fns_with_mjs_q_eval</span> <span class="op">=</span> fns_with_mjs_q_eval</span>
<span id="cb40-861"><a href="#cb40-861" aria-hidden="true" tabindex="-1"></a> <span class="bu">window</span><span class="op">.</span><span class="at">mjs_q_eval</span> <span class="op">=</span> mjs_q_eval</span>
<span id="cb40-862"><a href="#cb40-862" aria-hidden="true" tabindex="-1"></a> <span class="co">// trigger an update animation here, but is that good without checking if individual numbers changed ?</span></span>
<span id="cb40-863"><a href="#cb40-863" aria-hidden="true" tabindex="-1"></a> <span class="co">// setup a history?</span></span>
<span id="cb40-864"><a href="#cb40-864" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-7-1" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-7-2" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-7-3" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-7-4" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-7-5" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb41" data-startfrom="868" data-source-offset="-36788"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 867;"><span id="cb41-868"><a href="#cb41-868" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb41-869"><a href="#cb41-869" aria-hidden="true" tabindex="-1"></a>  <span class="co">// can I make this run on editor scroll? or make CM generate full dom?</span></span>
<span id="cb41-870"><a href="#cb41-870" aria-hidden="true" tabindex="-1"></a>      <span class="co">//document.getElementById('a-'+32).textContent = fmt(fns_with_mjs_q_eval[32]);</span></span>
<span id="cb41-871"><a href="#cb41-871" aria-hidden="true" tabindex="-1"></a><span class="co">// Seems like these cells stop if there is a single error,</span></span>
<span id="cb41-872"><a href="#cb41-872" aria-hidden="true" tabindex="-1"></a><span class="co">// like modifying an element that isn't yet created</span></span>
<span id="cb41-873"><a href="#cb41-873" aria-hidden="true" tabindex="-1"></a><span class="co">// Quarto/OJS gives no error!</span></span>
<span id="cb41-874"><a href="#cb41-874" aria-hidden="true" tabindex="-1"></a><span class="co">// maybe due to output: false? DANGEROUS</span></span>
<span id="cb41-875"><a href="#cb41-875" aria-hidden="true" tabindex="-1"></a><span class="co">//console.log('UPDATE')</span></span>
<span id="cb41-876"><a href="#cb41-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-877"><a href="#cb41-877" aria-hidden="true" tabindex="-1"></a>  fns_with_mjs_q_eval[modelname][cul_scope_id]<span class="op">.</span><span class="fu">forEach</span>((v<span class="op">,</span> i) <span class="kw">=&gt;</span> {</span>
<span id="cb41-878"><a href="#cb41-878" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> d <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">'a-'</span><span class="op">+</span>i)</span>
<span id="cb41-879"><a href="#cb41-879" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (d)</span>
<span id="cb41-880"><a href="#cb41-880" aria-hidden="true" tabindex="-1"></a>    d<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="fu">fmt2</span>(v<span class="op">.</span><span class="at">name</span><span class="op">,</span> v<span class="op">.</span><span class="at">value</span>)<span class="co">//fmt(v);</span></span>
<span id="cb41-881"><a href="#cb41-881" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb41-882"><a href="#cb41-882" aria-hidden="true" tabindex="-1"></a>  mjs_q_eval[modelname][cul_scope_id]<span class="op">.</span><span class="fu">forEach</span>(({name<span class="op">,</span> value}<span class="op">,</span> i) <span class="kw">=&gt;</span> {</span>
<span id="cb41-883"><a href="#cb41-883" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> d <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">'w-'</span><span class="op">+</span>i)</span>
<span id="cb41-884"><a href="#cb41-884" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (d)    <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">'w-'</span><span class="op">+</span>i)<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="fu">fmt2</span>(name<span class="op">,</span> value)<span class="op">;</span> <span class="co">// does this get used? on update?</span></span>
<span id="cb41-885"><a href="#cb41-885" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb41-886"><a href="#cb41-886" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-7-6" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb42" data-startfrom="890" data-source-offset="-37654"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 889;"><span id="cb42-890"><a href="#cb42-890" aria-hidden="true" tabindex="-1"></a>fmt2 <span class="op">=</span> (name<span class="op">,</span> value) <span class="kw">=&gt;</span> {</span>
<span id="cb42-891"><a href="#cb42-891" aria-hidden="true" tabindex="-1"></a>  name <span class="op">=</span> name<span class="op">.</span><span class="fu">toLowerCase</span>()<span class="op">;</span></span>
<span id="cb42-892"><a href="#cb42-892" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (name <span class="op">==</span> <span class="st">'x'</span> <span class="op">||</span> name <span class="op">==</span> <span class="st">'y'</span>) <span class="cf">return</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">',.4f'</span>)(value)</span>
<span id="cb42-893"><a href="#cb42-893" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (name <span class="op">==</span> <span class="st">"map"</span>) <span class="cf">return</span> <span class="st">"[[..]]"</span></span>
<span id="cb42-894"><a href="#cb42-894" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(value)) <span class="cf">return</span> <span class="st">"[..]"</span></span>
<span id="cb42-895"><a href="#cb42-895" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (modelname <span class="op">==</span> <span class="st">'fizzbuzz'</span>) <span class="cf">return</span> <span class="kw">typeof</span> value <span class="op">==</span> <span class="st">'number'</span> <span class="op">?</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">',.0f'</span>)(value) <span class="op">:</span> value <span class="co">// works well for fizzbuzz</span></span>
<span id="cb42-896"><a href="#cb42-896" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (name <span class="op">==</span> <span class="st">'now'</span> <span class="op">||</span> name <span class="op">==</span> <span class="st">'date'</span>) <span class="cf">return</span> d3<span class="op">.</span><span class="fu">timeFormat</span>(<span class="st">"%Y-%m-%d"</span>)(value)</span>
<span id="cb42-897"><a href="#cb42-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-898"><a href="#cb42-898" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (modelname <span class="op">==</span> <span class="st">'emissions_my_lifetime'</span>) {</span>
<span id="cb42-899"><a href="#cb42-899" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (name <span class="op">==</span> <span class="st">'now'</span>) <span class="cf">return</span> d3<span class="op">.</span><span class="fu">timeFormat</span>(<span class="st">"%Y-%m-%d"</span>)(value)</span>
<span id="cb42-900"><a href="#cb42-900" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (name <span class="op">==</span> <span class="st">"emissions_my_lifetime_proportion"</span>) <span class="cf">return</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">".3%"</span>)(value)</span>
<span id="cb42-901"><a href="#cb42-901" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="kw">typeof</span> value <span class="op">==</span> <span class="st">'number'</span>)</span>
<span id="cb42-902"><a href="#cb42-902" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">".5k"</span>)(value)</span>
<span id="cb42-903"><a href="#cb42-903" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-904"><a href="#cb42-904" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (name <span class="op">==</span> <span class="st">"v"</span>) <span class="cf">return</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">",.5f"</span>)(value)</span>
<span id="cb42-905"><a href="#cb42-905" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (name <span class="op">==</span> <span class="st">"v_pow_term_left"</span>) <span class="cf">return</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">",.5f"</span>)(value)</span>
<span id="cb42-906"><a href="#cb42-906" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (name<span class="op">.</span><span class="fu">includes</span>(<span class="st">"_hit_object"</span>)) <span class="cf">return</span> <span class="st">"{..}"</span><span class="co">//`{x: ${value.x.toFixed(2)}, y: ${value.y.toFixed(2)}, v: ${value.v}, step_in: ${value.step_in}}`</span></span>
<span id="cb42-907"><a href="#cb42-907" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (name<span class="op">.</span><span class="fu">includes</span>(<span class="st">"_co"</span>)) <span class="cf">return</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">",.0f"</span>)(value)</span>
<span id="cb42-908"><a href="#cb42-908" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (name<span class="op">.</span><span class="fu">includes</span>(<span class="st">"rate"</span>) <span class="op">&amp;&amp;</span> name<span class="op">.</span><span class="fu">includes</span>(<span class="st">"interest"</span>)) <span class="cf">return</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">".3%"</span>)(value)</span>
<span id="cb42-909"><a href="#cb42-909" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (name<span class="op">.</span><span class="fu">includes</span>(<span class="st">"rate"</span>) <span class="op">||</span> name<span class="op">.</span><span class="fu">includes</span>(<span class="st">"percent"</span>) <span class="op">||</span> name<span class="op">.</span><span class="fu">includes</span>(<span class="st">"fraction"</span>)) <span class="cf">return</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">".2%"</span>)(value)</span>
<span id="cb42-910"><a href="#cb42-910" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> ((name<span class="op">.</span><span class="fu">includes</span>(<span class="st">"year"</span>)) <span class="op">||</span> name<span class="op">.</span><span class="fu">includes</span>(<span class="st">"term"</span>) <span class="op">||</span> name<span class="op">.</span><span class="fu">includes</span>(<span class="st">"duration"</span>) <span class="op">||</span> name<span class="op">.</span><span class="fu">includes</span>(<span class="st">"frame"</span>)) <span class="cf">return</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">".0f"</span>)(value)</span>
<span id="cb42-911"><a href="#cb42-911" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (name<span class="op">.</span><span class="fu">includes</span>(<span class="st">"object"</span>) <span class="op">||</span> <span class="kw">typeof</span> value <span class="op">!=</span> <span class="st">'number'</span>) <span class="cf">return</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(value)</span>
<span id="cb42-912"><a href="#cb42-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-913"><a href="#cb42-913" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> d3<span class="op">.</span><span class="fu">format</span>(fmt_fmt)(value)</span>
<span id="cb42-914"><a href="#cb42-914" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-915"><a href="#cb42-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-916"><a href="#cb42-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-917"><a href="#cb42-917" aria-hidden="true" tabindex="-1"></a><span class="co">////</span></span>
<span id="cb42-918"><a href="#cb42-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-919"><a href="#cb42-919" aria-hidden="true" tabindex="-1"></a><span class="co">// how to call a function</span></span>
<span id="cb42-920"><a href="#cb42-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-921"><a href="#cb42-921" aria-hidden="true" tabindex="-1"></a>fns_with_mjs <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">values</span>(calculang_source_introspection<span class="op">.</span><span class="at">cul_functions</span>)</span>
<span id="cb42-922"><a href="#cb42-922" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(</span>
<span id="cb42-923"><a href="#cb42-923" aria-hidden="true" tabindex="-1"></a>    (d) <span class="kw">=&gt;</span></span>
<span id="cb42-924"><a href="#cb42-924" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">reason</span> <span class="op">==</span> <span class="st">"definition"</span> <span class="co">/*input definition doesn't have a loc*/</span> <span class="op">&amp;&amp;</span></span>
<span id="cb42-925"><a href="#cb42-925" aria-hidden="true" tabindex="-1"></a>      d<span class="op">.</span><span class="at">cul_scope_id</span> <span class="op">==</span> cul_scope_id</span>
<span id="cb42-926"><a href="#cb42-926" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-927"><a href="#cb42-927" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> ({ <span class="op">...</span>d<span class="op">,</span> <span class="dt">mjs</span><span class="op">:</span> <span class="vs">`{</span><span class="sc">${</span>d<span class="op">.</span><span class="at">inputs</span><span class="op">.</span><span class="fu">join</span>(<span class="st">","</span>)<span class="sc">}</span><span class="vs">}`</span> })) <span class="co">// assuming completely on one line</span></span>
<span id="cb42-928"><a href="#cb42-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-929"><a href="#cb42-929" aria-hidden="true" tabindex="-1"></a><span class="co">// ex- calls_with_mjs, relates to that in generator</span></span>
<span id="cb42-930"><a href="#cb42-930" aria-hidden="true" tabindex="-1"></a>calls <span class="op">=</span> calculang_source_introspection<span class="op">.</span><span class="at">cul_links</span></span>
<span id="cb42-931"><a href="#cb42-931" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> <span class="op">!</span>d<span class="op">.</span><span class="at">from</span><span class="op">.</span><span class="fu">includes</span>(<span class="st">'undefined'</span>))<span class="op">.</span><span class="fu">filter</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">reason</span> <span class="op">==</span> <span class="st">"call"</span> <span class="op">&amp;&amp;</span> cul_scope_id <span class="op">==</span> <span class="op">+</span>d<span class="op">.</span><span class="at">to</span><span class="op">.</span><span class="fu">split</span>(<span class="st">"_"</span>)[<span class="dv">0</span>]) <span class="co">// bugs for double digit scopes</span></span>
<span id="cb42-932"><a href="#cb42-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-933"><a href="#cb42-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-934"><a href="#cb42-934" aria-hidden="true" tabindex="-1"></a><span class="co">// ex CheckboxWidget</span></span>
<span id="cb42-935"><a href="#cb42-935" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AnswersWorkingsOverlayWidget <span class="kw">extends</span> cmImports<span class="op">.</span><span class="at">view</span><span class="op">.</span><span class="at">WidgetType</span> {</span>
<span id="cb42-936"><a href="#cb42-936" aria-hidden="true" tabindex="-1"></a>  <span class="fu">constructor</span>(v<span class="op">,</span> call<span class="op">,</span> call_i<span class="op">,</span> type) {</span>
<span id="cb42-937"><a href="#cb42-937" aria-hidden="true" tabindex="-1"></a>    <span class="co">//a = v;</span></span>
<span id="cb42-938"><a href="#cb42-938" aria-hidden="true" tabindex="-1"></a>    <span class="kw">super</span>()<span class="op">;</span></span>
<span id="cb42-939"><a href="#cb42-939" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">v</span> <span class="op">=</span> v<span class="op">;</span></span>
<span id="cb42-940"><a href="#cb42-940" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">call</span> <span class="op">=</span> call<span class="op">;</span></span>
<span id="cb42-941"><a href="#cb42-941" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">call_i</span> <span class="op">=</span> call_i<span class="op">;</span></span>
<span id="cb42-942"><a href="#cb42-942" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="at">type</span> <span class="op">=</span> type<span class="op">;</span></span>
<span id="cb42-943"><a href="#cb42-943" aria-hidden="true" tabindex="-1"></a>    <span class="co">//this.evals = type == "definition" ? mjs_q_eval : fns_with_mjs_q_eval;</span></span>
<span id="cb42-944"><a href="#cb42-944" aria-hidden="true" tabindex="-1"></a>    <span class="co">//this.info = type == "definition" ? fns_with_mjs : calls_with_mjs_qualified;</span></span>
<span id="cb42-945"><a href="#cb42-945" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-946"><a href="#cb42-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-947"><a href="#cb42-947" aria-hidden="true" tabindex="-1"></a>  <span class="fu">toDOM</span>() {</span>
<span id="cb42-948"><a href="#cb42-948" aria-hidden="true" tabindex="-1"></a>    <span class="co">// mjs_q_eval; use this to test flicker/parse issues for plugins setting values (now set setparately by DOM calls)</span></span>
<span id="cb42-949"><a href="#cb42-949" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> wrap <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">createElement</span>(<span class="st">"span"</span>)<span class="op">;</span></span>
<span id="cb42-950"><a href="#cb42-950" aria-hidden="true" tabindex="-1"></a>    <span class="co">//wrap.className = "tooltip";</span></span>
<span id="cb42-951"><a href="#cb42-951" aria-hidden="true" tabindex="-1"></a>    <span class="co">//wrap.textContent = "101.19";</span></span>
<span id="cb42-952"><a href="#cb42-952" aria-hidden="true" tabindex="-1"></a>    wrap<span class="op">.</span><span class="fu">setAttribute</span>(<span class="st">"aria-hidden"</span><span class="op">,</span> <span class="st">"true"</span>)<span class="op">;</span> <span class="co">// not in a good place, todo fix</span></span>
<span id="cb42-953"><a href="#cb42-953" aria-hidden="true" tabindex="-1"></a>    wrap<span class="op">.</span><span class="at">className</span> <span class="op">=</span> <span class="st">"calculang_tooltip"</span><span class="op">;</span></span>
<span id="cb42-954"><a href="#cb42-954" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">type</span> <span class="op">==</span> <span class="st">"definition"</span>) {</span>
<span id="cb42-955"><a href="#cb42-955" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;span class="calculang_tooltip answer" id="c-a-</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">v</span><span class="sc">}</span><span class="vs">"&gt;&lt;!--&lt;input type="checkbox"&gt;&lt;/input&gt;--&gt;&lt;span id="a-</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">v</span><span class="sc">}</span><span class="vs">" class="tooltiptext" anchor="c-a-</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">v</span><span class="sc">}</span><span class="vs">"&gt;</span><span class="sc">${</span><span class="fu">fmt2</span>(</span>
<span id="cb42-956"><a href="#cb42-956" aria-hidden="true" tabindex="-1"></a>        <span class="bu">window</span><span class="op">.</span><span class="at">fns_with_mjs_q_eval</span>[modelname][cul_scope_id][<span class="kw">this</span><span class="op">.</span><span class="at">v</span>]<span class="op">.</span><span class="at">name</span><span class="op">,</span> <span class="bu">window</span><span class="op">.</span><span class="at">fns_with_mjs_q_eval</span>[modelname][cul_scope_id][<span class="kw">this</span><span class="op">.</span><span class="at">v</span>]<span class="op">.</span><span class="at">value</span><span class="co">//999</span></span>
<span id="cb42-957"><a href="#cb42-957" aria-hidden="true" tabindex="-1"></a>      )<span class="sc">}</span><span class="vs">&lt;/span&gt;&lt;/span&gt;`</span><span class="op">;</span></span>
<span id="cb42-958"><a href="#cb42-958" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-959"><a href="#cb42-959" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;span onclick=</span><span class="sc">${</span>() <span class="kw">=&gt;</span> {</span>
<span id="cb42-960"><a href="#cb42-960" aria-hidden="true" tabindex="-1"></a>      <span class="co">/* </span><span class="al">TODO</span><span class="co">*/</span> <span class="kw">set</span>(viewof formulae_visible<span class="op">,</span> [ <span class="co">// I'm supposed to use options.formulae_visible !!</span></span>
<span id="cb42-961"><a href="#cb42-961" aria-hidden="true" tabindex="-1"></a>        calls[<span class="kw">this</span><span class="op">.</span><span class="at">v</span>]<span class="op">.</span><span class="at">from</span><span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span>)</span>
<span id="cb42-962"><a href="#cb42-962" aria-hidden="true" tabindex="-1"></a>      ])<span class="op">;</span></span>
<span id="cb42-963"><a href="#cb42-963" aria-hidden="true" tabindex="-1"></a>      <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'.calculang_f_'</span><span class="op">+</span>calls[<span class="kw">this</span><span class="op">.</span><span class="at">v</span>]<span class="op">.</span><span class="at">from</span><span class="op">.</span><span class="fu">slice</span>(<span class="dv">2</span>)<span class="co">/*</span><span class="al">BUG</span><span class="co"> for &gt;9 scopes!*/</span>)<span class="op">.</span><span class="fu">scrollIntoView</span>(scrollIntoViewOpts)</span>
<span id="cb42-964"><a href="#cb42-964" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="bu">window</span><span class="op">.</span><span class="at">mjs_q_eval</span>[modelname][cul_scope_id][<span class="kw">this</span><span class="op">.</span><span class="at">v</span>]<span class="op">.</span><span class="at">handler</span>) <span class="bu">window</span><span class="op">.</span><span class="at">mjs_q_eval</span>[modelname][cul_scope_id][<span class="kw">this</span><span class="op">.</span><span class="at">v</span>]<span class="op">.</span><span class="fu">handler</span>()<span class="op">;</span></span>
<span id="cb42-965"><a href="#cb42-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-966"><a href="#cb42-966" aria-hidden="true" tabindex="-1"></a>    }<span class="sc">}</span><span class="vs"> class="calculang_tooltip" id="c-w-</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">call_i</span><span class="sc">}</span><span class="vs">"&gt;&lt;!--&amp;nbsp;&lt;input type="checkbox"&gt;&lt;/input&gt;--&gt;&lt;span id="w-</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">call_i</span><span class="sc">}</span><span class="vs">" class="tooltiptext" anchor="c-w-</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">call_i</span><span class="sc">}</span><span class="vs">"&gt;</span><span class="sc">${</span><span class="fu">fmt2</span>( <span class="bu">window</span><span class="op">.</span><span class="at">mjs_q_eval</span>[modelname][cul_scope_id][<span class="kw">this</span><span class="op">.</span><span class="at">call_i</span>]<span class="op">.</span><span class="at">name</span><span class="op">,</span></span>
<span id="cb42-967"><a href="#cb42-967" aria-hidden="true" tabindex="-1"></a>     <span class="bu">window</span><span class="op">.</span><span class="at">mjs_q_eval</span>[modelname][cul_scope_id][<span class="kw">this</span><span class="op">.</span><span class="at">call_i</span>]<span class="op">.</span><span class="at">value</span></span>
<span id="cb42-968"><a href="#cb42-968" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">}</span><span class="vs">&lt;/span&gt;&lt;/span&gt;`</span><span class="op">;</span></span>
<span id="cb42-969"><a href="#cb42-969" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> wrap<span class="op">;</span></span>
<span id="cb42-970"><a href="#cb42-970" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-971"><a href="#cb42-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-972"><a href="#cb42-972" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ignoreEvent</span>() {</span>
<span id="cb42-973"><a href="#cb42-973" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb42-974"><a href="#cb42-974" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-975"><a href="#cb42-975" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-976"><a href="#cb42-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-977"><a href="#cb42-977" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">workings</span>(view) {</span>
<span id="cb42-978"><a href="#cb42-978" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Decoration<span class="op">.</span><span class="fu">set</span>(</span>
<span id="cb42-979"><a href="#cb42-979" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb42-980"><a href="#cb42-980" aria-hidden="true" tabindex="-1"></a>      <span class="op">...</span>calls<span class="op">.</span><span class="fu">map</span>((d<span class="op">,</span> i) <span class="kw">=&gt;</span></span>
<span id="cb42-981"><a href="#cb42-981" aria-hidden="true" tabindex="-1"></a>        Decoration<span class="op">.</span><span class="fu">widget</span>({</span>
<span id="cb42-982"><a href="#cb42-982" aria-hidden="true" tabindex="-1"></a>          <span class="dt">widget</span><span class="op">:</span> <span class="kw">new</span> <span class="fu">AnswersWorkingsOverlayWidget</span>(i<span class="op">,</span> d<span class="op">,</span> i)<span class="op">,</span></span>
<span id="cb42-983"><a href="#cb42-983" aria-hidden="true" tabindex="-1"></a>          <span class="dt">side</span><span class="op">:</span> <span class="dv">1</span></span>
<span id="cb42-984"><a href="#cb42-984" aria-hidden="true" tabindex="-1"></a>        })<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb42-985"><a href="#cb42-985" aria-hidden="true" tabindex="-1"></a>          d<span class="op">.</span><span class="at">loc</span><span class="op">.</span><span class="at">start</span><span class="op">.</span><span class="at">index</span> <span class="op">+</span></span>
<span id="cb42-986"><a href="#cb42-986" aria-hidden="true" tabindex="-1"></a>            d<span class="op">.</span><span class="at">from</span><span class="op">.</span><span class="at">length</span> <span class="op">-</span></span>
<span id="cb42-987"><a href="#cb42-987" aria-hidden="true" tabindex="-1"></a>            <span class="dv">0</span> <span class="op">-</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(d<span class="op">.</span><span class="at">from</span><span class="op">.</span><span class="at">length</span><span class="op">/</span><span class="dv">2</span>) <span class="co">// this split is wrong for interest_rate for example!</span></span>
<span id="cb42-988"><a href="#cb42-988" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb42-989"><a href="#cb42-989" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb42-990"><a href="#cb42-990" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb42-991"><a href="#cb42-991" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb42-992"><a href="#cb42-992" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-993"><a href="#cb42-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-994"><a href="#cb42-994" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">answers</span>(view) {</span>
<span id="cb42-995"><a href="#cb42-995" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Decoration<span class="op">.</span><span class="fu">set</span>(</span>
<span id="cb42-996"><a href="#cb42-996" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb42-997"><a href="#cb42-997" aria-hidden="true" tabindex="-1"></a>      <span class="op">...</span>fns_with_mjs<span class="op">.</span><span class="fu">map</span>((d<span class="op">,</span> i) <span class="kw">=&gt;</span></span>
<span id="cb42-998"><a href="#cb42-998" aria-hidden="true" tabindex="-1"></a>        Decoration<span class="op">.</span><span class="fu">widget</span>({</span>
<span id="cb42-999"><a href="#cb42-999" aria-hidden="true" tabindex="-1"></a>          <span class="dt">widget</span><span class="op">:</span> <span class="kw">new</span> <span class="fu">AnswersWorkingsOverlayWidget</span>(i<span class="op">,</span> d<span class="op">,</span> i<span class="op">,</span> <span class="st">"definition"</span>)<span class="op">,</span></span>
<span id="cb42-1000"><a href="#cb42-1000" aria-hidden="true" tabindex="-1"></a>          <span class="dt">side</span><span class="op">:</span> <span class="dv">1</span></span>
<span id="cb42-1001"><a href="#cb42-1001" aria-hidden="true" tabindex="-1"></a>        })<span class="op">.</span><span class="fu">range</span>(</span>
<span id="cb42-1002"><a href="#cb42-1002" aria-hidden="true" tabindex="-1"></a>          <span class="co">//                    }).range(view.state.doc.line(e).from)</span></span>
<span id="cb42-1003"><a href="#cb42-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1004"><a href="#cb42-1004" aria-hidden="true" tabindex="-1"></a>          view<span class="op">.</span><span class="at">state</span><span class="op">.</span><span class="at">doc</span><span class="op">.</span><span class="fu">line</span>(d<span class="op">.</span><span class="at">loc</span><span class="op">.</span><span class="at">start</span><span class="op">.</span><span class="at">line</span>)<span class="op">.</span><span class="at">to</span></span>
<span id="cb42-1005"><a href="#cb42-1005" aria-hidden="true" tabindex="-1"></a>          <span class="co">//d.from.length -</span></span>
<span id="cb42-1006"><a href="#cb42-1006" aria-hidden="true" tabindex="-1"></a>          <span class="co">/* todo take midpoint start-end */</span></span>
<span id="cb42-1007"><a href="#cb42-1007" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb42-1008"><a href="#cb42-1008" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb42-1009"><a href="#cb42-1009" aria-hidden="true" tabindex="-1"></a>    ] <span class="co">/* todo take midpoint start-end */</span></span>
<span id="cb42-1010"><a href="#cb42-1010" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb42-1011"><a href="#cb42-1011" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-1012"><a href="#cb42-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1013"><a href="#cb42-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1014"><a href="#cb42-1014" aria-hidden="true" tabindex="-1"></a>overlay_answers <span class="op">=</span> {</span>
<span id="cb42-1015"><a href="#cb42-1015" aria-hidden="true" tabindex="-1"></a>  <span class="co">// prevent input events coming from the contenteditable div that</span></span>
<span id="cb42-1016"><a href="#cb42-1016" aria-hidden="true" tabindex="-1"></a>  <span class="co">// propagates and triggers a cell refresh; we shall handle it ourselves.</span></span>
<span id="cb42-1017"><a href="#cb42-1017" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> answers_decorations <span class="op">=</span> cmImports<span class="op">.</span><span class="at">view</span><span class="op">.</span><span class="at">ViewPlugin</span><span class="op">.</span><span class="fu">fromClass</span>(</span>
<span id="cb42-1018"><a href="#cb42-1018" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> {</span>
<span id="cb42-1019"><a href="#cb42-1019" aria-hidden="true" tabindex="-1"></a>      <span class="fu">constructor</span>(view) {</span>
<span id="cb42-1020"><a href="#cb42-1020" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">decorations</span> <span class="op">=</span> <span class="fu">answers</span>(view)<span class="op">;</span></span>
<span id="cb42-1021"><a href="#cb42-1021" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb42-1022"><a href="#cb42-1022" aria-hidden="true" tabindex="-1"></a>      <span class="fu">update</span>(update) {</span>
<span id="cb42-1023"><a href="#cb42-1023" aria-hidden="true" tabindex="-1"></a>        <span class="co">// updates cause difficulty clicking numbers - thankfully not needed</span></span>
<span id="cb42-1024"><a href="#cb42-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1025"><a href="#cb42-1025" aria-hidden="true" tabindex="-1"></a>        <span class="co">//this.decorations = answers(update.view);</span></span>
<span id="cb42-1026"><a href="#cb42-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1027"><a href="#cb42-1027" aria-hidden="true" tabindex="-1"></a>        <span class="co">// not necessary for read-only</span></span>
<span id="cb42-1028"><a href="#cb42-1028" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb42-1029"><a href="#cb42-1029" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb42-1030"><a href="#cb42-1030" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb42-1031"><a href="#cb42-1031" aria-hidden="true" tabindex="-1"></a>      <span class="dt">decorations</span><span class="op">:</span> (v) <span class="kw">=&gt;</span> v<span class="op">.</span><span class="at">decorations</span><span class="op">,</span></span>
<span id="cb42-1032"><a href="#cb42-1032" aria-hidden="true" tabindex="-1"></a>      <span class="dt">eventHandlers</span><span class="op">:</span> {}</span>
<span id="cb42-1033"><a href="#cb42-1033" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-1034"><a href="#cb42-1034" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb42-1035"><a href="#cb42-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1036"><a href="#cb42-1036" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [answers_decorations]<span class="op">;</span></span>
<span id="cb42-1037"><a href="#cb42-1037" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-1038"><a href="#cb42-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1039"><a href="#cb42-1039" aria-hidden="true" tabindex="-1"></a>overlay_workings <span class="op">=</span> {</span>
<span id="cb42-1040"><a href="#cb42-1040" aria-hidden="true" tabindex="-1"></a>  <span class="co">// prevent input events coming from the contenteditable div that</span></span>
<span id="cb42-1041"><a href="#cb42-1041" aria-hidden="true" tabindex="-1"></a>  <span class="co">// propagates and triggers a cell refresh; we shall handle it ourselves.</span></span>
<span id="cb42-1042"><a href="#cb42-1042" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> checkboxPlugin <span class="op">=</span> cmImports<span class="op">.</span><span class="at">view</span><span class="op">.</span><span class="at">ViewPlugin</span><span class="op">.</span><span class="fu">fromClass</span>(</span>
<span id="cb42-1043"><a href="#cb42-1043" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> {</span>
<span id="cb42-1044"><a href="#cb42-1044" aria-hidden="true" tabindex="-1"></a>      <span class="fu">constructor</span>(view) {</span>
<span id="cb42-1045"><a href="#cb42-1045" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">decorations</span> <span class="op">=</span> <span class="fu">workings</span>(view)<span class="op">;</span></span>
<span id="cb42-1046"><a href="#cb42-1046" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb42-1047"><a href="#cb42-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1048"><a href="#cb42-1048" aria-hidden="true" tabindex="-1"></a>      <span class="fu">update</span>(update) {</span>
<span id="cb42-1049"><a href="#cb42-1049" aria-hidden="true" tabindex="-1"></a>        <span class="co">// updates cause difficulty clicking numbers - thankfully not needed</span></span>
<span id="cb42-1050"><a href="#cb42-1050" aria-hidden="true" tabindex="-1"></a>        <span class="co">// not necessary for read-only</span></span>
<span id="cb42-1051"><a href="#cb42-1051" aria-hidden="true" tabindex="-1"></a>        <span class="co">//if (update.docChanged || update.viewportChanged)</span></span>
<span id="cb42-1052"><a href="#cb42-1052" aria-hidden="true" tabindex="-1"></a>         <span class="co">//this.decorations = workings(update.view);</span></span>
<span id="cb42-1053"><a href="#cb42-1053" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb42-1054"><a href="#cb42-1054" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb42-1055"><a href="#cb42-1055" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb42-1056"><a href="#cb42-1056" aria-hidden="true" tabindex="-1"></a>      <span class="dt">decorations</span><span class="op">:</span> (v) <span class="kw">=&gt;</span> v<span class="op">.</span><span class="at">decorations</span></span>
<span id="cb42-1057"><a href="#cb42-1057" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb42-1058"><a href="#cb42-1058" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb42-1059"><a href="#cb42-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1060"><a href="#cb42-1060" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> [checkboxPlugin]<span class="op">;</span></span>
<span id="cb42-1061"><a href="#cb42-1061" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-1062"><a href="#cb42-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1063"><a href="#cb42-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1064"><a href="#cb42-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1065"><a href="#cb42-1065" aria-hidden="true" tabindex="-1"></a>fmt <span class="op">=</span> d <span class="kw">=&gt;</span> (<span class="kw">typeof</span> d <span class="op">==</span> <span class="st">'number'</span>) <span class="op">?</span> (<span class="bu">Math</span><span class="op">.</span><span class="fu">abs</span>(d) <span class="op">&lt;</span> <span class="dv">2</span> <span class="op">?</span> d3<span class="op">.</span><span class="fu">format</span>(<span class="st">'.2%'</span>)(d) <span class="op">:</span> d3<span class="op">.</span><span class="fu">format</span>(fmt_fmt)(d)) <span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(d)</span>
<span id="cb42-1066"><a href="#cb42-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1067"><a href="#cb42-1067" aria-hidden="true" tabindex="-1"></a>embed_ <span class="op">=</span> <span class="pp">require</span>(<span class="st">"vega-embed"</span>)</span>
<span id="cb42-1068"><a href="#cb42-1068" aria-hidden="true" tabindex="-1"></a>embed <span class="op">=</span> (spec<span class="op">,</span> options) <span class="kw">=&gt;</span> <span class="fu">embed_</span>(spec<span class="op">,</span> {actions<span class="op">,</span> <span class="dt">renderer</span><span class="op">:</span><span class="st">'svg'</span><span class="op">,...</span>options})</span>
<span id="cb42-1069"><a href="#cb42-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1070"><a href="#cb42-1070" aria-hidden="true" tabindex="-1"></a><span class="co">//theme = 'powerbi';</span></span>
<span id="cb42-1071"><a href="#cb42-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1072"><a href="#cb42-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1073"><a href="#cb42-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-1074"><a href="#cb42-1074" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb42-1075"><a href="#cb42-1075" aria-hidden="true" tabindex="-1"></a>  f_in<span class="op">;</span></span>
<span id="cb42-1076"><a href="#cb42-1076" aria-hidden="true" tabindex="-1"></a>  mutable frame_val <span class="op">=</span> f_in<span class="op">;</span></span>
<span id="cb42-1077"><a href="#cb42-1077" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-7-7" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-7-8" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-7-9" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-7-10" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-7-11" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-7-12" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-7-13" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-7-14" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-7-15" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-7-16" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-7-17" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-7-18" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<details>
<summary>
ü§´
</summary>
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb43" data-startfrom="1084" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1083;"><span id="cb43-1084"><a href="#cb43-1084" aria-hidden="true" tabindex="-1"></a>scrollIntoViewOpts <span class="op">=</span> { <span class="cf">return</span> ({<span class="dt">behaviour</span><span class="op">:</span><span class="st">'smooth'</span><span class="op">,</span> <span class="dt">block</span><span class="op">:</span><span class="st">'center'</span>})}</span>
<span id="cb43-1085"><a href="#cb43-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-1086"><a href="#cb43-1086" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">button</span>([</span>
<span id="cb43-1087"><a href="#cb43-1087" aria-hidden="true" tabindex="-1"></a>  [<span class="st">"expand all"</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="kw">set</span>(viewof formulae_visible<span class="op">,</span> formulae_all)]<span class="op">,</span></span>
<span id="cb43-1088"><a href="#cb43-1088" aria-hidden="true" tabindex="-1"></a>  [<span class="st">"collapse all"</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="kw">set</span>(viewof formulae_visible<span class="op">,</span> [])]<span class="op">,</span></span>
<span id="cb43-1089"><a href="#cb43-1089" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-8-1" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-8-2" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb44" data-startfrom="1092" data-source-offset="-221"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1091;"><span id="cb44-1092"><a href="#cb44-1092" aria-hidden="true" tabindex="-1"></a>viewof options <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">checkbox</span>([<span class="st">"export consts"</span><span class="op">,</span> <span class="st">"inputs"</span><span class="co">/*, "lists (todo)"*/</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"unhide?"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> [<span class="st">"export consts"</span><span class="op">,</span> <span class="st">"inputs"</span>]})</span>
<span id="cb44-1093"><a href="#cb44-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1094"><a href="#cb44-1094" aria-hidden="true" tabindex="-1"></a>viewof overlay <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({ <span class="dt">label</span><span class="op">:</span> <span class="st">"overlay?"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> q<span class="op">.</span><span class="fu">get</span>(<span class="st">'principal_in'</span>) <span class="op">?</span> <span class="kw">true</span> <span class="op">:</span> <span class="kw">false</span> })</span>
<span id="cb44-1095"><a href="#cb44-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1096"><a href="#cb44-1096" aria-hidden="true" tabindex="-1"></a><span class="co">//md`---`</span></span>
<span id="cb44-1097"><a href="#cb44-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1098"><a href="#cb44-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1099"><a href="#cb44-1099" aria-hidden="true" tabindex="-1"></a>viewof cul_js <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">radio</span>([<span class="st">"üìù calculang source üí¨"</span><span class="op">,</span> <span class="st">"‚ú® JS/ESM output ‚ú® (modular annotations bad)"</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">"ü´∂"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"üìù calculang source üí¨"</span>})</span>
<span id="cb44-1100"><a href="#cb44-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1101"><a href="#cb44-1101" aria-hidden="true" tabindex="-1"></a>cul_js_cul <span class="op">=</span> cul_js <span class="op">==</span> <span class="st">"üìù calculang source üí¨"</span> <span class="op">?</span> <span class="kw">true</span> <span class="op">:</span> <span class="kw">false</span></span>
<span id="cb44-1102"><a href="#cb44-1102" aria-hidden="true" tabindex="-1"></a>viewof calculang_source_nomemo <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">checkbox</span>([<span class="st">"nomemo"</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span> [<span class="st">"nomemo"</span>]<span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">'see memo? üíÄ'</span><span class="op">,</span> <span class="dt">disabled</span><span class="op">:</span>cul_js<span class="op">==</span><span class="st">"üìù calculang source üí¨"</span>})</span>
<span id="cb44-1103"><a href="#cb44-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1104"><a href="#cb44-1104" aria-hidden="true" tabindex="-1"></a>viewof formulae_visible <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">input</span>(modelname <span class="op">==</span> <span class="st">'simple_loan'</span> <span class="op">?</span> [<span class="st">'repayment_amount'</span>] <span class="op">:</span> <span class="co">/*modelname == 'year_remaining' ? ['fractionLeftInYear'] :*/</span> formulae_all)<span class="co">// modelname == 'year_remaining' ? ['fractionLeftInYear'] : modelname == 'savings' ? ["balance", "interest", "deposits"] : modelname == 'fizzbuzz' ? formulae_all : [])</span></span>
<span id="cb44-1105"><a href="#cb44-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-1106"><a href="#cb44-1106" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb44-1107"><a href="#cb44-1107" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (modelname <span class="op">==</span> <span class="st">'year_remaining'</span>) <span class="co">// doesn't work ?</span></span>
<span id="cb44-1108"><a href="#cb44-1108" aria-hidden="true" tabindex="-1"></a>    <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'.calculang_f_'</span><span class="op">+</span><span class="st">"fractionLeftInYear"</span>)<span class="op">.</span><span class="fu">scrollIntoView</span>(scrollIntoViewOpts)</span>
<span id="cb44-1109"><a href="#cb44-1109" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-8-3" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-8-4" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-8-5" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-8-6" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-8-7" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-8-8" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-8-9" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb45" data-startfrom="1111" data-source-offset="-1331"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1110;"><span id="cb45-1111"><a href="#cb45-1111" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb45-1112"><a href="#cb45-1112" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (modelname <span class="op">==</span> <span class="st">'raycasting2'</span>)</span>
<span id="cb45-1113"><a href="#cb45-1113" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span>(viewof overlay<span class="op">,</span> <span class="kw">false</span>)</span>
<span id="cb45-1114"><a href="#cb45-1114" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-8-10" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb46" data-startfrom="1116" data-source-offset="-1399"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1115;"><span id="cb46-1116"><a href="#cb46-1116" aria-hidden="true" tabindex="-1"></a>viewof fmt_fmt <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">text</span>({<span class="dt">value</span><span class="op">:</span><span class="st">",.2f"</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">'format'</span>})</span>
<span id="cb46-1117"><a href="#cb46-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-1118"><a href="#cb46-1118" aria-hidden="true" tabindex="-1"></a>viewof actions <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span><span class="st">'vega actions?'</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span><span class="kw">false</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-8-11" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-8-12" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</details>
</div>
<!-- can I make this column optional? -->
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div><div class="bslib-grid" style="display: grid; grid-template-rows: minmax(3em, max-content); grid-auto-columns: minmax(0, 1fr);">
<div class="card bslib-card html-fill-container" data-fill="false" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<strong style="font-size:1.5em;"><!--application(s)--></strong>
<p style="background-color:pink; padding: 5px; border-radius: 0 10px 10px 10px; font-size: 1.3em">
üé†üéàüïπÔ∏è
</p>
<div id="raycasting2" class="modeldept html-fill-item html-fill-container" title="raycasting2">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb47" data-startfrom="1144" data-source-offset="-50"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1143;"><span id="cb47-1144"><a href="#cb47-1144" aria-hidden="true" tabindex="-1"></a>mutable frame_val <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb47-1145"><a href="#cb47-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1146"><a href="#cb47-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1147"><a href="#cb47-1147" aria-hidden="true" tabindex="-1"></a>mutable keys_shared <span class="op">=</span> []</span>
<span id="cb47-1148"><a href="#cb47-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1149"><a href="#cb47-1149" aria-hidden="true" tabindex="-1"></a><span class="co">//Inputs.bind(Scrubber(_.range(0, 200), { autoplay: false, delay: 50 }), viewof f_in)</span></span>
<span id="cb47-1150"><a href="#cb47-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1151"><a href="#cb47-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1152"><a href="#cb47-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1153"><a href="#cb47-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1154"><a href="#cb47-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1155"><a href="#cb47-1155" aria-hidden="true" tabindex="-1"></a>viewof keys_stream <span class="op">=</span> { <span class="co">// https://observablehq.com/d/867e1424e1d093ab</span></span>
<span id="cb47-1156"><a href="#cb47-1156" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> e <span class="op">=</span> <span class="fu">html</span><span class="vs">`&lt;div class='target' style='color:pink; background:#eee' tabIndex=1&gt;Keyboard target&lt;/div&gt;`</span><span class="op">;</span></span>
<span id="cb47-1157"><a href="#cb47-1157" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> keys <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb47-1158"><a href="#cb47-1158" aria-hidden="true" tabindex="-1"></a>  e<span class="op">.</span><span class="at">value</span> <span class="op">=</span> keys<span class="op">;</span></span>
<span id="cb47-1159"><a href="#cb47-1159" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> gap <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">;</span></span>
<span id="cb47-1160"><a href="#cb47-1160" aria-hidden="true" tabindex="-1"></a>  e<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">"keyup"</span><span class="op">,</span> (evt) <span class="kw">=&gt;</span> {</span>
<span id="cb47-1161"><a href="#cb47-1161" aria-hidden="true" tabindex="-1"></a>    keys<span class="op">.</span><span class="fu">push</span>({</span>
<span id="cb47-1162"><a href="#cb47-1162" aria-hidden="true" tabindex="-1"></a>      <span class="dt">key</span><span class="op">:</span> evt<span class="op">.</span><span class="at">key</span><span class="op">,</span></span>
<span id="cb47-1163"><a href="#cb47-1163" aria-hidden="true" tabindex="-1"></a>      <span class="dt">delay</span><span class="op">:</span> <span class="kw">new</span> <span class="bu">Date</span>() <span class="op">-</span> gap<span class="op">,</span></span>
<span id="cb47-1164"><a href="#cb47-1164" aria-hidden="true" tabindex="-1"></a>      <span class="dt">frame</span><span class="op">:</span> mutable frame_val <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb47-1165"><a href="#cb47-1165" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb47-1166"><a href="#cb47-1166" aria-hidden="true" tabindex="-1"></a>    keys_shared<span class="op">.</span><span class="fu">push</span>({</span>
<span id="cb47-1167"><a href="#cb47-1167" aria-hidden="true" tabindex="-1"></a>      <span class="dt">key</span><span class="op">:</span> evt<span class="op">.</span><span class="at">key</span><span class="op">,</span></span>
<span id="cb47-1168"><a href="#cb47-1168" aria-hidden="true" tabindex="-1"></a>      <span class="dt">delay</span><span class="op">:</span> <span class="kw">new</span> <span class="bu">Date</span>() <span class="op">-</span> gap<span class="op">,</span></span>
<span id="cb47-1169"><a href="#cb47-1169" aria-hidden="true" tabindex="-1"></a>      <span class="dt">frame</span><span class="op">:</span> mutable frame_val <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb47-1170"><a href="#cb47-1170" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb47-1171"><a href="#cb47-1171" aria-hidden="true" tabindex="-1"></a>    gap <span class="op">=</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">;</span></span>
<span id="cb47-1172"><a href="#cb47-1172" aria-hidden="true" tabindex="-1"></a>    e<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">"input"</span>))<span class="op">;</span></span>
<span id="cb47-1173"><a href="#cb47-1173" aria-hidden="true" tabindex="-1"></a>    evt<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span> <span class="co">// for revealjs? not enough</span></span>
<span id="cb47-1174"><a href="#cb47-1174" aria-hidden="true" tabindex="-1"></a>          <span class="kw">set</span>(viewof f_in<span class="op">,</span> viewof f_in<span class="op">.</span><span class="at">value</span><span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb47-1175"><a href="#cb47-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1176"><a href="#cb47-1176" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb47-1177"><a href="#cb47-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1178"><a href="#cb47-1178" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> e<span class="op">;</span></span>
<span id="cb47-1179"><a href="#cb47-1179" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-1180"><a href="#cb47-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-1181"><a href="#cb47-1181" aria-hidden="true" tabindex="-1"></a>viewof scene <span class="op">=</span> <span class="fu">embed</span>(scene_spec<span class="op">,</span> { <span class="dt">renderer</span><span class="op">:</span> <span class="st">"svg"</span><span class="op">,</span> <span class="dt">padding</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> actions<span class="op">,</span> <span class="dt">config</span><span class="op">:</span> { <span class="dt">autosize</span><span class="op">:</span> <span class="st">'fit-y'</span> }<span class="op">,</span></span>
<span id="cb47-1182"><a href="#cb47-1182" aria-hidden="true" tabindex="-1"></a><span class="dt">patch</span><span class="op">:</span> s <span class="kw">=&gt;</span> {s<span class="op">.</span><span class="at">signals</span><span class="op">.</span><span class="fu">push</span>({</span>
<span id="cb47-1183"><a href="#cb47-1183" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-1184"><a href="#cb47-1184" aria-hidden="true" tabindex="-1"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">"doubleclick"</span><span class="op">,</span></span>
<span id="cb47-1185"><a href="#cb47-1185" aria-hidden="true" tabindex="-1"></a>    <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb47-1186"><a href="#cb47-1186" aria-hidden="true" tabindex="-1"></a>      <span class="st">"on"</span><span class="op">:</span> [{<span class="st">"events"</span><span class="op">:</span> <span class="st">"dblclick"</span><span class="op">,</span> <span class="st">"update"</span><span class="op">:</span> <span class="st">"datum"</span>}]</span>
<span id="cb47-1187"><a href="#cb47-1187" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-1188"><a href="#cb47-1188" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb47-1189"><a href="#cb47-1189" aria-hidden="true" tabindex="-1"></a> <span class="cf">return</span> s}</span>
<span id="cb47-1190"><a href="#cb47-1190" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-9-1" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-9-2" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-9-3" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-9-4" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
<div class="cell hidden html-fill-item html-fill-container">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb48" data-startfrom="1201" data-source-offset="-2"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1200;"><span id="cb48-1201"><a href="#cb48-1201" aria-hidden="true" tabindex="-1"></a>{f_in<span class="op">;</span></span>
<span id="cb48-1202"><a href="#cb48-1202" aria-hidden="true" tabindex="-1"></a>    mutable show_ray <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb48-1203"><a href="#cb48-1203" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span>(viewof show_ray_h<span class="op">,</span> <span class="kw">false</span>)</span>
<span id="cb48-1204"><a href="#cb48-1204" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span>(viewof show_ray_v<span class="op">,</span> <span class="kw">false</span>)</span>
<span id="cb48-1205"><a href="#cb48-1205" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-10-1" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb49" data-startfrom="1207" data-source-offset="-112"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1206;"><span id="cb49-1207"><a href="#cb49-1207" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb49-1208"><a href="#cb49-1208" aria-hidden="true" tabindex="-1"></a>    scene<span class="op">.</span><span class="fu">addSignalListener</span>(<span class="st">'doubleclick'</span><span class="op">,</span> _ <span class="kw">=&gt;</span> {</span>
<span id="cb49-1209"><a href="#cb49-1209" aria-hidden="true" tabindex="-1"></a>      <span class="kw">set</span>(viewof overlay<span class="op">,</span> <span class="kw">true</span>)</span>
<span id="cb49-1210"><a href="#cb49-1210" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb49-1211"><a href="#cb49-1211" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-10-2" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb50" data-startfrom="1213" data-source-offset="-208"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1212;"><span id="cb50-1213"><a href="#cb50-1213" aria-hidden="true" tabindex="-1"></a>viewof scene_size <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="fl">0.1</span><span class="op">,</span><span class="dv">1</span>]<span class="op">,</span> {<span class="dt">value</span><span class="op">:</span><span class="fl">0.5</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">'size'</span>})</span>
<span id="cb50-1214"><a href="#cb50-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1215"><a href="#cb50-1215" aria-hidden="true" tabindex="-1"></a>viewof show_ray_steps <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">'show ray steps?'</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="kw">false</span>})</span>
<span id="cb50-1216"><a href="#cb50-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1217"><a href="#cb50-1217" aria-hidden="true" tabindex="-1"></a>viewof show_ray_h <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">'show h ray?'</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="kw">false</span>})</span>
<span id="cb50-1218"><a href="#cb50-1218" aria-hidden="true" tabindex="-1"></a>viewof show_ray_v <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({<span class="dt">label</span><span class="op">:</span> <span class="st">'show v ray?'</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="kw">false</span>})</span>
<span id="cb50-1219"><a href="#cb50-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1220"><a href="#cb50-1220" aria-hidden="true" tabindex="-1"></a><span class="co">// hmr versions works but the set for version doesn't work</span></span>
<span id="cb50-1221"><a href="#cb50-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-1222"><a href="#cb50-1222" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb50-1223"><a href="#cb50-1223" aria-hidden="true" tabindex="-1"></a>  raycasting_latest<span class="op">;</span></span>
<span id="cb50-1224"><a href="#cb50-1224" aria-hidden="true" tabindex="-1"></a>  mutable aaa <span class="op">=</span> [<span class="op">...</span>mutable aaa<span class="op">,</span> raycasting_latest]</span>
<span id="cb50-1225"><a href="#cb50-1225" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span>(viewof version<span class="op">,</span> viewof version<span class="op">.</span><span class="at">value</span><span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb50-1226"><a href="#cb50-1226" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-10-3" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-10-4" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-10-5" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-10-6" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-10-7" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<div class="cell hidden html-fill-item html-fill-container">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb51" data-startfrom="1234" data-source-offset="-2"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1233;"><span id="cb51-1234"><a href="#cb51-1234" aria-hidden="true" tabindex="-1"></a>scene<span class="op">.</span><span class="fu">addSignalListener</span>(<span class="st">"formula"</span><span class="op">,</span> (a<span class="op">,</span> b) <span class="kw">=&gt;</span> {</span>
<span id="cb51-1235"><a href="#cb51-1235" aria-hidden="true" tabindex="-1"></a>  <span class="co">//debugger;</span></span>
<span id="cb51-1236"><a href="#cb51-1236" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span>(viewof formulae_visible<span class="op">,</span> [<span class="st">"ray_inverse_distance"</span>])</span>
<span id="cb51-1237"><a href="#cb51-1237" aria-hidden="true" tabindex="-1"></a>  <span class="co">//set(viewof year_in, b.year_in[0])</span></span>
<span id="cb51-1238"><a href="#cb51-1238" aria-hidden="true" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'.calculang_f_'</span><span class="op">+</span><span class="st">"ray_inverse_distance"</span>)<span class="op">.</span><span class="fu">scrollIntoView</span>(scrollIntoViewOpts)</span>
<span id="cb51-1239"><a href="#cb51-1239" aria-hidden="true" tabindex="-1"></a> <span class="co">//}</span></span>
<span id="cb51-1240"><a href="#cb51-1240" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-11-1" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb52" data-startfrom="1242" data-source-offset="-267"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1241;"><span id="cb52-1242"><a href="#cb52-1242" aria-hidden="true" tabindex="-1"></a>htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;button onclick=</span><span class="sc">${</span>() <span class="kw">=&gt;</span> (mutable scene_data0 <span class="op">=</span> scene_data)<span class="sc">}</span><span class="vs">&gt;insert data -&gt; vega editor (dev)&lt;/button&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-11-2" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb53" data-startfrom="1243" data-source-offset="-379"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1242;"><span id="cb53-1243"><a href="#cb53-1243" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="dv">10</span><span class="op">,</span><span class="dv">100</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span><span class="dv">1</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span> <span class="st">'step'</span>})<span class="op">,</span> viewof step_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-11-3" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb54" data-startfrom="1245" data-source-offset="-458"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1244;"><span id="cb54-1245"><a href="#cb54-1245" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb54-1246"><a href="#cb54-1246" aria-hidden="true" tabindex="-1"></a>  scene<span class="op">;</span></span>
<span id="cb54-1247"><a href="#cb54-1247" aria-hidden="true" tabindex="-1"></a>  <span class="bu">window</span><span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">Event</span>(<span class="st">'resize'</span>))</span>
<span id="cb54-1248"><a href="#cb54-1248" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-11-4" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb55" data-startfrom="1255" data-source-offset="-627"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1254;"><span id="cb55-1255"><a href="#cb55-1255" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb55-1256"><a href="#cb55-1256" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;style&gt;</span></span>
<span id="cb55-1257"><a href="#cb55-1257" aria-hidden="true" tabindex="-1"></a><span class="vs">  #raycasting2 .fit-y svg {</span></span>
<span id="cb55-1258"><a href="#cb55-1258" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: linear-gradient(to bottom, lightblue, pink, white);</span></span>
<span id="cb55-1259"><a href="#cb55-1259" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb55-1260"><a href="#cb55-1260" aria-hidden="true" tabindex="-1"></a><span class="vs">  #reflection svg {</span></span>
<span id="cb55-1261"><a href="#cb55-1261" aria-hidden="true" tabindex="-1"></a><span class="vs">    margin-top: -10px;</span></span>
<span id="cb55-1262"><a href="#cb55-1262" aria-hidden="true" tabindex="-1"></a><span class="vs">  background: linear-gradient(to bottom, orange, pink, white);</span></span>
<span id="cb55-1263"><a href="#cb55-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1264"><a href="#cb55-1264" aria-hidden="true" tabindex="-1"></a><span class="vs">    /*filter: blur(10px);</span></span>
<span id="cb55-1265"><a href="#cb55-1265" aria-hidden="true" tabindex="-1"></a><span class="vs">      background: white; linear-gradient(to bottom, lightblue, green, white);*/</span></span>
<span id="cb55-1266"><a href="#cb55-1266" aria-hidden="true" tabindex="-1"></a><span class="vs">      transform: scaleY(-0.7); /*translateY(65px);*/</span></span>
<span id="cb55-1267"><a href="#cb55-1267" aria-hidden="true" tabindex="-1"></a><span class="vs">      mask: linear-gradient(to bottom, transparent, black 98%);</span></span>
<span id="cb55-1268"><a href="#cb55-1268" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb55-1269"><a href="#cb55-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-1270"><a href="#cb55-1270" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/style&gt;</span></span>
<span id="cb55-1271"><a href="#cb55-1271" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-11-5" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb56" data-startfrom="1275" data-source-offset="-1114"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1274;"><span id="cb56-1275"><a href="#cb56-1275" aria-hidden="true" tabindex="-1"></a>scene_spec <span class="op">=</span> { <span class="cf">return</span> ({</span>
<span id="cb56-1276"><a href="#cb56-1276" aria-hidden="true" tabindex="-1"></a>  <span class="dt">config</span><span class="op">:</span> {<span class="dt">autosize</span><span class="op">:</span> <span class="st">'fit'</span>}<span class="op">,</span></span>
<span id="cb56-1277"><a href="#cb56-1277" aria-hidden="true" tabindex="-1"></a>    <span class="st">"data"</span><span class="op">:</span> {<span class="st">"name"</span><span class="op">:</span> <span class="st">"source"</span>}<span class="op">,</span></span>
<span id="cb56-1278"><a href="#cb56-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1279"><a href="#cb56-1279" aria-hidden="true" tabindex="-1"></a>  <span class="dt">datasets</span><span class="op">:</span> {<span class="st">'source'</span><span class="op">:</span> scene_data0 }<span class="op">,</span></span>
<span id="cb56-1280"><a href="#cb56-1280" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="st">"container"</span><span class="op">,</span></span>
<span id="cb56-1281"><a href="#cb56-1281" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">550</span><span class="op">*</span>scene_size<span class="op">,</span></span>
<span id="cb56-1282"><a href="#cb56-1282" aria-hidden="true" tabindex="-1"></a>  <span class="co">//height: 400,</span></span>
<span id="cb56-1283"><a href="#cb56-1283" aria-hidden="true" tabindex="-1"></a>  <span class="co">//height: "container",</span></span>
<span id="cb56-1284"><a href="#cb56-1284" aria-hidden="true" tabindex="-1"></a>  <span class="co">//background: "linear-gradient(blue, pink)",</span></span>
<span id="cb56-1285"><a href="#cb56-1285" aria-hidden="true" tabindex="-1"></a>  <span class="dt">mark</span><span class="op">:</span> { <span class="dt">type</span><span class="op">:</span> <span class="st">"bar"</span><span class="op">,</span> <span class="dt">clip</span><span class="op">:</span> <span class="kw">true</span> }<span class="op">,</span></span>
<span id="cb56-1286"><a href="#cb56-1286" aria-hidden="true" tabindex="-1"></a>  <span class="co">//transform: [{calculate: "2*datum.r_hit_v+(0)", as: "r_hit_v__r_hit_h_or_v"}],</span></span>
<span id="cb56-1287"><a href="#cb56-1287" aria-hidden="true" tabindex="-1"></a>  <span class="dt">encoding</span><span class="op">:</span> {</span>
<span id="cb56-1288"><a href="#cb56-1288" aria-hidden="true" tabindex="-1"></a>    <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb56-1289"><a href="#cb56-1289" aria-hidden="true" tabindex="-1"></a>      <span class="dt">field</span><span class="op">:</span> <span class="st">"ray_angle_in"</span><span class="op">,</span></span>
<span id="cb56-1290"><a href="#cb56-1290" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"ordinal"</span><span class="op">,</span></span>
<span id="cb56-1291"><a href="#cb56-1291" aria-hidden="true" tabindex="-1"></a>      <span class="dt">axis</span><span class="op">:</span> guides <span class="op">?</span> { <span class="dt">format</span><span class="op">:</span> <span class="st">",.2f"</span><span class="op">,</span> <span class="dt">grid</span><span class="op">:</span> <span class="kw">false</span> } <span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb56-1292"><a href="#cb56-1292" aria-hidden="true" tabindex="-1"></a>      <span class="dt">sort</span><span class="op">:</span> <span class="st">"descending"</span></span>
<span id="cb56-1293"><a href="#cb56-1293" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb56-1294"><a href="#cb56-1294" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb56-1295"><a href="#cb56-1295" aria-hidden="true" tabindex="-1"></a>      <span class="dt">field</span><span class="op">:</span> <span class="st">"ray_inverse_distance"</span><span class="op">,</span></span>
<span id="cb56-1296"><a href="#cb56-1296" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"quantitative"</span><span class="op">,</span></span>
<span id="cb56-1297"><a href="#cb56-1297" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> { <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>] }<span class="op">,</span></span>
<span id="cb56-1298"><a href="#cb56-1298" aria-hidden="true" tabindex="-1"></a>      <span class="dt">axis</span><span class="op">:</span> guides <span class="op">?</span> { <span class="dt">grid</span><span class="op">:</span> <span class="kw">false</span> } <span class="op">:</span> <span class="kw">null</span></span>
<span id="cb56-1299"><a href="#cb56-1299" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb56-1300"><a href="#cb56-1300" aria-hidden="true" tabindex="-1"></a>    <span class="dt">stroke</span><span class="op">:</span> {<span class="dt">value</span><span class="op">:</span> <span class="st">'black'</span>}<span class="op">,</span></span>
<span id="cb56-1301"><a href="#cb56-1301" aria-hidden="true" tabindex="-1"></a>    <span class="dt">strokeOpacity</span><span class="op">:</span> {      <span class="dt">condition</span><span class="op">:</span> { <span class="dt">param</span><span class="op">:</span> <span class="st">"ray_angle_in"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="dv">1</span> }<span class="op">,</span></span>
<span id="cb56-1302"><a href="#cb56-1302" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span></span>
<span id="cb56-1303"><a href="#cb56-1303" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span></span>
<span id="cb56-1304"><a href="#cb56-1304" aria-hidden="true" tabindex="-1"></a>    <span class="co">/*strokeWidth: {</span></span>
<span id="cb56-1305"><a href="#cb56-1305" aria-hidden="true" tabindex="-1"></a><span class="co">      condition: { param: "ray_angle_in", value: 2 },</span></span>
<span id="cb56-1306"><a href="#cb56-1306" aria-hidden="true" tabindex="-1"></a><span class="co">      value: 1,</span></span>
<span id="cb56-1307"><a href="#cb56-1307" aria-hidden="true" tabindex="-1"></a><span class="co">    },*/</span></span>
<span id="cb56-1308"><a href="#cb56-1308" aria-hidden="true" tabindex="-1"></a>    <span class="dt">color</span><span class="op">:</span> {</span>
<span id="cb56-1309"><a href="#cb56-1309" aria-hidden="true" tabindex="-1"></a>      <span class="dt">condition</span><span class="op">:</span> { <span class="dt">param</span><span class="op">:</span> <span class="st">"ray_angle_in"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"red"</span> }<span class="op">,</span></span>
<span id="cb56-1310"><a href="#cb56-1310" aria-hidden="true" tabindex="-1"></a>      <span class="co">//"datum": {</span></span>
<span id="cb56-1311"><a href="#cb56-1311" aria-hidden="true" tabindex="-1"></a>        <span class="co">//"value": "1",</span></span>
<span id="cb56-1312"><a href="#cb56-1312" aria-hidden="true" tabindex="-1"></a>      <span class="co">//},</span></span>
<span id="cb56-1313"><a href="#cb56-1313" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> {<span class="dt">domain</span><span class="op">:</span> [<span class="dv">2</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="dv">4</span><span class="op">,</span><span class="dv">5</span><span class="op">,</span><span class="dv">6</span><span class="op">,</span><span class="dv">7</span>]<span class="op">,</span><span class="dt">range</span><span class="op">:</span> [<span class="st">"hsl(250, 76%, 60%)"</span><span class="op">,</span><span class="st">"hsl(250, 76%, 72%)"</span><span class="op">,</span><span class="st">"hsl(200, 76%, 60%)"</span><span class="op">,</span><span class="st">"hsl(200, 76%, 72%)"</span><span class="op">,</span><span class="st">"hsl(100, 76%, 60%)"</span><span class="op">,</span><span class="st">"hsl(100, 76%, 72%)"</span>]}<span class="op">,</span></span>
<span id="cb56-1314"><a href="#cb56-1314" aria-hidden="true" tabindex="-1"></a>      <span class="dt">field</span><span class="op">:</span> <span class="st">"r_hit_v__r_hit_h_or_v"</span><span class="op">,</span></span>
<span id="cb56-1315"><a href="#cb56-1315" aria-hidden="true" tabindex="-1"></a>      <span class="co">//type: "nominal",</span></span>
<span id="cb56-1316"><a href="#cb56-1316" aria-hidden="true" tabindex="-1"></a>      <span class="dt">legend</span><span class="op">:</span> guides</span>
<span id="cb56-1317"><a href="#cb56-1317" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb56-1318"><a href="#cb56-1318" aria-hidden="true" tabindex="-1"></a>    <span class="dt">opacity</span><span class="op">:</span> {</span>
<span id="cb56-1319"><a href="#cb56-1319" aria-hidden="true" tabindex="-1"></a>      <span class="dt">field</span><span class="op">:</span> <span class="st">'ray_distance'</span><span class="op">,</span></span>
<span id="cb56-1320"><a href="#cb56-1320" aria-hidden="true" tabindex="-1"></a>      <span class="dt">legend</span><span class="op">:</span> guides<span class="op">,</span></span>
<span id="cb56-1321"><a href="#cb56-1321" aria-hidden="true" tabindex="-1"></a>      <span class="dt">scale</span><span class="op">:</span> {<span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span><span class="dv">15</span>]<span class="op">,</span> <span class="dt">range</span><span class="op">:</span> [<span class="dv">1</span><span class="op">,.</span><span class="dv">1</span>]}<span class="op">,</span></span>
<span id="cb56-1322"><a href="#cb56-1322" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">'quantitative'</span></span>
<span id="cb56-1323"><a href="#cb56-1323" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb56-1324"><a href="#cb56-1324" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb56-1325"><a href="#cb56-1325" aria-hidden="true" tabindex="-1"></a>  <span class="dt">params</span><span class="op">:</span> [</span>
<span id="cb56-1326"><a href="#cb56-1326" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb56-1327"><a href="#cb56-1327" aria-hidden="true" tabindex="-1"></a>      <span class="dt">name</span><span class="op">:</span> <span class="st">"player_angle_in"</span><span class="op">,</span></span>
<span id="cb56-1328"><a href="#cb56-1328" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> { <span class="dt">player_angle_in</span><span class="op">:</span> <span class="dv">0</span> }<span class="op">,</span></span>
<span id="cb56-1329"><a href="#cb56-1329" aria-hidden="true" tabindex="-1"></a>      <span class="dt">select</span><span class="op">:</span> {</span>
<span id="cb56-1330"><a href="#cb56-1330" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"point"</span><span class="op">,</span></span>
<span id="cb56-1331"><a href="#cb56-1331" aria-hidden="true" tabindex="-1"></a>        <span class="co">//on: "mousemove{0,50}",</span></span>
<span id="cb56-1332"><a href="#cb56-1332" aria-hidden="true" tabindex="-1"></a>        <span class="dt">on</span><span class="op">:</span> <span class="st">"[touchdown, touchup] &gt; touchmove, [mousedown, mouseup] &gt; mousemove"</span><span class="op">,</span> <span class="co">//{10, 100}",</span></span>
<span id="cb56-1333"><a href="#cb56-1333" aria-hidden="true" tabindex="-1"></a>        <span class="co">//        on: "[mousedown, mouseup] &gt; mousemove",</span></span>
<span id="cb56-1334"><a href="#cb56-1334" aria-hidden="true" tabindex="-1"></a>        <span class="dt">nearest</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb56-1335"><a href="#cb56-1335" aria-hidden="true" tabindex="-1"></a>        <span class="dt">toggle</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb56-1336"><a href="#cb56-1336" aria-hidden="true" tabindex="-1"></a>        <span class="dt">clear</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb56-1337"><a href="#cb56-1337" aria-hidden="true" tabindex="-1"></a>        <span class="dt">encodings</span><span class="op">:</span> [<span class="st">"x"</span>]</span>
<span id="cb56-1338"><a href="#cb56-1338" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb56-1339"><a href="#cb56-1339" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb56-1340"><a href="#cb56-1340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1341"><a href="#cb56-1341" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb56-1342"><a href="#cb56-1342" aria-hidden="true" tabindex="-1"></a>      <span class="dt">name</span><span class="op">:</span> <span class="st">"ray_angle_in"</span><span class="op">,</span></span>
<span id="cb56-1343"><a href="#cb56-1343" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> { <span class="dt">ray_angle_in</span><span class="op">:</span> <span class="dv">0</span> }<span class="op">,</span></span>
<span id="cb56-1344"><a href="#cb56-1344" aria-hidden="true" tabindex="-1"></a>      <span class="dt">select</span><span class="op">:</span> {</span>
<span id="cb56-1345"><a href="#cb56-1345" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"point"</span><span class="op">,</span></span>
<span id="cb56-1346"><a href="#cb56-1346" aria-hidden="true" tabindex="-1"></a>        <span class="co">//on: "mousemove{0,50}",</span></span>
<span id="cb56-1347"><a href="#cb56-1347" aria-hidden="true" tabindex="-1"></a>        <span class="dt">on</span><span class="op">:</span> <span class="st">"mousemove"</span><span class="op">,</span> <span class="co">//{10, 100}",</span></span>
<span id="cb56-1348"><a href="#cb56-1348" aria-hidden="true" tabindex="-1"></a>        <span class="co">//        on: "[mousedown, mouseup] &gt; mousemove",</span></span>
<span id="cb56-1349"><a href="#cb56-1349" aria-hidden="true" tabindex="-1"></a>        <span class="dt">nearest</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb56-1350"><a href="#cb56-1350" aria-hidden="true" tabindex="-1"></a>        <span class="dt">toggle</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb56-1351"><a href="#cb56-1351" aria-hidden="true" tabindex="-1"></a>        <span class="dt">clear</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb56-1352"><a href="#cb56-1352" aria-hidden="true" tabindex="-1"></a>        <span class="dt">encodings</span><span class="op">:</span> [<span class="st">"x"</span>]</span>
<span id="cb56-1353"><a href="#cb56-1353" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb56-1354"><a href="#cb56-1354" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb56-1355"><a href="#cb56-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1356"><a href="#cb56-1356" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb56-1357"><a href="#cb56-1357" aria-hidden="true" tabindex="-1"></a>      <span class="dt">name</span><span class="op">:</span> <span class="st">"formula"</span><span class="op">,</span></span>
<span id="cb56-1358"><a href="#cb56-1358" aria-hidden="true" tabindex="-1"></a>      <span class="co">//value: { ray_angle_in: 0 },</span></span>
<span id="cb56-1359"><a href="#cb56-1359" aria-hidden="true" tabindex="-1"></a>      <span class="dt">select</span><span class="op">:</span> {</span>
<span id="cb56-1360"><a href="#cb56-1360" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"point"</span><span class="op">,</span></span>
<span id="cb56-1361"><a href="#cb56-1361" aria-hidden="true" tabindex="-1"></a>        <span class="co">//on: "mousemove{0,50}",</span></span>
<span id="cb56-1362"><a href="#cb56-1362" aria-hidden="true" tabindex="-1"></a>        <span class="dt">on</span><span class="op">:</span> <span class="st">"mousedown"</span><span class="op">,</span> <span class="co">//{10, 100}",</span></span>
<span id="cb56-1363"><a href="#cb56-1363" aria-hidden="true" tabindex="-1"></a>        <span class="co">//        on: "[mousedown, mouseup] &gt; mousemove",</span></span>
<span id="cb56-1364"><a href="#cb56-1364" aria-hidden="true" tabindex="-1"></a>        <span class="dt">nearest</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb56-1365"><a href="#cb56-1365" aria-hidden="true" tabindex="-1"></a>        <span class="dt">toggle</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb56-1366"><a href="#cb56-1366" aria-hidden="true" tabindex="-1"></a>        <span class="dt">clear</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb56-1367"><a href="#cb56-1367" aria-hidden="true" tabindex="-1"></a>        <span class="dt">encodings</span><span class="op">:</span> [<span class="st">"y"</span>]</span>
<span id="cb56-1368"><a href="#cb56-1368" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb56-1369"><a href="#cb56-1369" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb56-1370"><a href="#cb56-1370" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb56-1371"><a href="#cb56-1371" aria-hidden="true" tabindex="-1"></a>}) }</span>
<span id="cb56-1372"><a href="#cb56-1372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1373"><a href="#cb56-1373" aria-hidden="true" tabindex="-1"></a>player_angle_in <span class="op">=</span> raycasting2<span class="op">.</span><span class="fu">player_angle</span>({keys_stream_function_in<span class="op">,</span></span>
<span id="cb56-1374"><a href="#cb56-1374" aria-hidden="true" tabindex="-1"></a>keys_stream_version_in<span class="op">,</span> f_in})</span>
<span id="cb56-1375"><a href="#cb56-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1376"><a href="#cb56-1376" aria-hidden="true" tabindex="-1"></a><span class="co">// add additional for signalled ray angle exactly??</span></span>
<span id="cb56-1377"><a href="#cb56-1377" aria-hidden="true" tabindex="-1"></a>scene_data <span class="op">=</span> <span class="fu">calcuvegadata</span>({</span>
<span id="cb56-1378"><a href="#cb56-1378" aria-hidden="true" tabindex="-1"></a>  <span class="dt">$schema</span><span class="op">:</span> <span class="st">"https://vega.github.io/schema/vega-lite/v5.json"</span><span class="op">,</span></span>
<span id="cb56-1379"><a href="#cb56-1379" aria-hidden="true" tabindex="-1"></a>  <span class="dt">models</span><span class="op">:</span> [raycasting222]<span class="op">,</span></span>
<span id="cb56-1380"><a href="#cb56-1380" aria-hidden="true" tabindex="-1"></a>  <span class="dt">spec</span><span class="op">:</span> ({<span class="op">...</span>scene_spec<span class="op">,</span> <span class="dt">a</span><span class="op">:</span> {<span class="dt">field</span><span class="op">:</span> <span class="st">'r_hit_v'</span><span class="op">,</span> <span class="dt">b</span><span class="op">:</span> {<span class="dt">field</span><span class="op">:</span><span class="st">'r_hit_h_or_v'</span>}}})<span class="op">,</span></span>
<span id="cb56-1381"><a href="#cb56-1381" aria-hidden="true" tabindex="-1"></a>  <span class="dt">domains</span><span class="op">:</span> {</span>
<span id="cb56-1382"><a href="#cb56-1382" aria-hidden="true" tabindex="-1"></a>    <span class="co">//step_in: _.range(0, 8.1, 1),</span></span>
<span id="cb56-1383"><a href="#cb56-1383" aria-hidden="true" tabindex="-1"></a>    <span class="dt">ray_angle_in</span><span class="op">:</span> _<span class="op">.</span><span class="fu">range</span>(<span class="op">-</span><span class="dv">1</span> <span class="op">/</span> <span class="dv">2</span><span class="op">,</span> <span class="fl">1.01</span> <span class="op">/</span> <span class="dv">2</span><span class="op">,</span> ray_angle_step_size)<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> d <span class="op">+</span> player_angle_in) <span class="co">//[ray_angle_in, ray_angle_in + 0.4, ray_angle_in - 0.4]</span></span>
<span id="cb56-1384"><a href="#cb56-1384" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb56-1385"><a href="#cb56-1385" aria-hidden="true" tabindex="-1"></a>  <span class="dt">input_cursors</span><span class="op">:</span> [</span>
<span id="cb56-1386"><a href="#cb56-1386" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb56-1387"><a href="#cb56-1387" aria-hidden="true" tabindex="-1"></a>      fisheye_correction_in<span class="op">,</span></span>
<span id="cb56-1388"><a href="#cb56-1388" aria-hidden="true" tabindex="-1"></a>keys_stream_function_in<span class="op">,</span></span>
<span id="cb56-1389"><a href="#cb56-1389" aria-hidden="true" tabindex="-1"></a>keys_stream_version_in<span class="op">,</span> f_in<span class="op">,</span></span>
<span id="cb56-1390"><a href="#cb56-1390" aria-hidden="true" tabindex="-1"></a><span class="co">//player_angle_in /* needed for fisheye */</span></span>
<span id="cb56-1391"><a href="#cb56-1391" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb56-1392"><a href="#cb56-1392" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb56-1393"><a href="#cb56-1393" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({<span class="op">...</span>d<span class="op">,</span> <span class="dt">r_hit_v__r_hit_h_or_v</span><span class="op">:</span> <span class="dv">2</span><span class="op">*</span>d<span class="op">.</span><span class="at">r_hit_v</span><span class="op">+</span>(d<span class="op">.</span><span class="at">r_hit_h_or_v</span> <span class="op">==</span> <span class="st">'h'</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">0</span>)}))</span>
<span id="cb56-1394"><a href="#cb56-1394" aria-hidden="true" tabindex="-1"></a><span class="co">//| output: false</span></span>
<span id="cb56-1395"><a href="#cb56-1395" aria-hidden="true" tabindex="-1"></a><span class="co">//| </span></span>
<span id="cb56-1396"><a href="#cb56-1396" aria-hidden="true" tabindex="-1"></a>scene_updates <span class="op">=</span> {</span>
<span id="cb56-1397"><a href="#cb56-1397" aria-hidden="true" tabindex="-1"></a>  <span class="co">//scene.signal("ray_angle_in", ray_angle_in); causes infinite re-runs</span></span>
<span id="cb56-1398"><a href="#cb56-1398" aria-hidden="true" tabindex="-1"></a>  scene<span class="op">.</span><span class="fu">data</span>(<span class="st">"source"</span><span class="op">,</span> scene_data)<span class="op">.</span><span class="fu">resize</span>()<span class="op">.</span><span class="fu">run</span>()<span class="op">;</span></span>
<span id="cb56-1399"><a href="#cb56-1399" aria-hidden="true" tabindex="-1"></a>  <span class="co">//scene2.data("source", scene_data).resize().run();</span></span>
<span id="cb56-1400"><a href="#cb56-1400" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-1401"><a href="#cb56-1401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-1402"><a href="#cb56-1402" aria-hidden="true" tabindex="-1"></a>scene<span class="op">.</span><span class="fu">addSignalListener</span>(<span class="st">"ray_angle_in"</span><span class="op">,</span> (a<span class="op">,</span> b) <span class="kw">=&gt;</span> {</span>
<span id="cb56-1403"><a href="#cb56-1403" aria-hidden="true" tabindex="-1"></a>  mutable show_ray <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb56-1404"><a href="#cb56-1404" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span>(viewof ray_angle_in<span class="op">,</span> b<span class="op">.</span><span class="at">ray_angle_in</span>[<span class="dv">0</span>])</span>
<span id="cb56-1405"><a href="#cb56-1405" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-11-6" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-11-7" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-11-8" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-11-9" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-11-10" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb57" data-startfrom="1407" data-source-offset="-4860"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1406;"><span id="cb57-1407"><a href="#cb57-1407" aria-hidden="true" tabindex="-1"></a>ray_angle_in</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-11-11" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb58" data-startfrom="1409" data-source-offset="-4874"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1408;"><span id="cb58-1409"><a href="#cb58-1409" aria-hidden="true" tabindex="-1"></a>scene_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-11-12" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb59" data-startfrom="1411" data-source-offset="-4886"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1410;"><span id="cb59-1411"><a href="#cb59-1411" aria-hidden="true" tabindex="-1"></a>mjs_q_eval</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-11-13" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb60" data-startfrom="1413" data-source-offset="-4898"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1412;"><span id="cb60-1413"><a href="#cb60-1413" aria-hidden="true" tabindex="-1"></a>fns_with_mjs_q_eval</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-11-14" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb61" data-startfrom="1415" data-source-offset="-4919"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1414;"><span id="cb61-1415"><a href="#cb61-1415" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="dv">100</span><span class="op">,</span><span class="dv">100</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span> <span class="fl">0.1</span>})<span class="op">,</span> viewof ray_angle_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-11-15" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb62" data-startfrom="1417" data-source-offset="-5068"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1416;"><span id="cb62-1417"><a href="#cb62-1417" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="dv">10</span><span class="op">,</span><span class="dv">10</span>]<span class="op">,</span> {<span class="dt">step</span><span class="op">:</span><span class="dv">1</span>})<span class="op">,</span> viewof year_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-11-16" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb63" data-startfrom="1419" data-source-offset="-5131"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1418;"><span id="cb63-1419"><a href="#cb63-1419" aria-hidden="true" tabindex="-1"></a>viewof opacity_vertical <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span> {</span>
<span id="cb63-1420"><a href="#cb63-1420" aria-hidden="true" tabindex="-1"></a>  <span class="dt">step</span><span class="op">:</span> <span class="fl">0.1</span><span class="op">,</span></span>
<span id="cb63-1421"><a href="#cb63-1421" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="fl">0.5</span><span class="op">,</span></span>
<span id="cb63-1422"><a href="#cb63-1422" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"vert"</span></span>
<span id="cb63-1423"><a href="#cb63-1423" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-11-17" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<div class="cell hidden html-fill-item html-fill-container">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb64" data-startfrom="1434" data-source-offset="-56"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1433;"><span id="cb64-1434"><a href="#cb64-1434" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb64-1435"><a href="#cb64-1435" aria-hidden="true" tabindex="-1"></a>  formulae_visible<span class="op">.</span><span class="fu">forEach</span>(f <span class="kw">=&gt;</span> {</span>
<span id="cb64-1436"><a href="#cb64-1436" aria-hidden="true" tabindex="-1"></a>    <span class="co">//if (Object.values(introspection_nomemo.cul_functions).find(d =&gt; d.name == f &amp;&amp; d.inputs.includes('step_in')))</span></span>
<span id="cb64-1437"><a href="#cb64-1437" aria-hidden="true" tabindex="-1"></a>      <span class="co">//set(viewof show_ray_steps, true)</span></span>
<span id="cb64-1438"><a href="#cb64-1438" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb64-1439"><a href="#cb64-1439" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-12-1" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb65" data-startfrom="1445" data-source-offset="-317"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1444;"><span id="cb65-1445"><a href="#cb65-1445" aria-hidden="true" tabindex="-1"></a>show_ray_steps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-12-2" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb66" data-startfrom="1448" data-source-offset="-356"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1447;"><span id="cb66-1448"><a href="#cb66-1448" aria-hidden="true" tabindex="-1"></a>mutable show_ray <span class="op">=</span> <span class="kw">false</span></span>
<span id="cb66-1449"><a href="#cb66-1449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-1450"><a href="#cb66-1450" aria-hidden="true" tabindex="-1"></a>show_ray</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-12-3" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-12-4" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb67" data-startfrom="1452" data-source-offset="-392"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1451;"><span id="cb67-1452"><a href="#cb67-1452" aria-hidden="true" tabindex="-1"></a>level<span class="op">.</span><span class="fu">addSignalListener</span>(<span class="st">'step_in'</span><span class="op">,</span> (_<span class="op">,</span>b) <span class="kw">=&gt;</span> {</span>
<span id="cb67-1453"><a href="#cb67-1453" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span>(viewof step_in<span class="op">,</span> b[<span class="dv">0</span>])</span>
<span id="cb67-1454"><a href="#cb67-1454" aria-hidden="true" tabindex="-1"></a>  <span class="co">// </span><span class="al">TODO</span><span class="co"> process the formula part [1]</span></span>
<span id="cb67-1455"><a href="#cb67-1455" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(b)<span class="op">;</span></span>
<span id="cb67-1456"><a href="#cb67-1456" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-12-5" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb68" data-startfrom="1459" data-source-offset="-528"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1458;"><span id="cb68-1459"><a href="#cb68-1459" aria-hidden="true" tabindex="-1"></a>level<span class="op">.</span><span class="fu">addSignalListener</span>(<span class="st">"rhv"</span><span class="op">,</span> (a<span class="op">,</span> b) <span class="kw">=&gt;</span> {</span>
<span id="cb68-1460"><a href="#cb68-1460" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span>(viewof formulae_visible<span class="op">,</span> [<span class="st">"rhv"</span>])</span>
<span id="cb68-1461"><a href="#cb68-1461" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span>(viewof step_in<span class="op">,</span> b)</span>
<span id="cb68-1462"><a href="#cb68-1462" aria-hidden="true" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'.calculang_f_'</span><span class="op">+</span><span class="st">"rhv"</span>)<span class="op">.</span><span class="fu">scrollIntoView</span>(scrollIntoViewOpts)</span>
<span id="cb68-1463"><a href="#cb68-1463" aria-hidden="true" tabindex="-1"></a> <span class="co">//}</span></span>
<span id="cb68-1464"><a href="#cb68-1464" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-12-6" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb69" data-startfrom="1466" data-source-offset="-728"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1465;"><span id="cb69-1466"><a href="#cb69-1466" aria-hidden="true" tabindex="-1"></a>level<span class="op">.</span><span class="fu">addSignalListener</span>(<span class="st">"rvv"</span><span class="op">,</span> (a<span class="op">,</span> b) <span class="kw">=&gt;</span> {</span>
<span id="cb69-1467"><a href="#cb69-1467" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span>(viewof formulae_visible<span class="op">,</span> [<span class="st">"rvv"</span>])</span>
<span id="cb69-1468"><a href="#cb69-1468" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span>(viewof step_in<span class="op">,</span> b)</span>
<span id="cb69-1469"><a href="#cb69-1469" aria-hidden="true" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'.calculang_f_'</span><span class="op">+</span><span class="st">"rvv"</span>)<span class="op">.</span><span class="fu">scrollIntoView</span>(scrollIntoViewOpts)</span>
<span id="cb69-1470"><a href="#cb69-1470" aria-hidden="true" tabindex="-1"></a> <span class="co">//}</span></span>
<span id="cb69-1471"><a href="#cb69-1471" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-12-7" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<details>
<summary>
üó∫Ô∏è
</summary>
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb70" data-startfrom="1481" data-source-offset="-2"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1480;"><span id="cb70-1481"><a href="#cb70-1481" aria-hidden="true" tabindex="-1"></a>viewof level <span class="op">=</span> <span class="fu">embed</span>(level_spec<span class="op">,</span> {<span class="dt">renderer</span><span class="op">:</span> <span class="st">'svg'</span><span class="op">,</span> actions})</span>
<span id="cb70-1482"><a href="#cb70-1482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1483"><a href="#cb70-1483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1484"><a href="#cb70-1484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1485"><a href="#cb70-1485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1486"><a href="#cb70-1486" aria-hidden="true" tabindex="-1"></a>ray_steps_dataff <span class="op">=</span>  <span class="fu">calcuvegadata</span>({</span>
<span id="cb70-1487"><a href="#cb70-1487" aria-hidden="true" tabindex="-1"></a>  <span class="dt">models</span><span class="op">:</span> [raycasting2]<span class="op">,</span></span>
<span id="cb70-1488"><a href="#cb70-1488" aria-hidden="true" tabindex="-1"></a>  <span class="dt">spec</span><span class="op">:</span> ray_steps_spec<span class="op">,</span></span>
<span id="cb70-1489"><a href="#cb70-1489" aria-hidden="true" tabindex="-1"></a>  <span class="dt">domains</span><span class="op">:</span> {</span>
<span id="cb70-1490"><a href="#cb70-1490" aria-hidden="true" tabindex="-1"></a>    <span class="dt">step_in</span><span class="op">:</span> _<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span><span class="fl">8.1</span>)</span>
<span id="cb70-1491"><a href="#cb70-1491" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb70-1492"><a href="#cb70-1492" aria-hidden="true" tabindex="-1"></a>  <span class="dt">input_cursors</span><span class="op">:</span> [{fisheye_correction_in<span class="op">,</span></span>
<span id="cb70-1493"><a href="#cb70-1493" aria-hidden="true" tabindex="-1"></a>    keys_stream_function_in<span class="op">,</span></span>
<span id="cb70-1494"><a href="#cb70-1494" aria-hidden="true" tabindex="-1"></a>    keys_stream_version_in<span class="op">,</span></span>
<span id="cb70-1495"><a href="#cb70-1495" aria-hidden="true" tabindex="-1"></a>    f_in<span class="op">,</span></span>
<span id="cb70-1496"><a href="#cb70-1496" aria-hidden="true" tabindex="-1"></a>    ray_angle_in<span class="op">,</span> fisheye_correction_in</span>
<span id="cb70-1497"><a href="#cb70-1497" aria-hidden="true" tabindex="-1"></a>  }]</span>
<span id="cb70-1498"><a href="#cb70-1498" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb70-1499"><a href="#cb70-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1500"><a href="#cb70-1500" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> {<span class="cf">return</span> ({keys_stream_function_in<span class="op">,</span></span>
<span id="cb70-1501"><a href="#cb70-1501" aria-hidden="true" tabindex="-1"></a>    keys_stream_version_in<span class="op">,</span></span>
<span id="cb70-1502"><a href="#cb70-1502" aria-hidden="true" tabindex="-1"></a>    f_in<span class="op">,</span></span>
<span id="cb70-1503"><a href="#cb70-1503" aria-hidden="true" tabindex="-1"></a>    ray_angle_in<span class="op">,</span> fisheye_correction_in <span class="co">/* irrelevant but.. */</span>})}</span>
<span id="cb70-1504"><a href="#cb70-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1505"><a href="#cb70-1505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1506"><a href="#cb70-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1507"><a href="#cb70-1507" aria-hidden="true" tabindex="-1"></a>ray_h_data <span class="op">=</span> _<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span>raycasting2<span class="op">.</span><span class="fu">rh_hit_step</span>({<span class="op">...</span>c})<span class="op">+</span><span class="fl">0.1</span>)<span class="op">.</span><span class="fu">map</span>(step_in <span class="kw">=&gt;</span> ({</span>
<span id="cb70-1508"><a href="#cb70-1508" aria-hidden="true" tabindex="-1"></a>  <span class="dt">rhx</span><span class="op">:</span> raycasting2<span class="op">.</span><span class="fu">rhx</span>({<span class="op">...</span>c<span class="op">,</span> step_in})<span class="op">,</span></span>
<span id="cb70-1509"><a href="#cb70-1509" aria-hidden="true" tabindex="-1"></a>  <span class="dt">rhy</span><span class="op">:</span> raycasting2<span class="op">.</span><span class="fu">rhy</span>({<span class="op">...</span>c<span class="op">,</span> step_in})<span class="op">,</span></span>
<span id="cb70-1510"><a href="#cb70-1510" aria-hidden="true" tabindex="-1"></a>  step_in<span class="op">,</span> fisheye_correction_in</span>
<span id="cb70-1511"><a href="#cb70-1511" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb70-1512"><a href="#cb70-1512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1513"><a href="#cb70-1513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-1514"><a href="#cb70-1514" aria-hidden="true" tabindex="-1"></a>ray_v_data <span class="op">=</span> _<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span>raycasting2<span class="op">.</span><span class="fu">rv_hit_step</span>({<span class="op">...</span>c})<span class="op">+</span><span class="fl">0.1</span>)<span class="op">.</span><span class="fu">map</span>(step_in <span class="kw">=&gt;</span> ({</span>
<span id="cb70-1515"><a href="#cb70-1515" aria-hidden="true" tabindex="-1"></a>  <span class="dt">rvx</span><span class="op">:</span> raycasting2<span class="op">.</span><span class="fu">rvx</span>({<span class="op">...</span>c<span class="op">,</span> step_in})<span class="op">,</span></span>
<span id="cb70-1516"><a href="#cb70-1516" aria-hidden="true" tabindex="-1"></a>  <span class="dt">rvy</span><span class="op">:</span> raycasting2<span class="op">.</span><span class="fu">rvy</span>({<span class="op">...</span>c<span class="op">,</span> step_in})<span class="op">,</span></span>
<span id="cb70-1517"><a href="#cb70-1517" aria-hidden="true" tabindex="-1"></a>  step_in<span class="op">,</span> fisheye_correction_in</span>
<span id="cb70-1518"><a href="#cb70-1518" aria-hidden="true" tabindex="-1"></a>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-13-1" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-13-2" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-13-3" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-13-4" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-13-5" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</details>
<details>
<summary>
ü§´
</summary>
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb71" data-startfrom="1531" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1530;"><span id="cb71-1531"><a href="#cb71-1531" aria-hidden="true" tabindex="-1"></a>mutable aaa <span class="op">=</span> []</span>
<span id="cb71-1532"><a href="#cb71-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-1533"><a href="#cb71-1533" aria-hidden="true" tabindex="-1"></a>viewof refresh <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">button</span>(<span class="st">"hot reload"</span>)</span>
<span id="cb71-1534"><a href="#cb71-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-1535"><a href="#cb71-1535" aria-hidden="true" tabindex="-1"></a>raycasting222 <span class="op">=</span> aaa[version]</span>
<span id="cb71-1536"><a href="#cb71-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-1537"><a href="#cb71-1537" aria-hidden="true" tabindex="-1"></a>raycasting_latest <span class="op">=</span> <span class="cf">await</span> <span class="pp">require</span>(<span class="vs">`http://localhost:8080/raycasting/raycasting.js?</span><span class="sc">${</span>refresh<span class="sc">}${</span><span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>()<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb71-1538"><a href="#cb71-1538" aria-hidden="true" tabindex="-1"></a>raycasting2 <span class="op">=</span> <span class="cf">await</span> <span class="pp">require</span>(<span class="vs">`http://localhost:8080/raycasting/raycasting.js?</span><span class="sc">${</span>refresh<span class="sc">}${</span><span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>()<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb71-1539"><a href="#cb71-1539" aria-hidden="true" tabindex="-1"></a>simple_loan <span class="op">=</span> <span class="cf">await</span> <span class="pp">require</span>(<span class="vs">`https://calculang.dev/models/simple-loan/simple-loan.js`</span>)<span class="op">;</span></span>
<span id="cb71-1540"><a href="#cb71-1540" aria-hidden="true" tabindex="-1"></a><span class="co">//emissions_my_lifetime = //await require(`http://localhost:8080/emissions-my-lifetime/emissions-my-lifetime.js?${refresh}${Date.now()}`);</span></span>
<span id="cb71-1541"><a href="#cb71-1541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-1542"><a href="#cb71-1542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-1543"><a href="#cb71-1543" aria-hidden="true" tabindex="-1"></a><span class="co">//htl.html`&lt;button onclick=${() =&gt; (mutable aaa = [...mutable aaa, raycasting_latest])}&gt;refresh 2&lt;/button&gt;`</span></span>
<span id="cb71-1544"><a href="#cb71-1544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-1545"><a href="#cb71-1545" aria-hidden="true" tabindex="-1"></a>viewof version <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="op">-</span><span class="dv">1</span><span class="op">,</span><span class="dv">10</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">'hot reload version'</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="op">-</span><span class="dv">1</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span><span class="dv">1</span>})</span>
<span id="cb71-1546"><a href="#cb71-1546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-1547"><a href="#cb71-1547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-1548"><a href="#cb71-1548" aria-hidden="true" tabindex="-1"></a><span class="co">//htl.html`&lt;button onclick=${() =&gt; (mutable scene_data0 = scene_data)}&gt;insert data -&gt; vega editor (dev)&lt;/button&gt;`</span></span>
<span id="cb71-1549"><a href="#cb71-1549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-1550"><a href="#cb71-1550" aria-hidden="true" tabindex="-1"></a>viewof guides <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">toggle</span>({ <span class="dt">label</span><span class="op">:</span> <span class="st">"guides"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="kw">false</span> })</span>
<span id="cb71-1551"><a href="#cb71-1551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-1552"><a href="#cb71-1552" aria-hidden="true" tabindex="-1"></a><span class="co">//viewof model_x = Inputs.range([0,10], {step:1, label: 'model version'})</span></span>
<span id="cb71-1553"><a href="#cb71-1553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-1554"><a href="#cb71-1554" aria-hidden="true" tabindex="-1"></a>viewof ray_angle_step_size <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>([<span class="fl">0.02</span><span class="op">,</span><span class="fl">0.01</span><span class="op">,</span><span class="fl">0.005</span>]<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span> <span class="st">'step size (resolution)'</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fl">0.01</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-14-1" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-14-2" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-14-3" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-14-4" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-14-5" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-14-6" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-14-7" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-14-8" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-14-9" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</details>
<div class="cell hidden html-fill-item html-fill-container">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb72" data-startfrom="1562" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1561;"><span id="cb72-1562"><a href="#cb72-1562" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { calcuvegadata } <span class="im">from</span> <span class="st">"baafa4b071a5b66a"</span></span>
<span id="cb72-1563"><a href="#cb72-1563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1564"><a href="#cb72-1564" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> {Scrubber} <span class="im">from</span> <span class="st">"@mbostock/scrubber"</span></span>
<span id="cb72-1565"><a href="#cb72-1565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1566"><a href="#cb72-1566" aria-hidden="true" tabindex="-1"></a>keys_stream_function_in <span class="op">=</span> (a) <span class="kw">=&gt;</span> [</span>
<span id="cb72-1567"><a href="#cb72-1567" aria-hidden="true" tabindex="-1"></a>        <span class="op">...</span>keys_shared]</span>
<span id="cb72-1568"><a href="#cb72-1568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1569"><a href="#cb72-1569" aria-hidden="true" tabindex="-1"></a>level_data <span class="op">=</span> <span class="fu">calcuvegadata</span>({</span>
<span id="cb72-1570"><a href="#cb72-1570" aria-hidden="true" tabindex="-1"></a>  <span class="dt">models</span><span class="op">:</span> [raycasting2]<span class="op">,</span></span>
<span id="cb72-1571"><a href="#cb72-1571" aria-hidden="true" tabindex="-1"></a>  <span class="dt">spec</span><span class="op">:</span> rays<span class="op">,</span></span>
<span id="cb72-1572"><a href="#cb72-1572" aria-hidden="true" tabindex="-1"></a>  <span class="dt">domains</span><span class="op">:</span> {</span>
<span id="cb72-1573"><a href="#cb72-1573" aria-hidden="true" tabindex="-1"></a>    <span class="dt">step_in</span><span class="op">:</span> _<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="fl">8.1</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">,</span></span>
<span id="cb72-1574"><a href="#cb72-1574" aria-hidden="true" tabindex="-1"></a>    <span class="dt">ray_angle_in</span><span class="op">:</span> [ray_angle_in<span class="op">,</span> ]<span class="op">,</span><span class="co">//_.range(-1 / 2, 1.01 / 2, /*0.025*20 ROUNDING CAUSES </span><span class="al">BUG</span><span class="co"> TO NOT SHOW*/).map((d) =&gt; d + ray_angle_in) //[ray_angle_in, ray_angle_in + 0.4, ray_angle_in - 0.4]</span></span>
<span id="cb72-1575"><a href="#cb72-1575" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb72-1576"><a href="#cb72-1576" aria-hidden="true" tabindex="-1"></a>  <span class="dt">input_cursors</span><span class="op">:</span> [{       keys_stream_function_in<span class="op">,</span></span>
<span id="cb72-1577"><a href="#cb72-1577" aria-hidden="true" tabindex="-1"></a>keys_stream_version_in<span class="op">,</span> f_in<span class="op">,</span> fisheye_correction_in</span>
<span id="cb72-1578"><a href="#cb72-1578" aria-hidden="true" tabindex="-1"></a><span class="co">//player_angle0_in//: ray_angle_in</span></span>
<span id="cb72-1579"><a href="#cb72-1579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1580"><a href="#cb72-1580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1581"><a href="#cb72-1581" aria-hidden="true" tabindex="-1"></a>}]</span>
<span id="cb72-1582"><a href="#cb72-1582" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb72-1583"><a href="#cb72-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1584"><a href="#cb72-1584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1585"><a href="#cb72-1585" aria-hidden="true" tabindex="-1"></a>fov_cursor <span class="op">=</span> { <span class="cf">return</span> ({    keys_stream_function_in<span class="op">,</span></span>
<span id="cb72-1586"><a href="#cb72-1586" aria-hidden="true" tabindex="-1"></a>    keys_stream_version_in<span class="op">,</span></span>
<span id="cb72-1587"><a href="#cb72-1587" aria-hidden="true" tabindex="-1"></a>    f_in<span class="op">,</span></span>
<span id="cb72-1588"><a href="#cb72-1588" aria-hidden="true" tabindex="-1"></a>})}</span>
<span id="cb72-1589"><a href="#cb72-1589" aria-hidden="true" tabindex="-1"></a>fov_data <span class="op">=</span> [{<span class="dt">id</span><span class="op">:</span><span class="dv">0</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_x</span>(fov_cursor)<span class="op">,</span> <span class="dt">y</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">player_y</span>(fov_cursor)}<span class="op">,</span>{<span class="dt">id</span><span class="op">:</span><span class="dv">1</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rvx</span>({<span class="op">...</span>fov_cursor<span class="op">,</span> <span class="dt">step_in</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">ray_angle_in</span><span class="op">:</span> player_angle_in<span class="op">-.</span><span class="dv">5</span>})<span class="op">,</span> <span class="dt">y</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rvy</span>({<span class="op">...</span>fov_cursor<span class="op">,</span> <span class="dt">step_in</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">ray_angle_in</span><span class="op">:</span> player_angle_in<span class="op">-.</span><span class="dv">5</span>})}<span class="op">,</span>{<span class="dt">id</span><span class="op">:</span><span class="dv">1</span><span class="op">,</span> <span class="dt">x</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rvx</span>({<span class="op">...</span>fov_cursor<span class="op">,</span> <span class="dt">step_in</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">ray_angle_in</span><span class="op">:</span> player_angle_in<span class="op">+.</span><span class="dv">5</span>})<span class="op">,</span> <span class="dt">y</span><span class="op">:</span>raycasting2<span class="op">.</span><span class="fu">rvy</span>({<span class="op">...</span>fov_cursor<span class="op">,</span> <span class="dt">step_in</span><span class="op">:</span> <span class="dv">10</span><span class="op">,</span> <span class="dt">ray_angle_in</span><span class="op">:</span> player_angle_in<span class="op">+.</span><span class="dv">5</span>})}]</span>
<span id="cb72-1590"><a href="#cb72-1590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1591"><a href="#cb72-1591" aria-hidden="true" tabindex="-1"></a>player_data <span class="op">=</span>  <span class="fu">calcuvegadata</span>({</span>
<span id="cb72-1592"><a href="#cb72-1592" aria-hidden="true" tabindex="-1"></a>  <span class="dt">models</span><span class="op">:</span> [raycasting2]<span class="op">,</span></span>
<span id="cb72-1593"><a href="#cb72-1593" aria-hidden="true" tabindex="-1"></a>  <span class="dt">spec</span><span class="op">:</span> player_spec<span class="op">,</span></span>
<span id="cb72-1594"><a href="#cb72-1594" aria-hidden="true" tabindex="-1"></a>  <span class="dt">domains</span><span class="op">:</span> {</span>
<span id="cb72-1595"><a href="#cb72-1595" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb72-1596"><a href="#cb72-1596" aria-hidden="true" tabindex="-1"></a>  <span class="dt">input_cursors</span><span class="op">:</span> [{</span>
<span id="cb72-1597"><a href="#cb72-1597" aria-hidden="true" tabindex="-1"></a>    keys_stream_function_in<span class="op">,</span></span>
<span id="cb72-1598"><a href="#cb72-1598" aria-hidden="true" tabindex="-1"></a>    keys_stream_version_in<span class="op">,</span></span>
<span id="cb72-1599"><a href="#cb72-1599" aria-hidden="true" tabindex="-1"></a>    f_in<span class="op">,</span> fisheye_correction_in</span>
<span id="cb72-1600"><a href="#cb72-1600" aria-hidden="true" tabindex="-1"></a>  }]</span>
<span id="cb72-1601"><a href="#cb72-1601" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb72-1602"><a href="#cb72-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1603"><a href="#cb72-1603" aria-hidden="true" tabindex="-1"></a>ray_steps_data <span class="op">=</span>  <span class="fu">calcuvegadata</span>({</span>
<span id="cb72-1604"><a href="#cb72-1604" aria-hidden="true" tabindex="-1"></a>  <span class="dt">models</span><span class="op">:</span> [raycasting2]<span class="op">,</span></span>
<span id="cb72-1605"><a href="#cb72-1605" aria-hidden="true" tabindex="-1"></a>  <span class="dt">spec</span><span class="op">:</span> ray_steps_spec<span class="op">,</span></span>
<span id="cb72-1606"><a href="#cb72-1606" aria-hidden="true" tabindex="-1"></a>  <span class="dt">domains</span><span class="op">:</span> {</span>
<span id="cb72-1607"><a href="#cb72-1607" aria-hidden="true" tabindex="-1"></a>    <span class="dt">step_in</span><span class="op">:</span> _<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span><span class="fl">8.1</span>)</span>
<span id="cb72-1608"><a href="#cb72-1608" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb72-1609"><a href="#cb72-1609" aria-hidden="true" tabindex="-1"></a>  <span class="dt">input_cursors</span><span class="op">:</span> [{</span>
<span id="cb72-1610"><a href="#cb72-1610" aria-hidden="true" tabindex="-1"></a>    keys_stream_function_in<span class="op">,</span></span>
<span id="cb72-1611"><a href="#cb72-1611" aria-hidden="true" tabindex="-1"></a>    keys_stream_version_in<span class="op">,</span></span>
<span id="cb72-1612"><a href="#cb72-1612" aria-hidden="true" tabindex="-1"></a>    f_in<span class="op">,</span></span>
<span id="cb72-1613"><a href="#cb72-1613" aria-hidden="true" tabindex="-1"></a>    ray_angle_in<span class="op">,</span> fisheye_correction_in</span>
<span id="cb72-1614"><a href="#cb72-1614" aria-hidden="true" tabindex="-1"></a>  }]</span>
<span id="cb72-1615"><a href="#cb72-1615" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb72-1616"><a href="#cb72-1616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-1617"><a href="#cb72-1617" aria-hidden="true" tabindex="-1"></a>c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-1" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-2" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-3" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-4" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-5" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-6" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-7" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-8" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-9" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb73" data-startfrom="1619" data-source-offset="-1633"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1618;"><span id="cb73-1619"><a href="#cb73-1619" aria-hidden="true" tabindex="-1"></a>rays_hv_data <span class="op">=</span>  <span class="fu">calcuvegadata</span>({</span>
<span id="cb73-1620"><a href="#cb73-1620" aria-hidden="true" tabindex="-1"></a>  <span class="dt">models</span><span class="op">:</span> [raycasting2]<span class="op">,</span></span>
<span id="cb73-1621"><a href="#cb73-1621" aria-hidden="true" tabindex="-1"></a>  <span class="dt">spec</span><span class="op">:</span>      [{<span class="dt">field</span><span class="op">:</span> <span class="st">'rv_hit_x'</span>}<span class="op">,</span> {<span class="dt">field</span><span class="op">:</span> <span class="st">'rv_hit_y'</span>}<span class="op">,</span>{<span class="dt">field</span><span class="op">:</span> <span class="st">'rh_hit_x'</span>}<span class="op">,</span> {<span class="dt">field</span><span class="op">:</span> <span class="st">'rh_hit_y'</span>}<span class="op">,</span>   {<span class="dt">field</span><span class="op">:</span> <span class="st">'player_x'</span>}<span class="op">,</span> {<span class="dt">field</span><span class="op">:</span> <span class="st">'player_y'</span>}]</span>
<span id="cb73-1622"><a href="#cb73-1622" aria-hidden="true" tabindex="-1"></a><span class="op">,</span></span>
<span id="cb73-1623"><a href="#cb73-1623" aria-hidden="true" tabindex="-1"></a>  <span class="dt">domains</span><span class="op">:</span> {</span>
<span id="cb73-1624"><a href="#cb73-1624" aria-hidden="true" tabindex="-1"></a>    <span class="co">//step_in: _.range(0,8.1)</span></span>
<span id="cb73-1625"><a href="#cb73-1625" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb73-1626"><a href="#cb73-1626" aria-hidden="true" tabindex="-1"></a>  <span class="dt">input_cursors</span><span class="op">:</span> [{</span>
<span id="cb73-1627"><a href="#cb73-1627" aria-hidden="true" tabindex="-1"></a>    keys_stream_function_in<span class="op">,</span></span>
<span id="cb73-1628"><a href="#cb73-1628" aria-hidden="true" tabindex="-1"></a>    keys_stream_version_in<span class="op">,</span></span>
<span id="cb73-1629"><a href="#cb73-1629" aria-hidden="true" tabindex="-1"></a>    f_in<span class="op">,</span></span>
<span id="cb73-1630"><a href="#cb73-1630" aria-hidden="true" tabindex="-1"></a>    ray_angle_in<span class="op">,</span> fisheye_correction_in</span>
<span id="cb73-1631"><a href="#cb73-1631" aria-hidden="true" tabindex="-1"></a>  }]</span>
<span id="cb73-1632"><a href="#cb73-1632" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb73-1633"><a href="#cb73-1633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1634"><a href="#cb73-1634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1635"><a href="#cb73-1635" aria-hidden="true" tabindex="-1"></a>map_data <span class="op">=</span> _<span class="op">.</span><span class="fu">range</span>(<span class="fl">0.5</span><span class="op">,</span><span class="dv">8</span>)<span class="op">.</span><span class="fu">map</span>(x_in <span class="kw">=&gt;</span> _<span class="op">.</span><span class="fu">range</span>(<span class="fl">0.5</span><span class="op">,</span><span class="dv">8</span>)<span class="op">.</span><span class="fu">map</span>(y_in <span class="kw">=&gt;</span> ({x_in<span class="op">,</span> y_in<span class="op">,</span> <span class="dt">map_lookup</span><span class="op">:</span> raycasting2<span class="op">.</span><span class="fu">map_lookup</span>({x_in<span class="op">,</span>y_in})})))<span class="op">.</span><span class="fu">flat</span>()</span>
<span id="cb73-1636"><a href="#cb73-1636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1637"><a href="#cb73-1637" aria-hidden="true" tabindex="-1"></a>updates_level <span class="op">=</span> {</span>
<span id="cb73-1638"><a href="#cb73-1638" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (ray_angle_in <span class="op">!=</span> <span class="kw">null</span>)</span>
<span id="cb73-1639"><a href="#cb73-1639" aria-hidden="true" tabindex="-1"></a>  <span class="co">//level.signal("ray_angle_in", ray_angle_in);</span></span>
<span id="cb73-1640"><a href="#cb73-1640" aria-hidden="true" tabindex="-1"></a>  level</span>
<span id="cb73-1641"><a href="#cb73-1641" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(<span class="st">"source"</span><span class="op">,</span> level_data) <span class="co">/*.resize()*/</span></span>
<span id="cb73-1642"><a href="#cb73-1642" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">run</span>()<span class="op">;</span></span>
<span id="cb73-1643"><a href="#cb73-1643" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-1644"><a href="#cb73-1644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-1645"><a href="#cb73-1645" aria-hidden="true" tabindex="-1"></a>level<span class="op">.</span><span class="fu">data</span>(<span class="st">'player_data'</span><span class="op">,</span> player_data)<span class="op">.</span><span class="fu">run</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-10" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-11" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-12" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-13" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb74" data-startfrom="1646" data-source-offset="-2365"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1645;"><span id="cb74-1646"><a href="#cb74-1646" aria-hidden="true" tabindex="-1"></a>level<span class="op">.</span><span class="fu">data</span>(<span class="st">'ray_steps_data'</span><span class="op">,</span> ray_steps_data)<span class="op">.</span><span class="fu">run</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-14" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb75" data-startfrom="1647" data-source-offset="-2416"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1646;"><span id="cb75-1647"><a href="#cb75-1647" aria-hidden="true" tabindex="-1"></a>level<span class="op">.</span><span class="fu">data</span>(<span class="st">'ray_h_data'</span><span class="op">,</span> ray_h_data)<span class="op">.</span><span class="fu">run</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-15" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb76" data-startfrom="1648" data-source-offset="-2459"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1647;"><span id="cb76-1648"><a href="#cb76-1648" aria-hidden="true" tabindex="-1"></a>level<span class="op">.</span><span class="fu">data</span>(<span class="st">'ray_v_data'</span><span class="op">,</span> ray_v_data)<span class="op">.</span><span class="fu">run</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-16" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb77" data-startfrom="1649" data-source-offset="-2502"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1648;"><span id="cb77-1649"><a href="#cb77-1649" aria-hidden="true" tabindex="-1"></a>level<span class="op">.</span><span class="fu">data</span>(<span class="st">'rays_hv_data'</span><span class="op">,</span> rays_hv_data)<span class="op">.</span><span class="fu">run</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-17" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb78" data-startfrom="1651" data-source-offset="-2550"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1650;"><span id="cb78-1651"><a href="#cb78-1651" aria-hidden="true" tabindex="-1"></a>level<span class="op">.</span><span class="fu">signal</span>(<span class="st">'player_angle_in'</span><span class="op">,</span> player_angle_in)<span class="op">.</span><span class="fu">run</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-18" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb79" data-startfrom="1655" data-source-offset="-2608"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1654;"><span id="cb79-1655"><a href="#cb79-1655" aria-hidden="true" tabindex="-1"></a>updates_fov <span class="op">=</span> {</span>
<span id="cb79-1656"><a href="#cb79-1656" aria-hidden="true" tabindex="-1"></a>  level</span>
<span id="cb79-1657"><a href="#cb79-1657" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(<span class="st">"fov"</span><span class="op">,</span> fov_data) <span class="co">/*.resize()*/</span></span>
<span id="cb79-1658"><a href="#cb79-1658" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">run</span>()<span class="op">;</span></span>
<span id="cb79-1659"><a href="#cb79-1659" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-1660"><a href="#cb79-1660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1661"><a href="#cb79-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1662"><a href="#cb79-1662" aria-hidden="true" tabindex="-1"></a>mutable scene_data0 <span class="op">=</span> []</span>
<span id="cb79-1663"><a href="#cb79-1663" aria-hidden="true" tabindex="-1"></a>mutable level_data0 <span class="op">=</span> [] <span class="co">// includes data in spec for when I Open in Vega Editor</span></span>
<span id="cb79-1664"><a href="#cb79-1664" aria-hidden="true" tabindex="-1"></a>mutable fov_data0 <span class="op">=</span> [] </span>
<span id="cb79-1665"><a href="#cb79-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1666"><a href="#cb79-1666" aria-hidden="true" tabindex="-1"></a>rays <span class="op">=</span> {<span class="cf">return</span> [</span>
<span id="cb79-1667"><a href="#cb79-1667" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb79-1668"><a href="#cb79-1668" aria-hidden="true" tabindex="-1"></a>      <span class="dt">from</span><span class="op">:</span> { <span class="dt">data</span><span class="op">:</span> <span class="st">"source"</span> }<span class="op">,</span></span>
<span id="cb79-1669"><a href="#cb79-1669" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"symbol"</span><span class="op">,</span></span>
<span id="cb79-1670"><a href="#cb79-1670" aria-hidden="true" tabindex="-1"></a>      <span class="dt">encode</span><span class="op">:</span> {</span>
<span id="cb79-1671"><a href="#cb79-1671" aria-hidden="true" tabindex="-1"></a>        <span class="dt">enter</span><span class="op">:</span> {</span>
<span id="cb79-1672"><a href="#cb79-1672" aria-hidden="true" tabindex="-1"></a>          <span class="dt">x</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"r_hit_x"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span></span>
<span id="cb79-1673"><a href="#cb79-1673" aria-hidden="true" tabindex="-1"></a>          <span class="dt">y</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"r_hit_y"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }<span class="op">,</span></span>
<span id="cb79-1674"><a href="#cb79-1674" aria-hidden="true" tabindex="-1"></a>          <span class="dt">size</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"ray_distance"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"length"</span> }<span class="op">,</span></span>
<span id="cb79-1675"><a href="#cb79-1675" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fill</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"orange"</span> }<span class="op">,</span></span>
<span id="cb79-1676"><a href="#cb79-1676" aria-hidden="true" tabindex="-1"></a>          <span class="co">//opacity: {value: 0.4},</span></span>
<span id="cb79-1677"><a href="#cb79-1677" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fillOpacity</span><span class="op">:</span> {<span class="dt">value</span><span class="op">:</span> <span class="fl">0.1</span>}<span class="op">,</span></span>
<span id="cb79-1678"><a href="#cb79-1678" aria-hidden="true" tabindex="-1"></a>          <span class="dt">stroke</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"black"</span> }<span class="op">,</span></span>
<span id="cb79-1679"><a href="#cb79-1679" aria-hidden="true" tabindex="-1"></a>          <span class="dt">shape</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"M -0.1 -0.4 L 0.3 -0.7 L 0.2 -0.1 L 0.8 0 L 0.2 0.5 L 0.2 0.9 L -0.1 0.1 L -0.3 0.6 L -0.4 -0.6"</span> } <span class="co">// made with https://yqnn.github.io/svg-path-editor/</span></span>
<span id="cb79-1680"><a href="#cb79-1680" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb79-1681"><a href="#cb79-1681" aria-hidden="true" tabindex="-1"></a>        <span class="dt">update</span><span class="op">:</span> {</span>
<span id="cb79-1682"><a href="#cb79-1682" aria-hidden="true" tabindex="-1"></a>          <span class="dt">x</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"r_hit_x"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span></span>
<span id="cb79-1683"><a href="#cb79-1683" aria-hidden="true" tabindex="-1"></a>          <span class="dt">y</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"r_hit_y"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }<span class="op">,</span></span>
<span id="cb79-1684"><a href="#cb79-1684" aria-hidden="true" tabindex="-1"></a>          <span class="dt">size</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"ray_distance"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"length"</span> }<span class="op">,</span></span>
<span id="cb79-1685"><a href="#cb79-1685" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb79-1686"><a href="#cb79-1686" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb79-1687"><a href="#cb79-1687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1688"><a href="#cb79-1688" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span></span>
<span id="cb79-1689"><a href="#cb79-1689" aria-hidden="true" tabindex="-1"></a>({</span>
<span id="cb79-1690"><a href="#cb79-1690" aria-hidden="true" tabindex="-1"></a>  <span class="dt">from</span><span class="op">:</span> { <span class="dt">data</span><span class="op">:</span> <span class="st">"source"</span> }<span class="op">,</span></span>
<span id="cb79-1691"><a href="#cb79-1691" aria-hidden="true" tabindex="-1"></a>  <span class="co">//mark: {type: "rule", clip: true},</span></span>
<span id="cb79-1692"><a href="#cb79-1692" aria-hidden="true" tabindex="-1"></a>  <span class="dt">type</span><span class="op">:</span> <span class="st">'rule'</span><span class="op">,</span></span>
<span id="cb79-1693"><a href="#cb79-1693" aria-hidden="true" tabindex="-1"></a>  <span class="dt">encode</span><span class="op">:</span> {</span>
<span id="cb79-1694"><a href="#cb79-1694" aria-hidden="true" tabindex="-1"></a>    <span class="dt">enter</span><span class="op">:</span> {</span>
<span id="cb79-1695"><a href="#cb79-1695" aria-hidden="true" tabindex="-1"></a>      <span class="dt">stroke</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"red"</span> }<span class="op">,</span></span>
<span id="cb79-1696"><a href="#cb79-1696" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeWidth</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">3</span> }<span class="op">,</span></span>
<span id="cb79-1697"><a href="#cb79-1697" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeOpacity</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="fl">0.5</span> }<span class="op">,</span></span>
<span id="cb79-1698"><a href="#cb79-1698" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeDash</span><span class="op">:</span> {<span class="dt">value</span><span class="op">:</span> [<span class="dv">8</span><span class="op">,</span><span class="dv">8</span>]}</span>
<span id="cb79-1699"><a href="#cb79-1699" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb79-1700"><a href="#cb79-1700" aria-hidden="true" tabindex="-1"></a>    <span class="dt">update</span><span class="op">:</span> {</span>
<span id="cb79-1701"><a href="#cb79-1701" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"player_x"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span></span>
<span id="cb79-1702"><a href="#cb79-1702" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"player_y"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }<span class="op">,</span></span>
<span id="cb79-1703"><a href="#cb79-1703" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x2</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"r_hit_x"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span></span>
<span id="cb79-1704"><a href="#cb79-1704" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y2</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"r_hit_y"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }</span>
<span id="cb79-1705"><a href="#cb79-1705" aria-hidden="true" tabindex="-1"></a>      <span class="co">//stroke: { field: "ray_angle_in" }</span></span>
<span id="cb79-1706"><a href="#cb79-1706" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb79-1707"><a href="#cb79-1707" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb79-1708"><a href="#cb79-1708" aria-hidden="true" tabindex="-1"></a>})]}</span>
<span id="cb79-1709"><a href="#cb79-1709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1710"><a href="#cb79-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1711"><a href="#cb79-1711" aria-hidden="true" tabindex="-1"></a>hits <span class="op">=</span> {<span class="cf">return</span> ({</span>
<span id="cb79-1712"><a href="#cb79-1712" aria-hidden="true" tabindex="-1"></a>      <span class="co">//</span></span>
<span id="cb79-1713"><a href="#cb79-1713" aria-hidden="true" tabindex="-1"></a>    })}</span>
<span id="cb79-1714"><a href="#cb79-1714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1715"><a href="#cb79-1715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1716"><a href="#cb79-1716" aria-hidden="true" tabindex="-1"></a>fov_spec <span class="op">=</span> {<span class="cf">return</span> ({</span>
<span id="cb79-1717"><a href="#cb79-1717" aria-hidden="true" tabindex="-1"></a>  <span class="dt">from</span><span class="op">:</span> { <span class="dt">data</span><span class="op">:</span> <span class="st">"fov"</span> }<span class="op">,</span></span>
<span id="cb79-1718"><a href="#cb79-1718" aria-hidden="true" tabindex="-1"></a>  <span class="dt">type</span><span class="op">:</span> <span class="st">"line"</span><span class="op">,</span></span>
<span id="cb79-1719"><a href="#cb79-1719" aria-hidden="true" tabindex="-1"></a>  <span class="dt">encode</span><span class="op">:</span> {</span>
<span id="cb79-1720"><a href="#cb79-1720" aria-hidden="true" tabindex="-1"></a>    <span class="dt">enter</span><span class="op">:</span> {</span>
<span id="cb79-1721"><a href="#cb79-1721" aria-hidden="true" tabindex="-1"></a>      <span class="dt">stroke</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"#0FFF50"</span> }<span class="op">,</span></span>
<span id="cb79-1722"><a href="#cb79-1722" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeWidth</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="fl">5.01</span> }<span class="op">,</span></span>
<span id="cb79-1723"><a href="#cb79-1723" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeOpacity</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">1</span> }<span class="op">,</span></span>
<span id="cb79-1724"><a href="#cb79-1724" aria-hidden="true" tabindex="-1"></a>      <span class="dt">interpolate</span><span class="op">:</span> {<span class="dt">value</span><span class="op">:</span> <span class="st">'linear-closed'</span>}</span>
<span id="cb79-1725"><a href="#cb79-1725" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb79-1726"><a href="#cb79-1726" aria-hidden="true" tabindex="-1"></a>    <span class="dt">update</span><span class="op">:</span> {</span>
<span id="cb79-1727"><a href="#cb79-1727" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span></span>
<span id="cb79-1728"><a href="#cb79-1728" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }<span class="op">,</span></span>
<span id="cb79-1729"><a href="#cb79-1729" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fill</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"green"</span> }<span class="op">,</span></span>
<span id="cb79-1730"><a href="#cb79-1730" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fillOpacity</span><span class="op">:</span> {<span class="dt">value</span><span class="op">:</span> <span class="fl">0.2</span>}</span>
<span id="cb79-1731"><a href="#cb79-1731" aria-hidden="true" tabindex="-1"></a>      <span class="co">//x2: { field: "rvx", scale: "x" },</span></span>
<span id="cb79-1732"><a href="#cb79-1732" aria-hidden="true" tabindex="-1"></a>      <span class="co">//y2: { field: "rvy", scale: "y" }</span></span>
<span id="cb79-1733"><a href="#cb79-1733" aria-hidden="true" tabindex="-1"></a>      <span class="co">//stroke: { field: "ray_angle_in" }</span></span>
<span id="cb79-1734"><a href="#cb79-1734" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb79-1735"><a href="#cb79-1735" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb79-1736"><a href="#cb79-1736" aria-hidden="true" tabindex="-1"></a>})}</span>
<span id="cb79-1737"><a href="#cb79-1737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1738"><a href="#cb79-1738" aria-hidden="true" tabindex="-1"></a>map_spec <span class="op">=</span> {<span class="cf">return</span> ({</span>
<span id="cb79-1739"><a href="#cb79-1739" aria-hidden="true" tabindex="-1"></a>  <span class="dt">from</span><span class="op">:</span> { <span class="dt">data</span><span class="op">:</span> <span class="st">"map_data"</span> }<span class="op">,</span></span>
<span id="cb79-1740"><a href="#cb79-1740" aria-hidden="true" tabindex="-1"></a>  <span class="dt">type</span><span class="op">:</span> <span class="st">"rect"</span><span class="op">,</span></span>
<span id="cb79-1741"><a href="#cb79-1741" aria-hidden="true" tabindex="-1"></a>  <span class="dt">encode</span><span class="op">:</span> {</span>
<span id="cb79-1742"><a href="#cb79-1742" aria-hidden="true" tabindex="-1"></a>    <span class="dt">enter</span><span class="op">:</span> {</span>
<span id="cb79-1743"><a href="#cb79-1743" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"floor(datum.x_in)"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">'x'</span> }<span class="op">,</span></span>
<span id="cb79-1744"><a href="#cb79-1744" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x2</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"floor(datum.x_in)+1-0.05"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">'x'</span> }<span class="op">,</span></span>
<span id="cb79-1745"><a href="#cb79-1745" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"floor(datum.y_in)"</span> <span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">'y'</span>}<span class="op">,</span></span>
<span id="cb79-1746"><a href="#cb79-1746" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y2</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"floor(datum.y_in)+1-0.05"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">'y'</span> }<span class="op">,</span></span>
<span id="cb79-1747"><a href="#cb79-1747" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fill</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">'map_lookup'</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">'map_lookup'</span>}</span>
<span id="cb79-1748"><a href="#cb79-1748" aria-hidden="true" tabindex="-1"></a>      <span class="co">//color: { field: "floor(datum.y_in)+1" },</span></span>
<span id="cb79-1749"><a href="#cb79-1749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1750"><a href="#cb79-1750" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb79-1751"><a href="#cb79-1751" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb79-1752"><a href="#cb79-1752" aria-hidden="true" tabindex="-1"></a>})}</span>
<span id="cb79-1753"><a href="#cb79-1753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1754"><a href="#cb79-1754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1755"><a href="#cb79-1755" aria-hidden="true" tabindex="-1"></a>player_spec <span class="op">=</span> {<span class="cf">return</span> ({</span>
<span id="cb79-1756"><a href="#cb79-1756" aria-hidden="true" tabindex="-1"></a>      <span class="co">// PLAYER</span></span>
<span id="cb79-1757"><a href="#cb79-1757" aria-hidden="true" tabindex="-1"></a>      <span class="dt">from</span><span class="op">:</span> { <span class="dt">data</span><span class="op">:</span> <span class="st">"player_data"</span> }<span class="op">,</span></span>
<span id="cb79-1758"><a href="#cb79-1758" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"symbol"</span><span class="op">,</span></span>
<span id="cb79-1759"><a href="#cb79-1759" aria-hidden="true" tabindex="-1"></a>      <span class="dt">encode</span><span class="op">:</span> {</span>
<span id="cb79-1760"><a href="#cb79-1760" aria-hidden="true" tabindex="-1"></a>        <span class="dt">enter</span><span class="op">:</span> {</span>
<span id="cb79-1761"><a href="#cb79-1761" aria-hidden="true" tabindex="-1"></a>          <span class="dt">x</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"player_x"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span></span>
<span id="cb79-1762"><a href="#cb79-1762" aria-hidden="true" tabindex="-1"></a>          <span class="dt">y</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"player_y"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }<span class="op">,</span></span>
<span id="cb79-1763"><a href="#cb79-1763" aria-hidden="true" tabindex="-1"></a>          <span class="dt">size</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">500</span> }<span class="op">,</span></span>
<span id="cb79-1764"><a href="#cb79-1764" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fill</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"yellow"</span> }<span class="op">,</span></span>
<span id="cb79-1765"><a href="#cb79-1765" aria-hidden="true" tabindex="-1"></a>          <span class="dt">stroke</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"black"</span> }<span class="op">,</span></span>
<span id="cb79-1766"><a href="#cb79-1766" aria-hidden="true" tabindex="-1"></a>          <span class="dt">shape</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"arrow"</span> }</span>
<span id="cb79-1767"><a href="#cb79-1767" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb79-1768"><a href="#cb79-1768" aria-hidden="true" tabindex="-1"></a>        <span class="dt">update</span><span class="op">:</span> {</span>
<span id="cb79-1769"><a href="#cb79-1769" aria-hidden="true" tabindex="-1"></a>          <span class="dt">x</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"player_x"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span></span>
<span id="cb79-1770"><a href="#cb79-1770" aria-hidden="true" tabindex="-1"></a>          <span class="dt">y</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"player_y"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }<span class="op">,</span></span>
<span id="cb79-1771"><a href="#cb79-1771" aria-hidden="true" tabindex="-1"></a>          <span class="dt">angle</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"-180 - 90 - player_angle_in * 180 / PI"</span> }</span>
<span id="cb79-1772"><a href="#cb79-1772" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb79-1773"><a href="#cb79-1773" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb79-1774"><a href="#cb79-1774" aria-hidden="true" tabindex="-1"></a>    })}</span>
<span id="cb79-1775"><a href="#cb79-1775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1776"><a href="#cb79-1776" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb79-1777"><a href="#cb79-1777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1778"><a href="#cb79-1778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1779"><a href="#cb79-1779" aria-hidden="true" tabindex="-1"></a>ray_steps_spec <span class="op">=</span> {<span class="cf">return</span> ([</span>
<span id="cb79-1780"><a href="#cb79-1780" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb79-1781"><a href="#cb79-1781" aria-hidden="true" tabindex="-1"></a>      <span class="co">// HORIZONTAL REDS</span></span>
<span id="cb79-1782"><a href="#cb79-1782" aria-hidden="true" tabindex="-1"></a>      <span class="dt">from</span><span class="op">:</span> { <span class="dt">data</span><span class="op">:</span> <span class="st">"ray_steps_data"</span> }<span class="op">,</span></span>
<span id="cb79-1783"><a href="#cb79-1783" aria-hidden="true" tabindex="-1"></a>      <span class="dt">name</span><span class="op">:</span> <span class="st">'h'</span><span class="op">,</span></span>
<span id="cb79-1784"><a href="#cb79-1784" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"symbol"</span><span class="op">,</span></span>
<span id="cb79-1785"><a href="#cb79-1785" aria-hidden="true" tabindex="-1"></a>      <span class="dt">encode</span><span class="op">:</span> {</span>
<span id="cb79-1786"><a href="#cb79-1786" aria-hidden="true" tabindex="-1"></a>        <span class="dt">enter</span><span class="op">:</span> {</span>
<span id="cb79-1787"><a href="#cb79-1787" aria-hidden="true" tabindex="-1"></a>          <span class="co">//opacity: { value: opacity_vertical },</span></span>
<span id="cb79-1788"><a href="#cb79-1788" aria-hidden="true" tabindex="-1"></a>          <span class="co">//opacity: { field: "if_ray_hit_horizontal", scale: "hit" },</span></span>
<span id="cb79-1789"><a href="#cb79-1789" aria-hidden="true" tabindex="-1"></a>          <span class="dt">x</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"rhx"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span></span>
<span id="cb79-1790"><a href="#cb79-1790" aria-hidden="true" tabindex="-1"></a>          <span class="dt">y</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"rhy"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }<span class="op">,</span></span>
<span id="cb79-1791"><a href="#cb79-1791" aria-hidden="true" tabindex="-1"></a>          <span class="dt">size</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">300</span> }<span class="op">,</span></span>
<span id="cb79-1792"><a href="#cb79-1792" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fill</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"red"</span> }<span class="op">,</span></span>
<span id="cb79-1793"><a href="#cb79-1793" aria-hidden="true" tabindex="-1"></a>          <span class="dt">shape</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"circle"</span> }<span class="op">,</span></span>
<span id="cb79-1794"><a href="#cb79-1794" aria-hidden="true" tabindex="-1"></a>          <span class="dt">strokeWidth</span><span class="op">:</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">5</span>}<span class="op">,</span></span>
<span id="cb79-1795"><a href="#cb79-1795" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb79-1796"><a href="#cb79-1796" aria-hidden="true" tabindex="-1"></a>        <span class="dt">update</span><span class="op">:</span> {</span>
<span id="cb79-1797"><a href="#cb79-1797" aria-hidden="true" tabindex="-1"></a>          <span class="dt">stroke</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"(datum.step_in == step_in[0] &amp;&amp; step_in[1] == 'h') ? 'yellow' : null"</span>}<span class="op">,</span><span class="co">//, scale: "hit" },</span></span>
<span id="cb79-1798"><a href="#cb79-1798" aria-hidden="true" tabindex="-1"></a>          <span class="dt">x</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"rhx"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span></span>
<span id="cb79-1799"><a href="#cb79-1799" aria-hidden="true" tabindex="-1"></a>          <span class="dt">y</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"rhy"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }</span>
<span id="cb79-1800"><a href="#cb79-1800" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb79-1801"><a href="#cb79-1801" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb79-1802"><a href="#cb79-1802" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb79-1803"><a href="#cb79-1803" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb79-1804"><a href="#cb79-1804" aria-hidden="true" tabindex="-1"></a>      <span class="co">// VERTICAL GREENS</span></span>
<span id="cb79-1805"><a href="#cb79-1805" aria-hidden="true" tabindex="-1"></a>      <span class="dt">from</span><span class="op">:</span> { <span class="dt">data</span><span class="op">:</span> <span class="st">"ray_steps_data"</span> }<span class="op">,</span></span>
<span id="cb79-1806"><a href="#cb79-1806" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"symbol"</span><span class="op">,</span></span>
<span id="cb79-1807"><a href="#cb79-1807" aria-hidden="true" tabindex="-1"></a>      <span class="dt">name</span><span class="op">:</span> <span class="st">'v'</span><span class="op">,</span></span>
<span id="cb79-1808"><a href="#cb79-1808" aria-hidden="true" tabindex="-1"></a>      <span class="dt">encode</span><span class="op">:</span> {</span>
<span id="cb79-1809"><a href="#cb79-1809" aria-hidden="true" tabindex="-1"></a>        <span class="dt">enter</span><span class="op">:</span> {</span>
<span id="cb79-1810"><a href="#cb79-1810" aria-hidden="true" tabindex="-1"></a>          <span class="co">//opacity: { value: opacity_vertical },</span></span>
<span id="cb79-1811"><a href="#cb79-1811" aria-hidden="true" tabindex="-1"></a>          <span class="co">//opacity: { field: "if_ray_hit_vertical", scale: "hit" },</span></span>
<span id="cb79-1812"><a href="#cb79-1812" aria-hidden="true" tabindex="-1"></a>          <span class="dt">x</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"rvx"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span></span>
<span id="cb79-1813"><a href="#cb79-1813" aria-hidden="true" tabindex="-1"></a>          <span class="dt">y</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"rvy"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }<span class="op">,</span></span>
<span id="cb79-1814"><a href="#cb79-1814" aria-hidden="true" tabindex="-1"></a>          <span class="dt">size</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">200</span> }<span class="op">,</span></span>
<span id="cb79-1815"><a href="#cb79-1815" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fill</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"green"</span> }<span class="op">,</span></span>
<span id="cb79-1816"><a href="#cb79-1816" aria-hidden="true" tabindex="-1"></a>          <span class="dt">shape</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"circle"</span> }<span class="op">,</span></span>
<span id="cb79-1817"><a href="#cb79-1817" aria-hidden="true" tabindex="-1"></a>          <span class="dt">strokeWidth</span><span class="op">:</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">5</span>}<span class="op">,</span></span>
<span id="cb79-1818"><a href="#cb79-1818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1819"><a href="#cb79-1819" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb79-1820"><a href="#cb79-1820" aria-hidden="true" tabindex="-1"></a>        <span class="dt">update</span><span class="op">:</span> {</span>
<span id="cb79-1821"><a href="#cb79-1821" aria-hidden="true" tabindex="-1"></a>          <span class="co">//opacity: { value: opacity_vertical },</span></span>
<span id="cb79-1822"><a href="#cb79-1822" aria-hidden="true" tabindex="-1"></a>          <span class="dt">stroke</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"(datum.step_in == step_in[0] &amp;&amp; step_in[1] == 'v') ? 'yellow' : null"</span>}<span class="op">,</span><span class="co">//, scale: "hit" },</span></span>
<span id="cb79-1823"><a href="#cb79-1823" aria-hidden="true" tabindex="-1"></a>          <span class="dt">x</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"rvx"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span></span>
<span id="cb79-1824"><a href="#cb79-1824" aria-hidden="true" tabindex="-1"></a>          <span class="dt">y</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"rvy"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }</span>
<span id="cb79-1825"><a href="#cb79-1825" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb79-1826"><a href="#cb79-1826" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb79-1827"><a href="#cb79-1827" aria-hidden="true" tabindex="-1"></a>    }])}</span>
<span id="cb79-1828"><a href="#cb79-1828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1829"><a href="#cb79-1829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1830"><a href="#cb79-1830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1831"><a href="#cb79-1831" aria-hidden="true" tabindex="-1"></a>ray_v_spec <span class="op">=</span> {<span class="cf">return</span> [</span>
<span id="cb79-1832"><a href="#cb79-1832" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb79-1833"><a href="#cb79-1833" aria-hidden="true" tabindex="-1"></a>      <span class="dt">from</span><span class="op">:</span> { <span class="dt">data</span><span class="op">:</span> <span class="st">"rays_hv_data"</span> }<span class="op">,</span></span>
<span id="cb79-1834"><a href="#cb79-1834" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"symbol"</span><span class="op">,</span></span>
<span id="cb79-1835"><a href="#cb79-1835" aria-hidden="true" tabindex="-1"></a>      <span class="dt">encode</span><span class="op">:</span> {</span>
<span id="cb79-1836"><a href="#cb79-1836" aria-hidden="true" tabindex="-1"></a>        <span class="dt">enter</span><span class="op">:</span> {</span>
<span id="cb79-1837"><a href="#cb79-1837" aria-hidden="true" tabindex="-1"></a>          <span class="dt">x</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"rv_hit_x"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span></span>
<span id="cb79-1838"><a href="#cb79-1838" aria-hidden="true" tabindex="-1"></a>          <span class="dt">y</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"rv_hit_y"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }<span class="op">,</span></span>
<span id="cb79-1839"><a href="#cb79-1839" aria-hidden="true" tabindex="-1"></a>          <span class="dt">size</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"ray_distance"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"length"</span> }<span class="op">,</span></span>
<span id="cb79-1840"><a href="#cb79-1840" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fill</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"green"</span> }<span class="op">,</span></span>
<span id="cb79-1841"><a href="#cb79-1841" aria-hidden="true" tabindex="-1"></a>          <span class="co">//opacity: {value: 0.4},</span></span>
<span id="cb79-1842"><a href="#cb79-1842" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fillOpacity</span><span class="op">:</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">1</span>}<span class="op">,</span></span>
<span id="cb79-1843"><a href="#cb79-1843" aria-hidden="true" tabindex="-1"></a>          <span class="dt">stroke</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"black"</span> }<span class="op">,</span></span>
<span id="cb79-1844"><a href="#cb79-1844" aria-hidden="true" tabindex="-1"></a>          <span class="dt">shape</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"circle"</span> }</span>
<span id="cb79-1845"><a href="#cb79-1845" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb79-1846"><a href="#cb79-1846" aria-hidden="true" tabindex="-1"></a>        <span class="dt">update</span><span class="op">:</span> {</span>
<span id="cb79-1847"><a href="#cb79-1847" aria-hidden="true" tabindex="-1"></a>          <span class="dt">x</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"rv_hit_x"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span></span>
<span id="cb79-1848"><a href="#cb79-1848" aria-hidden="true" tabindex="-1"></a>          <span class="dt">y</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"rv_hit_y"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }<span class="op">,</span></span>
<span id="cb79-1849"><a href="#cb79-1849" aria-hidden="true" tabindex="-1"></a>          <span class="dt">size</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"ray_distance"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"length"</span> }<span class="op">,</span></span>
<span id="cb79-1850"><a href="#cb79-1850" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb79-1851"><a href="#cb79-1851" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb79-1852"><a href="#cb79-1852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1853"><a href="#cb79-1853" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span></span>
<span id="cb79-1854"><a href="#cb79-1854" aria-hidden="true" tabindex="-1"></a>({</span>
<span id="cb79-1855"><a href="#cb79-1855" aria-hidden="true" tabindex="-1"></a>  <span class="dt">from</span><span class="op">:</span> { <span class="dt">data</span><span class="op">:</span> <span class="st">"rays_hv_data"</span> }<span class="op">,</span></span>
<span id="cb79-1856"><a href="#cb79-1856" aria-hidden="true" tabindex="-1"></a>  <span class="co">//mark: {type: "rule", clip: true},</span></span>
<span id="cb79-1857"><a href="#cb79-1857" aria-hidden="true" tabindex="-1"></a>  <span class="dt">type</span><span class="op">:</span> <span class="st">'rule'</span><span class="op">,</span></span>
<span id="cb79-1858"><a href="#cb79-1858" aria-hidden="true" tabindex="-1"></a>  <span class="dt">encode</span><span class="op">:</span> {</span>
<span id="cb79-1859"><a href="#cb79-1859" aria-hidden="true" tabindex="-1"></a>    <span class="dt">enter</span><span class="op">:</span> {</span>
<span id="cb79-1860"><a href="#cb79-1860" aria-hidden="true" tabindex="-1"></a>      <span class="dt">stroke</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"green"</span> }<span class="op">,</span></span>
<span id="cb79-1861"><a href="#cb79-1861" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeWidth</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">10</span> }<span class="op">,</span></span>
<span id="cb79-1862"><a href="#cb79-1862" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeOpacity</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">1</span> }<span class="op">,</span></span>
<span id="cb79-1863"><a href="#cb79-1863" aria-hidden="true" tabindex="-1"></a>      <span class="co">//strokeDash: {value: [8,8]}</span></span>
<span id="cb79-1864"><a href="#cb79-1864" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb79-1865"><a href="#cb79-1865" aria-hidden="true" tabindex="-1"></a>    <span class="dt">update</span><span class="op">:</span> {</span>
<span id="cb79-1866"><a href="#cb79-1866" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"datum.player_x+0.05"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span></span>
<span id="cb79-1867"><a href="#cb79-1867" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"datum.player_y+0.05"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }<span class="op">,</span></span>
<span id="cb79-1868"><a href="#cb79-1868" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x2</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"datum.rv_hit_x+0.05"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span> <span class="co">// calcuvegadata doesn't process signal expressions!</span></span>
<span id="cb79-1869"><a href="#cb79-1869" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y2</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"datum.rv_hit_y+0.05"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }<span class="op">,</span></span>
<span id="cb79-1870"><a href="#cb79-1870" aria-hidden="true" tabindex="-1"></a>      <span class="dt">fake</span><span class="op">:</span> {<span class="dt">field</span><span class="op">:</span> <span class="st">'rv_hit_x'</span>}<span class="op">,</span> <span class="dt">fake2</span><span class="op">:</span> {<span class="dt">field</span><span class="op">:</span> <span class="st">'rv_hit_y'</span>}<span class="op">,</span>      <span class="dt">fake3</span><span class="op">:</span> {<span class="dt">field</span><span class="op">:</span> <span class="st">'player_x'</span>}<span class="op">,</span> <span class="dt">fake4</span><span class="op">:</span> {<span class="dt">field</span><span class="op">:</span> <span class="st">'player_y'</span>}</span>
<span id="cb79-1871"><a href="#cb79-1871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1872"><a href="#cb79-1872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1873"><a href="#cb79-1873" aria-hidden="true" tabindex="-1"></a>      <span class="co">/*x: { signal: "datum.player_x+1", scale: "x" },</span></span>
<span id="cb79-1874"><a href="#cb79-1874" aria-hidden="true" tabindex="-1"></a><span class="co">      y: { signal: "datum.player_y+0.5", scale: "y" },</span></span>
<span id="cb79-1875"><a href="#cb79-1875" aria-hidden="true" tabindex="-1"></a><span class="co">      x2: { signal: "datum.rv_hit_x+0.5", scale: "x" },</span></span>
<span id="cb79-1876"><a href="#cb79-1876" aria-hidden="true" tabindex="-1"></a><span class="co">      y2: { signal: "datum.rv_hit_y+0.5", scale: "y" }*/</span></span>
<span id="cb79-1877"><a href="#cb79-1877" aria-hidden="true" tabindex="-1"></a>      <span class="co">//stroke: { field: "ray_angle_in" }</span></span>
<span id="cb79-1878"><a href="#cb79-1878" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb79-1879"><a href="#cb79-1879" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb79-1880"><a href="#cb79-1880" aria-hidden="true" tabindex="-1"></a>})]}</span>
<span id="cb79-1881"><a href="#cb79-1881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1882"><a href="#cb79-1882" aria-hidden="true" tabindex="-1"></a>ray_h_spec <span class="op">=</span> { <span class="cf">return</span> [</span>
<span id="cb79-1883"><a href="#cb79-1883" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb79-1884"><a href="#cb79-1884" aria-hidden="true" tabindex="-1"></a>      <span class="dt">from</span><span class="op">:</span> { <span class="dt">data</span><span class="op">:</span> <span class="st">"rays_hv_data"</span> }<span class="op">,</span></span>
<span id="cb79-1885"><a href="#cb79-1885" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"symbol"</span><span class="op">,</span></span>
<span id="cb79-1886"><a href="#cb79-1886" aria-hidden="true" tabindex="-1"></a>      <span class="dt">encode</span><span class="op">:</span> {</span>
<span id="cb79-1887"><a href="#cb79-1887" aria-hidden="true" tabindex="-1"></a>        <span class="dt">enter</span><span class="op">:</span> {</span>
<span id="cb79-1888"><a href="#cb79-1888" aria-hidden="true" tabindex="-1"></a>          <span class="dt">x</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"rh_hit_x"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span></span>
<span id="cb79-1889"><a href="#cb79-1889" aria-hidden="true" tabindex="-1"></a>          <span class="dt">y</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"rh_hit_y"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }<span class="op">,</span></span>
<span id="cb79-1890"><a href="#cb79-1890" aria-hidden="true" tabindex="-1"></a>          <span class="dt">size</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"ray_distance"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"length"</span> }<span class="op">,</span></span>
<span id="cb79-1891"><a href="#cb79-1891" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fill</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"orange"</span> }<span class="op">,</span></span>
<span id="cb79-1892"><a href="#cb79-1892" aria-hidden="true" tabindex="-1"></a>          <span class="co">//opacity: {value: 0.4},</span></span>
<span id="cb79-1893"><a href="#cb79-1893" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fillOpacity</span><span class="op">:</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">1</span>}<span class="op">,</span></span>
<span id="cb79-1894"><a href="#cb79-1894" aria-hidden="true" tabindex="-1"></a>          <span class="dt">stroke</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"black"</span> }<span class="op">,</span></span>
<span id="cb79-1895"><a href="#cb79-1895" aria-hidden="true" tabindex="-1"></a>          <span class="dt">shape</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"circle"</span> }</span>
<span id="cb79-1896"><a href="#cb79-1896" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb79-1897"><a href="#cb79-1897" aria-hidden="true" tabindex="-1"></a>        <span class="dt">update</span><span class="op">:</span> {</span>
<span id="cb79-1898"><a href="#cb79-1898" aria-hidden="true" tabindex="-1"></a>          <span class="dt">x</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"rh_hit_x"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span></span>
<span id="cb79-1899"><a href="#cb79-1899" aria-hidden="true" tabindex="-1"></a>          <span class="dt">y</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"rh_hit_y"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }<span class="op">,</span></span>
<span id="cb79-1900"><a href="#cb79-1900" aria-hidden="true" tabindex="-1"></a>          <span class="dt">size</span><span class="op">:</span> { <span class="dt">field</span><span class="op">:</span> <span class="st">"ray_distance"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"length"</span> }<span class="op">,</span></span>
<span id="cb79-1901"><a href="#cb79-1901" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb79-1902"><a href="#cb79-1902" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb79-1903"><a href="#cb79-1903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1904"><a href="#cb79-1904" aria-hidden="true" tabindex="-1"></a>}<span class="op">,</span>({</span>
<span id="cb79-1905"><a href="#cb79-1905" aria-hidden="true" tabindex="-1"></a>  <span class="dt">from</span><span class="op">:</span> { <span class="dt">data</span><span class="op">:</span> <span class="st">"rays_hv_data"</span> }<span class="op">,</span></span>
<span id="cb79-1906"><a href="#cb79-1906" aria-hidden="true" tabindex="-1"></a>  <span class="co">//mark: {type: "rule", clip: true},</span></span>
<span id="cb79-1907"><a href="#cb79-1907" aria-hidden="true" tabindex="-1"></a>  <span class="dt">type</span><span class="op">:</span> <span class="st">'rule'</span><span class="op">,</span></span>
<span id="cb79-1908"><a href="#cb79-1908" aria-hidden="true" tabindex="-1"></a>  <span class="dt">encode</span><span class="op">:</span> {</span>
<span id="cb79-1909"><a href="#cb79-1909" aria-hidden="true" tabindex="-1"></a>    <span class="dt">enter</span><span class="op">:</span> {</span>
<span id="cb79-1910"><a href="#cb79-1910" aria-hidden="true" tabindex="-1"></a>      <span class="dt">stroke</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"orange"</span> }<span class="op">,</span></span>
<span id="cb79-1911"><a href="#cb79-1911" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeWidth</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">10</span> }<span class="op">,</span></span>
<span id="cb79-1912"><a href="#cb79-1912" aria-hidden="true" tabindex="-1"></a>      <span class="dt">strokeOpacity</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">1</span> }<span class="op">,</span></span>
<span id="cb79-1913"><a href="#cb79-1913" aria-hidden="true" tabindex="-1"></a>      <span class="co">//strokeDash: {value: [8,8]}</span></span>
<span id="cb79-1914"><a href="#cb79-1914" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb79-1915"><a href="#cb79-1915" aria-hidden="true" tabindex="-1"></a>    <span class="dt">update</span><span class="op">:</span> {</span>
<span id="cb79-1916"><a href="#cb79-1916" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"datum.player_x-.05"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span></span>
<span id="cb79-1917"><a href="#cb79-1917" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"datum.player_y-.05"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }<span class="op">,</span></span>
<span id="cb79-1918"><a href="#cb79-1918" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x2</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"datum.rh_hit_x-.05"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span></span>
<span id="cb79-1919"><a href="#cb79-1919" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y2</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"datum.rh_hit_y-.05"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }<span class="op">,</span></span>
<span id="cb79-1920"><a href="#cb79-1920" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fake</span><span class="op">:</span> {<span class="dt">field</span><span class="op">:</span> <span class="st">'rh_hit_x'</span>}<span class="op">,</span> <span class="dt">fake2</span><span class="op">:</span> {<span class="dt">field</span><span class="op">:</span> <span class="st">'rh_hit_y'</span>}</span>
<span id="cb79-1921"><a href="#cb79-1921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1922"><a href="#cb79-1922" aria-hidden="true" tabindex="-1"></a>      <span class="co">//stroke: { field: "ray_angle_in" }</span></span>
<span id="cb79-1923"><a href="#cb79-1923" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb79-1924"><a href="#cb79-1924" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb79-1925"><a href="#cb79-1925" aria-hidden="true" tabindex="-1"></a>})<span class="op">,</span></span>
<span id="cb79-1926"><a href="#cb79-1926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1927"><a href="#cb79-1927" aria-hidden="true" tabindex="-1"></a>]}</span>
<span id="cb79-1928"><a href="#cb79-1928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1929"><a href="#cb79-1929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1930"><a href="#cb79-1930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1931"><a href="#cb79-1931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1932"><a href="#cb79-1932" aria-hidden="true" tabindex="-1"></a>level_spec <span class="op">=</span> { <span class="cf">return</span> ({</span>
<span id="cb79-1933"><a href="#cb79-1933" aria-hidden="true" tabindex="-1"></a>  <span class="dt">data</span><span class="op">:</span> [</span>
<span id="cb79-1934"><a href="#cb79-1934" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">name</span><span class="op">:</span> <span class="st">"source"</span><span class="op">,</span> <span class="dt">values</span><span class="op">:</span> level_data0 }<span class="op">,</span> <span class="co">// layer 5 for rays by step</span></span>
<span id="cb79-1935"><a href="#cb79-1935" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">name</span><span class="op">:</span> <span class="st">"fov"</span><span class="op">,</span> <span class="dt">values</span><span class="op">:</span> fov_data0 }<span class="op">,</span></span>
<span id="cb79-1936"><a href="#cb79-1936" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">name</span><span class="op">:</span> <span class="st">"map_data"</span><span class="op">,</span> <span class="dt">values</span><span class="op">:</span> map_data }<span class="op">,</span></span>
<span id="cb79-1937"><a href="#cb79-1937" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">name</span><span class="op">:</span> <span class="st">"player_data"</span><span class="op">,</span> <span class="dt">values</span><span class="op">:</span> [] }<span class="op">,</span></span>
<span id="cb79-1938"><a href="#cb79-1938" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">name</span><span class="op">:</span> <span class="st">"hits_data"</span><span class="op">,</span> <span class="dt">values</span><span class="op">:</span> [] }<span class="op">,</span></span>
<span id="cb79-1939"><a href="#cb79-1939" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">name</span><span class="op">:</span> <span class="st">"ray_steps_data"</span><span class="op">,</span> <span class="dt">values</span><span class="op">:</span> [] }<span class="op">,</span></span>
<span id="cb79-1940"><a href="#cb79-1940" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">name</span><span class="op">:</span> <span class="st">"ray_h_data"</span><span class="op">,</span> <span class="dt">values</span><span class="op">:</span> [] }<span class="op">,</span></span>
<span id="cb79-1941"><a href="#cb79-1941" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">name</span><span class="op">:</span> <span class="st">"ray_v_data"</span><span class="op">,</span> <span class="dt">values</span><span class="op">:</span> [] }<span class="op">,</span></span>
<span id="cb79-1942"><a href="#cb79-1942" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">name</span><span class="op">:</span> <span class="st">"rays_hv_data"</span><span class="op">,</span> <span class="dt">values</span><span class="op">:</span> [] }<span class="op">,</span></span>
<span id="cb79-1943"><a href="#cb79-1943" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb79-1944"><a href="#cb79-1944" aria-hidden="true" tabindex="-1"></a>  <span class="co">//background: "grey",</span></span>
<span id="cb79-1945"><a href="#cb79-1945" aria-hidden="true" tabindex="-1"></a>  <span class="co">//width: 'container',</span></span>
<span id="cb79-1946"><a href="#cb79-1946" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="dv">400</span><span class="op">,</span></span>
<span id="cb79-1947"><a href="#cb79-1947" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">300</span><span class="op">,</span></span>
<span id="cb79-1948"><a href="#cb79-1948" aria-hidden="true" tabindex="-1"></a>  <span class="dt">background</span><span class="op">:</span> <span class="st">'#ccc'</span><span class="op">,</span></span>
<span id="cb79-1949"><a href="#cb79-1949" aria-hidden="true" tabindex="-1"></a>  <span class="dt">signals</span><span class="op">:</span> [</span>
<span id="cb79-1950"><a href="#cb79-1950" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">name</span><span class="op">:</span> <span class="st">"player_angle_in"</span> }<span class="op">,</span></span>
<span id="cb79-1951"><a href="#cb79-1951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1952"><a href="#cb79-1952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1953"><a href="#cb79-1953" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb79-1954"><a href="#cb79-1954" aria-hidden="true" tabindex="-1"></a>      <span class="st">"name"</span><span class="op">:</span> <span class="st">"step_in"</span><span class="op">,</span></span>
<span id="cb79-1955"><a href="#cb79-1955" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> [<span class="op">-</span><span class="dv">10</span><span class="op">,</span><span class="st">'?'</span>]<span class="op">,</span></span>
<span id="cb79-1956"><a href="#cb79-1956" aria-hidden="true" tabindex="-1"></a>      <span class="st">"on"</span><span class="op">:</span> [{<span class="st">"events"</span><span class="op">:</span> <span class="st">"@h2:mouseover"</span><span class="op">,</span> <span class="st">"update"</span><span class="op">:</span> <span class="st">"[datum.step_in]"</span>}<span class="op">,</span>{<span class="st">"events"</span><span class="op">:</span> <span class="st">"@v2:mouseover"</span><span class="op">,</span> <span class="st">"update"</span><span class="op">:</span> <span class="st">"[datum.step_in]"</span><span class="op">,</span>}]</span>
<span id="cb79-1957"><a href="#cb79-1957" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb79-1958"><a href="#cb79-1958" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb79-1959"><a href="#cb79-1959" aria-hidden="true" tabindex="-1"></a>      <span class="st">"name"</span><span class="op">:</span> <span class="st">"rhv"</span><span class="op">,</span></span>
<span id="cb79-1960"><a href="#cb79-1960" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="op">-</span><span class="dv">10</span><span class="op">,</span></span>
<span id="cb79-1961"><a href="#cb79-1961" aria-hidden="true" tabindex="-1"></a>      <span class="st">"on"</span><span class="op">:</span> [{<span class="st">"events"</span><span class="op">:</span> <span class="st">"@h2:click"</span><span class="op">,</span> <span class="st">"update"</span><span class="op">:</span> <span class="st">"datum.step_in"</span>}]</span>
<span id="cb79-1962"><a href="#cb79-1962" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb79-1963"><a href="#cb79-1963" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb79-1964"><a href="#cb79-1964" aria-hidden="true" tabindex="-1"></a>      <span class="st">"name"</span><span class="op">:</span> <span class="st">"rvv"</span><span class="op">,</span></span>
<span id="cb79-1965"><a href="#cb79-1965" aria-hidden="true" tabindex="-1"></a>      <span class="dt">value</span><span class="op">:</span> <span class="op">-</span><span class="dv">10</span><span class="op">,</span></span>
<span id="cb79-1966"><a href="#cb79-1966" aria-hidden="true" tabindex="-1"></a>      <span class="st">"on"</span><span class="op">:</span> [{<span class="st">"events"</span><span class="op">:</span> <span class="st">"@v2:click"</span><span class="op">,</span> <span class="st">"update"</span><span class="op">:</span> <span class="st">"datum.step_in"</span>}]</span>
<span id="cb79-1967"><a href="#cb79-1967" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb79-1968"><a href="#cb79-1968" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb79-1969"><a href="#cb79-1969" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scales</span><span class="op">:</span> [</span>
<span id="cb79-1970"><a href="#cb79-1970" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">name</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"linear"</span><span class="op">,</span> <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">8</span>]<span class="op">,</span> <span class="dt">range</span><span class="op">:</span> <span class="st">"width"</span> }<span class="op">,</span></span>
<span id="cb79-1971"><a href="#cb79-1971" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">name</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"linear"</span><span class="op">,</span> <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">8</span>]<span class="op">,</span> <span class="dt">range</span><span class="op">:</span> <span class="st">"height"</span><span class="op">,</span> <span class="dt">reverse</span><span class="op">:</span> <span class="kw">true</span> }<span class="op">,</span></span>
<span id="cb79-1972"><a href="#cb79-1972" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">name</span><span class="op">:</span> <span class="st">"hit"</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"ordinal"</span><span class="op">,</span> <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>]<span class="op">,</span> <span class="dt">range</span><span class="op">:</span> [<span class="fl">0.01</span><span class="op">,</span> <span class="fl">0.1</span>] }<span class="op">,</span></span>
<span id="cb79-1973"><a href="#cb79-1973" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">name</span><span class="op">:</span> <span class="st">"length"</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"linear"</span><span class="op">,</span> <span class="dt">domain</span><span class="op">:</span> [<span class="dv">2</span><span class="op">,</span> <span class="dv">8</span>]<span class="op">,</span> <span class="dt">range</span><span class="op">:</span> [<span class="dv">1000</span><span class="op">,</span> <span class="dv">10</span>]  }<span class="op">,</span></span>
<span id="cb79-1974"><a href="#cb79-1974" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">name</span><span class="op">:</span> <span class="st">"length2"</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"linear"</span><span class="op">,</span> <span class="dt">domain</span><span class="op">:</span> [<span class="dv">2</span><span class="op">,</span> <span class="dv">6</span>]<span class="op">,</span> <span class="dt">range</span><span class="op">:</span> [<span class="dv">1000</span><span class="op">,</span> <span class="dv">0</span>]  }<span class="op">,</span></span>
<span id="cb79-1975"><a href="#cb79-1975" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">name</span><span class="op">:</span> <span class="st">"map_lookup"</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">"ordinal"</span><span class="op">,</span> <span class="dt">domain</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span>]<span class="op">,</span> <span class="dt">range</span><span class="op">:</span> [<span class="st">"white"</span><span class="op">,</span> <span class="st">"hsl(250, 76%, 60%)"</span><span class="op">,</span><span class="st">"hsl(200, 76%, 60%)"</span><span class="op">,</span><span class="st">"hsl(100, 76%, 60%)"</span>] }</span>
<span id="cb79-1976"><a href="#cb79-1976" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb79-1977"><a href="#cb79-1977" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [</span>
<span id="cb79-1978"><a href="#cb79-1978" aria-hidden="true" tabindex="-1"></a>    map_spec<span class="op">,</span></span>
<span id="cb79-1979"><a href="#cb79-1979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1980"><a href="#cb79-1980" aria-hidden="true" tabindex="-1"></a>    fov_spec<span class="op">,</span></span>
<span id="cb79-1981"><a href="#cb79-1981" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>(show_ray <span class="op">&amp;&amp;</span> show_ray_h <span class="op">?</span> ray_h_spec <span class="op">:</span> [])<span class="op">,</span></span>
<span id="cb79-1982"><a href="#cb79-1982" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>(show_ray <span class="op">&amp;&amp;</span> show_ray_v <span class="op">?</span> ray_v_spec <span class="op">:</span> [])<span class="op">,</span></span>
<span id="cb79-1983"><a href="#cb79-1983" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>(show_ray <span class="op">?</span> rays <span class="op">:</span> [])<span class="op">,</span></span>
<span id="cb79-1984"><a href="#cb79-1984" aria-hidden="true" tabindex="-1"></a>    player_spec<span class="op">,</span></span>
<span id="cb79-1985"><a href="#cb79-1985" aria-hidden="true" tabindex="-1"></a>    <span class="op">...</span>(show_ray <span class="op">&amp;&amp;</span> show_ray_steps <span class="op">?</span> ray_steps_spec <span class="op">:</span> [])<span class="op">,</span></span>
<span id="cb79-1986"><a href="#cb79-1986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1987"><a href="#cb79-1987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1988"><a href="#cb79-1988" aria-hidden="true" tabindex="-1"></a><span class="op">...</span>(show_ray <span class="op">&amp;&amp;</span> show_ray_h <span class="op">?</span> [{</span>
<span id="cb79-1989"><a href="#cb79-1989" aria-hidden="true" tabindex="-1"></a>      <span class="co">// HORIZONTAL REDS</span></span>
<span id="cb79-1990"><a href="#cb79-1990" aria-hidden="true" tabindex="-1"></a>      <span class="dt">from</span><span class="op">:</span> { <span class="dt">data</span><span class="op">:</span> <span class="st">"ray_h_data"</span> }<span class="op">,</span></span>
<span id="cb79-1991"><a href="#cb79-1991" aria-hidden="true" tabindex="-1"></a>      <span class="dt">name</span><span class="op">:</span> <span class="st">'h2'</span><span class="op">,</span></span>
<span id="cb79-1992"><a href="#cb79-1992" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"symbol"</span><span class="op">,</span></span>
<span id="cb79-1993"><a href="#cb79-1993" aria-hidden="true" tabindex="-1"></a>      <span class="dt">encode</span><span class="op">:</span> {</span>
<span id="cb79-1994"><a href="#cb79-1994" aria-hidden="true" tabindex="-1"></a>        <span class="dt">enter</span><span class="op">:</span> {</span>
<span id="cb79-1995"><a href="#cb79-1995" aria-hidden="true" tabindex="-1"></a>          <span class="dt">opacity</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="fl">0.1</span> }<span class="op">,</span></span>
<span id="cb79-1996"><a href="#cb79-1996" aria-hidden="true" tabindex="-1"></a>          <span class="co">//opacity: { field: "if_ray_hit_horizontal", scale: "hit" },</span></span>
<span id="cb79-1997"><a href="#cb79-1997" aria-hidden="true" tabindex="-1"></a>          <span class="dt">x</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"datum.rhx-0.05*0"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span></span>
<span id="cb79-1998"><a href="#cb79-1998" aria-hidden="true" tabindex="-1"></a>          <span class="dt">y</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"datum.rhy-0.05*0"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }<span class="op">,</span></span>
<span id="cb79-1999"><a href="#cb79-1999" aria-hidden="true" tabindex="-1"></a>          <span class="dt">size</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">600</span> }<span class="op">,</span></span>
<span id="cb79-2000"><a href="#cb79-2000" aria-hidden="true" tabindex="-1"></a>          <span class="co">//fill: { value: "red" },</span></span>
<span id="cb79-2001"><a href="#cb79-2001" aria-hidden="true" tabindex="-1"></a>          <span class="dt">angle</span><span class="op">:</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">45</span>}<span class="op">,</span></span>
<span id="cb79-2002"><a href="#cb79-2002" aria-hidden="true" tabindex="-1"></a>          <span class="dt">shape</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"cross"</span> }<span class="op">,</span></span>
<span id="cb79-2003"><a href="#cb79-2003" aria-hidden="true" tabindex="-1"></a>          <span class="dt">stroke</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"black"</span>}<span class="op">,</span></span>
<span id="cb79-2004"><a href="#cb79-2004" aria-hidden="true" tabindex="-1"></a>          <span class="dt">strokeWidth</span><span class="op">:</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">2</span>}<span class="op">,</span></span>
<span id="cb79-2005"><a href="#cb79-2005" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb79-2006"><a href="#cb79-2006" aria-hidden="true" tabindex="-1"></a>        <span class="dt">update</span><span class="op">:</span> {</span>
<span id="cb79-2007"><a href="#cb79-2007" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fill</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"(datum.step_in == step_in[0]) ? 'pink' : null"</span>}<span class="op">,</span><span class="co">//, scale: "hit" },</span></span>
<span id="cb79-2008"><a href="#cb79-2008" aria-hidden="true" tabindex="-1"></a>          <span class="dt">opacity</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"(datum.step_in == step_in[0]) ? 1 : 0.1"</span>}<span class="op">,</span><span class="co">//, scale: "hit" },</span></span>
<span id="cb79-2009"><a href="#cb79-2009" aria-hidden="true" tabindex="-1"></a>          <span class="co">//stroke: { signal: "(datum.step_in == step_in[0]) ? 'black' : null"},//, scale: "hit" },</span></span>
<span id="cb79-2010"><a href="#cb79-2010" aria-hidden="true" tabindex="-1"></a>          <span class="dt">x</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"datum.rhx-0.05*0"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span></span>
<span id="cb79-2011"><a href="#cb79-2011" aria-hidden="true" tabindex="-1"></a>          <span class="dt">y</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"datum.rhy-0.05*0"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }<span class="op">,</span></span>
<span id="cb79-2012"><a href="#cb79-2012" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb79-2013"><a href="#cb79-2013" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb79-2014"><a href="#cb79-2014" aria-hidden="true" tabindex="-1"></a>    }] <span class="op">:</span> [])<span class="op">,</span></span>
<span id="cb79-2015"><a href="#cb79-2015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-2016"><a href="#cb79-2016" aria-hidden="true" tabindex="-1"></a><span class="op">...</span>(show_ray <span class="op">&amp;&amp;</span> show_ray_v <span class="op">?</span> [{</span>
<span id="cb79-2017"><a href="#cb79-2017" aria-hidden="true" tabindex="-1"></a>      <span class="co">// VERTICAL GREENS</span></span>
<span id="cb79-2018"><a href="#cb79-2018" aria-hidden="true" tabindex="-1"></a>      <span class="dt">from</span><span class="op">:</span> { <span class="dt">data</span><span class="op">:</span> <span class="st">"ray_v_data"</span> }<span class="op">,</span></span>
<span id="cb79-2019"><a href="#cb79-2019" aria-hidden="true" tabindex="-1"></a>      <span class="dt">name</span><span class="op">:</span> <span class="st">'v2'</span><span class="op">,</span></span>
<span id="cb79-2020"><a href="#cb79-2020" aria-hidden="true" tabindex="-1"></a>      <span class="dt">type</span><span class="op">:</span> <span class="st">"symbol"</span><span class="op">,</span></span>
<span id="cb79-2021"><a href="#cb79-2021" aria-hidden="true" tabindex="-1"></a>      <span class="dt">encode</span><span class="op">:</span> {</span>
<span id="cb79-2022"><a href="#cb79-2022" aria-hidden="true" tabindex="-1"></a>        <span class="dt">enter</span><span class="op">:</span> {</span>
<span id="cb79-2023"><a href="#cb79-2023" aria-hidden="true" tabindex="-1"></a>          <span class="dt">opacity</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="fl">0.1</span> }<span class="op">,</span></span>
<span id="cb79-2024"><a href="#cb79-2024" aria-hidden="true" tabindex="-1"></a>          <span class="co">//opacity: { field: "if_ray_hit_horizontal", scale: "hit" },</span></span>
<span id="cb79-2025"><a href="#cb79-2025" aria-hidden="true" tabindex="-1"></a>          <span class="dt">x</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"datum.rvx+0.05*0"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span></span>
<span id="cb79-2026"><a href="#cb79-2026" aria-hidden="true" tabindex="-1"></a>          <span class="dt">y</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"datum.rvy+0.05*0"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }<span class="op">,</span></span>
<span id="cb79-2027"><a href="#cb79-2027" aria-hidden="true" tabindex="-1"></a>          <span class="dt">size</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="dv">600</span> }<span class="op">,</span></span>
<span id="cb79-2028"><a href="#cb79-2028" aria-hidden="true" tabindex="-1"></a>          <span class="co">//fill: { value: "red" },</span></span>
<span id="cb79-2029"><a href="#cb79-2029" aria-hidden="true" tabindex="-1"></a>          <span class="dt">angle</span><span class="op">:</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">45</span>}<span class="op">,</span></span>
<span id="cb79-2030"><a href="#cb79-2030" aria-hidden="true" tabindex="-1"></a>          <span class="dt">shape</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"cross"</span> }<span class="op">,</span></span>
<span id="cb79-2031"><a href="#cb79-2031" aria-hidden="true" tabindex="-1"></a>          <span class="dt">stroke</span><span class="op">:</span> { <span class="dt">value</span><span class="op">:</span> <span class="st">"black"</span>}<span class="op">,</span></span>
<span id="cb79-2032"><a href="#cb79-2032" aria-hidden="true" tabindex="-1"></a>          <span class="dt">strokeWidth</span><span class="op">:</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">2</span>}<span class="op">,</span></span>
<span id="cb79-2033"><a href="#cb79-2033" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb79-2034"><a href="#cb79-2034" aria-hidden="true" tabindex="-1"></a>        <span class="dt">update</span><span class="op">:</span> {</span>
<span id="cb79-2035"><a href="#cb79-2035" aria-hidden="true" tabindex="-1"></a>          <span class="dt">fill</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"(datum.step_in == step_in[0]) ? 'pink' : null"</span>}<span class="op">,</span><span class="co">//, scale: "hit" },</span></span>
<span id="cb79-2036"><a href="#cb79-2036" aria-hidden="true" tabindex="-1"></a>          <span class="dt">opacity</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"(datum.step_in == step_in[0]) ? 1 : 0.1"</span>}<span class="op">,</span><span class="co">//, scale: "hit" },</span></span>
<span id="cb79-2037"><a href="#cb79-2037" aria-hidden="true" tabindex="-1"></a>          <span class="co">//stroke: { signal: "(datum.step_in == step_in[0]) ? 'black' : null"},//, scale: "hit" },</span></span>
<span id="cb79-2038"><a href="#cb79-2038" aria-hidden="true" tabindex="-1"></a>          <span class="dt">x</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"datum.rvx+0.05*0"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span> }<span class="op">,</span></span>
<span id="cb79-2039"><a href="#cb79-2039" aria-hidden="true" tabindex="-1"></a>          <span class="dt">y</span><span class="op">:</span> { <span class="dt">signal</span><span class="op">:</span> <span class="st">"datum.rvy+0.05*0"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span> }<span class="op">,</span></span>
<span id="cb79-2040"><a href="#cb79-2040" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb79-2041"><a href="#cb79-2041" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb79-2042"><a href="#cb79-2042" aria-hidden="true" tabindex="-1"></a>    }] <span class="op">:</span> [])</span>
<span id="cb79-2043"><a href="#cb79-2043" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb79-2044"><a href="#cb79-2044" aria-hidden="true" tabindex="-1"></a>  <span class="dt">axes</span><span class="op">:</span> [</span>
<span id="cb79-2045"><a href="#cb79-2045" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">orient</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> <span class="dt">labelFontSize</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dt">labelColor</span><span class="op">:</span> <span class="st">'blue'</span>}<span class="op">,</span></span>
<span id="cb79-2046"><a href="#cb79-2046" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">orient</span><span class="op">:</span> <span class="st">"left"</span><span class="op">,</span> <span class="dt">scale</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="dt">labelFontSize</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dt">labelColor</span><span class="op">:</span> <span class="st">'blue'</span>}</span>
<span id="cb79-2047"><a href="#cb79-2047" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb79-2048"><a href="#cb79-2048" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb79-2049"><a href="#cb79-2049" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-2050"><a href="#cb79-2050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-2051"><a href="#cb79-2051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-2052"><a href="#cb79-2052" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`&lt;style&gt;</span></span>
<span id="cb79-2053"><a href="#cb79-2053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-2054"><a href="#cb79-2054" aria-hidden="true" tabindex="-1"></a><span class="vs">.modeldept {</span></span>
<span id="cb79-2055"><a href="#cb79-2055" aria-hidden="true" tabindex="-1"></a><span class="vs">  display: none;</span></span>
<span id="cb79-2056"><a href="#cb79-2056" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb79-2057"><a href="#cb79-2057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-2058"><a href="#cb79-2058" aria-hidden="true" tabindex="-1"></a><span class="vs">#</span><span class="sc">${</span>modelname<span class="sc">}</span><span class="vs">.modeldept {</span></span>
<span id="cb79-2059"><a href="#cb79-2059" aria-hidden="true" tabindex="-1"></a><span class="vs">  display: block;</span></span>
<span id="cb79-2060"><a href="#cb79-2060" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb79-2061"><a href="#cb79-2061" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;/style&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-19" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-20" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-21" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-22" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-23" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-24" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-25" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-26" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-27" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-28" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-29" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-30" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-31" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-32" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb80" data-startfrom="2065" data-source-offset="-14425"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2064;"><span id="cb80-2065"><a href="#cb80-2065" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb80-2066"><a href="#cb80-2066" aria-hidden="true" tabindex="-1"></a>    savings_viz<span class="op">.</span><span class="fu">addSignalListener</span>(<span class="st">'doubleclick'</span><span class="op">,</span> _ <span class="kw">=&gt;</span> {</span>
<span id="cb80-2067"><a href="#cb80-2067" aria-hidden="true" tabindex="-1"></a>      <span class="kw">set</span>(viewof overlay<span class="op">,</span> <span class="kw">true</span>)</span>
<span id="cb80-2068"><a href="#cb80-2068" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb80-2069"><a href="#cb80-2069" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-15-33" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
</div>
<div id="savings" class="modeldept html-fill-item html-fill-container">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb81" data-startfrom="2079" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2078;"><span id="cb81-2079"><a href="#cb81-2079" aria-hidden="true" tabindex="-1"></a>mutable savings_data0 <span class="op">=</span> []</span>
<span id="cb81-2080"><a href="#cb81-2080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-2081"><a href="#cb81-2081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-2082"><a href="#cb81-2082" aria-hidden="true" tabindex="-1"></a>savings_spec <span class="op">=</span> { <span class="cf">return</span> ({</span>
<span id="cb81-2083"><a href="#cb81-2083" aria-hidden="true" tabindex="-1"></a>  <span class="co">//width: 'container', height:'container', bad for mobile</span></span>
<span id="cb81-2084"><a href="#cb81-2084" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="st">'container'</span><span class="op">,</span> <span class="dt">height</span><span class="op">:</span> <span class="dv">350</span><span class="op">,</span></span>
<span id="cb81-2085"><a href="#cb81-2085" aria-hidden="true" tabindex="-1"></a>  <span class="st">"data"</span><span class="op">:</span> {<span class="st">"name"</span><span class="op">:</span> <span class="st">"source"</span>}<span class="op">,</span></span>
<span id="cb81-2086"><a href="#cb81-2086" aria-hidden="true" tabindex="-1"></a>  <span class="dt">datasets</span><span class="op">:</span> {<span class="st">'source'</span><span class="op">:</span> savings_data0 }<span class="op">,</span></span>
<span id="cb81-2087"><a href="#cb81-2087" aria-hidden="true" tabindex="-1"></a>  <span class="dt">mark</span><span class="op">:</span> { <span class="dt">type</span><span class="op">:</span> <span class="st">'text'</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dt">tooltip</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="st">"fontWeight"</span><span class="op">:</span> <span class="st">"bold"</span>}<span class="op">,</span></span>
<span id="cb81-2088"><a href="#cb81-2088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-2089"><a href="#cb81-2089" aria-hidden="true" tabindex="-1"></a>  <span class="dt">encoding</span><span class="op">:</span> {</span>
<span id="cb81-2090"><a href="#cb81-2090" aria-hidden="true" tabindex="-1"></a>    <span class="st">"x"</span><span class="op">:</span> {</span>
<span id="cb81-2091"><a href="#cb81-2091" aria-hidden="true" tabindex="-1"></a>      <span class="st">"field"</span><span class="op">:</span> <span class="st">"formula"</span><span class="op">,</span></span>
<span id="cb81-2092"><a href="#cb81-2092" aria-hidden="true" tabindex="-1"></a>      <span class="st">"type"</span><span class="op">:</span> <span class="st">"nominal"</span><span class="op">,</span></span>
<span id="cb81-2093"><a href="#cb81-2093" aria-hidden="true" tabindex="-1"></a>      <span class="st">"axis"</span><span class="op">:</span> {<span class="st">"labelAngle"</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="st">"orient"</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="dt">title</span><span class="op">:</span><span class="kw">null</span><span class="op">,</span> <span class="st">"labelLimit"</span><span class="op">:</span> <span class="dv">300</span><span class="op">,</span> <span class="dt">labelFontSize</span><span class="op">:</span> <span class="dv">30</span>}</span>
<span id="cb81-2094"><a href="#cb81-2094" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb81-2095"><a href="#cb81-2095" aria-hidden="true" tabindex="-1"></a>        <span class="dt">color</span><span class="op">:</span> {<span class="dt">field</span><span class="op">:</span> <span class="st">'formula'</span><span class="op">,</span> <span class="dt">legend</span><span class="op">:</span> <span class="kw">false</span>}<span class="op">,</span></span>
<span id="cb81-2096"><a href="#cb81-2096" aria-hidden="true" tabindex="-1"></a>    <span class="dt">y</span><span class="op">:</span> {<span class="dt">field</span><span class="op">:</span> <span class="st">'year_in'</span><span class="op">,</span> <span class="dt">axis</span><span class="op">:</span> {<span class="dt">titleFontSize</span><span class="op">:</span><span class="dv">20</span><span class="op">,</span> <span class="dt">labelFontSize</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span> }}<span class="op">,</span></span>
<span id="cb81-2097"><a href="#cb81-2097" aria-hidden="true" tabindex="-1"></a>    <span class="dt">text</span><span class="op">:</span> {<span class="dt">field</span><span class="op">:</span> <span class="st">'value'</span><span class="co">/*, format:',.2f'*/</span>}</span>
<span id="cb81-2098"><a href="#cb81-2098" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb81-2099"><a href="#cb81-2099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-2100"><a href="#cb81-2100" aria-hidden="true" tabindex="-1"></a>  <span class="dt">params</span><span class="op">:</span> [</span>
<span id="cb81-2101"><a href="#cb81-2101" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb81-2102"><a href="#cb81-2102" aria-hidden="true" tabindex="-1"></a>      <span class="dt">name</span><span class="op">:</span> <span class="st">"formula"</span><span class="op">,</span></span>
<span id="cb81-2103"><a href="#cb81-2103" aria-hidden="true" tabindex="-1"></a>      <span class="co">//value: { ray_angle_in: 0 },</span></span>
<span id="cb81-2104"><a href="#cb81-2104" aria-hidden="true" tabindex="-1"></a>      <span class="dt">select</span><span class="op">:</span> {</span>
<span id="cb81-2105"><a href="#cb81-2105" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"point"</span><span class="op">,</span></span>
<span id="cb81-2106"><a href="#cb81-2106" aria-hidden="true" tabindex="-1"></a>        <span class="co">//on: "mousemove{0,50}",</span></span>
<span id="cb81-2107"><a href="#cb81-2107" aria-hidden="true" tabindex="-1"></a>        <span class="dt">on</span><span class="op">:</span> <span class="st">"mouseup, touchup, [mousedown, mouseup] &gt; mousemove"</span><span class="op">,</span></span>
<span id="cb81-2108"><a href="#cb81-2108" aria-hidden="true" tabindex="-1"></a>        <span class="co">//on: "[touchdown, touchup] &gt; touchmove, [mousedown, mouseup] &gt; mousemove", //{10, 100}",</span></span>
<span id="cb81-2109"><a href="#cb81-2109" aria-hidden="true" tabindex="-1"></a>        <span class="co">//        on: "[mousedown, mouseup] &gt; mousemove",</span></span>
<span id="cb81-2110"><a href="#cb81-2110" aria-hidden="true" tabindex="-1"></a>        <span class="dt">nearest</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb81-2111"><a href="#cb81-2111" aria-hidden="true" tabindex="-1"></a>        <span class="dt">toggle</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb81-2112"><a href="#cb81-2112" aria-hidden="true" tabindex="-1"></a>        <span class="dt">clear</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb81-2113"><a href="#cb81-2113" aria-hidden="true" tabindex="-1"></a>        <span class="dt">encodings</span><span class="op">:</span> [<span class="st">"x"</span><span class="op">,</span> <span class="st">"y"</span>]</span>
<span id="cb81-2114"><a href="#cb81-2114" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb81-2115"><a href="#cb81-2115" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb81-2116"><a href="#cb81-2116" aria-hidden="true" tabindex="-1"></a>  ]</span>
<span id="cb81-2117"><a href="#cb81-2117" aria-hidden="true" tabindex="-1"></a>}) }</span>
<span id="cb81-2118"><a href="#cb81-2118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-2119"><a href="#cb81-2119" aria-hidden="true" tabindex="-1"></a>savings_data <span class="op">=</span> <span class="fu">calcuvegadata</span>({</span>
<span id="cb81-2120"><a href="#cb81-2120" aria-hidden="true" tabindex="-1"></a>  <span class="dt">models</span><span class="op">:</span> [savings]<span class="op">,</span></span>
<span id="cb81-2121"><a href="#cb81-2121" aria-hidden="true" tabindex="-1"></a>  <span class="dt">spec</span><span class="op">:</span> savings_spec<span class="op">,</span></span>
<span id="cb81-2122"><a href="#cb81-2122" aria-hidden="true" tabindex="-1"></a>  <span class="dt">domains</span><span class="op">:</span> {</span>
<span id="cb81-2123"><a href="#cb81-2123" aria-hidden="true" tabindex="-1"></a>    <span class="dt">year_in</span><span class="op">:</span> _<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span>duration_in<span class="op">+</span><span class="fl">0.1</span>)<span class="op">,</span></span>
<span id="cb81-2124"><a href="#cb81-2124" aria-hidden="true" tabindex="-1"></a>    <span class="dt">formula</span><span class="op">:</span> [<span class="st">'balance'</span><span class="op">,</span> <span class="st">'interest'</span><span class="op">,</span> <span class="st">'deposits'</span>]</span>
<span id="cb81-2125"><a href="#cb81-2125" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb81-2126"><a href="#cb81-2126" aria-hidden="true" tabindex="-1"></a>  <span class="dt">input_cursors</span><span class="op">:</span> [{duration_in<span class="op">,</span>interest_rate_in<span class="op">,</span>annual_payment_in}]</span>
<span id="cb81-2127"><a href="#cb81-2127" aria-hidden="true" tabindex="-1"></a>})<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({<span class="op">...</span>d<span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="fu">fmt2</span>(d<span class="op">.</span><span class="at">formula</span><span class="op">,</span> d<span class="op">.</span><span class="at">value</span>)})) <span class="co">// fmt2 doesn't matter in this case</span></span>
<span id="cb81-2128"><a href="#cb81-2128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-2129"><a href="#cb81-2129" aria-hidden="true" tabindex="-1"></a><span class="co">//Inputs.table(savings_data)</span></span>
<span id="cb81-2130"><a href="#cb81-2130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-2131"><a href="#cb81-2131" aria-hidden="true" tabindex="-1"></a>viewof savings_viz <span class="op">=</span> <span class="fu">embed</span>(savings_spec<span class="op">,</span> {<span class="dt">renderer</span><span class="op">:</span><span class="st">'svg'</span><span class="op">,</span> actions<span class="op">,</span></span>
<span id="cb81-2132"><a href="#cb81-2132" aria-hidden="true" tabindex="-1"></a><span class="dt">patch</span><span class="op">:</span> s <span class="kw">=&gt;</span> {s<span class="op">.</span><span class="at">signals</span><span class="op">.</span><span class="fu">push</span>({</span>
<span id="cb81-2133"><a href="#cb81-2133" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-2134"><a href="#cb81-2134" aria-hidden="true" tabindex="-1"></a>    <span class="dt">name</span><span class="op">:</span> <span class="st">"doubleclick"</span><span class="op">,</span></span>
<span id="cb81-2135"><a href="#cb81-2135" aria-hidden="true" tabindex="-1"></a>    <span class="dt">value</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb81-2136"><a href="#cb81-2136" aria-hidden="true" tabindex="-1"></a>      <span class="st">"on"</span><span class="op">:</span> [{<span class="st">"events"</span><span class="op">:</span> <span class="st">"dblclick"</span><span class="op">,</span> <span class="st">"update"</span><span class="op">:</span> <span class="st">"datum"</span>}]</span>
<span id="cb81-2137"><a href="#cb81-2137" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-2138"><a href="#cb81-2138" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb81-2139"><a href="#cb81-2139" aria-hidden="true" tabindex="-1"></a> <span class="cf">return</span> s}</span>
<span id="cb81-2140"><a href="#cb81-2140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-2141"><a href="#cb81-2141" aria-hidden="true" tabindex="-1"></a>  })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-16-1" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-16-2" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-16-3" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-16-4" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
<style>


/*body {
  height: 100vh;
}*/

.pc {
  height: 100%;
}


/*.vega-embed {
  width: 100%;
  height: calc(100%);
}*/

/* svg, .chart-wrapper, .vega-embed, .vega-embed-wrapper, .observablehq, .ojs-cell-2-2, .html-fill-item, .cell-output, .card, .bslib-grid, .bslib-card { */
/*#savings .chart-wrapper, .vega-embed, .vega-embed-wrapper, #savings .observablehq, #savings .html-fill-item {
  height:80%
}*/

.cell-output, .card, .bslib-grid, .marks.svg, .chart-wrapper, .vega-embed, .vega-embed-wrapper {
  /*height: 100%*/
}




  </style>
<div class="cell hidden html-fill-item html-fill-container">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb82" data-startfrom="2184" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2183;"><span id="cb82-2184"><a href="#cb82-2184" aria-hidden="true" tabindex="-1"></a>htl<span class="op">.</span><span class="fu">html</span><span class="vs">`&lt;button onclick=</span><span class="sc">${</span>() <span class="kw">=&gt;</span> (mutable savings_data0 <span class="op">=</span> savings_data)<span class="sc">}</span><span class="vs">&gt;insert data -&gt; vega editor (dev)&lt;/button&gt;`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-17-1" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb83" data-startfrom="2187" data-source-offset="-119"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2186;"><span id="cb83-2187"><a href="#cb83-2187" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb83-2188"><a href="#cb83-2188" aria-hidden="true" tabindex="-1"></a>  savings_viz<span class="op">;</span> <span class="co">// force resize event on load or user sees nothing</span></span>
<span id="cb83-2189"><a href="#cb83-2189" aria-hidden="true" tabindex="-1"></a>  <span class="co">// see limitations here: https://vega.github.io/vega-lite/docs/size.html#specifying-responsive-width-and-height</span></span>
<span id="cb83-2190"><a href="#cb83-2190" aria-hidden="true" tabindex="-1"></a>  <span class="bu">window</span><span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">Event</span>(<span class="st">'resize'</span>))</span>
<span id="cb83-2191"><a href="#cb83-2191" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-17-2" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb84" data-startfrom="2194" data-source-offset="-349"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2193;"><span id="cb84-2194"><a href="#cb84-2194" aria-hidden="true" tabindex="-1"></a>savings_viz<span class="op">.</span><span class="fu">addSignalListener</span>(<span class="st">"formula"</span><span class="op">,</span> (a<span class="op">,</span> b) <span class="kw">=&gt;</span> {</span>
<span id="cb84-2195"><a href="#cb84-2195" aria-hidden="true" tabindex="-1"></a>  <span class="co">/*viewof aa.value = b.ray_angle_in; //scene.signal("ray_angle_in");</span></span>
<span id="cb84-2196"><a href="#cb84-2196" aria-hidden="true" tabindex="-1"></a><span class="co">  viewof aa.dispatchEvent(new CustomEvent("input", { bubbles: true }));</span></span>
<span id="cb84-2197"><a href="#cb84-2197" aria-hidden="true" tabindex="-1"></a><span class="co">  */</span></span>
<span id="cb84-2198"><a href="#cb84-2198" aria-hidden="true" tabindex="-1"></a> <span class="co">//if (b.ray_angle_in[0] !== ray_angle_in) {</span></span>
<span id="cb84-2199"><a href="#cb84-2199" aria-hidden="true" tabindex="-1"></a>  <span class="co">//console.log(b.ray_angle_in[0], ray_angle_in, b.ray_angle_in[0] !== ray_angle_in)</span></span>
<span id="cb84-2200"><a href="#cb84-2200" aria-hidden="true" tabindex="-1"></a> <span class="co">//viewof ray_angle_in.value = b.ray_angle_in[0]; //scene.signal("ray_angle_in");</span></span>
<span id="cb84-2201"><a href="#cb84-2201" aria-hidden="true" tabindex="-1"></a> <span class="co">// viewof ray_angle_in.dispatchEvent(</span></span>
<span id="cb84-2202"><a href="#cb84-2202" aria-hidden="true" tabindex="-1"></a> <span class="co">//   new CustomEvent("input", { bubbles: true })</span></span>
<span id="cb84-2203"><a href="#cb84-2203" aria-hidden="true" tabindex="-1"></a>  <span class="co">//);</span></span>
<span id="cb84-2204"><a href="#cb84-2204" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span>(viewof formulae_visible<span class="op">,</span> [b<span class="op">.</span><span class="at">formula</span>[<span class="dv">0</span>]])</span>
<span id="cb84-2205"><a href="#cb84-2205" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span>(viewof year_in<span class="op">,</span> b<span class="op">.</span><span class="at">year_in</span>[<span class="dv">0</span>])</span>
<span id="cb84-2206"><a href="#cb84-2206" aria-hidden="true" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'.calculang_f_'</span><span class="op">+</span>b<span class="op">.</span><span class="at">formula</span>[<span class="dv">0</span>])<span class="op">.</span><span class="fu">scrollIntoView</span>(scrollIntoViewOpts)</span>
<span id="cb84-2207"><a href="#cb84-2207" aria-hidden="true" tabindex="-1"></a> <span class="co">//}</span></span>
<span id="cb84-2208"><a href="#cb84-2208" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-17-3" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb85" data-startfrom="2211" data-source-offset="-1040"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2210;"><span id="cb85-2211"><a href="#cb85-2211" aria-hidden="true" tabindex="-1"></a>savings_actualator<span class="op">.</span><span class="fu">addSignalListener</span>(<span class="st">"formula"</span><span class="op">,</span> (a<span class="op">,</span> b) <span class="kw">=&gt;</span> {</span>
<span id="cb85-2212"><a href="#cb85-2212" aria-hidden="true" tabindex="-1"></a>  <span class="co">/*viewof aa.value = b.ray_angle_in; //scene.signal("ray_angle_in");</span></span>
<span id="cb85-2213"><a href="#cb85-2213" aria-hidden="true" tabindex="-1"></a><span class="co">  viewof aa.dispatchEvent(new CustomEvent("input", { bubbles: true }));</span></span>
<span id="cb85-2214"><a href="#cb85-2214" aria-hidden="true" tabindex="-1"></a><span class="co">  */</span></span>
<span id="cb85-2215"><a href="#cb85-2215" aria-hidden="true" tabindex="-1"></a> <span class="co">//if (b.ray_angle_in[0] !== ray_angle_in) {</span></span>
<span id="cb85-2216"><a href="#cb85-2216" aria-hidden="true" tabindex="-1"></a>  <span class="co">//console.log(b.ray_angle_in[0], ray_angle_in, b.ray_angle_in[0] !== ray_angle_in)</span></span>
<span id="cb85-2217"><a href="#cb85-2217" aria-hidden="true" tabindex="-1"></a> <span class="co">//viewof ray_angle_in.value = b.ray_angle_in[0]; //scene.signal("ray_angle_in");</span></span>
<span id="cb85-2218"><a href="#cb85-2218" aria-hidden="true" tabindex="-1"></a> <span class="co">// viewof ray_angle_in.dispatchEvent(</span></span>
<span id="cb85-2219"><a href="#cb85-2219" aria-hidden="true" tabindex="-1"></a> <span class="co">//   new CustomEvent("input", { bubbles: true })</span></span>
<span id="cb85-2220"><a href="#cb85-2220" aria-hidden="true" tabindex="-1"></a>  <span class="co">//);</span></span>
<span id="cb85-2221"><a href="#cb85-2221" aria-hidden="true" tabindex="-1"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(b)</span>
<span id="cb85-2222"><a href="#cb85-2222" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span>(viewof formulae_visible<span class="op">,</span> [b<span class="op">.</span><span class="at">formula</span>[<span class="dv">0</span>]])</span>
<span id="cb85-2223"><a href="#cb85-2223" aria-hidden="true" tabindex="-1"></a>  <span class="kw">set</span>(viewof year_in<span class="op">,</span> b<span class="op">.</span><span class="at">year_in</span>[<span class="dv">0</span>])</span>
<span id="cb85-2224"><a href="#cb85-2224" aria-hidden="true" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'.calculang_f_'</span><span class="op">+</span>b<span class="op">.</span><span class="at">formula</span>[<span class="dv">0</span>])<span class="op">.</span><span class="fu">scrollIntoView</span>(scrollIntoViewOpts)</span>
<span id="cb85-2225"><a href="#cb85-2225" aria-hidden="true" tabindex="-1"></a> <span class="co">//}</span></span>
<span id="cb85-2226"><a href="#cb85-2226" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-17-4" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb86" data-startfrom="2236" data-source-offset="-1872"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2235;"><span id="cb86-2236"><a href="#cb86-2236" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb86-2237"><a href="#cb86-2237" aria-hidden="true" tabindex="-1"></a>  <span class="co">//scene.signal("ray_angle_in", ray_angle_in); causes infinite re-runs</span></span>
<span id="cb86-2238"><a href="#cb86-2238" aria-hidden="true" tabindex="-1"></a>  savings_viz<span class="op">.</span><span class="fu">data</span>(<span class="st">"source"</span><span class="op">,</span> savings_data)<span class="op">.</span><span class="fu">resize</span>()<span class="op">.</span><span class="fu">run</span>()<span class="op">;</span></span>
<span id="cb86-2239"><a href="#cb86-2239" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-17-5" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
</div>
<div id="starfield" class="modeldept html-fill-item html-fill-container">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb87" data-startfrom="2259" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2258;"><span id="cb87-2259"><a href="#cb87-2259" aria-hidden="true" tabindex="-1"></a>Inputs<span class="op">.</span><span class="fu">bind</span>(<span class="fu">Scrubber</span>(_<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span><span class="dv">60</span><span class="op">*</span><span class="dv">5</span>)<span class="op">,</span> {<span class="dt">autoplay</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="dt">delay</span><span class="op">:</span><span class="dv">50</span><span class="op">,</span> <span class="dt">label</span><span class="op">:</span><span class="st">'frame'</span><span class="op">,</span> <span class="dt">initial</span><span class="op">:</span> <span class="dv">2</span>})<span class="op">,</span> viewof frame_in)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-18-1" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb88" data-startfrom="2263" data-source-offset="-195"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2262;"><span id="cb88-2263"><a href="#cb88-2263" aria-hidden="true" tabindex="-1"></a>starfield_spec <span class="op">=</span> { <span class="cf">return</span> ({</span>
<span id="cb88-2264"><a href="#cb88-2264" aria-hidden="true" tabindex="-1"></a>  <span class="dt">background</span><span class="op">:</span> <span class="st">'black'</span><span class="op">,</span><span class="co">//'lightblue',</span></span>
<span id="cb88-2265"><a href="#cb88-2265" aria-hidden="true" tabindex="-1"></a>  <span class="st">"data"</span><span class="op">:</span> {<span class="st">"name"</span><span class="op">:</span> <span class="st">"data"</span>}<span class="op">,</span></span>
<span id="cb88-2266"><a href="#cb88-2266" aria-hidden="true" tabindex="-1"></a>  <span class="st">"datasets"</span><span class="op">:</span> { <span class="st">"data"</span><span class="op">:</span> starfield_data0}<span class="op">,</span></span>
<span id="cb88-2267"><a href="#cb88-2267" aria-hidden="true" tabindex="-1"></a>    <span class="st">"height"</span><span class="op">:</span> <span class="dv">500</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">500</span><span class="op">,</span></span>
<span id="cb88-2268"><a href="#cb88-2268" aria-hidden="true" tabindex="-1"></a>    <span class="dt">layer</span><span class="op">:</span> [{</span>
<span id="cb88-2269"><a href="#cb88-2269" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mark"</span><span class="op">:</span> {<span class="dt">type</span><span class="op">:</span> <span class="st">"point"</span><span class="op">,</span> <span class="dt">filled</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">tooltip</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="dt">clip</span><span class="op">:</span> <span class="kw">false</span>}<span class="op">,</span></span>
<span id="cb88-2270"><a href="#cb88-2270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-2271"><a href="#cb88-2271" aria-hidden="true" tabindex="-1"></a>  <span class="dt">params</span><span class="op">:</span> [</span>
<span id="cb88-2272"><a href="#cb88-2272" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb88-2273"><a href="#cb88-2273" aria-hidden="true" tabindex="-1"></a>      <span class="dt">name</span><span class="op">:</span> <span class="st">"star_select"</span><span class="op">,</span></span>
<span id="cb88-2274"><a href="#cb88-2274" aria-hidden="true" tabindex="-1"></a>      <span class="co">//value: { ray_angle_in: 0 },</span></span>
<span id="cb88-2275"><a href="#cb88-2275" aria-hidden="true" tabindex="-1"></a>      <span class="dt">select</span><span class="op">:</span> {</span>
<span id="cb88-2276"><a href="#cb88-2276" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">"point"</span><span class="op">,</span></span>
<span id="cb88-2277"><a href="#cb88-2277" aria-hidden="true" tabindex="-1"></a>        <span class="co">//on: "mousemove{0,50}",</span></span>
<span id="cb88-2278"><a href="#cb88-2278" aria-hidden="true" tabindex="-1"></a>        <span class="dt">on</span><span class="op">:</span> <span class="st">"mouseup, touchup, [mousedown, mouseup] &gt; mousemove"</span><span class="op">,</span></span>
<span id="cb88-2279"><a href="#cb88-2279" aria-hidden="true" tabindex="-1"></a>        <span class="co">//on: "[touchdown, touchup] &gt; touchmove, [mousedown, mouseup] &gt; mousemove", //{10, 100}",</span></span>
<span id="cb88-2280"><a href="#cb88-2280" aria-hidden="true" tabindex="-1"></a>        <span class="co">//        on: "[mousedown, mouseup] &gt; mousemove",</span></span>
<span id="cb88-2281"><a href="#cb88-2281" aria-hidden="true" tabindex="-1"></a>        <span class="dt">nearest</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb88-2282"><a href="#cb88-2282" aria-hidden="true" tabindex="-1"></a>        <span class="dt">toggle</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb88-2283"><a href="#cb88-2283" aria-hidden="true" tabindex="-1"></a>        <span class="dt">clear</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb88-2284"><a href="#cb88-2284" aria-hidden="true" tabindex="-1"></a>        <span class="co">//encodings: ["x", "y"]</span></span>
<span id="cb88-2285"><a href="#cb88-2285" aria-hidden="true" tabindex="-1"></a>        <span class="dt">fields</span><span class="op">:</span> [<span class="st">"star_in"</span>]</span>
<span id="cb88-2286"><a href="#cb88-2286" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb88-2287"><a href="#cb88-2287" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb88-2288"><a href="#cb88-2288" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb88-2289"><a href="#cb88-2289" aria-hidden="true" tabindex="-1"></a>    <span class="co">/*"params": [{</span></span>
<span id="cb88-2290"><a href="#cb88-2290" aria-hidden="true" tabindex="-1"></a><span class="co">      "name": "brush",</span></span>
<span id="cb88-2291"><a href="#cb88-2291" aria-hidden="true" tabindex="-1"></a><span class="co">       value: { x: [leap_year_start, leap_year_start+50]}, // initial value here fails whenever I switch to this model after loading a different one ... understand</span></span>
<span id="cb88-2292"><a href="#cb88-2292" aria-hidden="true" tabindex="-1"></a><span class="co">      //"value": {"year_in": [2000, 2010]},</span></span>
<span id="cb88-2293"><a href="#cb88-2293" aria-hidden="true" tabindex="-1"></a><span class="co">      "select": {"type": "interval", "encodings": ["x"]}</span></span>
<span id="cb88-2294"><a href="#cb88-2294" aria-hidden="true" tabindex="-1"></a><span class="co">    }],*/</span></span>
<span id="cb88-2295"><a href="#cb88-2295" aria-hidden="true" tabindex="-1"></a>    <span class="st">"encoding"</span><span class="op">:</span> {</span>
<span id="cb88-2296"><a href="#cb88-2296" aria-hidden="true" tabindex="-1"></a>      <span class="st">"x"</span><span class="op">:</span> {</span>
<span id="cb88-2297"><a href="#cb88-2297" aria-hidden="true" tabindex="-1"></a>        <span class="st">"field"</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span></span>
<span id="cb88-2298"><a href="#cb88-2298" aria-hidden="true" tabindex="-1"></a>        <span class="st">"type"</span><span class="op">:</span> <span class="st">"quantitative"</span><span class="op">,</span></span>
<span id="cb88-2299"><a href="#cb88-2299" aria-hidden="true" tabindex="-1"></a>        <span class="dt">scale</span><span class="op">:</span> {<span class="dt">zero</span><span class="op">:</span><span class="kw">false</span><span class="op">,</span> <span class="dt">nice</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="dt">domain</span><span class="op">:</span>[<span class="op">-</span><span class="dv">50</span><span class="op">,</span><span class="dv">50</span>]}<span class="op">,</span></span>
<span id="cb88-2300"><a href="#cb88-2300" aria-hidden="true" tabindex="-1"></a>        <span class="dt">axis</span><span class="op">:</span> {<span class="dt">format</span><span class="op">:</span><span class="st">".0f"</span><span class="op">,</span> <span class="dt">gridOpacity</span><span class="op">:</span><span class="fl">0.1</span><span class="op">,</span> <span class="dt">tickCount</span><span class="op">:</span><span class="dv">12</span><span class="op">,</span> <span class="dt">ticks</span><span class="op">:</span><span class="kw">true</span> }</span>
<span id="cb88-2301"><a href="#cb88-2301" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb88-2302"><a href="#cb88-2302" aria-hidden="true" tabindex="-1"></a>      <span class="st">"y"</span><span class="op">:</span> {</span>
<span id="cb88-2303"><a href="#cb88-2303" aria-hidden="true" tabindex="-1"></a>        <span class="st">"field"</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb88-2304"><a href="#cb88-2304" aria-hidden="true" tabindex="-1"></a>        <span class="st">"type"</span><span class="op">:</span> <span class="st">"quantitative"</span><span class="op">,</span></span>
<span id="cb88-2305"><a href="#cb88-2305" aria-hidden="true" tabindex="-1"></a>        <span class="dt">scale</span><span class="op">:</span> {<span class="dt">zero</span><span class="op">:</span><span class="kw">false</span><span class="op">,</span> <span class="dt">nice</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="dt">domain</span><span class="op">:</span>[<span class="op">-</span><span class="dv">50</span><span class="op">,</span><span class="dv">50</span>]}<span class="op">,</span></span>
<span id="cb88-2306"><a href="#cb88-2306" aria-hidden="true" tabindex="-1"></a>        <span class="st">"axis"</span><span class="op">:</span> { <span class="st">"grid"</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="dt">gridOpacity</span><span class="op">:</span><span class="fl">0.1</span><span class="op">,</span> <span class="dt">tickCount</span><span class="op">:</span><span class="dv">12</span><span class="op">,</span> <span class="dt">ticks</span><span class="op">:</span><span class="kw">true</span><span class="op">,</span> <span class="dt">format</span><span class="op">:</span> <span class="st">'.0f'</span>}</span>
<span id="cb88-2307"><a href="#cb88-2307" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb88-2308"><a href="#cb88-2308" aria-hidden="true" tabindex="-1"></a>      <span class="st">"size"</span><span class="op">:</span> {</span>
<span id="cb88-2309"><a href="#cb88-2309" aria-hidden="true" tabindex="-1"></a>        <span class="st">"field"</span><span class="op">:</span> <span class="st">"z"</span><span class="op">,</span></span>
<span id="cb88-2310"><a href="#cb88-2310" aria-hidden="true" tabindex="-1"></a>        <span class="st">"type"</span><span class="op">:</span> <span class="st">"quantitative"</span><span class="op">,</span></span>
<span id="cb88-2311"><a href="#cb88-2311" aria-hidden="true" tabindex="-1"></a>        <span class="dt">scale</span><span class="op">:</span> {<span class="dt">reverse</span><span class="op">:</span><span class="kw">true</span>}<span class="op">,</span></span>
<span id="cb88-2312"><a href="#cb88-2312" aria-hidden="true" tabindex="-1"></a>        <span class="dt">legend</span><span class="op">:</span><span class="kw">false</span></span>
<span id="cb88-2313"><a href="#cb88-2313" aria-hidden="true" tabindex="-1"></a>        <span class="co">//scale: {zero:false, nice: false, domain:[-50,50]},</span></span>
<span id="cb88-2314"><a href="#cb88-2314" aria-hidden="true" tabindex="-1"></a>        <span class="co">//"axis": { "grid": false, values: [0,1], format: '.0f'}</span></span>
<span id="cb88-2315"><a href="#cb88-2315" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb88-2316"><a href="#cb88-2316" aria-hidden="true" tabindex="-1"></a>      <span class="dt">color</span><span class="op">:</span> {<span class="dt">value</span><span class="op">:</span><span class="st">'white'</span>}<span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> {<span class="dt">value</span><span class="op">:</span><span class="dv">1</span>}</span>
<span id="cb88-2317"><a href="#cb88-2317" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb88-2318"><a href="#cb88-2318" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb88-2319"><a href="#cb88-2319" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb88-2320"><a href="#cb88-2320" aria-hidden="true" tabindex="-1"></a>      <span class="dt">mark</span><span class="op">:</span> <span class="st">'rule'</span><span class="op">,</span></span>
<span id="cb88-2321"><a href="#cb88-2321" aria-hidden="true" tabindex="-1"></a>      <span class="dt">encoding</span><span class="op">:</span> {</span>
<span id="cb88-2322"><a href="#cb88-2322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-2323"><a href="#cb88-2323" aria-hidden="true" tabindex="-1"></a>      <span class="st">"x"</span><span class="op">:</span> {</span>
<span id="cb88-2324"><a href="#cb88-2324" aria-hidden="true" tabindex="-1"></a>        <span class="st">"field"</span><span class="op">:</span> <span class="st">"x"</span><span class="op">,</span></span>
<span id="cb88-2325"><a href="#cb88-2325" aria-hidden="true" tabindex="-1"></a>        <span class="st">"type"</span><span class="op">:</span> <span class="st">"quantitative"</span><span class="op">,</span></span>
<span id="cb88-2326"><a href="#cb88-2326" aria-hidden="true" tabindex="-1"></a>        <span class="dt">scale</span><span class="op">:</span> {<span class="dt">zero</span><span class="op">:</span><span class="kw">false</span><span class="op">,</span> <span class="dt">nice</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="dt">domain</span><span class="op">:</span>[<span class="op">-</span><span class="dv">50</span><span class="op">,</span><span class="dv">50</span>]}<span class="op">,</span></span>
<span id="cb88-2327"><a href="#cb88-2327" aria-hidden="true" tabindex="-1"></a>        <span class="co">//axis: {format:".0f", grid: false, tickCount:12, ticks:true }</span></span>
<span id="cb88-2328"><a href="#cb88-2328" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb88-2329"><a href="#cb88-2329" aria-hidden="true" tabindex="-1"></a>      <span class="st">"y"</span><span class="op">:</span> {</span>
<span id="cb88-2330"><a href="#cb88-2330" aria-hidden="true" tabindex="-1"></a>        <span class="st">"field"</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span></span>
<span id="cb88-2331"><a href="#cb88-2331" aria-hidden="true" tabindex="-1"></a>        <span class="st">"type"</span><span class="op">:</span> <span class="st">"quantitative"</span><span class="op">,</span></span>
<span id="cb88-2332"><a href="#cb88-2332" aria-hidden="true" tabindex="-1"></a>        <span class="dt">scale</span><span class="op">:</span> {<span class="dt">zero</span><span class="op">:</span><span class="kw">false</span><span class="op">,</span> <span class="dt">nice</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="dt">domain</span><span class="op">:</span>[<span class="op">-</span><span class="dv">50</span><span class="op">,</span><span class="dv">50</span>]}<span class="op">,</span></span>
<span id="cb88-2333"><a href="#cb88-2333" aria-hidden="true" tabindex="-1"></a>        <span class="co">//"axis": { "grid": false, values: [0,1], format: '.0f'}</span></span>
<span id="cb88-2334"><a href="#cb88-2334" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb88-2335"><a href="#cb88-2335" aria-hidden="true" tabindex="-1"></a>      <span class="st">"x2"</span><span class="op">:</span> {</span>
<span id="cb88-2336"><a href="#cb88-2336" aria-hidden="true" tabindex="-1"></a>        <span class="st">"field"</span><span class="op">:</span> <span class="st">"px"</span><span class="op">,</span></span>
<span id="cb88-2337"><a href="#cb88-2337" aria-hidden="true" tabindex="-1"></a>        <span class="st">"type"</span><span class="op">:</span> <span class="st">"quantitative"</span><span class="op">,</span></span>
<span id="cb88-2338"><a href="#cb88-2338" aria-hidden="true" tabindex="-1"></a>        <span class="dt">scale</span><span class="op">:</span> {<span class="dt">zero</span><span class="op">:</span><span class="kw">false</span><span class="op">,</span> <span class="dt">nice</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="dt">domain</span><span class="op">:</span>[<span class="op">-</span><span class="dv">50</span><span class="op">,</span><span class="dv">50</span>]}<span class="op">,</span></span>
<span id="cb88-2339"><a href="#cb88-2339" aria-hidden="true" tabindex="-1"></a>        <span class="co">//axis: {format:".0f", grid: false, tickCount:12, ticks:true }</span></span>
<span id="cb88-2340"><a href="#cb88-2340" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb88-2341"><a href="#cb88-2341" aria-hidden="true" tabindex="-1"></a>      <span class="st">"y2"</span><span class="op">:</span> {</span>
<span id="cb88-2342"><a href="#cb88-2342" aria-hidden="true" tabindex="-1"></a>        <span class="st">"field"</span><span class="op">:</span> <span class="st">"py"</span><span class="op">,</span></span>
<span id="cb88-2343"><a href="#cb88-2343" aria-hidden="true" tabindex="-1"></a>        <span class="st">"type"</span><span class="op">:</span> <span class="st">"quantitative"</span><span class="op">,</span></span>
<span id="cb88-2344"><a href="#cb88-2344" aria-hidden="true" tabindex="-1"></a>        <span class="dt">scale</span><span class="op">:</span> {<span class="dt">zero</span><span class="op">:</span><span class="kw">false</span><span class="op">,</span> <span class="dt">nice</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span> <span class="dt">domain</span><span class="op">:</span>[<span class="op">-</span><span class="dv">50</span><span class="op">,</span><span class="dv">50</span>]}<span class="op">,</span></span>
<span id="cb88-2345"><a href="#cb88-2345" aria-hidden="true" tabindex="-1"></a>        <span class="co">//"axis": { "grid": false, values: [0,1], format: '.0f'}</span></span>
<span id="cb88-2346"><a href="#cb88-2346" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb88-2347"><a href="#cb88-2347" aria-hidden="true" tabindex="-1"></a>      <span class="dt">color</span><span class="op">:</span> {<span class="dt">value</span><span class="op">:</span><span class="st">'white'</span>}</span>
<span id="cb88-2348"><a href="#cb88-2348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-2349"><a href="#cb88-2349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-2350"><a href="#cb88-2350" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb88-2351"><a href="#cb88-2351" aria-hidden="true" tabindex="-1"></a>    }]</span>
<span id="cb88-2352"><a href="#cb88-2352" aria-hidden="true" tabindex="-1"></a>})}</span>
<span id="cb88-2353"><a href="#cb88-2353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-2354"><a href="#cb88-2354" aria-hidden="true" tabindex="-1"></a>starfield_data <span class="op">=</span> <span class="fu">calcuvegadata</span>({</span>
<span id="cb88-2355"><a href="#cb88-2355" aria-hidden="true" tabindex="-1"></a>  <span class="dt">models</span><span class="op">:</span> [starfield]<span class="op">,</span><span class="co">//modelname == 'starfield' ? [starfield] : [],</span></span>
<span id="cb88-2356"><a href="#cb88-2356" aria-hidden="true" tabindex="-1"></a>  <span class="dt">spec</span><span class="op">:</span> starfield_spec<span class="op">,</span></span>
<span id="cb88-2357"><a href="#cb88-2357" aria-hidden="true" tabindex="-1"></a>  <span class="dt">domains</span><span class="op">:</span> { <span class="dt">star_in</span><span class="op">:</span> _<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">100</span>) }<span class="op">,</span></span>
<span id="cb88-2358"><a href="#cb88-2358" aria-hidden="true" tabindex="-1"></a>  <span class="dt">input_cursors</span><span class="op">:</span> [{speed_in<span class="op">,</span> frame_in<span class="op">,</span> random_seed_in}]</span>
<span id="cb88-2359"><a href="#cb88-2359" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb88-2360"><a href="#cb88-2360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-2361"><a href="#cb88-2361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-2362"><a href="#cb88-2362" aria-hidden="true" tabindex="-1"></a>viewof starfield_viz <span class="op">=</span> <span class="fu">embed</span>(starfield_spec<span class="op">,</span> {actions})</span>
<span id="cb88-2363"><a href="#cb88-2363" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb88-2364"><a href="#cb88-2364" aria-hidden="true" tabindex="-1"></a><span class="co">{</span></span>
<span id="cb88-2365"><a href="#cb88-2365" aria-hidden="true" tabindex="-1"></a><span class="co">  leap_year_viz.signal('brush', { x: [2000, 1990+50]}).run();</span></span>
<span id="cb88-2366"><a href="#cb88-2366" aria-hidden="true" tabindex="-1"></a><span class="co">}*/</span></span>
<span id="cb88-2367"><a href="#cb88-2367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-2368"><a href="#cb88-2368" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb88-2369"><a href="#cb88-2369" aria-hidden="true" tabindex="-1"></a><span class="co">// no idea why this doesn't work</span></span>
<span id="cb88-2370"><a href="#cb88-2370" aria-hidden="true" tabindex="-1"></a><span class="co">htl.html`&lt;button onclick=${() =&gt; {leap_year_viz.signal('brush', { x: [2000, 1990+50]}).run()} }&gt;sig&lt;/button&gt;`</span></span>
<span id="cb88-2371"><a href="#cb88-2371" aria-hidden="true" tabindex="-1"></a><span class="co">htl.html`&lt;button onclick=${() =&gt; {leap_year_viz.signal('brush', { year_in: [2000, 1990+50]}).run()} }&gt;sig&lt;/button&gt;`*/</span></span>
<span id="cb88-2372"><a href="#cb88-2372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-2373"><a href="#cb88-2373" aria-hidden="true" tabindex="-1"></a>mutable starfield_data0 <span class="op">=</span> []</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-18-2" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-18-3" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-18-4" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-18-5" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
<div class="cell hidden html-fill-item html-fill-container">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb89" data-startfrom="2384" data-source-offset="-3"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2383;"><span id="cb89-2384"><a href="#cb89-2384" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb89-2385"><a href="#cb89-2385" aria-hidden="true" tabindex="-1"></a>  starfield_viz<span class="op">.</span><span class="fu">data</span>(<span class="st">"data"</span><span class="op">,</span> starfield_data)<span class="co">/*.resize()*/</span><span class="op">.</span><span class="fu">run</span>()<span class="op">;</span></span>
<span id="cb89-2386"><a href="#cb89-2386" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-19-1" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb90" data-startfrom="2388" data-source-offset="-73"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2387;"><span id="cb90-2388"><a href="#cb90-2388" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb90-2389"><a href="#cb90-2389" aria-hidden="true" tabindex="-1"></a>  starfield_viz<span class="op">.</span><span class="fu">addSignalListener</span>(<span class="st">'star_select'</span><span class="op">,</span> (_<span class="op">,</span> b) <span class="kw">=&gt;</span> {</span>
<span id="cb90-2390"><a href="#cb90-2390" aria-hidden="true" tabindex="-1"></a>    <span class="kw">set</span>(viewof star_in<span class="op">,</span> b<span class="op">.</span><span class="at">star_in</span>[<span class="dv">0</span>])</span>
<span id="cb90-2391"><a href="#cb90-2391" aria-hidden="true" tabindex="-1"></a>    <span class="co">//console.log(b)</span></span>
<span id="cb90-2392"><a href="#cb90-2392" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb90-2393"><a href="#cb90-2393" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-19-2" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
</div>
<div id="savings_rec" class="modeldept html-fill-item html-fill-container">
üëÄ
<p><em>highlight for actual-updates</em> ü™Ñ</p>
<div class="cell hidden html-fill-item html-fill-container">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb91" data-startfrom="2410" data-source-offset="-2"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2409;"><span id="cb91-2410"><a href="#cb91-2410" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb91-2411"><a href="#cb91-2411" aria-hidden="true" tabindex="-1"></a>  savings_actualator<span class="op">;</span></span>
<span id="cb91-2412"><a href="#cb91-2412" aria-hidden="true" tabindex="-1"></a>  <span class="bu">window</span><span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">Event</span>(<span class="st">'resize'</span>))</span>
<span id="cb91-2413"><a href="#cb91-2413" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-20-1" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb92" data-startfrom="2417" data-source-offset="-75"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2416;"><span id="cb92-2417"><a href="#cb92-2417" aria-hidden="true" tabindex="-1"></a>savings_actualator<span class="op">.</span><span class="fu">addSignalListener</span>(<span class="st">"y"</span><span class="op">,</span> (_<span class="op">,</span> r) <span class="kw">=&gt;</span> { <span class="co">// this didn't improve perf a lot vs event listener: nearly every mousemove is a signal change, I suppose</span></span>
<span id="cb92-2418"><a href="#cb92-2418" aria-hidden="true" tabindex="-1"></a>  <span class="co">//if (observable_world == 0) return;</span></span>
<span id="cb92-2419"><a href="#cb92-2419" aria-hidden="true" tabindex="-1"></a>  viewof actual_interest_rate_co_in<span class="op">.</span><span class="at">value</span> <span class="op">=</span> r<span class="op">.</span><span class="at">year_in</span>[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb92-2420"><a href="#cb92-2420" aria-hidden="true" tabindex="-1"></a>  viewof actual_interest_rate_co_in<span class="op">.</span><span class="fu">dispatchEvent</span>(<span class="kw">new</span> <span class="bu">CustomEvent</span>(<span class="st">'input'</span>)<span class="op">,</span> {<span class="dt">bubbles</span><span class="op">:</span><span class="kw">true</span>})<span class="op">;</span></span>
<span id="cb92-2421"><a href="#cb92-2421" aria-hidden="true" tabindex="-1"></a>}) <span class="op">&amp;&amp;</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-20-2" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb93" data-startfrom="2424" data-source-offset="-435"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2423;"><span id="cb93-2424"><a href="#cb93-2424" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb93-2425"><a href="#cb93-2425" aria-hidden="true" tabindex="-1"></a>  savings_actualator<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">'click'</span><span class="op">,</span> (<span class="bu">event</span><span class="op">,</span> item) <span class="kw">=&gt;</span> { <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(item) }) </span>
<span id="cb93-2426"><a href="#cb93-2426" aria-hidden="true" tabindex="-1"></a>  <span class="co">// difficult for layers?</span></span>
<span id="cb93-2427"><a href="#cb93-2427" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-20-3" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb94" data-startfrom="2436" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2435;"><span id="cb94-2436"><a href="#cb94-2436" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> {calcudata<span class="op">,</span> calcuvizspec} <span class="im">from</span> <span class="st">'@declann/little-calculang-helpers-perf'</span></span>
<span id="cb94-2437"><a href="#cb94-2437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-2438"><a href="#cb94-2438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-2439"><a href="#cb94-2439" aria-hidden="true" tabindex="-1"></a>savings_rec_data <span class="op">=</span> <span class="fu">calcudata</span>({</span>
<span id="cb94-2440"><a href="#cb94-2440" aria-hidden="true" tabindex="-1"></a>  <span class="dt">models</span><span class="op">:</span> [savings_rec]<span class="op">,</span></span>
<span id="cb94-2441"><a href="#cb94-2441" aria-hidden="true" tabindex="-1"></a>  <span class="dt">input_domains</span><span class="op">:</span> {<span class="dt">year_in</span><span class="op">:</span>_<span class="op">.</span><span class="fu">range</span>(<span class="dv">0</span><span class="op">,</span>duration_in<span class="op">+</span><span class="fl">0.1</span>)<span class="op">,</span> <span class="dt">actual_interest_rate_co_in</span><span class="op">:</span> [actual_interest_rate_co_in<span class="op">-</span><span class="dv">1</span><span class="op">,</span>actual_interest_rate_co_in]}<span class="op">,</span></span>
<span id="cb94-2442"><a href="#cb94-2442" aria-hidden="true" tabindex="-1"></a>  <span class="dt">input_cursors</span><span class="op">:</span> [{annual_payment_in}]<span class="op">,</span> </span>
<span id="cb94-2443"><a href="#cb94-2443" aria-hidden="true" tabindex="-1"></a>  <span class="dt">outputs</span><span class="op">:</span> [<span class="st">'balance'</span><span class="op">,</span><span class="st">'interest'</span><span class="op">,</span><span class="st">'deposits'</span><span class="op">,</span><span class="st">'interest_rate'</span>]</span>
<span id="cb94-2444"><a href="#cb94-2444" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb94-2445"><a href="#cb94-2445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-2446"><a href="#cb94-2446" aria-hidden="true" tabindex="-1"></a>viewof savings_actualator <span class="op">=</span> <span class="fu">embed</span>(</span>
<span id="cb94-2447"><a href="#cb94-2447" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb94-2448"><a href="#cb94-2448" aria-hidden="true" tabindex="-1"></a>  <span class="st">"data"</span><span class="op">:</span> {<span class="st">"name"</span><span class="op">:</span> <span class="st">"data"</span>}<span class="op">,</span></span>
<span id="cb94-2449"><a href="#cb94-2449" aria-hidden="true" tabindex="-1"></a>  <span class="dt">width</span><span class="op">:</span> <span class="st">"container"</span><span class="op">,</span></span>
<span id="cb94-2450"><a href="#cb94-2450" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span> <span class="dv">350</span><span class="op">,</span></span>
<span id="cb94-2451"><a href="#cb94-2451" aria-hidden="true" tabindex="-1"></a>  <span class="st">"transform"</span><span class="op">:</span> [</span>
<span id="cb94-2452"><a href="#cb94-2452" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb94-2453"><a href="#cb94-2453" aria-hidden="true" tabindex="-1"></a>      <span class="st">"window"</span><span class="op">:</span> [{<span class="st">"op"</span><span class="op">:</span> <span class="st">"lag"</span><span class="op">,</span> <span class="st">"field"</span><span class="op">:</span> <span class="st">"value"</span><span class="op">,</span> <span class="st">"as"</span><span class="op">:</span> <span class="st">"A_value"</span>}]<span class="op">,</span></span>
<span id="cb94-2454"><a href="#cb94-2454" aria-hidden="true" tabindex="-1"></a>      <span class="st">"groupby"</span><span class="op">:</span> [<span class="st">"formula"</span><span class="op">,</span><span class="st">"year_in"</span>]<span class="op">,</span></span>
<span id="cb94-2455"><a href="#cb94-2455" aria-hidden="true" tabindex="-1"></a>      <span class="st">"sort"</span><span class="op">:</span> [{<span class="st">"field"</span><span class="op">:</span> <span class="st">"actual_interest_rate_co_in"</span>}]<span class="op">,</span></span>
<span id="cb94-2456"><a href="#cb94-2456" aria-hidden="true" tabindex="-1"></a>      <span class="st">"frame"</span><span class="op">:</span> [<span class="op">-</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0</span>]</span>
<span id="cb94-2457"><a href="#cb94-2457" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb94-2458"><a href="#cb94-2458" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"calculate"</span><span class="op">:</span> <span class="st">"datum.value-datum.A_value"</span><span class="op">,</span> <span class="st">"as"</span><span class="op">:</span> <span class="st">"impact"</span>}<span class="op">,</span></span>
<span id="cb94-2459"><a href="#cb94-2459" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb94-2460"><a href="#cb94-2460" aria-hidden="true" tabindex="-1"></a>  <span class="st">"encoding"</span><span class="op">:</span> {</span>
<span id="cb94-2461"><a href="#cb94-2461" aria-hidden="true" tabindex="-1"></a>    <span class="st">"y"</span><span class="op">:</span> {<span class="st">"field"</span><span class="op">:</span> <span class="st">"year_in"</span><span class="op">,</span> <span class="st">"type"</span><span class="op">:</span> <span class="st">"nominal"</span><span class="op">,</span> <span class="st">"sort"</span><span class="op">:</span> <span class="st">"ascending"</span><span class="op">,</span> <span class="dt">axis</span><span class="op">:</span> {<span class="dt">labelFontSize</span><span class="op">:</span> <span class="dv">30</span>}}<span class="op">,</span></span>
<span id="cb94-2462"><a href="#cb94-2462" aria-hidden="true" tabindex="-1"></a>    <span class="st">"color"</span><span class="op">:</span> {<span class="st">"field"</span><span class="op">:</span> <span class="st">"formula"</span><span class="op">,</span> <span class="st">"type"</span><span class="op">:</span> <span class="st">"nominal"</span>}<span class="op">,</span></span>
<span id="cb94-2463"><a href="#cb94-2463" aria-hidden="true" tabindex="-1"></a>    <span class="st">"x"</span><span class="op">:</span> {</span>
<span id="cb94-2464"><a href="#cb94-2464" aria-hidden="true" tabindex="-1"></a>      <span class="st">"field"</span><span class="op">:</span> <span class="st">"formula"</span><span class="op">,</span></span>
<span id="cb94-2465"><a href="#cb94-2465" aria-hidden="true" tabindex="-1"></a>      <span class="st">"type"</span><span class="op">:</span> <span class="st">"nominal"</span><span class="op">,</span></span>
<span id="cb94-2466"><a href="#cb94-2466" aria-hidden="true" tabindex="-1"></a>      <span class="st">"axis"</span><span class="op">:</span> {<span class="st">"labelAngle"</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="st">"orient"</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span> <span class="st">"labelLimit"</span><span class="op">:</span> <span class="dv">90</span><span class="op">,</span> <span class="dt">title</span><span class="op">:</span><span class="kw">null</span><span class="op">,</span> <span class="st">"labelLimit"</span><span class="op">:</span> <span class="dv">300</span><span class="op">,</span> <span class="dt">labelFontSize</span><span class="op">:</span> <span class="dv">30</span>}</span>
<span id="cb94-2467"><a href="#cb94-2467" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb94-2468"><a href="#cb94-2468" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb94-2469"><a href="#cb94-2469" aria-hidden="true" tabindex="-1"></a>  <span class="dt">layer</span><span class="op">:</span> [{</span>
<span id="cb94-2470"><a href="#cb94-2470" aria-hidden="true" tabindex="-1"></a>            <span class="st">"params"</span><span class="op">:</span> [{<span class="st">"name"</span><span class="op">:</span> <span class="st">"y"</span><span class="op">,</span> <span class="st">"select"</span><span class="op">:</span> { <span class="st">"type"</span><span class="op">:</span> <span class="st">"point"</span><span class="op">,</span> <span class="st">"on"</span><span class="op">:</span> <span class="st">"mouseover"</span><span class="op">,</span> <span class="st">"nearest"</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="st">"encodings"</span><span class="op">:</span> [<span class="st">"y"</span>]<span class="op">,</span> <span class="st">"toggle"</span><span class="op">:</span><span class="kw">false</span>}}<span class="op">,</span></span>
<span id="cb94-2471"><a href="#cb94-2471" aria-hidden="true" tabindex="-1"></a>                 <span class="co">// params for layers not working good !{"name": "formula", "select": { "type": "point", "on": "mouseup, touchup, [mousedown, mouseup] &gt; mousemove", "nearest": true, "encodings": ["x", "y"]}}</span></span>
<span id="cb94-2472"><a href="#cb94-2472" aria-hidden="true" tabindex="-1"></a>                 ]</span>
<span id="cb94-2473"><a href="#cb94-2473" aria-hidden="true" tabindex="-1"></a>                 <span class="op">,</span></span>
<span id="cb94-2474"><a href="#cb94-2474" aria-hidden="true" tabindex="-1"></a>  <span class="st">"mark"</span><span class="op">:</span> {</span>
<span id="cb94-2475"><a href="#cb94-2475" aria-hidden="true" tabindex="-1"></a>    <span class="st">"type"</span><span class="op">:</span> <span class="st">"text"</span><span class="op">,</span></span>
<span id="cb94-2476"><a href="#cb94-2476" aria-hidden="true" tabindex="-1"></a>    <span class="st">"fontSize"</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span></span>
<span id="cb94-2477"><a href="#cb94-2477" aria-hidden="true" tabindex="-1"></a>    <span class="st">"fontWeight"</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span></span>
<span id="cb94-2478"><a href="#cb94-2478" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tooltip"</span><span class="op">:</span> <span class="kw">false</span></span>
<span id="cb94-2479"><a href="#cb94-2479" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb94-2480"><a href="#cb94-2480" aria-hidden="true" tabindex="-1"></a>        <span class="st">"transform"</span><span class="op">:</span> [{<span class="st">"filter"</span><span class="op">:</span> <span class="vs">`datum.actual_interest_rate_co_in != </span><span class="sc">${</span>actual_interest_rate_co_in<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="vs">`</span>}<span class="op">,</span></span>
<span id="cb94-2481"><a href="#cb94-2481" aria-hidden="true" tabindex="-1"></a>        <span class="co">//{"calculate": "datum.year_in &gt; datum.actual_interest_rate_co_in", "as": "fut"}</span></span>
<span id="cb94-2482"><a href="#cb94-2482" aria-hidden="true" tabindex="-1"></a>        ]<span class="op">,</span></span>
<span id="cb94-2483"><a href="#cb94-2483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-2484"><a href="#cb94-2484" aria-hidden="true" tabindex="-1"></a>  <span class="dt">encoding</span><span class="op">:</span> {</span>
<span id="cb94-2485"><a href="#cb94-2485" aria-hidden="true" tabindex="-1"></a>    <span class="st">"opacity"</span><span class="op">:</span>             {<span class="st">"condition"</span><span class="op">:</span> {<span class="st">"test"</span><span class="op">:</span> <span class="st">"datum.year_in &gt; datum.actual_interest_rate_co_in"</span><span class="op">,</span> <span class="st">"value"</span><span class="op">:</span> <span class="fl">0.5</span>}<span class="op">,</span> <span class="st">"value"</span><span class="op">:</span> <span class="dv">1</span>}<span class="op">,</span></span>
<span id="cb94-2486"><a href="#cb94-2486" aria-hidden="true" tabindex="-1"></a><span class="co">// {"field": "fut", "type": "nominal", "sort": "descending"},</span></span>
<span id="cb94-2487"><a href="#cb94-2487" aria-hidden="true" tabindex="-1"></a>        <span class="st">"text"</span><span class="op">:</span> {</span>
<span id="cb94-2488"><a href="#cb94-2488" aria-hidden="true" tabindex="-1"></a>      <span class="st">"field"</span><span class="op">:</span> <span class="st">"value"</span><span class="op">,</span></span>
<span id="cb94-2489"><a href="#cb94-2489" aria-hidden="true" tabindex="-1"></a>      <span class="st">"type"</span><span class="op">:</span> <span class="st">"quantitative"</span><span class="op">,</span></span>
<span id="cb94-2490"><a href="#cb94-2490" aria-hidden="true" tabindex="-1"></a>      <span class="st">"format"</span><span class="op">:</span> <span class="st">",.2f"</span><span class="op">,</span> <span class="co">// I can't do a conditional format here yet</span></span>
<span id="cb94-2491"><a href="#cb94-2491" aria-hidden="true" tabindex="-1"></a>      <span class="st">"axis"</span><span class="op">:</span> {<span class="st">"format"</span><span class="op">:</span> <span class="st">",.2f"</span>}</span>
<span id="cb94-2492"><a href="#cb94-2492" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb94-2493"><a href="#cb94-2493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-2494"><a href="#cb94-2494" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb94-2495"><a href="#cb94-2495" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span>{</span>
<span id="cb94-2496"><a href="#cb94-2496" aria-hidden="true" tabindex="-1"></a>  <span class="st">"mark"</span><span class="op">:</span> {</span>
<span id="cb94-2497"><a href="#cb94-2497" aria-hidden="true" tabindex="-1"></a>    <span class="st">"type"</span><span class="op">:</span> <span class="st">"text"</span><span class="op">,</span> <span class="dt">dx</span><span class="op">:</span><span class="dv">95</span><span class="op">,</span> <span class="dt">dy</span><span class="op">:</span> <span class="op">-</span><span class="dv">10</span><span class="op">,</span></span>
<span id="cb94-2498"><a href="#cb94-2498" aria-hidden="true" tabindex="-1"></a>    <span class="st">"fontSize"</span><span class="op">:</span> <span class="dv">22</span><span class="op">,</span></span>
<span id="cb94-2499"><a href="#cb94-2499" aria-hidden="true" tabindex="-1"></a>    <span class="st">"fontWeight"</span><span class="op">:</span> <span class="st">"bold"</span><span class="op">,</span><span class="co">//</span></span>
<span id="cb94-2500"><a href="#cb94-2500" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tooltip"</span><span class="op">:</span> <span class="kw">false</span></span>
<span id="cb94-2501"><a href="#cb94-2501" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb94-2502"><a href="#cb94-2502" aria-hidden="true" tabindex="-1"></a>        <span class="st">"transform"</span><span class="op">:</span> [{<span class="st">"filter"</span><span class="op">:</span> <span class="vs">`abs(datum.impact) &gt;= 0.00001 &amp;&amp; datum.actual_interest_rate_co_in != </span><span class="sc">${</span>actual_interest_rate_co_in<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="vs">`</span>}]<span class="op">,</span></span>
<span id="cb94-2503"><a href="#cb94-2503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-2504"><a href="#cb94-2504" aria-hidden="true" tabindex="-1"></a>  <span class="dt">encoding</span><span class="op">:</span> {</span>
<span id="cb94-2505"><a href="#cb94-2505" aria-hidden="true" tabindex="-1"></a>            <span class="st">"color"</span><span class="op">:</span> {<span class="st">"value"</span><span class="op">:</span> <span class="st">"green"</span><span class="op">,</span> <span class="st">"condition"</span><span class="op">:</span> {<span class="st">"test"</span><span class="op">:</span> <span class="st">"datum.impact &lt; 0"</span><span class="op">,</span> <span class="st">"value"</span><span class="op">:</span> <span class="st">"red"</span>}}<span class="op">,</span></span>
<span id="cb94-2506"><a href="#cb94-2506" aria-hidden="true" tabindex="-1"></a>                <span class="st">"opacity"</span><span class="op">:</span>             {<span class="st">"condition"</span><span class="op">:</span> {<span class="st">"test"</span><span class="op">:</span> <span class="st">"datum.year_in &gt; datum.actual_interest_rate_co_in"</span><span class="op">,</span> <span class="st">"value"</span><span class="op">:</span> <span class="fl">0.5</span>}<span class="op">,</span> <span class="st">"value"</span><span class="op">:</span> <span class="dv">1</span>}<span class="op">,</span></span>
<span id="cb94-2507"><a href="#cb94-2507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-2508"><a href="#cb94-2508" aria-hidden="true" tabindex="-1"></a>        <span class="st">"text"</span><span class="op">:</span> {</span>
<span id="cb94-2509"><a href="#cb94-2509" aria-hidden="true" tabindex="-1"></a>      <span class="st">"field"</span><span class="op">:</span> <span class="st">"impact"</span><span class="op">,</span></span>
<span id="cb94-2510"><a href="#cb94-2510" aria-hidden="true" tabindex="-1"></a>      <span class="st">"type"</span><span class="op">:</span> <span class="st">"quantitative"</span><span class="op">,</span></span>
<span id="cb94-2511"><a href="#cb94-2511" aria-hidden="true" tabindex="-1"></a>      <span class="st">"format"</span><span class="op">:</span> <span class="st">",.2f"</span><span class="op">,</span></span>
<span id="cb94-2512"><a href="#cb94-2512" aria-hidden="true" tabindex="-1"></a>      <span class="st">"axis"</span><span class="op">:</span> {<span class="st">"format"</span><span class="op">:</span> <span class="st">",.2f"</span>}</span>
<span id="cb94-2513"><a href="#cb94-2513" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb94-2514"><a href="#cb94-2514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-2515"><a href="#cb94-2515" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb94-2516"><a href="#cb94-2516" aria-hidden="true" tabindex="-1"></a>  }]<span class="op">,</span></span>
<span id="cb94-2517"><a href="#cb94-2517" aria-hidden="true" tabindex="-1"></a>  <span class="st">"config"</span><span class="op">:</span> {<span class="st">"legend"</span><span class="op">:</span> {<span class="st">"disable"</span><span class="op">:</span> <span class="kw">true</span>}}<span class="op">,</span></span>
<span id="cb94-2518"><a href="#cb94-2518" aria-hidden="true" tabindex="-1"></a>  <span class="st">"datasets"</span><span class="op">:</span> { <span class="dt">data</span><span class="op">:</span> savings_rec_data</span>
<span id="cb94-2519"><a href="#cb94-2519" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb94-2520"><a href="#cb94-2520" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-21-1" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-21-2" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-21-3" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div id="fizzbuzz" class="modeldept html-fill-item html-fill-container">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<details class="code-fold">
<summary>Show the code! (calcuvizspec)</summary>
<div class="sourceCode cell-code html-fill-item html-fill-container" id="cb95" data-startfrom="2537" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2536;"><span id="cb95-2537"><a href="#cb95-2537" aria-hidden="true" tabindex="-1"></a><span class="fu">embed</span>(</span>
<span id="cb95-2538"><a href="#cb95-2538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calcuvizspec</span>({</span>
<span id="cb95-2539"><a href="#cb95-2539" aria-hidden="true" tabindex="-1"></a>    <span class="dt">models</span><span class="op">:</span> [fizzbuzz]<span class="op">,</span></span>
<span id="cb95-2540"><a href="#cb95-2540" aria-hidden="true" tabindex="-1"></a>    <span class="dt">input_cursors</span><span class="op">:</span> [{}]<span class="op">,</span></span>
<span id="cb95-2541"><a href="#cb95-2541" aria-hidden="true" tabindex="-1"></a>    <span class="dt">mark</span><span class="op">:</span> {<span class="dt">type</span><span class="op">:</span> <span class="st">'text'</span><span class="op">,</span> <span class="dt">fontSize</span><span class="op">:</span><span class="dv">15</span><span class="op">,</span> <span class="dt">fontWeight</span><span class="op">:</span> <span class="st">'bold'</span>}<span class="op">,</span></span>
<span id="cb95-2542"><a href="#cb95-2542" aria-hidden="true" tabindex="-1"></a>    <span class="dt">encodings</span><span class="op">:</span> {</span>
<span id="cb95-2543"><a href="#cb95-2543" aria-hidden="true" tabindex="-1"></a>      <span class="dt">x</span><span class="op">:</span> {<span class="dt">name</span><span class="op">:</span> <span class="st">'formula'</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span><span class="st">'nominal'</span><span class="op">,</span> <span class="dt">domain</span><span class="op">:</span> [<span class="st">'fizz'</span><span class="op">,</span><span class="st">'buzz'</span><span class="op">,</span><span class="st">'fizzbuzz'</span>]<span class="op">,</span> <span class="dt">axis</span><span class="op">:</span> {<span class="dt">labelFontSize</span><span class="op">:</span> <span class="dv">60</span>}<span class="op">,</span> <span class="dt">sort</span><span class="op">:</span> [<span class="st">'fizzbuzz'</span>]}<span class="op">,</span></span>
<span id="cb95-2544"><a href="#cb95-2544" aria-hidden="true" tabindex="-1"></a>      <span class="dt">y</span><span class="op">:</span> {<span class="dt">name</span><span class="op">:</span> <span class="st">'i_in'</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span><span class="st">'nominal'</span><span class="op">,</span> <span class="dt">domain</span><span class="op">:</span> _<span class="op">.</span><span class="fu">range</span>(i_in<span class="op">,</span> i_in<span class="op">+</span><span class="dv">20</span>)<span class="op">,</span> <span class="dt">grid</span><span class="op">:</span> <span class="kw">true</span>}<span class="op">,</span></span>
<span id="cb95-2545"><a href="#cb95-2545" aria-hidden="true" tabindex="-1"></a>      <span class="dt">text</span><span class="op">:</span> {<span class="dt">name</span><span class="op">:</span> <span class="st">'value'</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">'nominal'</span>}<span class="op">,</span></span>
<span id="cb95-2546"><a href="#cb95-2546" aria-hidden="true" tabindex="-1"></a>      <span class="dt">color</span><span class="op">:</span> {<span class="dt">name</span><span class="op">:</span> <span class="st">'value'</span><span class="op">,</span> <span class="dt">type</span><span class="op">:</span> <span class="st">'nominal'</span><span class="op">,</span> <span class="dt">legend</span><span class="op">:</span><span class="kw">false</span>}<span class="op">,</span></span>
<span id="cb95-2547"><a href="#cb95-2547" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb95-2548"><a href="#cb95-2548" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="dv">250</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-22" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div id="year_remaining" class="modeldept html-fill-item html-fill-container">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<details class="code-fold">
<summary>üëÄ</summary>
<div class="sourceCode cell-code html-fill-item html-fill-container" id="cb96" data-startfrom="2564" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2563;"><span id="cb96-2564"><a href="#cb96-2564" aria-hidden="true" tabindex="-1"></a><span class="fu">md</span><span class="vs">`**</span><span class="sc">${</span>(d3<span class="op">.</span><span class="fu">format</span>(<span class="st">'.2%'</span>)(year_remaining<span class="op">.</span><span class="fu">fractionLeftInYear</span>({<span class="dt">date_in</span><span class="op">:</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">,</span> timing_in})))<span class="sc">}</span><span class="vs">** of year reamining, or visually:`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-23-1" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold">
<summary>üëÄ</summary>
<div class="sourceCode cell-code html-fill-item html-fill-container" id="cb97" data-startfrom="2566" data-source-offset="-133"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2565;"><span id="cb97-2566"><a href="#cb97-2566" aria-hidden="true" tabindex="-1"></a>Plot<span class="op">.</span><span class="fu">plot</span>({</span>
<span id="cb97-2567"><a href="#cb97-2567" aria-hidden="true" tabindex="-1"></a>  <span class="co">//marginLeft: 90,</span></span>
<span id="cb97-2568"><a href="#cb97-2568" aria-hidden="true" tabindex="-1"></a>  <span class="dt">height</span><span class="op">:</span><span class="dv">80</span><span class="op">,</span></span>
<span id="cb97-2569"><a href="#cb97-2569" aria-hidden="true" tabindex="-1"></a>  <span class="co">//width:5000,</span></span>
<span id="cb97-2570"><a href="#cb97-2570" aria-hidden="true" tabindex="-1"></a>  <span class="dt">color</span><span class="op">:</span> { <span class="dt">legend</span><span class="op">:</span> <span class="kw">true</span> }<span class="op">,</span></span>
<span id="cb97-2571"><a href="#cb97-2571" aria-hidden="true" tabindex="-1"></a>  <span class="dt">marks</span><span class="op">:</span> [    Plot<span class="op">.</span><span class="fu">axisX</span>({<span class="dt">anchor</span><span class="op">:</span> <span class="st">"top"</span>})<span class="op">,</span></span>
<span id="cb97-2572"><a href="#cb97-2572" aria-hidden="true" tabindex="-1"></a><span class="op">,</span>Plot<span class="op">.</span><span class="fu">barX</span>(</span>
<span id="cb97-2573"><a href="#cb97-2573" aria-hidden="true" tabindex="-1"></a>    [{<span class="dt">sort</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">status</span><span class="op">:</span><span class="st">'remaining'</span><span class="op">,</span><span class="dt">percent</span><span class="op">:</span><span class="dv">100</span><span class="op">*</span>year_remaining<span class="op">.</span><span class="fu">fractionLeftInYear</span>({<span class="dt">date_in</span><span class="op">:</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">,</span> timing_in})}<span class="op">,</span></span>
<span id="cb97-2574"><a href="#cb97-2574" aria-hidden="true" tabindex="-1"></a>    {<span class="dt">sort</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">status</span><span class="op">:</span><span class="st">'complete'</span><span class="op">,</span><span class="dt">percent</span><span class="op">:</span><span class="dv">100</span><span class="op">*</span>year_remaining<span class="op">.</span><span class="fu">fractionIntoYear</span>({<span class="dt">date_in</span><span class="op">:</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">,</span> timing_in})</span>
<span id="cb97-2575"><a href="#cb97-2575" aria-hidden="true" tabindex="-1"></a>}]</span>
<span id="cb97-2576"><a href="#cb97-2576" aria-hidden="true" tabindex="-1"></a><span class="op">,</span>{ <span class="dt">x</span><span class="op">:</span> <span class="st">"percent"</span><span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"status"</span><span class="op">,</span> <span class="dt">sort</span><span class="op">:</span><span class="st">'sort'</span> })]</span>
<span id="cb97-2577"><a href="#cb97-2577" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-23-2" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
<p>Not so sure? Check workings in the calculang model using ‚Äòoverlay‚Äô option!</p>
<em>Inspired by <a href="https://twitter.com/year_remaining"><span class="citation" data-cites="year_remaining">@year_remaining</span></a></em>
</div>
<div id="simple_loan" class="modeldept html-fill-item html-fill-container">
<p>‚ö†Ô∏è <em>The assumptions, methodology and limitations of a model should be carefully considered for any purpose you apply it to. I haven‚Äôt even listed these here, nor otherwise documented the model fully/clearly.</em> <strong>Proceed with caution</strong> üôè</p>
<p>‚ö†Ô∏è <em>This is not a complete model/narrative and you should not rely on it.</em></p>
<p>‚ö†Ô∏è <em>Not recommended to enter real personal or sensitive details. <strong>Contact me with real-world calculation or model requirements instead.</strong></em> üó£‚úÖ</p>
<p>‚ö†Ô∏è <em>This validator/scenario tool isn‚Äôt/won‚Äôt be financial advice etc.</em></p>
<div class="cell hidden html-fill-item html-fill-container">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb98" data-startfrom="2609" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2608;"><span id="cb98-2609"><a href="#cb98-2609" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb98-2610"><a href="#cb98-2610" aria-hidden="true" tabindex="-1"></a>  loan_viz<span class="op">.</span><span class="fu">data</span>(<span class="st">"source"</span><span class="op">,</span> loan_data)<span class="op">.</span><span class="fu">resize</span>()<span class="op">.</span><span class="fu">run</span>()<span class="op">;</span></span>
<span id="cb98-2611"><a href="#cb98-2611" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div id="ojs-cell-24" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<details class="code-fold">
<summary>üëÄ</summary>
<div class="sourceCode cell-code html-fill-item html-fill-container" id="cb99" data-startfrom="2623" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2622;"><span id="cb99-2623"><a href="#cb99-2623" aria-hidden="true" tabindex="-1"></a>loan_data <span class="op">=</span> <span class="fu">calcudata</span>({</span>
<span id="cb99-2624"><a href="#cb99-2624" aria-hidden="true" tabindex="-1"></a>  <span class="dt">models</span><span class="op">:</span> [simple_loan]<span class="op">,</span></span>
<span id="cb99-2625"><a href="#cb99-2625" aria-hidden="true" tabindex="-1"></a>  <span class="dt">input_domains</span><span class="op">:</span> {<span class="dt">year_in</span><span class="op">:</span>_<span class="op">.</span><span class="fu">range</span>(<span class="op">-</span><span class="dv">1</span><span class="op">,</span>term_in<span class="op">+</span><span class="fl">0.1</span>)}<span class="op">,</span></span>
<span id="cb99-2626"><a href="#cb99-2626" aria-hidden="true" tabindex="-1"></a>  <span class="dt">input_cursors</span><span class="op">:</span> [{principal_in<span class="op">,</span> i_in<span class="op">,</span> d_i_in<span class="op">,</span> d_i_year_in<span class="op">,</span> term_in}]<span class="op">,</span></span>
<span id="cb99-2627"><a href="#cb99-2627" aria-hidden="true" tabindex="-1"></a>  <span class="dt">outputs</span><span class="op">:</span> [<span class="st">"capital_repayment"</span><span class="op">,</span> <span class="st">"interest_repayment"</span><span class="op">,</span> <span class="st">"balance"</span>]<span class="op">,</span></span>
<span id="cb99-2628"><a href="#cb99-2628" aria-hidden="true" tabindex="-1"></a>  <span class="dt">pivot</span><span class="op">:</span> <span class="kw">false</span></span>
<span id="cb99-2629"><a href="#cb99-2629" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb99-2630"><a href="#cb99-2630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-2631"><a href="#cb99-2631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-2632"><a href="#cb99-2632" aria-hidden="true" tabindex="-1"></a>loan_spec <span class="op">=</span> { <span class="cf">return</span> ({</span>
<span id="cb99-2633"><a href="#cb99-2633" aria-hidden="true" tabindex="-1"></a>  <span class="st">"$schema"</span><span class="op">:</span> <span class="st">"https://vega.github.io/schema/vega-lite/v5.json"</span><span class="op">,</span></span>
<span id="cb99-2634"><a href="#cb99-2634" aria-hidden="true" tabindex="-1"></a>  <span class="st">"width"</span><span class="op">:</span> <span class="st">"container"</span><span class="op">,</span></span>
<span id="cb99-2635"><a href="#cb99-2635" aria-hidden="true" tabindex="-1"></a>  <span class="dt">datasets</span><span class="op">:</span> {<span class="st">'source'</span><span class="op">:</span> [] }<span class="op">,</span></span>
<span id="cb99-2636"><a href="#cb99-2636" aria-hidden="true" tabindex="-1"></a>  <span class="st">"encoding"</span><span class="op">:</span> {</span>
<span id="cb99-2637"><a href="#cb99-2637" aria-hidden="true" tabindex="-1"></a>        <span class="st">"x"</span><span class="op">:</span> {<span class="st">"field"</span><span class="op">:</span> <span class="st">"year_in"</span>}<span class="op">,</span></span>
<span id="cb99-2638"><a href="#cb99-2638" aria-hidden="true" tabindex="-1"></a>        <span class="st">"y"</span><span class="op">:</span> {<span class="st">"field"</span><span class="op">:</span> <span class="st">"value"</span><span class="op">,</span> <span class="st">"type"</span><span class="op">:</span> <span class="st">"quantitative"</span>}<span class="op">,</span></span>
<span id="cb99-2639"><a href="#cb99-2639" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb99-2640"><a href="#cb99-2640" aria-hidden="true" tabindex="-1"></a>  <span class="st">"layer"</span><span class="op">:</span> [</span>
<span id="cb99-2641"><a href="#cb99-2641" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb99-2642"><a href="#cb99-2642" aria-hidden="true" tabindex="-1"></a>      <span class="st">"transform"</span><span class="op">:</span> [{<span class="st">"filter"</span><span class="op">:</span> <span class="st">"datum.formula != 'balance'"</span>}]<span class="op">,</span></span>
<span id="cb99-2643"><a href="#cb99-2643" aria-hidden="true" tabindex="-1"></a>      <span class="st">"mark"</span><span class="op">:</span> {<span class="st">"type"</span><span class="op">:</span> <span class="st">"bar"</span><span class="op">,</span> <span class="st">"tooltip"</span><span class="op">:</span> <span class="kw">true</span>}<span class="op">,</span></span>
<span id="cb99-2644"><a href="#cb99-2644" aria-hidden="true" tabindex="-1"></a>      <span class="st">"encoding"</span><span class="op">:</span> {</span>
<span id="cb99-2645"><a href="#cb99-2645" aria-hidden="true" tabindex="-1"></a>        <span class="st">"color"</span><span class="op">:</span> {<span class="st">"field"</span><span class="op">:</span> <span class="st">"formula"</span><span class="op">,</span> <span class="st">"type"</span><span class="op">:</span> <span class="st">"nominal"</span><span class="op">,</span> <span class="dt">legend</span><span class="op">:</span> {<span class="dt">orient</span><span class="op">:</span> <span class="st">'top'</span>}}</span>
<span id="cb99-2646"><a href="#cb99-2646" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb99-2647"><a href="#cb99-2647" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb99-2648"><a href="#cb99-2648" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb99-2649"><a href="#cb99-2649" aria-hidden="true" tabindex="-1"></a>      <span class="st">"transform"</span><span class="op">:</span> [{<span class="st">"filter"</span><span class="op">:</span> <span class="st">"datum.formula == 'balance'"</span>}]<span class="op">,</span></span>
<span id="cb99-2650"><a href="#cb99-2650" aria-hidden="true" tabindex="-1"></a>      <span class="st">"mark"</span><span class="op">:</span> {<span class="st">"type"</span><span class="op">:</span> <span class="st">"line"</span><span class="op">,</span> <span class="st">"tooltip"</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="st">"point"</span><span class="op">:</span> <span class="kw">false</span>}<span class="op">,</span></span>
<span id="cb99-2651"><a href="#cb99-2651" aria-hidden="true" tabindex="-1"></a>      <span class="st">"encoding"</span><span class="op">:</span> {</span>
<span id="cb99-2652"><a href="#cb99-2652" aria-hidden="true" tabindex="-1"></a>        <span class="st">"color"</span><span class="op">:</span> {<span class="st">"value"</span><span class="op">:</span> <span class="st">"red"</span>}<span class="op">,</span></span>
<span id="cb99-2653"><a href="#cb99-2653" aria-hidden="true" tabindex="-1"></a>        <span class="st">"y"</span><span class="op">:</span> {<span class="st">"field"</span><span class="op">:</span> <span class="st">"value"</span><span class="op">,</span> <span class="st">"type"</span><span class="op">:</span> <span class="st">"quantitative"</span><span class="op">,</span> <span class="st">"title"</span><span class="op">:</span> <span class="st">"balance"</span>}</span>
<span id="cb99-2654"><a href="#cb99-2654" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb99-2655"><a href="#cb99-2655" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb99-2656"><a href="#cb99-2656" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb99-2657"><a href="#cb99-2657" aria-hidden="true" tabindex="-1"></a>      <span class="st">"transform"</span><span class="op">:</span> [{<span class="st">"filter"</span><span class="op">:</span> <span class="st">"datum.formula == 'balance'"</span>}]<span class="op">,</span></span>
<span id="cb99-2658"><a href="#cb99-2658" aria-hidden="true" tabindex="-1"></a>      <span class="st">"mark"</span><span class="op">:</span> {<span class="st">"type"</span><span class="op">:</span> <span class="st">"point"</span><span class="op">,</span> <span class="st">"tooltip"</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">filled</span><span class="op">:</span><span class="kw">true</span><span class="op">,</span> <span class="dt">opacity</span><span class="op">:</span> <span class="fl">0.7</span>}<span class="op">,</span></span>
<span id="cb99-2659"><a href="#cb99-2659" aria-hidden="true" tabindex="-1"></a>      <span class="st">"encoding"</span><span class="op">:</span> {</span>
<span id="cb99-2660"><a href="#cb99-2660" aria-hidden="true" tabindex="-1"></a>        <span class="st">"color"</span><span class="op">:</span> {<span class="st">"value"</span><span class="op">:</span> <span class="st">"red"</span><span class="op">,</span> <span class="dt">legend</span><span class="op">:</span> <span class="kw">true</span>}<span class="op">,</span></span>
<span id="cb99-2661"><a href="#cb99-2661" aria-hidden="true" tabindex="-1"></a>        <span class="dt">size</span><span class="op">:</span> {<span class="dt">value</span><span class="op">:</span> <span class="dv">200</span>}<span class="op">,</span></span>
<span id="cb99-2662"><a href="#cb99-2662" aria-hidden="true" tabindex="-1"></a>        <span class="st">"y"</span><span class="op">:</span> {<span class="st">"field"</span><span class="op">:</span> <span class="st">"value"</span><span class="op">,</span> <span class="st">"type"</span><span class="op">:</span> <span class="st">"quantitative"</span><span class="op">,</span> <span class="st">"title"</span><span class="op">:</span> <span class="st">"balance"</span><span class="op">,</span> <span class="dt">zero</span><span class="op">:</span> <span class="kw">true</span>}</span>
<span id="cb99-2663"><a href="#cb99-2663" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb99-2664"><a href="#cb99-2664" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb99-2665"><a href="#cb99-2665" aria-hidden="true" tabindex="-1"></a>  ]<span class="op">,</span></span>
<span id="cb99-2666"><a href="#cb99-2666" aria-hidden="true" tabindex="-1"></a>  <span class="st">"resolve"</span><span class="op">:</span> {<span class="st">"scale"</span><span class="op">:</span> {<span class="st">"y"</span><span class="op">:</span> <span class="st">"independent"</span>}}</span>
<span id="cb99-2667"><a href="#cb99-2667" aria-hidden="true" tabindex="-1"></a>})}</span>
<span id="cb99-2668"><a href="#cb99-2668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-2669"><a href="#cb99-2669" aria-hidden="true" tabindex="-1"></a>viewof loan_viz <span class="op">=</span> <span class="fu">embed</span>(loan_spec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-25-1" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-25-2" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-25-3" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
<div id="emissions_my_lifetime" class="modeldept html-fill-item html-fill-container">
<p>‚ö†Ô∏è <em>The assumptions, methodology and limitations of a model should be carefully considered for any purpose you apply it to. I haven‚Äôt even listed these here, nor otherwise documented the model fully/clearly.</em> <strong>Proceed with caution</strong> üôè</p>
<p>‚ö†Ô∏è <em>This is not a complete model/narrative and you should not rely on it.</em></p>
<p>‚ö†Ô∏è <em>Not recommended to enter real personal or sensitive details. <strong>Contact me with real-world calculation or model requirements instead.</strong></em> üó£‚úÖ</p>
<p>‚ö†Ô∏è <em>This validator/scenario tool isn‚Äôt/won‚Äôt be financial advice etc.</em></p>
<div class="cell hidden html-fill-item html-fill-container">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb100" data-startfrom="2693" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2692;"><span id="cb100-2693"><a href="#cb100-2693" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb100-2694"><a href="#cb100-2694" aria-hidden="true" tabindex="-1"></a>  loan_viz<span class="op">.</span><span class="fu">data</span>(<span class="st">"source"</span><span class="op">,</span> loan_data)<span class="op">.</span><span class="fu">resize</span>()<span class="op">.</span><span class="fu">run</span>()<span class="op">;</span></span>
<span id="cb100-2695"><a href="#cb100-2695" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div id="ojs-cell-26" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell hidden html-fill-item html-fill-container">
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb101" data-startfrom="2708" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2707;"><span id="cb101-2708"><a href="#cb101-2708" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span><span class="vs">`</span></span>
<span id="cb101-2709"><a href="#cb101-2709" aria-hidden="true" tabindex="-1"></a><span class="vs">&lt;style&gt;</span></span>
<span id="cb101-2710"><a href="#cb101-2710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-2711"><a href="#cb101-2711" aria-hidden="true" tabindex="-1"></a><span class="vs">.fui-FluentProvider{</span></span>
<span id="cb101-2712"><a href="#cb101-2712" aria-hidden="true" tabindex="-1"></a><span class="vs">  display: none;</span></span>
<span id="cb101-2713"><a href="#cb101-2713" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb101-2714"><a href="#cb101-2714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-2715"><a href="#cb101-2715" aria-hidden="true" tabindex="-1"></a><span class="vs">.vega-embed {</span></span>
<span id="cb101-2716"><a href="#cb101-2716" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: 100%;</span></span>
<span id="cb101-2717"><a href="#cb101-2717" aria-hidden="true" tabindex="-1"></a><span class="vs">  height: 100%;</span></span>
<span id="cb101-2718"><a href="#cb101-2718" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb101-2719"><a href="#cb101-2719" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span></span>
<span id="cb101-2720"><a href="#cb101-2720" aria-hidden="true" tabindex="-1"></a><span class="vs">  .answer {</span></span>
<span id="cb101-2721"><a href="#cb101-2721" aria-hidden="true" tabindex="-1"></a><span class="vs">    color: blue !important;</span></span>
<span id="cb101-2722"><a href="#cb101-2722" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-weight: bold;</span></span>
<span id="cb101-2723"><a href="#cb101-2723" aria-hidden="true" tabindex="-1"></a><span class="vs">    font-size: 1.5em !important;</span></span>
<span id="cb101-2724"><a href="#cb101-2724" aria-hidden="true" tabindex="-1"></a><span class="vs">    left: 80px !important;</span></span>
<span id="cb101-2725"><a href="#cb101-2725" aria-hidden="true" tabindex="-1"></a><span class="vs">    top: 10px;</span></span>
<span id="cb101-2726"><a href="#cb101-2726" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb101-2727"><a href="#cb101-2727" aria-hidden="true" tabindex="-1"></a><span class="vs">  .answer .tooltiptext  {</span></span>
<span id="cb101-2728"><a href="#cb101-2728" aria-hidden="true" tabindex="-1"></a><span class="vs">    /*border: 2px dashed black;*/</span></span>
<span id="cb101-2729"><a href="#cb101-2729" aria-hidden="true" tabindex="-1"></a><span class="vs">    background: #af5a;</span></span>
<span id="cb101-2730"><a href="#cb101-2730" aria-hidden="true" tabindex="-1"></a><span class="vs">    padding: 10px;</span></span>
<span id="cb101-2731"><a href="#cb101-2731" aria-hidden="true" tabindex="-1"></a><span class="vs">    border-radius: 15px;</span></span>
<span id="cb101-2732"><a href="#cb101-2732" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span></span>
<span id="cb101-2733"><a href="#cb101-2733" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb101-2734"><a href="#cb101-2734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-2735"><a href="#cb101-2735" aria-hidden="true" tabindex="-1"></a><span class="vs">  .answer .tooltiptext::after {</span></span>
<span id="cb101-2736"><a href="#cb101-2736" aria-hidden="true" tabindex="-1"></a><span class="vs">    /*color: red;*/</span></span>
<span id="cb101-2737"><a href="#cb101-2737" aria-hidden="true" tabindex="-1"></a><span class="vs">    border: none;</span></span>
<span id="cb101-2738"><a href="#cb101-2738" aria-hidden="true" tabindex="-1"></a><span class="vs">  }</span></span>
<span id="cb101-2739"><a href="#cb101-2739" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span></span>
<span id="cb101-2740"><a href="#cb101-2740" aria-hidden="true" tabindex="-1"></a><span class="vs">.answer:hover {</span></span>
<span id="cb101-2741"><a href="#cb101-2741" aria-hidden="true" tabindex="-1"></a><span class="vs">  /*font-size:2em !important;*/</span></span>
<span id="cb101-2742"><a href="#cb101-2742" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb101-2743"><a href="#cb101-2743" aria-hidden="true" tabindex="-1"></a><span class="vs">  </span></span>
<span id="cb101-2744"><a href="#cb101-2744" aria-hidden="true" tabindex="-1"></a><span class="vs">  body {</span></span>
<span id="cb101-2745"><a href="#cb101-2745" aria-hidden="true" tabindex="-1"></a><span class="vs">  font-family: system-ui;</span></span>
<span id="cb101-2746"><a href="#cb101-2746" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb101-2747"><a href="#cb101-2747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-2748"><a href="#cb101-2748" aria-hidden="true" tabindex="-1"></a><span class="vs">pre {</span></span>
<span id="cb101-2749"><a href="#cb101-2749" aria-hidden="true" tabindex="-1"></a><span class="vs">  line-height: 25px;</span></span>
<span id="cb101-2750"><a href="#cb101-2750" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb101-2751"><a href="#cb101-2751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-2752"><a href="#cb101-2752" aria-hidden="true" tabindex="-1"></a><span class="vs">.calculang_tooltip {</span></span>
<span id="cb101-2753"><a href="#cb101-2753" aria-hidden="true" tabindex="-1"></a><span class="vs">  color: #19f;</span></span>
<span id="cb101-2754"><a href="#cb101-2754" aria-hidden="true" tabindex="-1"></a><span class="vs">  position: relative;</span></span>
<span id="cb101-2755"><a href="#cb101-2755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-2756"><a href="#cb101-2756" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb101-2757"><a href="#cb101-2757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-2758"><a href="#cb101-2758" aria-hidden="true" tabindex="-1"></a><span class="vs">.tooltiptext {</span></span>
<span id="cb101-2759"><a href="#cb101-2759" aria-hidden="true" tabindex="-1"></a><span class="vs">  position: absolute;</span></span>
<span id="cb101-2760"><a href="#cb101-2760" aria-hidden="true" tabindex="-1"></a><span class="vs">  bottom: calc(100% - 15px);</span></span>
<span id="cb101-2761"><a href="#cb101-2761" aria-hidden="true" tabindex="-1"></a><span class="vs">  left: anchor(center);</span></span>
<span id="cb101-2762"><a href="#cb101-2762" aria-hidden="true" tabindex="-1"></a><span class="vs">  transform: translateX(-50%);</span></span>
<span id="cb101-2763"><a href="#cb101-2763" aria-hidden="true" tabindex="-1"></a><span class="vs">  width: max-content;</span></span>
<span id="cb101-2764"><a href="#cb101-2764" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb101-2765"><a href="#cb101-2765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-2766"><a href="#cb101-2766" aria-hidden="true" tabindex="-1"></a><span class="vs">.tooltiptext {</span></span>
<span id="cb101-2767"><a href="#cb101-2767" aria-hidden="true" tabindex="-1"></a><span class="vs">  cursor: zoom-in;</span></span>
<span id="cb101-2768"><a href="#cb101-2768" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb101-2769"><a href="#cb101-2769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-2770"><a href="#cb101-2770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-2771"><a href="#cb101-2771" aria-hidden="true" tabindex="-1"></a><span class="vs">.calculang_tooltip.answer .tooltiptext {</span></span>
<span id="cb101-2772"><a href="#cb101-2772" aria-hidden="true" tabindex="-1"></a><span class="vs">  bottom: 0;</span></span>
<span id="cb101-2773"><a href="#cb101-2773" aria-hidden="true" tabindex="-1"></a><span class="vs">} </span></span>
<span id="cb101-2774"><a href="#cb101-2774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-2775"><a href="#cb101-2775" aria-hidden="true" tabindex="-1"></a><span class="vs">calculang_tooltip.answer {</span></span>
<span id="cb101-2776"><a href="#cb101-2776" aria-hidden="true" tabindex="-1"></a><span class="vs">    background-color: lightorange;</span></span>
<span id="cb101-2777"><a href="#cb101-2777" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb101-2778"><a href="#cb101-2778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-2779"><a href="#cb101-2779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-2780"><a href="#cb101-2780" aria-hidden="true" tabindex="-1"></a><span class="vs">pre {</span></span>
<span id="cb101-2781"><a href="#cb101-2781" aria-hidden="true" tabindex="-1"></a><span class="vs">  cursor:default</span></span>
<span id="cb101-2782"><a href="#cb101-2782" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb101-2783"><a href="#cb101-2783" aria-hidden="true" tabindex="-1"></a><span class="vs">  &lt;/style&gt;</span></span>
<span id="cb101-2784"><a href="#cb101-2784" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-27-1" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<details class="code-fold hidden">
<summary>Show the code</summary>
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb102" data-startfrom="2786" data-source-offset="-989"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 2785;"><span id="cb102-2786"><a href="#cb102-2786" aria-hidden="true" tabindex="-1"></a>viewof color <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">text</span>({ <span class="dt">label</span><span class="op">:</span> <span class="st">"color"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"#0D0"</span> })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-27-2" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>


<div id="3ade8a4a-fb1d-4a6c-8409-ac45482d5fc9" class="hidden">

</div>
</div>
</div>


<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxuLy8gcmF5Y2FzdGluZ1xudmlld29mIHBsYXllcl94X2luID0gSW5wdXRzLmlucHV0KDEuNylcbnZpZXdvZiBwbGF5ZXJfeV9pbiA9IElucHV0cy5pbnB1dCg1LjUpXG52aWV3b2YgcmF5X2FuZ2xlX2luID0gSW5wdXRzLmlucHV0KDk5OSlcbnZpZXdvZiBmaXNoZXllX2NvcnJlY3Rpb25faW4gPSBJbnB1dHMuaW5wdXQodHJ1ZSlcbnZpZXdvZiBzdGVwX2luID0gSW5wdXRzLmlucHV0KDApXG52aWV3b2YgeF9pbiA9IElucHV0cy5pbnB1dCgzLjUpXG52aWV3b2YgeV9pbiA9IElucHV0cy5pbnB1dCgzLjUpXG52aWV3b2YgZl9pbiA9IElucHV0cy5pbnB1dCgwKVxudmlld29mIGtleV9zdHJlYW1fdmVyc2lvbl9pbiA9IElucHV0cy5pbnB1dCgwKVxudmlld29mIGtleXNfc3RyZWFtX3ZlcnNpb25faW4gPSBJbnB1dHMuaW5wdXQoXCJoaVwiKVxuXG4vLyBlbWlzc2lvbnMtc2F2aW5ncyBpbnRlcmFjdGlvbnMgdXNpbmcgeWVhciBmb3IgZGlmZmVyZW50IG1lYW5pbmdzIGRlc3Ryb3lzIGVhY2hvdGhlclxudmlld29mIGVtaXNzaW9uc195ZWFyX2luID0gSW5wdXRzLmlucHV0KDIwMjQpXG5cblxuLy8gc2F2aW5nc1xudmlld29mIGFubnVhbF9wYXltZW50X2luID0gSW5wdXRzLmlucHV0KDEwMDApXG52aWV3b2YgZHVyYXRpb25faW4gPSBJbnB1dHMuaW5wdXQoNSlcbnZpZXdvZiBpbnRlcmVzdF9yYXRlX2luID0gSW5wdXRzLmlucHV0KC4wMilcbnZpZXdvZiB5ZWFyX2luID0gSW5wdXRzLmlucHV0KG1vZGVsbmFtZSA9PSAnc2ltcGxlX2xvYW4nID8gMSA6IDUpXG52aWV3b2YgaV9pbiA9IElucHV0cy5pbnB1dChtb2RlbG5hbWUgPT0gJ2ZpenpidXp6JyA/IDAgOiArKHEuZ2V0KCdpX2luJyk/PzQpLzEwMCkgLy8gdnMgMiBmb3IgZml6emJ1enohIVxuXG52aWV3b2YgZGF0ZV9pbiA9IElucHV0cy5pbnB1dChuZXcgRGF0ZSgpKVxudmlld29mIG5vd19pbiA9IElucHV0cy5pbnB1dChuZXcgRGF0ZSgpKVxudmlld29mIHRpbWluZ19pbiA9ICBJbnB1dHMuaW5wdXQobW9kZWxuYW1lID09ICdlbWlzc2lvbnNfbXlfbGlmZXRpbWUnID8gXCJzdGFydCBvZiBiaXJ0aHllYXJcIiA6IFwic3RhcnQgb2YgdG9kYXlcIilcblxuXG4vLyBzdGFyZmllbGRcbnZpZXdvZiBzdGFyX2luID0gSW5wdXRzLmlucHV0KDMpXG52aWV3b2Ygc3BlZWRfaW4gPSBJbnB1dHMuaW5wdXQoMylcbnZpZXdvZiBmcmFtZV9pbiA9IElucHV0cy5pbnB1dCgyKVxudmlld29mIHJhbmRvbV9zZWVkX2luID0gSW5wdXRzLmlucHV0KFwiaGVsbG9cIilcblxuLy8gbG9hbiBiYWQuIGlfaW4gcHJvYmxlbT9cbnZpZXdvZiBkX2lfaW4gPSBJbnB1dHMuaW5wdXQoMC4wMilcbnZpZXdvZiBkX2lfeWVhcl9pbiA9IElucHV0cy5pbnB1dCg5OSlcbnZpZXdvZiBtaXNzZWRfcmVwYXltZW50X3llYXJfaW4gPSBJbnB1dHMuaW5wdXQoLTk5KVxudmlld29mIHNraXBfaW50ZXJlc3RfaW4gPSBJbnB1dHMuaW5wdXQoZmFsc2UpXG52aWV3b2YgcHJpbmNpcGFsX2luID0gSW5wdXRzLmlucHV0KCsocS5nZXQoJ3ByaW5jaXBhbF9pbicpID8/IDEwMDAwMCkpXG52aWV3b2YgdGVybV9pbiA9IElucHV0cy5pbnB1dCgrKHEuZ2V0KCd0ZXJtX2luJyk/PzEwKSlcblxuLy8gc25vd2ZsYWtlc1xudmlld29mIGhlaWdodF9pbiA9IElucHV0cy5pbnB1dCgyMDApXG52aWV3b2YgcF9pbiA9IElucHV0cy5pbnB1dCgxKVxudmlld29mIHdfaW4gPSBJbnB1dHMuaW5wdXQoLjYpXG52aWV3b2Ygd2lkdGhfaW4gPSBJbnB1dHMuaW5wdXQoNDAwKVxuXG52aWV3b2YgYWdlX2luID0gSW5wdXRzLmlucHV0KDI1KVxuXG5cblxuLy8gc2F2aW5ncy1yZWNcbnZpZXdvZiBhY3R1YWxfaW50ZXJlc3RfcmF0ZV9jb19pbiA9IElucHV0cy5pbnB1dCgwKVxuXG5cbm1pbmlfYmluZHMgPSB7XG4gIHJldHVybiAoe1xuICAgIGZpc2hleWVfY29ycmVjdGlvbl9pbjogSW5wdXRzLnRvZ2dsZSh7bGFiZWw6J/CfkJ/wn5GAIGNvcnJlY3QnfSksXG4gICAgZHVyYXRpb25faW46IElucHV0cy5yYW5nZShbMCwyMF0sIHtsYWJlbDonZHVyYXRpb24nLCBzdGVwOiAxLCBkaXNhYmxlZDogbW9kZWxuYW1lID09ICdzYXZpbmdzX3JlYyd9KSxcbiAgICB0ZXJtX2luOiBJbnB1dHMuc2VsZWN0KFsyNSwgMTUsIDEwLCA1LCAzMCwgMzUsIDQwLCAxLCA0ODBdLCB7bGFiZWw6IFwiVGVybSAoeWVhcnMpXCJ9KSxcbiAgICB5ZWFyX2luOiBJbnB1dHMucmFuZ2UoWy0xLG1vZGVsbmFtZSA9PSAnc2ltcGxlX2xvYW4nID8gdGVybV9pbiA6IGR1cmF0aW9uX2luXSwge2xhYmVsOid5ZWFyJywgc3RlcDogMX0pLFxuICAgIGVtaXNzaW9uc195ZWFyX2luOiBJbnB1dHMucmFuZ2UoWzE3NTAsMjAyNF0sIHtsYWJlbDonZW1pc3Npb25zIHllYXInLCBzdGVwOiAxfSksXG4gICAgYWdlX2luOiBJbnB1dHMucmFuZ2UoWzE4LDEwMF0sIHtsYWJlbDoneW91ciBhZ2UnLCBzdGVwOiAxfSksXG4gICAgYW5udWFsX3BheW1lbnRfaW46IElucHV0cy5yYW5nZShbMCwgMjAwMDBdLCB7bGFiZWw6J2FubnVhbF9wYXltZW50X2luJywgc3RlcDogMTAwLCBkaXNhYmxlZDogbW9kZWxuYW1lID09ICdzYXZpbmdzX3JlYyd9KSxcbiAgICBpbnRlcmVzdF9yYXRlX2luOiBJbnB1dHMucmFuZ2UoWy0wLjEsIDAuMV0sIHtmb3JtYXQ6IGQzLmZvcm1hdCgnLjNmJyksIGxhYmVsOidpbnRlcmVzdF9yYXRlX2luJywgc3RlcDowLjAwMSwgZGlzYWJsZWQ6IG1vZGVsbmFtZSA9PSAnc2F2aW5nc19yZWMnfSkgLy8gcHJlY2lzaW9uIGhvdz9cbiAgICAsIGFjdHVhbF9pbnRlcmVzdF9yYXRlX2NvX2luOiBJbnB1dHMucmFuZ2UoWy0xLCAyMF0sIHtsYWJlbDonYWN0dWFsX2ludGVyZXN0X3JhdGVfY29faW4nLCBzdGVwOjF9KVxuICAgICwgZl9pbjogSW5wdXRzLnJhbmdlKFswLCAyMDBdLCB7bGFiZWw6J2ZfaW4nLCBzdGVwOjF9KVxuICAgICwgcHJpbmNpcGFsX2luOiBJbnB1dHMucmFuZ2UoWzAsIDUwMDAwMF0sIHtsYWJlbDoncHJpbmNpcGFsX2luJywgc3RlcDoxMDAwfSlcbiAgICAvLywga2V5c19zdHJlYW1fZnVuY3Rpb25faW46IG1kYChrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbilgXG4gICAgLy8sIHN0ZXBfaW46IFRhbmdsZSh7bWluOiAtMSwgbWF4OiAyMCwgbGFiZWw6J3N0ZXBfaW4nfSlcbiAgICAvLywgeF9pbjogVGFuZ2xlKHttaW46IC0xLCBtYXg6IDIwMCwgbGFiZWw6J3hfaW4nfSlcbiAgICAvLywgeV9pbjogVGFuZ2xlKHttaW46IC0xLCBtYXg6IDIwMCwgbGFiZWw6J3lfaW4nfSlcbiAgICAvLywgcGxheWVyX3hfaW46IFRhbmdsZSh7bWluOiAtMSwgbWF4OiAxMCxmb3JtYXQ6IGQzLmZvcm1hdCgnLjJmJyksIGxhYmVsOidwbGF5ZXJfeF9pbid9KVxuICAgIC8vLCBwbGF5ZXJfeV9pbjogVGFuZ2xlKHttaW46IC0xLCBtYXg6IDEwLCBmb3JtYXQ6IGQzLmZvcm1hdCgnLjJmJyksbGFiZWw6J3BsYXllcl95X2luJ30pXG4gICAgLy8gb2ZmIHRvIGNoZWNrIHBlcmYgaW1wYWN0LCByYXlfYW5nbGVfaW46IElucHV0cy5yYW5nZShbLTIwLDIwXSwge2xhYmVsOidyYXlfYW5nbGVfaW4nfSkvL1RhbmdsZSh7bWluOiAtMSwgbWF4OiAxMCwgZm9ybWF0OiBkMy5mb3JtYXQoJy4yZicpLGxhYmVsOidyYXlfYW5nbGVfaW4nfSlcbiAgICAsIGlfaW46IG1vZGVsbmFtZSA9PSAnZml6emJ1enonID8gSW5wdXRzLnJhbmdlKFstMTAsIDIwMF0sIHtsYWJlbDonaV9pbicsIHN0ZXA6MX0pIDogSW5wdXRzLnJhbmdlKFstMC4xLCAwLjFdLCB7bGFiZWw6J2lfaW4nLCBzdGVwOjAuMDAxfSlcbiAgICAsIGRfaV9pbjogSW5wdXRzLnJhbmdlKFstMC4xLCAwLjFdLCB7bGFiZWw6J86UIGlfaW4nLCBzdGVwOjAuMDAxfSlcbiAgICAsIGRfaV95ZWFyX2luOiBJbnB1dHMucmFuZ2UoWy0xLDk5XSwge2xhYmVsOifOlCBpX2luIHllYXInLCBzdGVwOiAxfSlcbiAgICAsIHN0ZXBfaW46IElucHV0cy5yYW5nZShbMCwgMTBdLCB7bGFiZWw6J3N0ZXBfaW4nLCBzdGVwOjF9KVxuICAgICwgZGF0ZV9pbjogSW5wdXRzLmRhdGUoe2xhYmVsOiBcImRhdGVcIn0pXG4gICAgLCBub3dfaW46IElucHV0cy5kYXRlKHtsYWJlbDogXCJub3dcIn0pXG4gICAgLCB0aW1pbmdfaW46IG1vZGVsbmFtZSA9PSAnZW1pc3Npb25zX215X2xpZmV0aW1lJyA/ICBJbnB1dHMuc2VsZWN0KFtcInN0YXJ0IG9mIGJpcnRoeWVhclwiLCBcImVuZCBvZiBiaXJ0aHllYXJcIl0pIDogSW5wdXRzLnNlbGVjdChbXCJzdGFydCBvZiB0b2RheVwiLCBcInN0YXJ0IG9mIHRvbW9ycm93XCJdKVxuICAgICwgcmFuZG9tX3NlZWRfaW46IElucHV0cy50ZXh0KHtsYWJlbDogJ3JhbmRvbSBzZWVkJ30pXG4gICAgLCBmcmFtZV9pbjogSW5wdXRzLnJhbmdlKFswLDIwMF0sIHtsYWJlbDonZnJhbWVfaW4nLCBzdGVwOjF9KVxuICAgICwgc3Rhcl9pbjogSW5wdXRzLnJhbmdlKFswLDIwMF0sIHtsYWJlbDonc3Rhcl9pbicsIHN0ZXA6MX0pXG4gICAgLCBzcGVlZF9pbjogSW5wdXRzLnJhbmdlKFstMSwxMF0sIHtsYWJlbDonc3BlZWRfaW4nLCBzdGVwOjAuMX0pXG5cbiAgfSlcbn1cblxuXG5JbnB1dHMuYmluZChtaW5pX2JpbmRzLmZpc2hleWVfY29ycmVjdGlvbl9pbiwgdmlld29mIGZpc2hleWVfY29ycmVjdGlvbl9pbilcbklucHV0cy5iaW5kKG1pbmlfYmluZHMuZHVyYXRpb25faW4sIHZpZXdvZiBkdXJhdGlvbl9pbilcbklucHV0cy5iaW5kKG1pbmlfYmluZHMueWVhcl9pbiwgdmlld29mIHllYXJfaW4pXG5JbnB1dHMuYmluZChtaW5pX2JpbmRzLmVtaXNzaW9uc195ZWFyX2luLCB2aWV3b2YgZW1pc3Npb25zX3llYXJfaW4pXG5JbnB1dHMuYmluZChtaW5pX2JpbmRzLmFubnVhbF9wYXltZW50X2luLCB2aWV3b2YgYW5udWFsX3BheW1lbnRfaW4pXG5JbnB1dHMuYmluZChtaW5pX2JpbmRzLmludGVyZXN0X3JhdGVfaW4sIHZpZXdvZiBpbnRlcmVzdF9yYXRlX2luKVxuSW5wdXRzLmJpbmQobWluaV9iaW5kcy5hY3R1YWxfaW50ZXJlc3RfcmF0ZV9jb19pbiwgdmlld29mIGFjdHVhbF9pbnRlcmVzdF9yYXRlX2NvX2luKVxuSW5wdXRzLmJpbmQobWluaV9iaW5kcy5mX2luLCB2aWV3b2YgZl9pbilcbklucHV0cy5iaW5kKG1pbmlfYmluZHMueF9pbiwgdmlld29mIHhfaW4pXG5JbnB1dHMuYmluZChtaW5pX2JpbmRzLnlfaW4sIHZpZXdvZiB5X2luKVxuSW5wdXRzLmJpbmQobWluaV9iaW5kcy5wbGF5ZXJfeF9pbiwgdmlld29mIHBsYXllcl94X2luKVxuSW5wdXRzLmJpbmQobWluaV9iaW5kcy5wbGF5ZXJfeV9pbiwgdmlld29mIHBsYXllcl95X2luKVxuSW5wdXRzLmJpbmQobWluaV9iaW5kcy5zdGVwX2luLCB2aWV3b2Ygc3RlcF9pbilcbklucHV0cy5iaW5kKG1pbmlfYmluZHMucmF5X2FuZ2xlX2luLCB2aWV3b2YgcmF5X2FuZ2xlX2luKVxuSW5wdXRzLmJpbmQobWluaV9iaW5kcy5pX2luLCB2aWV3b2YgaV9pbilcbklucHV0cy5iaW5kKG1pbmlfYmluZHMuZGF0ZV9pbiwgdmlld29mIGRhdGVfaW4pXG5JbnB1dHMuYmluZChtaW5pX2JpbmRzLnRpbWluZ19pbiwgdmlld29mIHRpbWluZ19pbilcbklucHV0cy5iaW5kKG1pbmlfYmluZHMucmFuZG9tX3NlZWRfaW4sIHZpZXdvZiByYW5kb21fc2VlZF9pbilcbklucHV0cy5iaW5kKG1pbmlfYmluZHMuZnJhbWVfaW4sIHZpZXdvZiBmcmFtZV9pbilcbklucHV0cy5iaW5kKG1pbmlfYmluZHMuc3BlZWRfaW4sIHZpZXdvZiBzcGVlZF9pbilcbklucHV0cy5iaW5kKG1pbmlfYmluZHMuc3Rhcl9pbiwgdmlld29mIHN0YXJfaW4pXG5JbnB1dHMuYmluZChtaW5pX2JpbmRzLnByaW5jaXBhbF9pbiwgdmlld29mIHByaW5jaXBhbF9pbilcbklucHV0cy5iaW5kKG1pbmlfYmluZHMudGVybV9pbiwgdmlld29mIHRlcm1faW4pXG5JbnB1dHMuYmluZChtaW5pX2JpbmRzLmFnZV9pbiwgdmlld29mIGFnZV9pbilcbklucHV0cy5iaW5kKG1pbmlfYmluZHMuZF9pX2luLCB2aWV3b2YgZF9pX2luKVxuSW5wdXRzLmJpbmQobWluaV9iaW5kcy5kX2lfeWVhcl9pbiwgdmlld29mIGRfaV95ZWFyX2luKVxuSW5wdXRzLmJpbmQobWluaV9iaW5kcy5ub3dfaW4sIHZpZXdvZiBub3dfaW4pXG5cblxuXG4vLyBUT0RPIE1BS0UgU1RFUFMgSElHSExJR0hUIFJFQUNUIFRPIFNURVBfSU4gVEFOR0xFXG5cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxuLy8gd29ya2luZyBpbnRlcmFjdGl2aXR5XG5cbmh0bWxgPHN0eWxlPlxuXG4uaW5wdXRzIHtcbiAgcGFkZGluZzogMjBweDtcbn1cblxuYnV0dG9uLmJ0biB7XG4gIGJhY2tncm91bmQtY29sb3I6IGFudGlxdWV3aGl0ZTtcbiAgY29sb3I6IGJsdWU7XG4gIHBhZGRpbmc6MDtcbn1cblxuLmNhbGN1bGFuZyB7XG4gIGxpbmUtaGVpZ2h0OiA0MHB4O1xuICAgIC13ZWJraXQtdHJhbnNpdGlvbjogYWxsIDAuMnMgbGluZWFyO1xuICAgIC1tb3otdHJhbnNpdGlvbjogYWxsIDAuMnMgbGluZWFyO1xuICAgIC1vLXRyYW5zaXRpb246IGFsbCAwLjJzIGxpbmVhcjtcbiAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBsaW5lYXI7XG4gIFxufVxuZGl2LmNhbGN1bGFuZy5jbS1saW5lOmhhcyhzcGFuLmNhbGN1bGFuZ190aXRsZSkge1xuICBtYXJnaW4tdG9wOjIwcHg7XG59XG5cbi5jYWxjdWxhbmcuY2FsY3VsYW5nX292ZXJ3cml0dGVuIHtcbiAgdGV4dC1kZWNvcmF0aW9uOiBsaW5lLXRocm91Z2g7XG4gIGZvbnQtd2VpZ2h0OiBib2xkO1xufVxuXG4ke2Zvcm11bGFlX2hpZGRlbi5sZW5ndGggPyBgLmNhbGN1bGFuZyB7XG4gICAgYmFja2dyb3VuZDogI2FhZjM7XG59YCA6ICcnfVxuXG5cbiR7Zm9ybXVsYWVfaGlkZGVuLm1hcChkID0+IGAuY2FsY3VsYW5nX2ZfJHtkfSArIC5jYWxjdWxhbmdfZl8ke2R9YCkuam9pbignLCAnKX0ge1xuICBmaWx0ZXI6IGJsdXIoN3B4KTtcbiAgbGluZS1oZWlnaHQ6IDVweDtcbiAgb3BhY2l0eTogMC41O1xufSAvKiArIHNlbGVjdG9yIHRvIGV4Y2x1ZGUgZmlyc3QhIGh0dHBzOi8vY29kZXJ3YWxsLmNvbS9wL3V1Z3Vydy9jc3Mtc2VsZWN0b3ItdHJpY2stc2VsZWN0LWFsbC1lbGVtZW50cy1leGNlcHQtdGhlLWZpcnN0ICovXG4ke2Zvcm11bGFlX2hpZGRlbi5tYXAoZCA9PiBgLmNhbGN1bGFuZ19mXyR7ZH1gKS5qb2luKCcsICcpfSB7XG4gIG9wYWNpdHk6IDAuNTtcbiAgYmFja2dyb3VuZDogd2hpdGU7XG59JHtmb3JtdWxhZV9oaWRkZW4ubWFwKGQgPT4gYC5jYWxjdWxhbmdfZl8ke2R9IC5jYWxjdWxhbmdfdG9vbHRpcGApLmpvaW4oJywgJyl9IHtcbiAgb3BhY2l0eTogMC4xO1xuICBiYWNrZ3JvdW5kOiB3aGl0ZTtcbn1cbiR7Zm9ybXVsYWVfaGlkZGVuLm1hcChkID0+IGAuY2FsY3VsYW5nX2ZfJHtkfSA+IC5jYWxjdWxhbmdfdGl0bGVgKS5qb2luKCcsICcpfSB7XG4gIGJhY2tncm91bmQtY29sb3I6IGxpZ2h0Z3JlZW47XG4gIGZvbnQtc2l6ZTogMC41ZW07XG59XG5cbnNwYW4uY2FsY3VsYW5nX2NhbGwgeyBcbiAgd2hpdGUtc3BhY2U6bm93cmFwO1xuICBjdXJzb3I6IHpvb20taW47XG4gIGJhY2tncm91bmQtY29sb3I6IGxpZ2h0Ymx1ZTtcbn1cblxuLnRvb2x0aXB0ZXh0IHsvKiBub3QgYWxsIHRvb2x0aXB0ZXh0cyBnbyB1bmRlciBhIGNhbGN1bGFuZyBjYWxsIHNwYW4hIChzaW5nbGUtbGVuZ3RoIG9uZXMgZG9udCkgKi9cbiAgLypjb2xvcjogcmVkOyovXG4gIGZvbnQtd2VpZ2h0OiBib2xkO1xuXG59XG5cbi5jYWxjdWxhbmdfY2FsbC5jYWxjdWxhbmdfY2FsbF9pbnB1dCB7XG4gIC8qY3Vyc29yOiBub25lOyovXG4gIGJhY2tncm91bmQtY29sb3I6IHBpbms7XG59XG5cbi5jYWxjdWxhbmdfY2FsbC5jYWxjdWxhbmdfY2FsbF9pbnB1dCAudG9vbHRpcHRleHQge1xuICBjb2xvcjogI2Y1MyAhaW1wb3J0YW50Oztcbn1cblxuLmNhbGN1bGFuZyAuY2FsY3VsYW5nX3RpdGxlIHNwYW4ge1xuICBwYWRkaW5nOiAzcHg7XG4gIGJhY2tncm91bmQ6ICNhZjU0O1xuICBmb250LXNpemU6IDEuNWVtO1xuICBmb250LXdlaWdodDogYm9sZDtcbiAgYm9yZGVyOiAxcHggc29saWQgZ3JleTtcbiAgICAtd2Via2l0LXRyYW5zaXRpb246IGFsbCAwLjJzIGxpbmVhcjtcbiAgICAtbW96LXRyYW5zaXRpb246IGFsbCAwLjJzIGxpbmVhcjtcbiAgICAtby10cmFuc2l0aW9uOiBhbGwgMC4ycyBsaW5lYXI7XG4gICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgbGluZWFyO1xuXG59XG5cbi5jYWxjdWxhbmdfdGl0bGUuY2FsY3VsYW5nX3RpdGxlX3JlbmFtZWQge1xuICB0ZXh0LWRlY29yYXRpb246IGxpbmUtdGhyb3VnaDtcbiAgdGV4dC1kZWNvcmF0aW9uLXN0eWxlOiBkYXNoZWQ7XG59XG48L3N0eWxlPmBcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Ii8vbW9kZWwgPSByZXF1aXJlKGAke2VudHJ5cG9pbnRfbm9fY3VsX2pzfS5qc2ApLy9cblxuLyptb2RlbHMgPSAoe3NhdmluZ3M6IDMsLy9yZXF1aXJlKGAke2VudHJ5cG9pbnRfbm9fY3VsX2pzfS5qc2ApLFxuICByYXljYXN0aW5nMjogcmVxdWlyZSgnaHR0cHM6Ly9jYWxjdWxhbmcuZGV2L21vZGVscy9yYXljYXN0aW5nL3JheWNhc3RpbmcuanMnKX0pKi9cblxuLy8gVE9ETyB3b3JrIHdpdGggbWVtbyBzYXZpbmdzLXJlY1xuXG5maXp6YnV6eiA9IGF3YWl0IHJlcXVpcmUoYGh0dHBzOi8vY2FsY3VsYW5nLmRldi9tb2RlbHMvZml6emJ1enovZml6emJ1enouanNgKVxueWVhcl9yZW1haW5pbmcgPSBhd2FpdCByZXF1aXJlKGBodHRwczovL2NhbGN1bGFuZy5kZXYvbW9kZWxzL3llYXItcmVtYWluaW5nL3llYXItcmVtYWluaW5nLmpzYClcbnN0YXJmaWVsZCA9IGF3YWl0IHJlcXVpcmUoYGh0dHBzOi8vY2FsY3VsYW5nLmRldi9tb2RlbHMvc3RhcmZpZWxkL3N0YXJmaWVsZC5qc2ApXG4vLyBVUERBVEUxIExPQUQgTU9ERUwgVVNJTkcgQ09SUkVDVCBSRUZcblxuc2F2aW5ncyA9IGF3YWl0IHJlcXVpcmUoYGh0dHBzOi8vY2FsY3VsYW5nLmRldi9tb2RlbHMvc2F2aW5ncy9zYXZpbmdzLmpzYCk7XG5cbnNhdmluZ3NfcmVjID0gYXdhaXQgcmVxdWlyZShgaHR0cHM6Ly9jYWxjdWxhbmcuZGV2L21vZGVscy9zYXZpbmdzL3NhdmluZ3MtcmVjLmpzYClcblxuXG5pbnRyb3NwZWN0aW9uX2ZldGNoID0gYXdhaXQgZmV0Y2goYCR7ZW50cnlwb2ludF9ub19jdWxfanN9LmludHJvc3BlY3Rpb24uanNvbmApXG5cbmludHJvc3BlY3Rpb24gPSBhd2FpdCBpbnRyb3NwZWN0aW9uX2ZldGNoLmpzb24oe3R5cGVkOnRydWV9KVxuXG5pbnRyb3NwZWN0aW9uX25vbWVtb19mZXRjaCA9IGF3YWl0IGZldGNoKGAke2VudHJ5cG9pbnRfbm9fY3VsX2pzfSR7Y2FsY3VsYW5nX3NvdXJjZV9ub21lbW8ubGVuZ3RoID8gJy1ub21lbW8nIDogJyd9LmludHJvc3BlY3Rpb24uanNvbmApXG5cbmludHJvc3BlY3Rpb25fbm9tZW1vID0gYXdhaXQgaW50cm9zcGVjdGlvbl9ub21lbW9fZmV0Y2guanNvbih7dHlwZWQ6dHJ1ZX0pXG5cblxuY2FsY3VsYW5nX3NvdXJjZV9pbnRyb3NwZWN0aW9uID0gY2FsY3VsYW5nX3NvdXJjZV9ub21lbW8ubGVuZ3RoID8gaW50cm9zcGVjdGlvbl9ub21lbW8gOiBpbnRyb3NwZWN0aW9uXG5cbmZvcm11bGFlX29ianMgPSBPYmplY3QudmFsdWVzKGNhbGN1bGFuZ19zb3VyY2VfaW50cm9zcGVjdGlvbi5jdWxfZnVuY3Rpb25zKS5maWx0ZXIoZCA9PiBkLnJlYXNvbiA9PSAnZGVmaW5pdGlvbicgJiYgaW5wdXRzLmluZGV4T2YoZC5uYW1lKydfaW4nKSA9PSAtMSlcbmlucHV0X2Zvcm11bGFlX29ianMgPSBPYmplY3QudmFsdWVzKGNhbGN1bGFuZ19zb3VyY2VfaW50cm9zcGVjdGlvbi5jdWxfZnVuY3Rpb25zKS5maWx0ZXIoZCA9PiBkLnJlYXNvbiA9PSAnZGVmaW5pdGlvbicgJiYgaW5wdXRzLmluZGV4T2YoZC5uYW1lKydfaW4nKSAhPSAtMSlcblxuaW5wdXRzID0gXy51bmlxKE9iamVjdC52YWx1ZXMoY2FsY3VsYW5nX3NvdXJjZV9pbnRyb3NwZWN0aW9uLmN1bF9mdW5jdGlvbnMpLmZpbHRlcihkID0+IGQucmVhc29uID09ICdpbnB1dCBkZWZpbml0aW9uJykubWFwKGQgPT4gZC5uYW1lKS5zb3J0KCkpXG5cbmZuczAgPSBPYmplY3QudmFsdWVzKGNhbGN1bGFuZ19zb3VyY2VfaW50cm9zcGVjdGlvbi5jdWxfZnVuY3Rpb25zKS5maWx0ZXIoZCA9PiBkLmN1bF9zY29wZV9pZCA9PSAwKS5tYXAoZCA9PiBkLmlucHV0cykuZmxhdCgpXG5cblxuaW1wb3J0IHsgQ29kZU1pcnJvciwgbG9hZENvZGVNaXJyb3JNb2R1bGVzIH0gZnJvbSBcIkBqbWF0c3VzaGl0YS9jb2RlbWlycm9yQDY3MFwiO1xuXG5jbUltcG9ydHMgPSBsb2FkQ29kZU1pcnJvck1vZHVsZXMoW1xuICBcInZpZXdANi4yMi4yXCIsIC8vIGNoayB2ZXJzaW9ucz9cbiAgXCJzdGF0ZUA2LjMuM1wiLFxuICBcImxhbmd1YWdlQDYuOS4zXCIsXG4gIFwibGFuZy1qYXZhc2NyaXB0XCJcbiAgLy9cImNvbW1hbmRzQDYuMy4yXCIsXG5dKTtcblxuRWRpdG9yVmlldyA9IGNtSW1wb3J0cy52aWV3LkVkaXRvclZpZXdcblxuRWRpdG9yU3RhdGUgPSBjbUltcG9ydHMuc3RhdGUuRWRpdG9yU3RhdGVcblxuRGVjb3JhdGlvbiA9IGNtSW1wb3J0cy52aWV3LkRlY29yYXRpb25cblxuc2V0ID0gKGlucHV0LCB2YWx1ZSkgPT4ge1xuICBpbnB1dC52YWx1ZSA9IHZhbHVlO1xuICBpbnB1dC5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudChcImlucHV0XCIsIHtidWJibGVzOiB0cnVlfSkpO1xufVxuXG4vLy8vLy8vLy8vLy8gcGx1Z2luIDE6IGRlY29yYXRpb24gJiBjdWwgbmF2aWdhdGlvbiBmb3IgZnVuY3Rpb24tbGV2ZWxcblxuc3ludGF4VHJlZSA9IGNtSW1wb3J0cy5sYW5ndWFnZS5zeW50YXhUcmVlXG5cbmZvcm11bGFEZWNvcmF0aW9ucyA9IHtcbiAgcmV0dXJuIChvcHRpb25zKSA9PiB7XG4gICAgLy9zZXQob3B0aW9ucy5mb3JtdWxhZV92aXNpYmxlLCBbXCJcIl0pIC8vIHRoaXMgd2FzIGRvaW5nIGEgbG90IG9mIGphbmshIVxuICAgIGNvbnN0IGZvcm11bGFEZWNvcmF0aW9ucyA9IGNtSW1wb3J0cy52aWV3LlZpZXdQbHVnaW4uZnJvbUNsYXNzKFxuICAgICAgY2xhc3Mge1xuXG4gICAgICAgIGNvbnN0cnVjdG9yKHZpZXcpIHtcbiAgICAgICAgICB0aGlzLmRlY29yYXRpb25zID0gZm9ybXVsYURlY29yYXRpb24odmlldyk7XG4gICAgICAgIH1cblxuICAgICAgICB1cGRhdGUodXBkYXRlKSB7XG4gICAgICAgICAgaWYgKHVwZGF0ZS5kb2NDaGFuZ2VkIHx8IHVwZGF0ZS52aWV3cG9ydENoYW5nZWQpXG4gICAgICAgICAgICB0aGlzLmRlY29yYXRpb25zID0gZm9ybXVsYURlY29yYXRpb24odXBkYXRlLnZpZXcpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBkZWNvcmF0aW9uczogKHYpID0+IHYuZGVjb3JhdGlvbnMsXG5cbiAgICAgICAgZXZlbnRIYW5kbGVyczoge1xuICAgICAgICAgIG1vdXNlZG93bjogKGUsIHZpZXcpID0+IHsgLy8gSE1NTSBJJ2xsIG5lZWQgdG8gcmVzb2x2ZSB0aGF0IGNhbGxzIGdldCBwcmVjZWRlbmNlISEhIFNob3VsZCBiZSB3b3JraW5nOlxuICAgICAgICAgICAgbGV0IGNsYXNzTGlzdCA9IFsuLi5lLnRhcmdldC5jbGFzc0xpc3QsIC4uLmUudGFyZ2V0LnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0XSAvLyB2ZXJ5IG9wZW4sIGJlIGF3YXJlIG9mIGJ1Z3MgPyFcbiAgICAgICAgICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJjdWxfY2FsbFwiKSkgLy8gVE9ET1xuICAgICAgICAgICAgICAxOy8vc2V0KHZpZXdvZiBmb3JtdWxhZV9zaG93biwgW3RhcmdldC50ZXh0Q29udGVudF0pOyBUT0RPXG4gICAgICAgICAgICBlbHNlIGlmIChcbiAgICAgICAgICAgICAgLy9lLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJkZXBvc2l0c1wiKSB8fFxuICAgICAgICAgICAgICAvL2UudGFyZ2V0LnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZGVwb3NpdHNcIilcbiAgICAgICAgICAgICAgY2xhc3NMaXN0LmZpbHRlcihkID0+IGQuaW5jbHVkZXMoXCJjYWxjdWxhbmdfZl9cIikpLmxlbmd0aFxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgICBzZXQob3B0aW9ucy5mb3JtdWxhZV92aXNpYmxlLCBbY2xhc3NMaXN0LmZpbmQoZCA9PiBkLmluY2x1ZGVzKFwiY2FsY3VsYW5nX2ZfXCIpKS5zbGljZShcImNhbGN1bGFuZ19mX1wiLmxlbmd0aCldKTtcbiAgICAgICAgICAgICAgLy8vLy8vLyBjYXVzZXMgdW5uZWNlc3Nhcnkgaml0dGVyIHdoZW4gd2UgYWxyZWFkeSBzZWUgZiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuJytjbGFzc0xpc3QuZmluZChkID0+IGQuaW5jbHVkZXMoXCJjYWxjdWxhbmdfZl9cIikpKS5zY3JvbGxJbnRvVmlldyhzY3JvbGxJbnRvVmlld09wdHMpXG4gICAgICAgICAgICAgIC8vdHJ5aW5nIGl0IFxuICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuJytjbGFzc0xpc3QuZmluZChkID0+IGQuaW5jbHVkZXMoXCJjYWxjdWxhbmdfZl9cIikpKS5zY3JvbGxJbnRvVmlldyhzY3JvbGxJbnRvVmlld09wdHMpXG5cblxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICk7XG5cbiAgICByZXR1cm4gW2Zvcm11bGFEZWNvcmF0aW9uc107XG4gIH1cbn1cblxuLy8gRGVjb3JhdGlvbi5saW5lc1xuZm9ybXVsYURlY29yYXRpb24gPSAodmlldykgPT4gRGVjb3JhdGlvbi5zZXQoXG4gIGZvcm11bGFfbGluZV9kZXRhaWxzXG4gICAgLm1hcCgoZCkgPT5cbiAgICAgIF8ucmFuZ2UoZC5saW5lU3RhcnQsIGQubGluZUVuZCArIDAuMSkubWFwKChlKSA9PlxuICAgICAgICBEZWNvcmF0aW9uLmxpbmUoe1xuICAgICAgICAgIGF0dHJpYnV0ZXM6IHtcbiAgICAgICAgICAgIGNsYXNzOiBcImNhbGN1bGFuZ1wiICsgXCIgXCIgKyBcImNhbGN1bGFuZ19mX1wiK2QubmFtZSArIChkLm92ZXJ3cml0dGVuID8gJyBjYWxjdWxhbmdfb3ZlcndyaXR0ZW4nIDogJycpIC8qICtzdHlsZSBhdmFpbGFibGUgKi8gLy8gbGVhdmluZyBzY29wZSBhbmQgb3RoZXIgcG90ZW50aWFsIGNvbmZsaWN0cyBvdXRcbiAgICAgICAgICB9XG4gICAgICAgIH0pLnJhbmdlKHZpZXcuc3RhdGUuZG9jLmxpbmUoZSkuZnJvbSlcbiAgICAgIClcbiAgICApXG4gICAgLmZsYXQoKSlcblxuZm9ybXVsYV9saW5lX2RldGFpbHMgPSBPYmplY3QudmFsdWVzKGNhbGN1bGFuZ19zb3VyY2VfaW50cm9zcGVjdGlvbi5jdWxfZnVuY3Rpb25zKVxuICAuZmlsdGVyKChkKSA9PiBkLnJlYXNvbi5pbmNsdWRlcyhcImRlZmluaXRpb25cIikgJiYgZC5uYW1lLnNsaWNlKC0zKSAhPSAnX2luJyAmJiBkLmN1bF9zY29wZV9pZCA9PSBjdWxfc2NvcGVfaWQpXG4gIC5tYXAoKHsgbmFtZSwgbG9jLCByZWFzb24gfSkgPT4gKHtcbiAgICBuYW1lLFxuICAgIGxpbmVTdGFydDogbG9jPy5zdGFydC5saW5lLFxuICAgIGxpbmVFbmQ6IGxvYz8uZW5kLmxpbmUsXG4gICAgb3ZlcndyaXR0ZW46IG5hbWUuc2xpY2UoLTEpID09ICdfJyAmJiAhKE9iamVjdC52YWx1ZXMoY2FsY3VsYW5nX3NvdXJjZV9pbnRyb3NwZWN0aW9uLmN1bF9mdW5jdGlvbnMpLmZpbHRlcihkID0+IGQuaW1wb3J0ZWQgPT0gbmFtZSAmJiBkLmN1bF9zb3VyY2Vfc2NvcGVfaWQgPT0gY3VsX3Njb3BlX2lkKSkubGVuZ3RoIC8vIGFuZCBub3QgZXhwbGljaXQgaW1wb3J0ZWQvdXNlZCBpbiBwYXJlbnQgZGVmblxuICB9KSlcblxuZm9ybXVsYV9saW5lX2RldGFpbHNfMCA9IE9iamVjdC52YWx1ZXMoY2FsY3VsYW5nX3NvdXJjZV9pbnRyb3NwZWN0aW9uLmN1bF9mdW5jdGlvbnMpXG4gIC5maWx0ZXIoKGQpID0+IGQucmVhc29uLmluY2x1ZGVzKFwiZGVmaW5pdGlvblwiKSAmJiBkLm5hbWUuc2xpY2UoLTMpICE9ICdfaW4nICYmIGQuY3VsX3Njb3BlX2lkID09IDApXG4gIC5tYXAoKHsgbmFtZSwgbG9jLCByZWFzb24gfSkgPT4gKHtcbiAgICBuYW1lLFxuICAgIGxpbmVTdGFydDogbG9jPy5zdGFydC5saW5lLFxuICAgIGxpbmVFbmQ6IGxvYz8uZW5kLmxpbmUsXG4gICAgb3ZlcndyaXR0ZW46IG5hbWUuc2xpY2UoLTEpID09ICdfJyAmJiAhKE9iamVjdC52YWx1ZXMoY2FsY3VsYW5nX3NvdXJjZV9pbnRyb3NwZWN0aW9uLmN1bF9mdW5jdGlvbnMpLmZpbHRlcihkID0+IGQuaW1wb3J0ZWQgPT0gbmFtZSkpLmxlbmd0aCAvLyBhbmQgbm90IGV4cGxpY2l0IGltcG9ydGVkL3VzZWQgaW4gcGFyZW50IGRlZm5cbiAgfSkpXG5cbi8vLy8vLy8vLy8vLyBwbHVnaW4gMjogZGVjb3JhdGlvbiAmIGN1bCBuYXZpZ2F0aW9uIGZvciBjYWxsLWxldmVsLCBhbHNvIGRlY29yYXRpb24gZm9yIHRpdGxlcy4gQnkgc3ludGF4IHRyZWUgYW5hbHlzaXNcbi8vIHVzZXMgZm9ybXVsYWVfYWxsLCBpbnB1dHM6IHNob3VsZCBkZXJpdmUgZnJvbSBlbnRyeXBvaW50L2ludHJvc3BlY3Rpb24gYmVmb3JlIHNwbGl0dGluZyB1cFxuLy8gYWxzbyBzZXRzIGZvcm1hZV92aXNpYmxlXG5cbi8vIGluY29uc2lzdGVudCBuYW1pbmcgIVxuXG5mb3JtdWxhZV9oaWRkZW4gPSBmb3JtdWxhZV9hbGwuZmlsdGVyKChkKSA9PiAhZm9ybXVsYWVfdmlzaWJsZS5pbmNsdWRlcyhkKSlcblxuZm9ybXVsYWVfYWxsID0gZm9ybXVsYV9saW5lX2RldGFpbHMubWFwKChkKSA9PiBkLm5hbWUpIC8vIHBvb3I/XG5cbnZpZXdvZiBob3ZlciA9IElucHV0cy50ZXh0KFwiXCIpXG5cbntcbiAgY29uc29sZS5sb2coJ2VlZScsIGhvdmVyKVxuICBpZiAoaG92ZXIgPT0gJ3J2X2hpdF9kaXN0YW5jZScpIHtcbiAgICBzZXQodmlld29mIHNob3dfcmF5X3YsIHRydWUpXG4gICAgc2V0KHZpZXdvZiBzaG93X3JheV9oLCBmYWxzZSlcbiAgfVxuICBpZiAoaG92ZXIgPT0gJ3JoX2hpdF9kaXN0YW5jZScpIHtcbiAgICBzZXQodmlld29mIHNob3dfcmF5X3YsIGZhbHNlKVxuICAgIHNldCh2aWV3b2Ygc2hvd19yYXlfaCwgdHJ1ZSlcbiAgfVxufVxuXG4vL2lucHV0cyA9IF8udW5pcShPYmplY3QudmFsdWVzKGludHJvc3BlY3Rpb24uY3VsX2lucHV0X21hcCkuZmxhdCgpKVxuXG5jYWxjdWxhbmdfaWRlbnRpZmllcl9kZWNvcmF0aW9ucyA9IHtcbiAgcmV0dXJuIChvcHRpb25zKSA9PiB7XG4gICAgLy9zZXQob3B0aW9ucy5mb3JtdWxhZV92aXNpYmxlLCBmb3JtdWxhZV9hbGwpIC8vIFdIRVJFIERPRVMgVEhJUyBORUVEIFRPIEdPP1xuICAgIGNvbnN0IGRlY29yYXRpb25zID0gY21JbXBvcnRzLnZpZXcuVmlld1BsdWdpbi5mcm9tQ2xhc3MoXG4gICAgICBjbGFzcyB7XG5cbiAgICAgICAgY29uc3RydWN0b3Iodmlldykge1xuICAgICAgICAgIHRoaXMuZGVjb3JhdGlvbnMgPSBpZGVudGlmaWVyX2RlY29yYXRpb25zKHZpZXcpO1xuICAgICAgICB9XG5cbiAgICAgICAgdXBkYXRlKHVwZGF0ZSkge1xuICAgICAgICAgIC8vZGVidWdnZXI7IHRoaXMgaXMgY2FsbGVkIGEgTE9UISFcbiAgICAgICAgICAvL2lmICh1cGRhdGUuZG9jQ2hhbmdlZCB8fCB1cGRhdGUuZm9jdXNDaGFuZ2VkfHwgdXBkYXRlLnZpZXdwb3J0Q2hhbmdlZCB8fCB1cGRhdGUuZ2VvbWV0cnlDaGFuZ2VkIHx8IHVwZGF0ZS5oZWlnaHRDaGFuZ2VkKSAvLyBleHBlbnNpdmUgdGhpbmdzIG9uIHNjcm9sbCwgYnV0IGRpZG4ndCBydW4gb24gZnVsbCBkb2MgZm9yIHNvbWUgcmVhc29uPyFcbiAgICAgICAgICAgIHRoaXMuZGVjb3JhdGlvbnMgPSBpZGVudGlmaWVyX2RlY29yYXRpb25zKHVwZGF0ZS52aWV3KTtcbiAgICAgICAgICAgIC8vIHdoeSBcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgZGVjb3JhdGlvbnM6ICh2KSA9PiB2LmRlY29yYXRpb25zLFxuXG4gICAgICAgIGV2ZW50SGFuZGxlcnM6IHtcbiAgICAgICAgICBtb3VzZW1vdmU6IChlLCB2aWV3KSA9PiB7XG4gICAgICAgICAgICBsZXQgY2xhc3NMaXN0ID0gWy4uLmUudGFyZ2V0LmNsYXNzTGlzdCwgLi4uZS50YXJnZXQucGFyZW50RWxlbWVudC5jbGFzc0xpc3RdIC8vIHZlcnkgb3BlbiwgYmUgYXdhcmUgb2YgYnVncyA/IVxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGMgPSBjbGFzc0xpc3QuZmlsdGVyKGQgPT4gZC5pbmNsdWRlcyhcImNhbGN1bGFuZ19jYWxsX1wiKSlcbiAgICAgICAgICAgIGxldCBjYz0gJ2JhZHZhbHVlJztcbiAgICAgICAgICAgIGlmIChjLmxlbmd0aCkgY2MgPSBjWzBdLnNsaWNlKFwiY2FsY3VsYW5nX2NhbGxfXCIubGVuZ3RoKVxuXG4gICAgICAgICAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FsY3VsYW5nX2NhbGxcIikgfHwgY2xhc3NMaXN0LmluY2x1ZGVzKFwiY2FsY3VsYW5nX3RpdGxlXCIpKSB7IC8vIFRPRE8gb25seSBpZiB0aGUgY29udGFpbmluZyBmb3JtdWxhIGlzIHZpc2libGUsIEkgaGF2ZSBvcHRpb25zLmZvcm11bGFlX3Zpc2libGU6XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdISUhJSElFRScpXG4gICAgICAgICAgICAvL2RlYnVnZ2VyO1xuICAgICAgICAgICAgICBzZXQodmlld29mIGhvdmVyLCBjYykgLy8gdG9vIG1hbnkgdHJpZ2dlcnMgIVxuICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIG1vdXNlZG93bjogKGUsIHZpZXcpID0+IHtcbiAgICAgICAgICAgIGxldCBjbGFzc0xpc3QgPSBbLi4uZS50YXJnZXQuY2xhc3NMaXN0LCAuLi5lLnRhcmdldC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdF0gLy8gdmVyeSBvcGVuLCBiZSBhd2FyZSBvZiBidWdzID8hXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgYyA9IGNsYXNzTGlzdC5maWx0ZXIoZCA9PiBkLmluY2x1ZGVzKFwiY2FsY3VsYW5nX2NhbGxfXCIpICYmIGQgIT0gXCJjYWxjdWxhbmdfY2FsbF9pbnB1dFwiKVxuICAgICAgICAgICAgbGV0IGNjPSAnYmFkdmFsdWUnO1xuICAgICAgICAgICAgaWYgKGMubGVuZ3RoKSBjYyA9IGNbMF0uc2xpY2UoXCJjYWxjdWxhbmdfY2FsbF9cIi5sZW5ndGgpXG5cbiAgICAgICAgICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJjYWxjdWxhbmdfY2FsbFwiKSB8fCBjbGFzc0xpc3QuaW5jbHVkZXMoXCJjYWxjdWxhbmdfdGl0bGVcIikpIHsgLy8gVE9ETyBvbmx5IGlmIHRoZSBjb250YWluaW5nIGZvcm11bGEgaXMgdmlzaWJsZSwgSSBoYXZlIG9wdGlvbnMuZm9ybXVsYWVfdmlzaWJsZTpcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ0hJSElISUVFJylcbiAgICAgICAgICAgIC8vZGVidWdnZXI7XG4gICAgICAgICAgICAgIHNldChvcHRpb25zLmZvcm11bGFlX3Zpc2libGUsIFtjY10pXG4gICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYWxjdWxhbmdfZl8nK2NjKS5zY3JvbGxJbnRvVmlldyhzY3JvbGxJbnRvVmlld09wdHMpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGVsc2UgaWYgKFxuICAgICAgICAgICAgICAvL2UudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImRlcG9zaXRzXCIpIHx8XG4gICAgICAgICAgICAgIC8vZS50YXJnZXQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoXCJkZXBvc2l0c1wiKVxuICAgICAgICAgICAgICBjbGFzc0xpc3QuZmlsdGVyKGQgPT4gZC5pbmNsdWRlcyhcImNhbGN1bGFuZ19mX1wiKSkubGVuZ3RoXG4gICAgICAgICAgICApIHsgLy8gdGhpcyBpcyBzZXR0aW5nIHdoZW4geW91IGNsaWNrIGluIHRoZSBhcmVhIG9mIGEgZm9ybXVsYSAtIG5vIG5lZWQgdG8gc2Nyb2xsXG4gICAgICAgICAgICAgIHNldChvcHRpb25zLmZvcm11bGFlX3Zpc2libGUsIFtjbGFzc0xpc3QuZmluZChkID0+IGQuaW5jbHVkZXMoXCJjYWxjdWxhbmdfZl9cIikpLnNsaWNlKFwiY2FsY3VsYW5nX2ZfXCIubGVuZ3RoKV0pO1xuICAgICAgICAgICAgICAvL2RvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nK2NsYXNzTGlzdC5maW5kKGQgPT4gZC5pbmNsdWRlcyhcImNhbGN1bGFuZ19mX1wiKSkpLnNjcm9sbEludG9WaWV3KHNjcm9sbEludG9WaWV3T3B0cylcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICApO1xuXG4gICAgcmV0dXJuIFtkZWNvcmF0aW9uc107XG4gIH1cbn1cblxuLy8gRGVjb3JhdGlvbi5tYXJrcyBzcGVjaWZpZWQgYnkgcmFuZ2VzXG5pZGVudGlmaWVyX2RlY29yYXRpb25zID0gdmlldyA9PiB7XG4gIGxldCBkZWNvcmF0aW9ucyA9IFtdO1xuXG4gIC8vZm9yIChsZXQgeyBmcm9tLCB0byB9IG9mIHZpZXcudmlzaWJsZVJhbmdlcykge1xuICAgIGNvbnNvbGUubG9nKHZpZXcuc3RhdGUpXG4gICAgY29uc29sZS5sb2codmlldy52aXNpYmxlUmFuZ2VzKVxuICAvL2ZvciAobGV0IHsgZnJvbSwgdG8gfSBvZiBbe2Zyb206IDAsIHRvOiAxMDAwfV0pIHtcbiAgICAvL2RlYnVnZ2VyO1xuICAgIC8vZGVidWdnZXI7XG4gICAgZm9yIChsZXQgeyBmcm9tLCB0byB9IG9mIHZpZXcudmlzaWJsZVJhbmdlcykge1xuICAgIC8vZm9yIChsZXQgeyBmcm9tLCB0byB9IG9mIFt7ZnJvbTowLCB0bzo1MDAwfV0pIHtcbiAgICAgIC8vY21JbXBvcnRzLmxhbmd1YWdlLnN5bnRheFRyZWVBdmFpbGFibGUodmlldy5zdGF0ZSwgKVxuICAgICAgLy9jbUltcG9ydHMubGFuZ3VhZ2UuZm9yY2VQYXJzaW5nKHZpZXcsIClcbiAgICAgIFxuICAgIGNtSW1wb3J0cy5sYW5ndWFnZS5zeW50YXhUcmVlKHZpZXcuc3RhdGUpLml0ZXJhdGUoe1xuICAgICAgZnJvbSxcbiAgICAgIHRvLFxuICAgICAgZW50ZXI6IChub2RlKSA9PiB7XG4gICAgICAgIGlmIChub2RlLm5hbWUgPT0gXCJWYXJpYWJsZURlZmluaXRpb25cIikge1xuICAgICAgICAgIGxldCBuYW1lID0gdmlldy5zdGF0ZS5kb2Muc2xpY2VTdHJpbmcobm9kZS5mcm9tLCBub2RlLnRvKTtcbiAgICAgICAgICBpZiAoZm9ybXVsYWVfYWxsLmluY2x1ZGVzKG5hbWUpKSB7XG4gICAgICAgICAgICBkZWNvcmF0aW9ucy5wdXNoKFxuICAgICAgICAgICAgICBEZWNvcmF0aW9uLm1hcmsoeyBjbGFzczogXCJjYWxjdWxhbmdfdGl0bGVcIiB9KS5yYW5nZShcbiAgICAgICAgICAgICAgICBub2RlLmZyb20sXG4gICAgICAgICAgICAgICAgbm9kZS50b1xuICAgICAgICAgICAgICApXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZm9ybXVsYWVfYWxsLmluY2x1ZGVzKG5hbWUgKyAnXycpKSB7XG4gICAgICAgICAgICBkZWNvcmF0aW9ucy5wdXNoKFxuICAgICAgICAgICAgICBEZWNvcmF0aW9uLm1hcmsoeyBjbGFzczogXCJjYWxjdWxhbmdfdGl0bGUgY2FsY3VsYW5nX3RpdGxlX3JlbmFtZWRcIiB9KS5yYW5nZShcbiAgICAgICAgICAgICAgICBub2RlLmZyb20sXG4gICAgICAgICAgICAgICAgbm9kZS50b1xuICAgICAgICAgICAgICApXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChub2RlLm5hbWUgPT0gXCJWYXJpYWJsZU5hbWVcIikge1xuICAgICAgICAgIGxldCBuYW1lID0gdmlldy5zdGF0ZS5kb2Muc2xpY2VTdHJpbmcobm9kZS5mcm9tLCBub2RlLnRvKTtcbiAgICAgICAgICBpZiAoZm9ybXVsYWVfYWxsLmluY2x1ZGVzKG5hbWUpKSB7XG4gICAgICAgICAgICBpZiAoaW5wdXRzLmluY2x1ZGVzKG5hbWUgKyBcIl9pblwiKSlcbiAgICAgICAgICAgICAgZGVjb3JhdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICBEZWNvcmF0aW9uLm1hcmsoeyBjbGFzczogYGNhbGN1bGFuZ19jYWxsIGNhbGN1bGFuZ19jYWxsX2lucHV0IGNhbGN1bGFuZ19jYWxsXyR7bmFtZX1gIH0pLnJhbmdlKFxuICAgICAgICAgICAgICAgICAgbm9kZS5mcm9tLFxuICAgICAgICAgICAgICAgICAgbm9kZS50b1xuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgZGVjb3JhdGlvbnMucHVzaChcbiAgICAgICAgICAgICAgICBEZWNvcmF0aW9uLm1hcmsoeyBjbGFzczogYGNhbGN1bGFuZ19jYWxsIGNhbGN1bGFuZ19jYWxsXyR7bmFtZX1gIH0pLnJhbmdlKG5vZGUuZnJvbSwgbm9kZS50bylcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICByZXR1cm4gRGVjb3JhdGlvbi5zZXQoZGVjb3JhdGlvbnMpO1xufVxuXG5cblxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC00IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoidmlld29mIHggPSBJbnB1dHMuaW5wdXQoMClcblxuZm9ybXVsYWVfdmlzaWJsZVxuXG5mb3JtdWxhZV9hbGxcblxuaW5wdXRzXG5cbmZvcm11bGFlX2hpZGRlblxuXG5tZGAtLS1gXG5cbi8vLy8vLy8vLy8vLy8vLy8gY29kZSBmb3IgZ2V0dGluZyBzb3VyY2VcblxuZXhhbXBsZXNfeWFtbCA9IGF3YWl0IChhd2FpdCBmZXRjaCgnL2dhbGxlcnkueW1sJykpLnRleHQoKVxuXG55YW1sID0gcmVxdWlyZSgnanMteWFtbEA0LjEuMC9kaXN0L2pzLXlhbWwubWluLmpzJylcblxuZXhhbXBsZXMgPSB5YW1sLmxvYWQoZXhhbXBsZXNfeWFtbClcblxuc2VsZWN0ZWRfbW9kZWwgPSBHZW5lcmF0b3JzLmlucHV0KGFfdGhpbmcyKVxuXG5leGFtcGxlX2RldGFpbHMgPSBleGFtcGxlcy5tYXAoZCA9PiBkLnRpbGVzKS5mbGF0KCkuZmluZChkID0+IGQuaWQgPT0gc2VsZWN0ZWRfbW9kZWwpXG5cbm1vZGVsbmFtZSA9IGV4YW1wbGVfZGV0YWlscy5pZC5yZXBsYWNlQWxsKCctJywnXycpIC8vIHJlcGxhY2UgZHVlIHRvIG9iamVjdCBsb29rdXBzXG5cbnEgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKGxvY2F0aW9uLnNlYXJjaClcblxuXG5kZWZhdWx0X2V4YW1wbGVfaWQgPSBxLmdldCgnaWQnKSA/PyAnJ1xuc2hvd19oaWRkZW4gPSB0cnVlLy8gcS5nZXQoJ2hpZGRlbicpID09ICdoaWRkZW4nID8/IHRydWVcblxuXG5kaXIgPSBkaXJuYW1lKGV4YW1wbGVfZW50cnlwb2ludClcblxuXG4vL2h0dHBzOi8vd3d3LmFiZWF1dGlmdWxzaXRlLm5ldC9wb3N0cy9qYXZhc2NyaXB0LWZ1bmN0aW9ucy1mb3ItYmFzZW5hbWUtYW5kLWRpcm5hbWUvXG5mdW5jdGlvbiBkaXJuYW1lKHBhdGgpIHtcbiAgcmV0dXJuIHBhdGgubWF0Y2goLy4qXFwvLyk7XG59XG5cblxuXG5cbmV4YW1wbGVfZW50cnlwb2ludCA9IGVudHJ5cG9pbnRcblxuZW50cnlwb2ludCA9IChleGFtcGxlX2RldGFpbHMuZW50cnlwb2ludFswXSA9PSBcIi9cIiA/IFwiaHR0cHM6Ly9jYWxjdWxhbmcuZGV2XCIgOiBcIlwiKSArXG4gIGV4YW1wbGVfZGV0YWlscy5lbnRyeXBvaW50XG5cbmVudHJ5cG9pbnRfbm9fY3VsX2pzID0gZW50cnlwb2ludC5zbGljZSgwLC03KVxuXG4vL3ZpZXdvZiBlbnRyeXBvaW50ID0gSW5wdXRzLnNlbGVjdChuZXcgTWFwKGVudHJ5cG9pbnRzX2FsbC5tYXAoKGQsaSkgPT4gW2RbMV0saV0pKSwge2xhYmVsOidtb2RlbCDwn5GAJywgdmFsdWU6MX0pIC8vIGxlYXZpbmcgb24gc2ltcGxlLWNsaW1hdGUgYXMgaXQgYnJlYWtzIGlmIG5vdCBkZWZhdWx0IDpvXG5cbi8vIGhhY2t5LCBkbyBxcyBwYXJzaW5nP1xuLy8gSSBzaG91bGQgdmlldyAubWpzIGluc3RlYWQgb2YgLmN1bC5qcyBmb3IgbWVtbyBjYXNlP1xuY3VsX3Jlc291cmNlcyA9IHtcbiAgaWYgKGN1bF9qc19jdWwpXG4gIHJldHVybiBPYmplY3QudmFsdWVzKGludHJvc3BlY3Rpb25fbm9tZW1vLmN1bF9zY29wZV9pZHNfdG9fcmVzb3VyY2UpLm1hcChsb2MgPT4gbG9jLnNsaWNlKDIpLnNsaWNlKDAsbG9jLmluZGV4T2YoJz8nKSAhPSAtMSA/IGxvYy5pbmRleE9mKCc/JyktMiA6IDk5OSkpLm1hcChkID0+IGQgKyAoKGQuc2xpY2UoLTMpICE9ICcuanMnKSA/ICcuanMnIDogJycpKS5tYXAobG9jID0+IGRpcisgbG9jKVxuICBlbHNlIHJldHVybiBbLi4uQXJyYXkoT2JqZWN0LmtleXMoaW50cm9zcGVjdGlvbl9ub21lbW8uY3VsX3Njb3BlX2lkc190b19yZXNvdXJjZSkubGVuZ3RoKV0ubWFwKChfLCBpKSA9PiBlbnRyeXBvaW50X25vX2N1bF9qcyAvKiB0aGlzIGlzIG5vdCBtb2RlbG5hbWUhIHRoaXMgc2hvdWxkIGJlIHJlbGF0ZWQgdG8gZW50cnlwb2l0LCBub3QgaWQgKi8rKGNhbGN1bGFuZ19zb3VyY2Vfbm9tZW1vLmxlbmd0aD8gJy1ub21lbW8nIDogJycpICsnX2VzbS8nKydjdWxfc2NvcGVfJytpKycubWpzJylcbn1cblxuLy9jdWxfcmVzb3VyY2VzXG5cbm91dHB1dCA9IHtcbiAgbGV0IG8gPSBbXTtcbiAgY3VsX3Jlc291cmNlcy5mb3JFYWNoKGxvYyA9PiB7XG4gICAgby5wdXNoKGZldGNoKGxvYykudGhlbihkID0+IGQudGV4dCgpKSlcbiAgfSlcbiAgcmV0dXJuIG9cbn1cblxuLy8gVE9ETyByZXBsYWNlIGR1cGxpY2F0ZSAoc291cmNlKSBjb2RlIGJ5IGEgbWVzc2FnZVxuXG5jYWxjdWxhbmcgPSBbYXdhaXQgb3V0cHV0WzBdLCBjdWxfcmVzb3VyY2VzLmxlbmd0aCA+IDEgPyBhd2FpdCBvdXRwdXRbMV0gOiAnJ1xuLCBjdWxfcmVzb3VyY2VzLmxlbmd0aCA+IDIgPyBhd2FpdCBvdXRwdXRbMl0gOiAnJ1xuLCBjdWxfcmVzb3VyY2VzLmxlbmd0aCA+IDMgPyBhd2FpdCBvdXRwdXRbM10gOiAnJ1xuLCBjdWxfcmVzb3VyY2VzLmxlbmd0aCA+IDQgPyBhd2FpdCBvdXRwdXRbNF0gOiAnJ1xuLCBjdWxfcmVzb3VyY2VzLmxlbmd0aCA+IDUgPyBhd2FpdCBvdXRwdXRbNV0gOiAnJ1xuLCBjdWxfcmVzb3VyY2VzLmxlbmd0aCA+IDYgPyBhd2FpdCBvdXRwdXRbNl0gOiAnJyAvLyBUT0RPIHdhcm4gd2hlbiBvdmVyZmxvd3NcbiwgY3VsX3Jlc291cmNlcy5sZW5ndGggPiA3ID8gYXdhaXQgb3V0cHV0WzddIDogJyddLmZpbHRlcihkID0+IGQgIT0gJycpXG4vL2NhbGN1bGFuZ1xuXG4vLyBcInguY3VsLmpzIGZvcm11bGFlP1wiXG5mZmYgPSBjYWxjdWxhbmcubWFwKGQgPT4gZC5zcGxpdCgnXFxuJykpLm1hcChkID0+IFtkLmZpbmRJbmRleChlID0+IGUuaW5kZXhPZignaW5wdXRzOicgKyAob3B0aW9ucy5pbmNsdWRlcygnaW5wdXRzJykgPyAnQkxBSCcgOiAnJykpICE9IC0xKSA/PyA5OTksIC4uLmRdKS5tYXAoZCA9PiBkLmZpbHRlcigoZSxpKSA9PiBpIDw9IGRbMF0gfHwgZFswXSA9PSAtMSkpLm1hcChkID0+IGQuc2xpY2UoMSkpLm1hcChkID0+IGQuam9pbignXFxuJykpLm1hcCgoZCxpKSA9PiBgKioqWyR7aW50cm9zcGVjdGlvbi5jdWxfc2NvcGVfaWRzX3RvX3Jlc291cmNlW2ldLnNwbGl0KCc/JylbMF0ucmVwbGFjZUFsbCgnLW5vbWVtbycsICcnKX1dKCR7Y3VsX3Jlc291cmNlc1tpXS5yZXBsYWNlQWxsKCctbm9tZW1vJywnJyl9KSAke2N1bF9qc19jdWwgPyBgLT4gW2pzXSgke2VudHJ5cG9pbnRfbm9fY3VsX2pzfV9lc20vY3VsX3Njb3BlXyR7aX0ubWpzKWAgOiBgYH0qKipcblxufn5+anNcbiR7ZC5yZXBsYWNlQWxsKCdleHBvcnQgY29uc3QgJyArIChvcHRpb25zLmluY2x1ZGVzKCdleHBvcnQgY29uc3RzJylcbiA/ICdCTEFIJyA6ICcnKSwgJycpfVxufn5+XG5gXG4pXG5cbmZmZjIgPSBjYWxjdWxhbmcuZmlsdGVyKChkLGkpID0+IGkgPT0gY3VsX3Njb3BlX2lkKS5tYXAoZCA9PiBkLnNwbGl0KCdcXG4nKSkubWFwKGQgPT4gW2QuZmluZEluZGV4KGUgPT4gZS5pbmRleE9mKCdpbnB1dHM6JyArIChvcHRpb25zLmluY2x1ZGVzKCdpbnB1dHMnKSA/ICdCTEFIJyA6ICcnKSkgIT0gLTEpID8/IDk5OSwgLi4uZF0pLm1hcChkID0+IGQuZmlsdGVyKChlLGkpID0+IGkgPD0gZFswXSB8fCBkWzBdID09IC0xKSkubWFwKGQgPT4gZC5zbGljZSgxKSkubWFwKGQgPT4gZC5qb2luKCdcXG4nKSlcblxuLm1hcCgoZCxpKSA9PiBgJHtkLnJlcGxhY2VBbGwoJ2V4cG9ydCBjb25zdCAnICsgKG9wdGlvbnMuaW5jbHVkZXMoJ2V4cG9ydCBjb25zdHMnKVxuID8gJ0JMQUgnIDogJycpLCAnJyl9YFxuKVxuXG5cbmZmZlxuXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiIvL21kYCR7ZmZmLmpvaW4oJ1xcblxcbicpfWBcblxuZW5hYmxlZCA9IFtcInJheWNhc3RpbmcyXCIsIFwic2F2aW5nc1wiLCBcInNhdmluZ3NfcmVjXCIsIFwic3RhcmZpZWxkXCIsIFwiZml6emJ1enpcIiwgXCJ5ZWFyX3JlbWFpbmluZ1wiLCBcInNpbXBsZV9sb2FuXCIvKiwgXCJlbWlzc2lvbnNfbXlfbGlmZXRpbWVcIiovXVxuXG5hX3RoaW5nMiA9IGh0bWxgPHNlbGVjdCBzdHlsZT1cImZvbnQtc2l6ZTogMS41ZW1cIj5cbiR7ZXhhbXBsZXMubWFwKGNhdGVnb3J5ID0+IGA8b3B0Z3JvdXAgbGFiZWw9XCIke2NhdGVnb3J5LmNhdGVnb3J5fVwiPlxuICAke2NhdGVnb3J5LnRpbGVzLmZpbHRlcih0aWxlID0+ICgoIXRpbGUuZGlzYWJsZWQpIHx8IHNob3dfaGlkZGVuKSkuZmlsdGVyKGQgPT4gZW5hYmxlZC5pbmNsdWRlcyhkLmlkLnJlcGxhY2VBbGwoJy0nLCdfJykpKS5tYXAoZCA9PiBgPG9wdGlvbiB2YWx1ZT1cIiR7ZC5pZH1cIiR7ZC5pZCA9PSBkZWZhdWx0X2V4YW1wbGVfaWQgPyAnIHNlbGVjdGVkPVwic2VsZWN0ZWRcIicgOiAnJ319PiR7ZC50aXRsZX08L29wdGlvbj5gKX1cbiAgJHtjYXRlZ29yeS50aWxlcy5maWx0ZXIoZCA9PiBkLmlkID09IGRlZmF1bHRfZXhhbXBsZV9pZCAmJiBkLmRpc2FibGVkICYmICghc2hvd19oaWRkZW4pKS5tYXAoZCA9PiBgPG9wdGlvbiB2YWx1ZT1cIiR7ZC5pZH1cIiR7ZC5pZCA9PSBkZWZhdWx0X2V4YW1wbGVfaWQgPyAnIHNlbGVjdGVkPVwic2VsZWN0ZWRcIicgOiAnJ319PiR7ZC50aXRsZX08L29wdGlvbj5gKX1cbjwvb3B0Z3JvdXA+XG5gKX08L3NlbGVjdD5gXG5cbm1kYCR7ZXhhbXBsZV9kZXRhaWxzLm1vZHVsYXIgPyAn4pm777iPJyA6ICcnfSAqJHtleGFtcGxlX2RldGFpbHMuc3VidGl0bGV9KmBcblxudmlld29mIGN1bF9zY29wZV9pZCA9IElucHV0cy5yYW5nZShbMCwxNV0sIHtsYWJlbDogJ2N1bCBzY29wZSBpZCcsIHZhbHVlOjAsIHN0ZXA6MX0pXG5cbnZpZXdvZiBmb3JtID0gSW5wdXRzLmZvcm0obWluaV9iaW5kcywge1xuICB0ZW1wbGF0ZTogaW5wdXRzMiA9PiBodGwuaHRtbGA8ZGV0YWlscyBpZD1cImlucHV0c19kZXRhaWxzXCIgb3Blbj48c3VtbWFyeT5pbnB1dHMg4pqZ77iPPC9zdW1tYXJ5PjxkaXYgY2xhc3M9XCJzdHlsZWRcIj4ke09iamVjdC5lbnRyaWVzKGlucHV0czIpLyouZmlsdGVyKChbayx2XSkgPT4gaW5wdXRzLmluY2x1ZGVzKGspKSovLm1hcCgoW2ssdl0pID0+IGh0bC5odG1sYDxkaXYgaWQ9XCJtaW5pLWJpbmQtJHtrfVwiIGNsYXNzPVwibWluaS1iaW5kXCI+JHt2fWApfWBcbiAgLy90ZW1wbGF0ZTogaW5wdXRzMiA9PiBodGwuaHRtbGAke09iamVjdC5lbnRyaWVzKGlucHV0czIpLyouZmlsdGVyKChbayx2XSkgPT4gaW5wdXRzLmluY2x1ZGVzKGspKSovLm1hcCgoW2ssdl0pID0+IGh0bC5odG1sYDxkaXYgaWQ9XCJtaW5pLWJpbmQtJHtrfVwiIGNsYXNzPVwibWluaS1iaW5kIHN0eWxlZFwiPiR7dn1gKX1gXG59KVxuXG5odG1sYFxuPHN0eWxlPlxuICAjaW5wdXRzX2RldGFpbHMge1xuICAgICAgYmFja2dyb3VuZDogIzY2ZGRjMTU1O1xuICAgICAgbWFyZ2luLWJvdHRvbTowO1xuICAgICAgfVxuXG4gIGRpdi5zdHlsZWQge1xuICAgIHRleHQtYWxpZ246IHJpZ2h0O1xuICAgIGNvbHVtbi1jb3VudDogMjtcbiAgfVxuICBkaXYuc3R5bGVkIHtcbiAgICBmb250LXdlaWdodDogYm9sZDtcbiAgICBmb250LXNpemU6IDAuN2VtO1xuICB9XG4gIGRpdi5zdHlsZWQgbGFiZWwge1xuICAgIC8qd2lkdGg6IDUwcHggIWltcG9ydGFudDsqL1xuICB9XG4gIGRpdi5zdHlsZWQgbGFiZWw6bm90KGRpdj5sYWJlbCk6YWZ0ZXIge1xuICAgIGNvbnRlbnQ6IFwiOlwiO1xuICB9XG4gIGRpdi5taW5pLWJpbmQge1xuICAgIGRpc3BsYXk6bm9uZTtcbiAgfVxuICAke2lucHV0cy5tYXAoZCA9PiBgZGl2I21pbmktYmluZC0ke2R9IHtcbiAgICBkaXNwbGF5OiBibG9jaztcbiAgfWApLmpvaW4oJ1xcblxcbicpfVxuPC9zdHlsZT5cbmBcblxuXG5cbi8qe1xuICB5ZWFyX2luO1xuICB2aWV3b2YgZm9ybS52YWx1ZS55ZWFyX2luID0geWVhcl9pbjtcbnZpZXdvZiAgICAgZm9ybS5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudChcImlucHV0XCIsIHtidWJibGVzOiB0cnVlfSkpO1xufSovXG5cblxuXG4vLywgdGVtcGxhdGU6IGlucHV0cyA9PiBodGwuaHRtbGA8ZGV0YWlscyBvcGVuPlxuLy8gICR7T2JqZWN0LnZhbHVlcyhpbnB1dHMpLyouZmlsdGVyKChbayx2XSkgPT4gaW5wdXRzLmluY2x1ZGVzKGspKSovLyoubWFwKChbayx2XSkgPT4gdikqL31cbi8vPC9kZXRhaWxzPmApIC8vIGh0dHBzOi8vb2JzZXJ2YWJsZWhxLmNvbS9AbWFydGllbi9ob3Jpem9udGFsLWlucHV0c1xuLy8gc3RpbGwgbm90IHJlbGlhYmxlLCBkbyBzZXQgaW1wbGVtZW50YXRpb24/XG5cblxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC02IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG5zaG93ID0gXy51bmlxKE9iamVjdC52YWx1ZXMoY2FsY3VsYW5nX3NvdXJjZV9pbnRyb3NwZWN0aW9uLmN1bF9mdW5jdGlvbnMpLmZpbHRlcihkID0+IGQucmVhc29uID09ICdpbnB1dCBkZWZpbml0aW9uJykubWFwKGQgPT4gZC5uYW1lKS5zb3J0KCkpLmZpbHRlcihkID0+IGZvcm11bGFfbGluZV9kZXRhaWxzXzAuZmlsdGVyKGUgPT4gZS5uYW1lICsgJ19pbicgPT0gZCAmJiAoZS5vdmVyd3JpdHRlbiA9PSB1bmRlZmluZWQgfHwgZS5vdmVyd3JpdHRlbiA9PSBmYWxzZSkpLmxlbmd0aClcblxuc3QgPSB7XG4gIGVudHJ5cG9pbnRfbm9fY3VsX2pzO1xuICAvLyBJIGNhbm5vdCBmZXRjaCAhISFcbiAgLy9mZXRjaChgJHtlbnRyeXBvaW50X25vX2N1bF9qc30kezEgPyAnLW5vbWVtbycgOiAnJ30uaW50cm9zcGVjdGlvbi5qc29uYCk7XG4gIC8vYXdhaXQgaW50cm9zcGVjdGlvbl9ub21lbW87IC8vIEkgY2FuIGRlcGVuZCBvbiBtb2RlbG5hbWUgYnV0IE5PVCBpbnB1dHMgb3IgaW50cm9zcGVjdGlvbiAhXG4gIHJldHVybiBbJ3llYXJfaW4nLCAnZHVyYXRpb25faW4nLCAnZl9pbiddIC8vIFwiYW5udWFsX3BheW1lbnRfaW5cIiwgXCJkdXJhdGlvbl9pblwiLCBcImludGVyZXN0X3JhdGVfaW5cIiwgXCJ5ZWFyX2luXCJcbiAgLy8gbm90IHdvcmtpbmdcbn1cblxuLy9mZmYyLmpvaW4oJ1xcblxcbicpXG5cbi8qbWpzX3FfZXZhbFxuXG5hYVxuXG5tb2RlbCovXG5cbnZpZXdvZiBlZGl0b3IgPSBDb2RlTWlycm9yKFxuICAvLyBUaGlzIG5lZWRzIHRvIGJlIGVudHJ5cG9pbnQgc2NvcGVpZD9cbiAgZmZmMi5qb2luKCdcXG5cXG4nKSxcbiAge1xuICAgIGV4dGVuc2lvbnM6IFsgLy8gd3JhcCBpbmRpY2F0b3JzIHdvdWxkIGJlIG5pY2VcbiAgICAgIC8vIG15RGVmYXVsdFRoZW1lLCAvLyBUT0RPIGJyaW5nIHRoaXMgaW4sICsgZGFyayB2ZXJzaW9uXG4gICAgICBjbUltcG9ydHNbXCJsYW5nLWphdmFzY3JpcHRcIl0uamF2YXNjcmlwdCgpLFxuICAgICAgLy9jbUltcG9ydHNbXCJsYW5ndWFnZVwiXS5mb2xkR3V0dGVyKCksXG4gICAgICAvL0VkaXRvclZpZXcuZGVjb3JhdGlvbnMub2YoRGVjb3JhdGlvbi5zZXQoeWVsbG93LnJhbmdlKHIpKSlcbiAgICAgIC8qIEJVSUxESU5HIGNtQ2hlY2tib3hQbHVnaW5WaWV3b2YsIC8vIGRvZXMgY3VsIGNvZGUgYW5ub3RhdGlvbiBhbmQgbmF2aWdhdGlvbiwgZGVwZW5kaW5nIG9uIHNob3dTdHJpcGVzXG4gICAgICBjbU92ZXJsYXlQbHVnaW5WaWV3b2YsKi9cbiAgICAgIG92ZXJsYXkgPyBvdmVybGF5X2Fuc3dlcnMgOiBFZGl0b3JTdGF0ZS5yZWFkT25seS5vZih0cnVlKSxcbiAgICAgIG92ZXJsYXkgPyBvdmVybGF5X3dvcmtpbmdzIDogRWRpdG9yU3RhdGUucmVhZE9ubHkub2YodHJ1ZSksXG4gICAgICBmb3JtdWxhRGVjb3JhdGlvbnMoe2Zvcm11bGFlX3Zpc2libGU6IHZpZXdvZiBmb3JtdWxhZV92aXNpYmxlfSksIC8vIGh0dHBzOi8vY29kZW1pcnJvci5uZXQvZXhhbXBsZXMvemVicmEvXG4gICAgICAvKiBUT0RPIGRvbid0IHByb2Nlc3MgSW1wb3J0L0V4cG9ydHMgZm9yIG5vdyAqLyBjYWxjdWxhbmdfaWRlbnRpZmllcl9kZWNvcmF0aW9ucyh7Zm9ybXVsYWVfdmlzaWJsZTogdmlld29mIGZvcm11bGFlX3Zpc2libGV9KSxcbiAgICAgIEVkaXRvclZpZXcubGluZVdyYXBwaW5nLFxuICAgICAgRWRpdG9yVmlldy5lZGl0YWJsZS5vZih0cnVlKSxcbiAgICAgIEVkaXRvclN0YXRlLnJlYWRPbmx5Lm9mKHRydWUpXG4gICAgXVxuICB9XG4pXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJcbi8vLy8vLy8vLy8vLy8gb3ZlcmxheSBwbHVnaW46XG5cbi8vLy8gZXZhbHM7IGZyb20gZ2VuZXJhdG9yIGluIHJlYWN0aXZlLXdvcmtpbmdzXG5cbmludGVyZXN0X3JhdGVfZXhwZWN0ZWQgPSAoKSA9PiAwIC8vIHN0aWxsIG5lZWRlZCwgVE9ETyBmaXghXG4vL2ludGVyZXN0X3JhdGVfZXhwZWN0ZWQgPSAoKSA9PiAwXG5cbi8vLy8vIENPUFkgRVZBTFNcbm1qc19xX2V2YWwgPSAgeyByZXR1cm4gKHtcInJheWNhc3RpbmcyXCI6W1t7bmFtZTogXCJyYXlfYW5nbGVcIiwgdmFsdWU6cmF5Y2FzdGluZzIucmF5X2FuZ2xlKHsgcmF5X2FuZ2xlX2luIH0pfSx7bmFtZTogXCJ0YW5fcmF5X2FuZ2xlXCIsIHZhbHVlOnJheWNhc3RpbmcyLnRhbl9yYXlfYW5nbGUoeyByYXlfYW5nbGVfaW4gfSl9LHtuYW1lOiBcInJheV9hbmdsZVwiLCB2YWx1ZTpyYXljYXN0aW5nMi5yYXlfYW5nbGUoeyByYXlfYW5nbGVfaW4gfSl9LHtuYW1lOiBcInJheV9hbmdsZVwiLCB2YWx1ZTpyYXljYXN0aW5nMi5yYXlfYW5nbGUoeyByYXlfYW5nbGVfaW4gfSl9LHtuYW1lOiBcInlcIiwgdmFsdWU6cmF5Y2FzdGluZzIueSh7IHlfaW4gfSl9LHtuYW1lOiBcInhcIiwgdmFsdWU6cmF5Y2FzdGluZzIueCh7IHhfaW4gfSl9LHtuYW1lOiBcInhcIiwgdmFsdWU6cmF5Y2FzdGluZzIueCh7IHhfaW4gfSl9LHtuYW1lOiBcInlcIiwgdmFsdWU6cmF5Y2FzdGluZzIueSh7IHlfaW4gfSl9LHtuYW1lOiBcIm1hcFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5tYXAoe30pfSx7bmFtZTogXCJ5XCIsIHZhbHVlOnJheWNhc3RpbmcyLnkoeyB5X2luIH0pfSx7bmFtZTogXCJ4XCIsIHZhbHVlOnJheWNhc3RpbmcyLngoeyB4X2luIH0pfSx7bmFtZTogXCJtYXBcIiwgdmFsdWU6cmF5Y2FzdGluZzIubWFwKHt9KX0se25hbWU6IFwieVwiLCB2YWx1ZTpyYXljYXN0aW5nMi55KHsgeV9pbiB9KX0se25hbWU6IFwieFwiLCB2YWx1ZTpyYXljYXN0aW5nMi54KHsgeF9pbiB9KX0se25hbWU6IFwic3RlcFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5zdGVwKHsgc3RlcF9pbiB9KX0se25hbWU6IFwicGxheWVyX3hcIiwgdmFsdWU6cmF5Y2FzdGluZzIucGxheWVyX3goeyBmX2luLCBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiB9KX0se25hbWU6IFwicGxheWVyX3lcIiwgdmFsdWU6cmF5Y2FzdGluZzIucGxheWVyX3koeyBmX2luLCBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiB9KX0se25hbWU6IFwicmh5XCIsIHZhbHVlOnJheWNhc3RpbmcyLnJoeSh7IHJheV9hbmdsZV9pbiwgc3RlcF9pbiwgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4gfSl9LHtuYW1lOiBcImludmVyc2VfdGFuX3JheV9hbmdsZVwiLCB2YWx1ZTpyYXljYXN0aW5nMi5pbnZlcnNlX3Rhbl9yYXlfYW5nbGUoeyByYXlfYW5nbGVfaW4gfSl9LHtuYW1lOiBcInJoeFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5yaHgoeyBmX2luLCBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiwgcmF5X2FuZ2xlX2luLCBzdGVwX2luOnJheWNhc3RpbmcyLnN0ZXAoeyBzdGVwX2luIH0pIC0gMSB9KSwgaGFuZGxlcjogKCkgPT4ge3NldCh2aWV3b2Ygc3RlcF9pbiwgcmF5Y2FzdGluZzIuc3RlcCh7IHN0ZXBfaW4gfSkgLSAxKX19LHtuYW1lOiBcInN0ZXBcIiwgdmFsdWU6cmF5Y2FzdGluZzIuc3RlcCh7IHN0ZXBfaW4gfSl9LHtuYW1lOiBcInJheV9sb29raW5nX3VwXCIsIHZhbHVlOnJheWNhc3RpbmcyLnJheV9sb29raW5nX3VwKHsgcmF5X2FuZ2xlX2luIH0pfSx7bmFtZTogXCJpbnZlcnNlX3Rhbl9yYXlfYW5nbGVcIiwgdmFsdWU6cmF5Y2FzdGluZzIuaW52ZXJzZV90YW5fcmF5X2FuZ2xlKHsgcmF5X2FuZ2xlX2luIH0pfSx7bmFtZTogXCJyYXlfbG9va2luZ191cFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5yYXlfbG9va2luZ191cCh7IHJheV9hbmdsZV9pbiB9KX0se25hbWU6IFwic3RlcFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5zdGVwKHsgc3RlcF9pbiB9KX0se25hbWU6IFwicGxheWVyX3lcIiwgdmFsdWU6cmF5Y2FzdGluZzIucGxheWVyX3koeyBmX2luLCBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiB9KX0se25hbWU6IFwicmh5XCIsIHZhbHVlOnJheWNhc3RpbmcyLnJoeSh7IHJheV9hbmdsZV9pbiwgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4sIHN0ZXBfaW46cmF5Y2FzdGluZzIuc3RlcCh7IHN0ZXBfaW4gfSkgLSAxIH0pLCBoYW5kbGVyOiAoKSA9PiB7c2V0KHZpZXdvZiBzdGVwX2luLCByYXljYXN0aW5nMi5zdGVwKHsgc3RlcF9pbiB9KSAtIDEpfX0se25hbWU6IFwic3RlcFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5zdGVwKHsgc3RlcF9pbiB9KX0se25hbWU6IFwic3RlcFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5zdGVwKHsgc3RlcF9pbiB9KX0se25hbWU6IFwicGxheWVyX3lcIiwgdmFsdWU6cmF5Y2FzdGluZzIucGxheWVyX3koeyBmX2luLCBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiB9KX0se25hbWU6IFwicmh5XCIsIHZhbHVlOnJheWNhc3RpbmcyLnJoeSh7IHJheV9hbmdsZV9pbiwgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4sIHN0ZXBfaW46cmF5Y2FzdGluZzIuc3RlcCh7IHN0ZXBfaW4gfSkgLSAxIH0pLCBoYW5kbGVyOiAoKSA9PiB7c2V0KHZpZXdvZiBzdGVwX2luLCByYXljYXN0aW5nMi5zdGVwKHsgc3RlcF9pbiB9KSAtIDEpfX0se25hbWU6IFwic3RlcFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5zdGVwKHsgc3RlcF9pbiB9KX0se25hbWU6IFwibWFwX2xvb2t1cFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5tYXBfbG9va3VwKHsgeF9pbjpyYXljYXN0aW5nMi5yaHgoeyBzdGVwX2luLCBmX2luLCBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiwgcmF5X2FuZ2xlX2luIH0pLCB5X2luOnJheWNhc3RpbmcyLnJoeSh7IHJheV9hbmdsZV9pbiwgc3RlcF9pbiwgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4gfSkgfSksIGhhbmRsZXI6ICgpID0+IHtzZXQodmlld29mIHhfaW4sIHJheWNhc3RpbmcyLnJoeCh7IHN0ZXBfaW4sIGZfaW4sIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luLCByYXlfYW5nbGVfaW4gfSkpOyBzZXQodmlld29mIHlfaW4sIHJheWNhc3RpbmcyLnJoeSh7IHJheV9hbmdsZV9pbiwgc3RlcF9pbiwgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4gfSkpfX0se25hbWU6IFwicmh4XCIsIHZhbHVlOnJheWNhc3RpbmcyLnJoeCh7IHN0ZXBfaW4sIGZfaW4sIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luLCByYXlfYW5nbGVfaW4gfSl9LHtuYW1lOiBcInJoeVwiLCB2YWx1ZTpyYXljYXN0aW5nMi5yaHkoeyByYXlfYW5nbGVfaW4sIHN0ZXBfaW4sIGZfaW4sIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luIH0pfSx7bmFtZTogXCJyaHZcIiwgdmFsdWU6cmF5Y2FzdGluZzIucmh2KHsgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4sIHJheV9hbmdsZV9pbiwgc3RlcF9pbiB9KX0se25hbWU6IFwicmh4XCIsIHZhbHVlOnJheWNhc3RpbmcyLnJoeCh7IGZfaW4sIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luLCByYXlfYW5nbGVfaW4sIHN0ZXBfaW4gfSl9LHtuYW1lOiBcInJoeVwiLCB2YWx1ZTpyYXljYXN0aW5nMi5yaHkoeyByYXlfYW5nbGVfaW4sIGZfaW4sIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luLCBzdGVwX2luIH0pfSx7bmFtZTogXCJyaHZcIiwgdmFsdWU6cmF5Y2FzdGluZzIucmh2KHsgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4sIHJheV9hbmdsZV9pbiwgc3RlcF9pbiB9KX0se25hbWU6IFwicmhfaGl0X29iamVjdFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5yaF9oaXRfb2JqZWN0KHsgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4sIHJheV9hbmdsZV9pbiB9KX0se25hbWU6IFwicmhfaGl0X29iamVjdFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5yaF9oaXRfb2JqZWN0KHsgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4sIHJheV9hbmdsZV9pbiB9KX0se25hbWU6IFwicmhfaGl0X29iamVjdFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5yaF9oaXRfb2JqZWN0KHsgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4sIHJheV9hbmdsZV9pbiB9KX0se25hbWU6IFwicmhfaGl0X29iamVjdFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5yaF9oaXRfb2JqZWN0KHsgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4sIHJheV9hbmdsZV9pbiB9KX0se25hbWU6IFwicmhfaGl0X3hcIiwgdmFsdWU6cmF5Y2FzdGluZzIucmhfaGl0X3goeyBmX2luLCBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiwgcmF5X2FuZ2xlX2luIH0pfSx7bmFtZTogXCJwbGF5ZXJfeFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5wbGF5ZXJfeCh7IGZfaW4sIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luIH0pfSx7bmFtZTogXCJyaF9oaXRfeVwiLCB2YWx1ZTpyYXljYXN0aW5nMi5yaF9oaXRfeSh7IGZfaW4sIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luLCByYXlfYW5nbGVfaW4gfSl9LHtuYW1lOiBcInBsYXllcl95XCIsIHZhbHVlOnJheWNhc3RpbmcyLnBsYXllcl95KHsgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4gfSl9LHtuYW1lOiBcInJheV9sb29raW5nX3JpZ2h0XCIsIHZhbHVlOnJheWNhc3RpbmcyLnJheV9sb29raW5nX3JpZ2h0KHsgcmF5X2FuZ2xlX2luIH0pfSx7bmFtZTogXCJzdGVwXCIsIHZhbHVlOnJheWNhc3RpbmcyLnN0ZXAoeyBzdGVwX2luIH0pfSx7bmFtZTogXCJwbGF5ZXJfeFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5wbGF5ZXJfeCh7IGZfaW4sIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luIH0pfSx7bmFtZTogXCJydnhcIiwgdmFsdWU6cmF5Y2FzdGluZzIucnZ4KHsgcmF5X2FuZ2xlX2luLCBmX2luLCBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiwgc3RlcF9pbjpyYXljYXN0aW5nMi5zdGVwKHsgc3RlcF9pbiB9KSAtIDEgfSksIGhhbmRsZXI6ICgpID0+IHtzZXQodmlld29mIHN0ZXBfaW4sIHJheWNhc3RpbmcyLnN0ZXAoeyBzdGVwX2luIH0pIC0gMSl9fSx7bmFtZTogXCJzdGVwXCIsIHZhbHVlOnJheWNhc3RpbmcyLnN0ZXAoeyBzdGVwX2luIH0pfSx7bmFtZTogXCJzdGVwXCIsIHZhbHVlOnJheWNhc3RpbmcyLnN0ZXAoeyBzdGVwX2luIH0pfSx7bmFtZTogXCJwbGF5ZXJfeFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5wbGF5ZXJfeCh7IGZfaW4sIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luIH0pfSx7bmFtZTogXCJydnhcIiwgdmFsdWU6cmF5Y2FzdGluZzIucnZ4KHsgcmF5X2FuZ2xlX2luLCBmX2luLCBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiwgc3RlcF9pbjpyYXljYXN0aW5nMi5zdGVwKHsgc3RlcF9pbiB9KSAtIDEgfSksIGhhbmRsZXI6ICgpID0+IHtzZXQodmlld29mIHN0ZXBfaW4sIHJheWNhc3RpbmcyLnN0ZXAoeyBzdGVwX2luIH0pIC0gMSl9fSx7bmFtZTogXCJzdGVwXCIsIHZhbHVlOnJheWNhc3RpbmcyLnN0ZXAoeyBzdGVwX2luIH0pfSx7bmFtZTogXCJzdGVwXCIsIHZhbHVlOnJheWNhc3RpbmcyLnN0ZXAoeyBzdGVwX2luIH0pfSx7bmFtZTogXCJwbGF5ZXJfeVwiLCB2YWx1ZTpyYXljYXN0aW5nMi5wbGF5ZXJfeSh7IGZfaW4sIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luIH0pfSx7bmFtZTogXCJwbGF5ZXJfeFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5wbGF5ZXJfeCh7IGZfaW4sIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luIH0pfSx7bmFtZTogXCJydnhcIiwgdmFsdWU6cmF5Y2FzdGluZzIucnZ4KHsgcmF5X2FuZ2xlX2luLCBzdGVwX2luLCBmX2luLCBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiB9KX0se25hbWU6IFwidGFuX3JheV9hbmdsZVwiLCB2YWx1ZTpyYXljYXN0aW5nMi50YW5fcmF5X2FuZ2xlKHsgcmF5X2FuZ2xlX2luIH0pfSx7bmFtZTogXCJydnlcIiwgdmFsdWU6cmF5Y2FzdGluZzIucnZ5KHsgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4sIHJheV9hbmdsZV9pbiwgc3RlcF9pbjpyYXljYXN0aW5nMi5zdGVwKHsgc3RlcF9pbiB9KSAtIDEgfSksIGhhbmRsZXI6ICgpID0+IHtzZXQodmlld29mIHN0ZXBfaW4sIHJheWNhc3RpbmcyLnN0ZXAoeyBzdGVwX2luIH0pIC0gMSl9fSx7bmFtZTogXCJzdGVwXCIsIHZhbHVlOnJheWNhc3RpbmcyLnN0ZXAoeyBzdGVwX2luIH0pfSx7bmFtZTogXCJyYXlfbG9va2luZ19yaWdodFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5yYXlfbG9va2luZ19yaWdodCh7IHJheV9hbmdsZV9pbiB9KX0se25hbWU6IFwidGFuX3JheV9hbmdsZVwiLCB2YWx1ZTpyYXljYXN0aW5nMi50YW5fcmF5X2FuZ2xlKHsgcmF5X2FuZ2xlX2luIH0pfSx7bmFtZTogXCJtYXBfbG9va3VwXCIsIHZhbHVlOnJheWNhc3RpbmcyLm1hcF9sb29rdXAoeyB4X2luOnJheWNhc3RpbmcyLnJ2eCh7IHJheV9hbmdsZV9pbiwgc3RlcF9pbiwgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4gfSksIHlfaW46cmF5Y2FzdGluZzIucnZ5KHsgc3RlcF9pbiwgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4sIHJheV9hbmdsZV9pbiB9KSB9KSwgaGFuZGxlcjogKCkgPT4ge3NldCh2aWV3b2YgeF9pbiwgcmF5Y2FzdGluZzIucnZ4KHsgcmF5X2FuZ2xlX2luLCBzdGVwX2luLCBmX2luLCBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiB9KSk7IHNldCh2aWV3b2YgeV9pbiwgcmF5Y2FzdGluZzIucnZ5KHsgc3RlcF9pbiwgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4sIHJheV9hbmdsZV9pbiB9KSl9fSx7bmFtZTogXCJydnhcIiwgdmFsdWU6cmF5Y2FzdGluZzIucnZ4KHsgcmF5X2FuZ2xlX2luLCBzdGVwX2luLCBmX2luLCBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiB9KX0se25hbWU6IFwicnZ5XCIsIHZhbHVlOnJheWNhc3RpbmcyLnJ2eSh7IHN0ZXBfaW4sIGZfaW4sIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luLCByYXlfYW5nbGVfaW4gfSl9LHtuYW1lOiBcInJ2dlwiLCB2YWx1ZTpyYXljYXN0aW5nMi5ydnYoeyByYXlfYW5nbGVfaW4sIGZfaW4sIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luLCBzdGVwX2luIH0pfSx7bmFtZTogXCJydnhcIiwgdmFsdWU6cmF5Y2FzdGluZzIucnZ4KHsgcmF5X2FuZ2xlX2luLCBmX2luLCBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiwgc3RlcF9pbiB9KX0se25hbWU6IFwicnZ5XCIsIHZhbHVlOnJheWNhc3RpbmcyLnJ2eSh7IGZfaW4sIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luLCByYXlfYW5nbGVfaW4sIHN0ZXBfaW4gfSl9LHtuYW1lOiBcInJ2dlwiLCB2YWx1ZTpyYXljYXN0aW5nMi5ydnYoeyByYXlfYW5nbGVfaW4sIGZfaW4sIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luLCBzdGVwX2luIH0pfSx7bmFtZTogXCJydl9oaXRfb2JqZWN0XCIsIHZhbHVlOnJheWNhc3RpbmcyLnJ2X2hpdF9vYmplY3QoeyByYXlfYW5nbGVfaW4sIGZfaW4sIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luIH0pfSx7bmFtZTogXCJydl9oaXRfb2JqZWN0XCIsIHZhbHVlOnJheWNhc3RpbmcyLnJ2X2hpdF9vYmplY3QoeyByYXlfYW5nbGVfaW4sIGZfaW4sIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luIH0pfSx7bmFtZTogXCJydl9oaXRfb2JqZWN0XCIsIHZhbHVlOnJheWNhc3RpbmcyLnJ2X2hpdF9vYmplY3QoeyByYXlfYW5nbGVfaW4sIGZfaW4sIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luIH0pfSx7bmFtZTogXCJydl9oaXRfb2JqZWN0XCIsIHZhbHVlOnJheWNhc3RpbmcyLnJ2X2hpdF9vYmplY3QoeyByYXlfYW5nbGVfaW4sIGZfaW4sIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luIH0pfSx7bmFtZTogXCJydl9oaXRfeFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5ydl9oaXRfeCh7IHJheV9hbmdsZV9pbiwgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4gfSl9LHtuYW1lOiBcInBsYXllcl94XCIsIHZhbHVlOnJheWNhc3RpbmcyLnBsYXllcl94KHsgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4gfSl9LHtuYW1lOiBcInJ2X2hpdF95XCIsIHZhbHVlOnJheWNhc3RpbmcyLnJ2X2hpdF95KHsgcmF5X2FuZ2xlX2luLCBmX2luLCBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiB9KX0se25hbWU6IFwicGxheWVyX3lcIiwgdmFsdWU6cmF5Y2FzdGluZzIucGxheWVyX3koeyBmX2luLCBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiB9KX0se25hbWU6IFwicnZfaGl0X2Rpc3RhbmNlXCIsIHZhbHVlOnJheWNhc3RpbmcyLnJ2X2hpdF9kaXN0YW5jZSh7IHlfaW4sIHhfaW4sIHJheV9hbmdsZV9pbiwgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4gfSl9LHtuYW1lOiBcInJoX2hpdF9kaXN0YW5jZVwiLCB2YWx1ZTpyYXljYXN0aW5nMi5yaF9oaXRfZGlzdGFuY2UoeyB5X2luLCB4X2luLCBmX2luLCBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiwgcmF5X2FuZ2xlX2luIH0pfSx7bmFtZTogXCJyX2hpdF9oX29yX3ZcIiwgdmFsdWU6cmF5Y2FzdGluZzIucl9oaXRfaF9vcl92KHsgeV9pbiwgeF9pbiwgcmF5X2FuZ2xlX2luLCBmX2luLCBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiB9KX0se25hbWU6IFwicnZfaGl0X29iamVjdFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5ydl9oaXRfb2JqZWN0KHsgcmF5X2FuZ2xlX2luLCBmX2luLCBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiB9KX0se25hbWU6IFwicmhfaGl0X29iamVjdFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5yaF9oaXRfb2JqZWN0KHsgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4sIHJheV9hbmdsZV9pbiB9KX0se25hbWU6IFwicl9oaXRfb2JqZWN0XCIsIHZhbHVlOnJheWNhc3RpbmcyLnJfaGl0X29iamVjdCh7IHlfaW4sIHhfaW4sIHJheV9hbmdsZV9pbiwgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4gfSl9LHtuYW1lOiBcInJfaGl0X29iamVjdFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5yX2hpdF9vYmplY3QoeyB5X2luLCB4X2luLCByYXlfYW5nbGVfaW4sIGZfaW4sIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luIH0pfSx7bmFtZTogXCJyX2hpdF9vYmplY3RcIiwgdmFsdWU6cmF5Y2FzdGluZzIucl9oaXRfb2JqZWN0KHsgeV9pbiwgeF9pbiwgcmF5X2FuZ2xlX2luLCBmX2luLCBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiB9KX0se25hbWU6IFwicl9oaXRfb2JqZWN0XCIsIHZhbHVlOnJheWNhc3RpbmcyLnJfaGl0X29iamVjdCh7IHlfaW4sIHhfaW4sIHJheV9hbmdsZV9pbiwgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4gfSl9LHtuYW1lOiBcInJ2X2hpdF9kaXN0YW5jZVwiLCB2YWx1ZTpyYXljYXN0aW5nMi5ydl9oaXRfZGlzdGFuY2UoeyB5X2luLCB4X2luLCByYXlfYW5nbGVfaW4sIGZfaW4sIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luIH0pfSx7bmFtZTogXCJyaF9oaXRfZGlzdGFuY2VcIiwgdmFsdWU6cmF5Y2FzdGluZzIucmhfaGl0X2Rpc3RhbmNlKHsgeV9pbiwgeF9pbiwgZl9pbiwga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4sIHJheV9hbmdsZV9pbiB9KX0se25hbWU6IFwiZmlzaGV5ZV9jb3JyZWN0aW9uXCIsIHZhbHVlOnJheWNhc3RpbmcyLmZpc2hleWVfY29ycmVjdGlvbih7IGZpc2hleWVfY29ycmVjdGlvbl9pbiB9KX0se25hbWU6IFwicGxheWVyX2FuZ2xlXCIsIHZhbHVlOnJheWNhc3RpbmcyLnBsYXllcl9hbmdsZSh7IGZfaW4sIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luIH0pfSx7bmFtZTogXCJyYXlfYW5nbGVcIiwgdmFsdWU6cmF5Y2FzdGluZzIucmF5X2FuZ2xlKHsgcmF5X2FuZ2xlX2luIH0pfSx7bmFtZTogXCJyYXlfZGlzdGFuY2VcIiwgdmFsdWU6cmF5Y2FzdGluZzIucmF5X2Rpc3RhbmNlKHsgeV9pbiwgeF9pbiwgcmF5X2FuZ2xlX2luLCBmX2luLCBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiwgZmlzaGV5ZV9jb3JyZWN0aW9uX2luIH0pfSx7bmFtZTogXCJrZXlzX3N0cmVhbV92ZXJzaW9uXCIsIHZhbHVlOnJheWNhc3RpbmcyLmtleXNfc3RyZWFtX3ZlcnNpb24oeyBrZXlzX3N0cmVhbV92ZXJzaW9uX2luIH0pfSx7bmFtZTogXCJrZXlzX3N0cmVhbV9mdW5jdGlvblwiLCB2YWx1ZTpyYXljYXN0aW5nMi5rZXlzX3N0cmVhbV9mdW5jdGlvbih7IGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luIH0pfSx7bmFtZTogXCJmXCIsIHZhbHVlOnJheWNhc3RpbmcyLmYoeyBmX2luIH0pfSx7bmFtZTogXCJrZXlzXCIsIHZhbHVlOnJheWNhc3RpbmcyLmtleXMoeyBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiwgZl9pbiB9KX0se25hbWU6IFwia2V5c1wiLCB2YWx1ZTpyYXljYXN0aW5nMi5rZXlzKHsga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4sIGZfaW4gfSl9LHtuYW1lOiBcImtleXNcIiwgdmFsdWU6cmF5Y2FzdGluZzIua2V5cyh7IGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luLCBmX2luIH0pfSx7bmFtZTogXCJrZXlzXCIsIHZhbHVlOnJheWNhc3RpbmcyLmtleXMoeyBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiwgZl9pbiB9KX0se25hbWU6IFwia2V5c1wiLCB2YWx1ZTpyYXljYXN0aW5nMi5rZXlzKHsga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4sIGZfaW4gfSl9LHtuYW1lOiBcImtleXNcIiwgdmFsdWU6cmF5Y2FzdGluZzIua2V5cyh7IGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luLCBmX2luIH0pfSx7bmFtZTogXCJrZXlzXCIsIHZhbHVlOnJheWNhc3RpbmcyLmtleXMoeyBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiwgZl9pbiB9KX0se25hbWU6IFwia2V5c1wiLCB2YWx1ZTpyYXljYXN0aW5nMi5rZXlzKHsga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4sIGZfaW4gfSl9LHtuYW1lOiBcImtleV91cFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5rZXlfdXAoeyBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiwgZl9pbiB9KX0se25hbWU6IFwia2V5X2Rvd25cIiwgdmFsdWU6cmF5Y2FzdGluZzIua2V5X2Rvd24oeyBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiwgZl9pbiB9KX0se25hbWU6IFwia2V5X2xlZnRcIiwgdmFsdWU6cmF5Y2FzdGluZzIua2V5X2xlZnQoeyBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiwgZl9pbiB9KX0se25hbWU6IFwia2V5X3JpZ2h0XCIsIHZhbHVlOnJheWNhc3RpbmcyLmtleV9yaWdodCh7IGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luLCBmX2luIH0pfSx7bmFtZTogXCJmXCIsIHZhbHVlOnJheWNhc3RpbmcyLmYoeyBmX2luIH0pfSx7bmFtZTogXCJwbGF5ZXJfYW5nbGVcIiwgdmFsdWU6cmF5Y2FzdGluZzIucGxheWVyX2FuZ2xlKHsga2V5c19zdHJlYW1fdmVyc2lvbl9pbiwga2V5c19zdHJlYW1fZnVuY3Rpb25faW4sIGZfaW46cmF5Y2FzdGluZzIuZih7IGZfaW4gfSkgLSAxIH0pLCBoYW5kbGVyOiAoKSA9PiB7c2V0KHZpZXdvZiBmX2luLCByYXljYXN0aW5nMi5mKHsgZl9pbiB9KSAtIDEpfX0se25hbWU6IFwiZlwiLCB2YWx1ZTpyYXljYXN0aW5nMi5mKHsgZl9pbiB9KX0se25hbWU6IFwibGVmdG5lc3NcIiwgdmFsdWU6cmF5Y2FzdGluZzIubGVmdG5lc3MoeyBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiwgZl9pbiB9KX0se25hbWU6IFwiZlwiLCB2YWx1ZTpyYXljYXN0aW5nMi5mKHsgZl9pbiB9KX0se25hbWU6IFwicGxheWVyX3hcIiwgdmFsdWU6cmF5Y2FzdGluZzIucGxheWVyX3goeyBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiwgZl9pbjpyYXljYXN0aW5nMi5mKHsgZl9pbiB9KSAtIDEgfSksIGhhbmRsZXI6ICgpID0+IHtzZXQodmlld29mIGZfaW4sIHJheWNhc3RpbmcyLmYoeyBmX2luIH0pIC0gMSl9fSx7bmFtZTogXCJmXCIsIHZhbHVlOnJheWNhc3RpbmcyLmYoeyBmX2luIH0pfSx7bmFtZTogXCJmb3J3YXJkbmVzc1wiLCB2YWx1ZTpyYXljYXN0aW5nMi5mb3J3YXJkbmVzcyh7IGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luLCBmX2luIH0pfSx7bmFtZTogXCJzcGVlZFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5zcGVlZCh7fSl9LHtuYW1lOiBcInBsYXllcl9hbmdsZVwiLCB2YWx1ZTpyYXljYXN0aW5nMi5wbGF5ZXJfYW5nbGUoeyBmX2luLCBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiB9KX0se25hbWU6IFwiZlwiLCB2YWx1ZTpyYXljYXN0aW5nMi5mKHsgZl9pbiB9KX0se25hbWU6IFwicGxheWVyX3lcIiwgdmFsdWU6cmF5Y2FzdGluZzIucGxheWVyX3koeyBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiwgZl9pbjpyYXljYXN0aW5nMi5mKHsgZl9pbiB9KSAtIDEgfSksIGhhbmRsZXI6ICgpID0+IHtzZXQodmlld29mIGZfaW4sIHJheWNhc3RpbmcyLmYoeyBmX2luIH0pIC0gMSl9fSx7bmFtZTogXCJmXCIsIHZhbHVlOnJheWNhc3RpbmcyLmYoeyBmX2luIH0pfSx7bmFtZTogXCJmb3J3YXJkbmVzc1wiLCB2YWx1ZTpyYXljYXN0aW5nMi5mb3J3YXJkbmVzcyh7IGtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luLCBmX2luIH0pfSx7bmFtZTogXCJzcGVlZFwiLCB2YWx1ZTpyYXljYXN0aW5nMi5zcGVlZCh7fSl9LHtuYW1lOiBcInBsYXllcl9hbmdsZVwiLCB2YWx1ZTpyYXljYXN0aW5nMi5wbGF5ZXJfYW5nbGUoeyBmX2luLCBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbiB9KX1dXSxcInNhdmluZ3NcIjpbW3tuYW1lOiBcInllYXJcIiwgdmFsdWU6c2F2aW5ncy55ZWFyKHsgeWVhcl9pbiB9KX0se25hbWU6IFwieWVhclwiLCB2YWx1ZTpzYXZpbmdzLnllYXIoeyB5ZWFyX2luIH0pfSx7bmFtZTogXCJkZXBvc2l0c1wiLCB2YWx1ZTpzYXZpbmdzLmRlcG9zaXRzKHsgeWVhcl9pbiwgZHVyYXRpb25faW4sIGFubnVhbF9wYXltZW50X2luIH0pfSx7bmFtZTogXCJiYWxhbmNlXCIsIHZhbHVlOnNhdmluZ3MuYmFsYW5jZSh7IGR1cmF0aW9uX2luLCBhbm51YWxfcGF5bWVudF9pbiwgaW50ZXJlc3RfcmF0ZV9pbiwgeWVhcl9pbjpzYXZpbmdzLnllYXIoeyB5ZWFyX2luIH0pIC0gMSB9KSwgaGFuZGxlcjogKCkgPT4ge3NldCh2aWV3b2YgeWVhcl9pbiwgc2F2aW5ncy55ZWFyKHsgeWVhcl9pbiB9KSAtIDEpfX0se25hbWU6IFwieWVhclwiLCB2YWx1ZTpzYXZpbmdzLnllYXIoeyB5ZWFyX2luIH0pfSx7bmFtZTogXCJkZXBvc2l0c1wiLCB2YWx1ZTpzYXZpbmdzLmRlcG9zaXRzKHsgeWVhcl9pbiwgZHVyYXRpb25faW4sIGFubnVhbF9wYXltZW50X2luIH0pfSx7bmFtZTogXCJpbnRlcmVzdFwiLCB2YWx1ZTpzYXZpbmdzLmludGVyZXN0KHsgeWVhcl9pbiwgZHVyYXRpb25faW4sIGFubnVhbF9wYXltZW50X2luLCBpbnRlcmVzdF9yYXRlX2luIH0pfSx7bmFtZTogXCJ5ZWFyXCIsIHZhbHVlOnNhdmluZ3MueWVhcih7IHllYXJfaW4gfSl9LHtuYW1lOiBcInllYXJcIiwgdmFsdWU6c2F2aW5ncy55ZWFyKHsgeWVhcl9pbiB9KX0se25hbWU6IFwiZHVyYXRpb25cIiwgdmFsdWU6c2F2aW5ncy5kdXJhdGlvbih7IGR1cmF0aW9uX2luIH0pfSx7bmFtZTogXCJhbm51YWxfcGF5bWVudFwiLCB2YWx1ZTpzYXZpbmdzLmFubnVhbF9wYXltZW50KHsgYW5udWFsX3BheW1lbnRfaW4gfSl9LHtuYW1lOiBcInllYXJcIiwgdmFsdWU6c2F2aW5ncy55ZWFyKHsgeWVhcl9pbiB9KX0se25hbWU6IFwiYmFsYW5jZVwiLCB2YWx1ZTpzYXZpbmdzLmJhbGFuY2UoeyBkdXJhdGlvbl9pbiwgYW5udWFsX3BheW1lbnRfaW4sIGludGVyZXN0X3JhdGVfaW4sIHllYXJfaW46c2F2aW5ncy55ZWFyKHsgeWVhcl9pbiB9KSAtIDEgfSksIGhhbmRsZXI6ICgpID0+IHtzZXQodmlld29mIHllYXJfaW4sIHNhdmluZ3MueWVhcih7IHllYXJfaW4gfSkgLSAxKX19LHtuYW1lOiBcInllYXJcIiwgdmFsdWU6c2F2aW5ncy55ZWFyKHsgeWVhcl9pbiB9KX0se25hbWU6IFwiaW50ZXJlc3RfcmF0ZVwiLCB2YWx1ZTpzYXZpbmdzLmludGVyZXN0X3JhdGUoeyBpbnRlcmVzdF9yYXRlX2luIH0pfV1dLFwic2F2aW5nc19yZWNcIjpbW3tuYW1lOiBcInllYXJcIiwgdmFsdWU6c2F2aW5nc19yZWMueWVhcih7IHllYXJfaW4gfSl9LHtuYW1lOiBcImFjdHVhbF9pbnRlcmVzdF9yYXRlX2NvXCIsIHZhbHVlOnNhdmluZ3NfcmVjLmFjdHVhbF9pbnRlcmVzdF9yYXRlX2NvKHsgYWN0dWFsX2ludGVyZXN0X3JhdGVfY29faW4gfSl9LHtuYW1lOiBcImludGVyZXN0X3JhdGVfZXhwZWN0ZWRcIiwgdmFsdWU6aW50ZXJlc3RfcmF0ZV9leHBlY3RlZCh7fSl9LHtuYW1lOiBcImFjdHVhbF9pbnRlcmVzdF9yYXRlc1wiLCB2YWx1ZTpzYXZpbmdzX3JlYy5hY3R1YWxfaW50ZXJlc3RfcmF0ZXMoe30pfSx7bmFtZTogXCJ5ZWFyXCIsIHZhbHVlOnNhdmluZ3NfcmVjLnllYXIoeyB5ZWFyX2luIH0pfV0sW10sW3tuYW1lOiBcInllYXJcIiwgdmFsdWU6c2F2aW5nc19yZWMueWVhcih7IHllYXJfaW4gfSl9LHtuYW1lOiBcInllYXJcIiwgdmFsdWU6c2F2aW5nc19yZWMueWVhcih7IHllYXJfaW4gfSl9LHtuYW1lOiBcImRlcG9zaXRzXCIsIHZhbHVlOnNhdmluZ3NfcmVjLmRlcG9zaXRzKHsgeWVhcl9pbiB9KX0se25hbWU6IFwiYmFsYW5jZVwiLCB2YWx1ZTpzYXZpbmdzX3JlYy5iYWxhbmNlKHsgYWN0dWFsX2ludGVyZXN0X3JhdGVfY29faW4sIHllYXJfaW46c2F2aW5nc19yZWMueWVhcih7IHllYXJfaW4gfSkgLSAxIH0pLCBoYW5kbGVyOiAoKSA9PiB7c2V0KHZpZXdvZiB5ZWFyX2luLCBzYXZpbmdzX3JlYy55ZWFyKHsgeWVhcl9pbiB9KSAtIDEpfX0se25hbWU6IFwieWVhclwiLCB2YWx1ZTpzYXZpbmdzX3JlYy55ZWFyKHsgeWVhcl9pbiB9KX0se25hbWU6IFwiZGVwb3NpdHNcIiwgdmFsdWU6c2F2aW5nc19yZWMuZGVwb3NpdHMoeyB5ZWFyX2luIH0pfSx7bmFtZTogXCJpbnRlcmVzdFwiLCB2YWx1ZTpzYXZpbmdzX3JlYy5pbnRlcmVzdCh7IHllYXJfaW4sIGFjdHVhbF9pbnRlcmVzdF9yYXRlX2NvX2luIH0pfSx7bmFtZTogXCJ5ZWFyXCIsIHZhbHVlOnNhdmluZ3NfcmVjLnllYXIoeyB5ZWFyX2luIH0pfSx7bmFtZTogXCJ5ZWFyXCIsIHZhbHVlOnNhdmluZ3NfcmVjLnllYXIoeyB5ZWFyX2luIH0pfSx7bmFtZTogXCJkdXJhdGlvblwiLCB2YWx1ZTpzYXZpbmdzX3JlYy5kdXJhdGlvbih7fSl9LHtuYW1lOiBcImFubnVhbF9wYXltZW50XCIsIHZhbHVlOnNhdmluZ3NfcmVjLmFubnVhbF9wYXltZW50KHt9KX0se25hbWU6IFwieWVhclwiLCB2YWx1ZTpzYXZpbmdzX3JlYy55ZWFyKHsgeWVhcl9pbiB9KX0se25hbWU6IFwiYmFsYW5jZVwiLCB2YWx1ZTpzYXZpbmdzX3JlYy5iYWxhbmNlKHsgYWN0dWFsX2ludGVyZXN0X3JhdGVfY29faW4sIHllYXJfaW46c2F2aW5nc19yZWMueWVhcih7IHllYXJfaW4gfSkgLSAxIH0pLCBoYW5kbGVyOiAoKSA9PiB7c2V0KHZpZXdvZiB5ZWFyX2luLCBzYXZpbmdzX3JlYy55ZWFyKHsgeWVhcl9pbiB9KSAtIDEpfX0se25hbWU6IFwieWVhclwiLCB2YWx1ZTpzYXZpbmdzX3JlYy55ZWFyKHsgeWVhcl9pbiB9KX0se25hbWU6IFwiaW50ZXJlc3RfcmF0ZVwiLCB2YWx1ZTpzYXZpbmdzX3JlYy5pbnRlcmVzdF9yYXRlKHsgeWVhcl9pbiwgYWN0dWFsX2ludGVyZXN0X3JhdGVfY29faW4gfSl9XV0sXCJzdGFyZmllbGRcIjpbW3tuYW1lOiBcInJhbmRvbV9zZWVkXCIsIHZhbHVlOnN0YXJmaWVsZC5yYW5kb21fc2VlZCh7IHJhbmRvbV9zZWVkX2luIH0pfSx7bmFtZTogXCJzZWVkZWRcIiwgdmFsdWU6c3RhcmZpZWxkLnNlZWRlZCh7IHJhbmRvbV9zZWVkX2luOnN0YXJmaWVsZC5yYW5kb21fc2VlZCh7IHJhbmRvbV9zZWVkX2luIH0pIH0pLCBoYW5kbGVyOiAoKSA9PiB7c2V0KHZpZXdvZiByYW5kb21fc2VlZF9pbiwgc3RhcmZpZWxkLnJhbmRvbV9zZWVkKHsgcmFuZG9tX3NlZWRfaW4gfSkpfX0se25hbWU6IFwicmFuZG9tX3NlZWRcIiwgdmFsdWU6c3RhcmZpZWxkLnJhbmRvbV9zZWVkKHsgcmFuZG9tX3NlZWRfaW4gfSl9LHtuYW1lOiBcInJhbmRvbVwiLCB2YWx1ZTpzdGFyZmllbGQucmFuZG9tKHsgcmFuZG9tX3NlZWRfaW4sIHN0YXJfaW46c3RhcmZpZWxkLnN0YXIoeyBzdGFyX2luIH0pLCBpZDogXCJ4XCIgfSksIGhhbmRsZXI6ICgpID0+IHtzZXQodmlld29mIHN0YXJfaW4sIHN0YXJmaWVsZC5zdGFyKHsgc3Rhcl9pbiB9KSl9fSx7bmFtZTogXCJzdGFyXCIsIHZhbHVlOnN0YXJmaWVsZC5zdGFyKHsgc3Rhcl9pbiB9KX0se25hbWU6IFwicmFuZG9tXCIsIHZhbHVlOnN0YXJmaWVsZC5yYW5kb20oeyByYW5kb21fc2VlZF9pbiwgc3Rhcl9pbjpzdGFyZmllbGQuc3Rhcih7IHN0YXJfaW4gfSksIGlkOiBcInlcIiB9KSwgaGFuZGxlcjogKCkgPT4ge3NldCh2aWV3b2Ygc3Rhcl9pbiwgc3RhcmZpZWxkLnN0YXIoeyBzdGFyX2luIH0pKX19LHtuYW1lOiBcInN0YXJcIiwgdmFsdWU6c3RhcmZpZWxkLnN0YXIoeyBzdGFyX2luIH0pfSx7bmFtZTogXCJyYW5kb21cIiwgdmFsdWU6c3RhcmZpZWxkLnJhbmRvbSh7IHJhbmRvbV9zZWVkX2luLCBzdGFyX2luOnN0YXJmaWVsZC5zdGFyKHsgc3Rhcl9pbiB9KSwgaWQ6IFwielwiIH0pLCBoYW5kbGVyOiAoKSA9PiB7c2V0KHZpZXdvZiBzdGFyX2luLCBzdGFyZmllbGQuc3Rhcih7IHN0YXJfaW4gfSkpfX0se25hbWU6IFwic3RhclwiLCB2YWx1ZTpzdGFyZmllbGQuc3Rhcih7IHN0YXJfaW4gfSl9LHtuYW1lOiBcImZyYW1lXCIsIHZhbHVlOnN0YXJmaWVsZC5mcmFtZSh7IGZyYW1lX2luIH0pfSx7bmFtZTogXCJ6MFwiLCB2YWx1ZTpzdGFyZmllbGQuejAoeyByYW5kb21fc2VlZF9pbiwgc3Rhcl9pbiB9KX0se25hbWU6IFwielwiLCB2YWx1ZTpzdGFyZmllbGQueih7IHJhbmRvbV9zZWVkX2luLCBzdGFyX2luLCBzcGVlZF9pbiwgZnJhbWVfaW46c3RhcmZpZWxkLmZyYW1lKHsgZnJhbWVfaW4gfSkgLSAxIH0pLCBoYW5kbGVyOiAoKSA9PiB7c2V0KHZpZXdvZiBmcmFtZV9pbiwgc3RhcmZpZWxkLmZyYW1lKHsgZnJhbWVfaW4gfSkgLSAxKX19LHtuYW1lOiBcImZyYW1lXCIsIHZhbHVlOnN0YXJmaWVsZC5mcmFtZSh7IGZyYW1lX2luIH0pfSx7bmFtZTogXCJzcGVlZFwiLCB2YWx1ZTpzdGFyZmllbGQuc3BlZWQoeyBzcGVlZF9pbiB9KX0se25hbWU6IFwielwiLCB2YWx1ZTpzdGFyZmllbGQueih7IHJhbmRvbV9zZWVkX2luLCBzdGFyX2luLCBzcGVlZF9pbiwgZnJhbWVfaW46c3RhcmZpZWxkLmZyYW1lKHsgZnJhbWVfaW4gfSkgLSAxIH0pLCBoYW5kbGVyOiAoKSA9PiB7c2V0KHZpZXdvZiBmcmFtZV9pbiwgc3RhcmZpZWxkLmZyYW1lKHsgZnJhbWVfaW4gfSkgLSAxKX19LHtuYW1lOiBcImZyYW1lXCIsIHZhbHVlOnN0YXJmaWVsZC5mcmFtZSh7IGZyYW1lX2luIH0pfSx7bmFtZTogXCJzcGVlZFwiLCB2YWx1ZTpzdGFyZmllbGQuc3BlZWQoeyBzcGVlZF9pbiB9KX0se25hbWU6IFwielwiLCB2YWx1ZTpzdGFyZmllbGQueih7IGZyYW1lX2luLCByYW5kb21fc2VlZF9pbiwgc3Rhcl9pbiwgc3BlZWRfaW4gfSl9LHtuYW1lOiBcImZyYW1lXCIsIHZhbHVlOnN0YXJmaWVsZC5mcmFtZSh7IGZyYW1lX2luIH0pfSx7bmFtZTogXCJ4MFwiLCB2YWx1ZTpzdGFyZmllbGQueDAoeyByYW5kb21fc2VlZF9pbiwgc3Rhcl9pbiB9KX0se25hbWU6IFwidmlzaWJsZVwiLCB2YWx1ZTpzdGFyZmllbGQudmlzaWJsZSh7IHJhbmRvbV9zZWVkX2luLCBzdGFyX2luLCBzcGVlZF9pbiwgZnJhbWVfaW46c3RhcmZpZWxkLmZyYW1lKHsgZnJhbWVfaW4gfSkgLSAxIH0pLCBoYW5kbGVyOiAoKSA9PiB7c2V0KHZpZXdvZiBmcmFtZV9pbiwgc3RhcmZpZWxkLmZyYW1lKHsgZnJhbWVfaW4gfSkgLSAxKX19LHtuYW1lOiBcImZyYW1lXCIsIHZhbHVlOnN0YXJmaWVsZC5mcmFtZSh7IGZyYW1lX2luIH0pfSx7bmFtZTogXCJ4MFwiLCB2YWx1ZTpzdGFyZmllbGQueDAoeyByYW5kb21fc2VlZF9pbiwgc3Rhcl9pbiB9KX0se25hbWU6IFwieDBcIiwgdmFsdWU6c3RhcmZpZWxkLngwKHsgcmFuZG9tX3NlZWRfaW4sIHN0YXJfaW4gfSl9LHtuYW1lOiBcInpcIiwgdmFsdWU6c3RhcmZpZWxkLnooeyBmcmFtZV9pbiwgcmFuZG9tX3NlZWRfaW4sIHN0YXJfaW4sIHNwZWVkX2luIH0pfSx7bmFtZTogXCJmcmFtZVwiLCB2YWx1ZTpzdGFyZmllbGQuZnJhbWUoeyBmcmFtZV9pbiB9KX0se25hbWU6IFwieTBcIiwgdmFsdWU6c3RhcmZpZWxkLnkwKHsgcmFuZG9tX3NlZWRfaW4sIHN0YXJfaW4gfSl9LHtuYW1lOiBcInZpc2libGVcIiwgdmFsdWU6c3RhcmZpZWxkLnZpc2libGUoeyByYW5kb21fc2VlZF9pbiwgc3Rhcl9pbiwgc3BlZWRfaW4sIGZyYW1lX2luOnN0YXJmaWVsZC5mcmFtZSh7IGZyYW1lX2luIH0pIC0gMSB9KSwgaGFuZGxlcjogKCkgPT4ge3NldCh2aWV3b2YgZnJhbWVfaW4sIHN0YXJmaWVsZC5mcmFtZSh7IGZyYW1lX2luIH0pIC0gMSl9fSx7bmFtZTogXCJmcmFtZVwiLCB2YWx1ZTpzdGFyZmllbGQuZnJhbWUoeyBmcmFtZV9pbiB9KX0se25hbWU6IFwieTBcIiwgdmFsdWU6c3RhcmZpZWxkLnkwKHsgcmFuZG9tX3NlZWRfaW4sIHN0YXJfaW4gfSl9LHtuYW1lOiBcInkwXCIsIHZhbHVlOnN0YXJmaWVsZC55MCh7IHJhbmRvbV9zZWVkX2luLCBzdGFyX2luIH0pfSx7bmFtZTogXCJ6XCIsIHZhbHVlOnN0YXJmaWVsZC56KHsgZnJhbWVfaW4sIHJhbmRvbV9zZWVkX2luLCBzdGFyX2luLCBzcGVlZF9pbiB9KX0se25hbWU6IFwieFwiLCB2YWx1ZTpzdGFyZmllbGQueCh7IGZyYW1lX2luLCByYW5kb21fc2VlZF9pbiwgc3Rhcl9pbiwgc3BlZWRfaW4gfSl9LHtuYW1lOiBcIngwXCIsIHZhbHVlOnN0YXJmaWVsZC54MCh7IHJhbmRvbV9zZWVkX2luLCBzdGFyX2luIH0pfSx7bmFtZTogXCJ4MFwiLCB2YWx1ZTpzdGFyZmllbGQueDAoeyByYW5kb21fc2VlZF9pbiwgc3Rhcl9pbiB9KX0se25hbWU6IFwieFwiLCB2YWx1ZTpzdGFyZmllbGQueCh7IHJhbmRvbV9zZWVkX2luLCBzdGFyX2luLCBzcGVlZF9pbiwgZnJhbWVfaW46c3RhcmZpZWxkLmZyYW1lKHsgZnJhbWVfaW4gfSkgLSAxIH0pLCBoYW5kbGVyOiAoKSA9PiB7c2V0KHZpZXdvZiBmcmFtZV9pbiwgc3RhcmZpZWxkLmZyYW1lKHsgZnJhbWVfaW4gfSkgLSAxKX19LHtuYW1lOiBcImZyYW1lXCIsIHZhbHVlOnN0YXJmaWVsZC5mcmFtZSh7IGZyYW1lX2luIH0pfSx7bmFtZTogXCJ5XCIsIHZhbHVlOnN0YXJmaWVsZC55KHsgZnJhbWVfaW4sIHJhbmRvbV9zZWVkX2luLCBzdGFyX2luLCBzcGVlZF9pbiB9KX0se25hbWU6IFwieTBcIiwgdmFsdWU6c3RhcmZpZWxkLnkwKHsgcmFuZG9tX3NlZWRfaW4sIHN0YXJfaW4gfSl9LHtuYW1lOiBcInkwXCIsIHZhbHVlOnN0YXJmaWVsZC55MCh7IHJhbmRvbV9zZWVkX2luLCBzdGFyX2luIH0pfSx7bmFtZTogXCJ5XCIsIHZhbHVlOnN0YXJmaWVsZC55KHsgcmFuZG9tX3NlZWRfaW4sIHN0YXJfaW4sIHNwZWVkX2luLCBmcmFtZV9pbjpzdGFyZmllbGQuZnJhbWUoeyBmcmFtZV9pbiB9KSAtIDEgfSksIGhhbmRsZXI6ICgpID0+IHtzZXQodmlld29mIGZyYW1lX2luLCBzdGFyZmllbGQuZnJhbWUoeyBmcmFtZV9pbiB9KSAtIDEpfX0se25hbWU6IFwiZnJhbWVcIiwgdmFsdWU6c3RhcmZpZWxkLmZyYW1lKHsgZnJhbWVfaW4gfSl9XV0sXCJmaXp6YnV6elwiOltbe25hbWU6IFwiaVwiLCB2YWx1ZTpmaXp6YnV6ei5pKHsgaV9pbiB9KX0se25hbWU6IFwiaVwiLCB2YWx1ZTpmaXp6YnV6ei5pKHsgaV9pbiB9KX0se25hbWU6IFwiZml6elwiLCB2YWx1ZTpmaXp6YnV6ei5maXp6KHsgaV9pbiB9KX0se25hbWU6IFwiYnV6elwiLCB2YWx1ZTpmaXp6YnV6ei5idXp6KHsgaV9pbiB9KX0se25hbWU6IFwiZml6elwiLCB2YWx1ZTpmaXp6YnV6ei5maXp6KHsgaV9pbiB9KX0se25hbWU6IFwiYnV6elwiLCB2YWx1ZTpmaXp6YnV6ei5idXp6KHsgaV9pbiB9KX0se25hbWU6IFwiaVwiLCB2YWx1ZTpmaXp6YnV6ei5pKHsgaV9pbiB9KX1dXSxcInllYXJfcmVtYWluaW5nXCI6W1t7bmFtZTogXCJkYXRlXCIsIHZhbHVlOnllYXJfcmVtYWluaW5nLmRhdGUoeyBkYXRlX2luIH0pfSx7bmFtZTogXCJ5ZWFyXCIsIHZhbHVlOnllYXJfcmVtYWluaW5nLnllYXIoeyBkYXRlX2luIH0pfSx7bmFtZTogXCJpc0xlYXBcIiwgdmFsdWU6eWVhcl9yZW1haW5pbmcuaXNMZWFwKHsgZGF0ZV9pbiB9KX0se25hbWU6IFwiZGF0ZVwiLCB2YWx1ZTp5ZWFyX3JlbWFpbmluZy5kYXRlKHsgZGF0ZV9pbiB9KX0se25hbWU6IFwiZGF0ZVwiLCB2YWx1ZTp5ZWFyX3JlbWFpbmluZy5kYXRlKHsgZGF0ZV9pbiB9KX0se25hbWU6IFwiZGF0ZVwiLCB2YWx1ZTp5ZWFyX3JlbWFpbmluZy5kYXRlKHsgZGF0ZV9pbiB9KX0se25hbWU6IFwiZGF0ZVwiLCB2YWx1ZTp5ZWFyX3JlbWFpbmluZy5kYXRlKHsgZGF0ZV9pbiB9KX0se25hbWU6IFwiZGF5c0ludG9ZZWFyU3RhcnRUb21vcnJvd1wiLCB2YWx1ZTp5ZWFyX3JlbWFpbmluZy5kYXlzSW50b1llYXJTdGFydFRvbW9ycm93KHsgZGF0ZV9pbiB9KX0se25hbWU6IFwidGltaW5nXCIsIHZhbHVlOnllYXJfcmVtYWluaW5nLnRpbWluZyh7IHRpbWluZ19pbiB9KX0se25hbWU6IFwiZGF5c0ludG9ZZWFyU3RhcnRUb2RheVwiLCB2YWx1ZTp5ZWFyX3JlbWFpbmluZy5kYXlzSW50b1llYXJTdGFydFRvZGF5KHsgZGF0ZV9pbiB9KX0se25hbWU6IFwiZGF5c0ludG9ZZWFyU3RhcnRUb21vcnJvd1wiLCB2YWx1ZTp5ZWFyX3JlbWFpbmluZy5kYXlzSW50b1llYXJTdGFydFRvbW9ycm93KHsgZGF0ZV9pbiB9KX0se25hbWU6IFwiZGF5c0ludG9ZZWFyXCIsIHZhbHVlOnllYXJfcmVtYWluaW5nLmRheXNJbnRvWWVhcih7IHRpbWluZ19pbiwgZGF0ZV9pbiB9KX0se25hbWU6IFwiZGF5c0luWWVhclwiLCB2YWx1ZTp5ZWFyX3JlbWFpbmluZy5kYXlzSW5ZZWFyKHsgZGF0ZV9pbiB9KX0se25hbWU6IFwiZnJhY3Rpb25JbnRvWWVhclwiLCB2YWx1ZTp5ZWFyX3JlbWFpbmluZy5mcmFjdGlvbkludG9ZZWFyKHsgdGltaW5nX2luLCBkYXRlX2luIH0pfV1dLFwic2ltcGxlX2xvYW5cIjpbW3tuYW1lOiBcImludGVyZXN0X3JhdGVcIiwgdmFsdWU6c2ltcGxlX2xvYW4uaW50ZXJlc3RfcmF0ZSh7IHllYXJfaW4sIGRfaV95ZWFyX2luLCBpX2luLCBkX2lfaW4gfSl9LHtuYW1lOiBcInZcIiwgdmFsdWU6c2ltcGxlX2xvYW4udih7IHllYXJfaW4sIGRfaV95ZWFyX2luLCBpX2luLCBkX2lfaW4gfSl9LHtuYW1lOiBcInRlcm1cIiwgdmFsdWU6c2ltcGxlX2xvYW4udGVybSh7IHRlcm1faW4gfSl9LHtuYW1lOiBcInllYXJcIiwgdmFsdWU6c2ltcGxlX2xvYW4ueWVhcih7IHllYXJfaW4gfSl9LHtuYW1lOiBcImJhbGFuY2VcIiwgdmFsdWU6c2ltcGxlX2xvYW4uYmFsYW5jZSh7IHByaW5jaXBhbF9pbiwgZF9pX3llYXJfaW4sIGlfaW4sIGRfaV9pbiwgbWlzc2VkX3JlcGF5bWVudF95ZWFyX2luLCBza2lwX2ludGVyZXN0X2luLCB0ZXJtX2luLCB5ZWFyX2luOnNpbXBsZV9sb2FuLnllYXIoeyB5ZWFyX2luIH0pIC0gMSB9KSwgaGFuZGxlcjogKCkgPT4ge3NldCh2aWV3b2YgeWVhcl9pbiwgc2ltcGxlX2xvYW4ueWVhcih7IHllYXJfaW4gfSkgLSAxKX19LHtuYW1lOiBcInllYXJcIiwgdmFsdWU6c2ltcGxlX2xvYW4ueWVhcih7IHllYXJfaW4gfSl9LHtuYW1lOiBcImludGVyZXN0X3JhdGVcIiwgdmFsdWU6c2ltcGxlX2xvYW4uaW50ZXJlc3RfcmF0ZSh7IHllYXJfaW4sIGRfaV95ZWFyX2luLCBpX2luLCBkX2lfaW4gfSl9LHtuYW1lOiBcImJhbGFuY2VcIiwgdmFsdWU6c2ltcGxlX2xvYW4uYmFsYW5jZSh7IHByaW5jaXBhbF9pbiwgZF9pX3llYXJfaW4sIGlfaW4sIGRfaV9pbiwgbWlzc2VkX3JlcGF5bWVudF95ZWFyX2luLCBza2lwX2ludGVyZXN0X2luLCB0ZXJtX2luLCB5ZWFyX2luOnNpbXBsZV9sb2FuLnllYXIoeyB5ZWFyX2luIH0pIC0gMSB9KSwgaGFuZGxlcjogKCkgPT4ge3NldCh2aWV3b2YgeWVhcl9pbiwgc2ltcGxlX2xvYW4ueWVhcih7IHllYXJfaW4gfSkgLSAxKX19LHtuYW1lOiBcInllYXJcIiwgdmFsdWU6c2ltcGxlX2xvYW4ueWVhcih7IHllYXJfaW4gfSl9LHtuYW1lOiBcInRlcm1cIiwgdmFsdWU6c2ltcGxlX2xvYW4udGVybSh7IHRlcm1faW4gfSl9LHtuYW1lOiBcInllYXJcIiwgdmFsdWU6c2ltcGxlX2xvYW4ueWVhcih7IHllYXJfaW4gfSl9LHtuYW1lOiBcImJhbGFuY2VcIiwgdmFsdWU6c2ltcGxlX2xvYW4uYmFsYW5jZSh7IHByaW5jaXBhbF9pbiwgZF9pX3llYXJfaW4sIGlfaW4sIGRfaV9pbiwgbWlzc2VkX3JlcGF5bWVudF95ZWFyX2luLCBza2lwX2ludGVyZXN0X2luLCB0ZXJtX2luLCB5ZWFyX2luOnNpbXBsZV9sb2FuLnllYXIoeyB5ZWFyX2luIH0pIC0gMSB9KSwgaGFuZGxlcjogKCkgPT4ge3NldCh2aWV3b2YgeWVhcl9pbiwgc2ltcGxlX2xvYW4ueWVhcih7IHllYXJfaW4gfSkgLSAxKX19LHtuYW1lOiBcInllYXJcIiwgdmFsdWU6c2ltcGxlX2xvYW4ueWVhcih7IHllYXJfaW4gfSl9LHtuYW1lOiBcImludGVyZXN0X3JhdGVcIiwgdmFsdWU6c2ltcGxlX2xvYW4uaW50ZXJlc3RfcmF0ZSh7IHllYXJfaW4sIGRfaV95ZWFyX2luLCBpX2luLCBkX2lfaW4gfSl9LHtuYW1lOiBcInZfcG93X3Rlcm1fbGVmdFwiLCB2YWx1ZTpzaW1wbGVfbG9hbi52X3Bvd190ZXJtX2xlZnQoeyB5ZWFyX2luLCBkX2lfeWVhcl9pbiwgaV9pbiwgZF9pX2luLCB0ZXJtX2luIH0pfSx7bmFtZTogXCJiYWxhbmNlXCIsIHZhbHVlOnNpbXBsZV9sb2FuLmJhbGFuY2UoeyBwcmluY2lwYWxfaW4sIGRfaV95ZWFyX2luLCBpX2luLCBkX2lfaW4sIG1pc3NlZF9yZXBheW1lbnRfeWVhcl9pbiwgc2tpcF9pbnRlcmVzdF9pbiwgdGVybV9pbiwgeWVhcl9pbjpzaW1wbGVfbG9hbi55ZWFyKHsgeWVhcl9pbiB9KSAtIDEgfSksIGhhbmRsZXI6ICgpID0+IHtzZXQodmlld29mIHllYXJfaW4sIHNpbXBsZV9sb2FuLnllYXIoeyB5ZWFyX2luIH0pIC0gMSl9fSx7bmFtZTogXCJ5ZWFyXCIsIHZhbHVlOnNpbXBsZV9sb2FuLnllYXIoeyB5ZWFyX2luIH0pfSx7bmFtZTogXCJpbnRlcmVzdF9yYXRlXCIsIHZhbHVlOnNpbXBsZV9sb2FuLmludGVyZXN0X3JhdGUoeyB5ZWFyX2luLCBkX2lfeWVhcl9pbiwgaV9pbiwgZF9pX2luIH0pfSx7bmFtZTogXCJyZXBheW1lbnRcIiwgdmFsdWU6c2ltcGxlX2xvYW4ucmVwYXltZW50KHsgeWVhcl9pbiwgbWlzc2VkX3JlcGF5bWVudF95ZWFyX2luLCBza2lwX2ludGVyZXN0X2luLCBwcmluY2lwYWxfaW4sIGRfaV95ZWFyX2luLCBpX2luLCBkX2lfaW4sIHRlcm1faW4gfSl9LHtuYW1lOiBcImludGVyZXN0X3JlcGF5bWVudFwiLCB2YWx1ZTpzaW1wbGVfbG9hbi5pbnRlcmVzdF9yZXBheW1lbnQoeyB5ZWFyX2luLCBtaXNzZWRfcmVwYXltZW50X3llYXJfaW4sIHNraXBfaW50ZXJlc3RfaW4sIHByaW5jaXBhbF9pbiwgZF9pX3llYXJfaW4sIGlfaW4sIGRfaV9pbiwgdGVybV9pbiB9KX0se25hbWU6IFwicmVwYXltZW50XCIsIHZhbHVlOnNpbXBsZV9sb2FuLnJlcGF5bWVudCh7IHllYXJfaW4sIG1pc3NlZF9yZXBheW1lbnRfeWVhcl9pbiwgc2tpcF9pbnRlcmVzdF9pbiwgcHJpbmNpcGFsX2luLCBkX2lfeWVhcl9pbiwgaV9pbiwgZF9pX2luLCB0ZXJtX2luIH0pfSx7bmFtZTogXCJpbnRlcmVzdFwiLCB2YWx1ZTpzaW1wbGVfbG9hbi5pbnRlcmVzdCh7IHllYXJfaW4sIHByaW5jaXBhbF9pbiwgbWlzc2VkX3JlcGF5bWVudF95ZWFyX2luLCBza2lwX2ludGVyZXN0X2luLCB0ZXJtX2luLCBkX2lfeWVhcl9pbiwgaV9pbiwgZF9pX2luIH0pfSx7bmFtZTogXCJ5ZWFyXCIsIHZhbHVlOnNpbXBsZV9sb2FuLnllYXIoeyB5ZWFyX2luIH0pfSx7bmFtZTogXCJ0ZXJtXCIsIHZhbHVlOnNpbXBsZV9sb2FuLnRlcm0oeyB0ZXJtX2luIH0pfSx7bmFtZTogXCJ5ZWFyXCIsIHZhbHVlOnNpbXBsZV9sb2FuLnllYXIoeyB5ZWFyX2luIH0pfSx7bmFtZTogXCJ5ZWFyXCIsIHZhbHVlOnNpbXBsZV9sb2FuLnllYXIoeyB5ZWFyX2luIH0pfSx7bmFtZTogXCJtaXNzZWRfcmVwYXltZW50X3llYXJcIiwgdmFsdWU6c2ltcGxlX2xvYW4ubWlzc2VkX3JlcGF5bWVudF95ZWFyKHsgbWlzc2VkX3JlcGF5bWVudF95ZWFyX2luIH0pfSx7bmFtZTogXCJza2lwX2ludGVyZXN0XCIsIHZhbHVlOnNpbXBsZV9sb2FuLnNraXBfaW50ZXJlc3QoeyBza2lwX2ludGVyZXN0X2luIH0pfSx7bmFtZTogXCJpbnRlcmVzdFwiLCB2YWx1ZTpzaW1wbGVfbG9hbi5pbnRlcmVzdCh7IHllYXJfaW4sIHByaW5jaXBhbF9pbiwgbWlzc2VkX3JlcGF5bWVudF95ZWFyX2luLCBza2lwX2ludGVyZXN0X2luLCB0ZXJtX2luLCBkX2lfeWVhcl9pbiwgaV9pbiwgZF9pX2luIH0pfSx7bmFtZTogXCJyZXBheW1lbnRfZHVlXCIsIHZhbHVlOnNpbXBsZV9sb2FuLnJlcGF5bWVudF9kdWUoeyB5ZWFyX2luLCB0ZXJtX2luIH0pfSx7bmFtZTogXCJyZXBheW1lbnRfYW1vdW50XCIsIHZhbHVlOnNpbXBsZV9sb2FuLnJlcGF5bWVudF9hbW91bnQoeyB5ZWFyX2luLCBwcmluY2lwYWxfaW4sIGRfaV95ZWFyX2luLCBpX2luLCBkX2lfaW4sIG1pc3NlZF9yZXBheW1lbnRfeWVhcl9pbiwgc2tpcF9pbnRlcmVzdF9pbiwgdGVybV9pbiB9KX0se25hbWU6IFwieWVhclwiLCB2YWx1ZTpzaW1wbGVfbG9hbi55ZWFyKHsgeWVhcl9pbiB9KX0se25hbWU6IFwieWVhclwiLCB2YWx1ZTpzaW1wbGVfbG9hbi55ZWFyKHsgeWVhcl9pbiB9KX0se25hbWU6IFwicHJpbmNpcGFsXCIsIHZhbHVlOnNpbXBsZV9sb2FuLnByaW5jaXBhbCh7IHByaW5jaXBhbF9pbiB9KX0se25hbWU6IFwiYmFsYW5jZVwiLCB2YWx1ZTpzaW1wbGVfbG9hbi5iYWxhbmNlKHsgcHJpbmNpcGFsX2luLCBkX2lfeWVhcl9pbiwgaV9pbiwgZF9pX2luLCBtaXNzZWRfcmVwYXltZW50X3llYXJfaW4sIHNraXBfaW50ZXJlc3RfaW4sIHRlcm1faW4sIHllYXJfaW46c2ltcGxlX2xvYW4ueWVhcih7IHllYXJfaW4gfSkgLSAxIH0pLCBoYW5kbGVyOiAoKSA9PiB7c2V0KHZpZXdvZiB5ZWFyX2luLCBzaW1wbGVfbG9hbi55ZWFyKHsgeWVhcl9pbiB9KSAtIDEpfX0se25hbWU6IFwieWVhclwiLCB2YWx1ZTpzaW1wbGVfbG9hbi55ZWFyKHsgeWVhcl9pbiB9KX0se25hbWU6IFwiaW50ZXJlc3RcIiwgdmFsdWU6c2ltcGxlX2xvYW4uaW50ZXJlc3QoeyB5ZWFyX2luLCBwcmluY2lwYWxfaW4sIG1pc3NlZF9yZXBheW1lbnRfeWVhcl9pbiwgc2tpcF9pbnRlcmVzdF9pbiwgdGVybV9pbiwgZF9pX3llYXJfaW4sIGlfaW4sIGRfaV9pbiB9KX0se25hbWU6IFwicmVwYXltZW50XCIsIHZhbHVlOnNpbXBsZV9sb2FuLnJlcGF5bWVudCh7IHllYXJfaW4sIG1pc3NlZF9yZXBheW1lbnRfeWVhcl9pbiwgc2tpcF9pbnRlcmVzdF9pbiwgcHJpbmNpcGFsX2luLCBkX2lfeWVhcl9pbiwgaV9pbiwgZF9pX2luLCB0ZXJtX2luIH0pfSx7bmFtZTogXCJ5ZWFyXCIsIHZhbHVlOnNpbXBsZV9sb2FuLnllYXIoeyB5ZWFyX2luIH0pfSx7bmFtZTogXCJkX2lfeWVhclwiLCB2YWx1ZTpzaW1wbGVfbG9hbi5kX2lfeWVhcih7IGRfaV95ZWFyX2luIH0pfSx7bmFtZTogXCJpXCIsIHZhbHVlOnNpbXBsZV9sb2FuLmkoeyBpX2luIH0pfSx7bmFtZTogXCJkX2lcIiwgdmFsdWU6c2ltcGxlX2xvYW4uZF9pKHsgZF9pX2luIH0pfSx7bmFtZTogXCJpXCIsIHZhbHVlOml9XV19XG4pfVxuXG5cbmZuc193aXRoX21qc19xX2V2YWwgPXsgcmV0dXJuIChcbntcInJheWNhc3RpbmcyXCI6W1t7bmFtZTpcInRhbl9yYXlfYW5nbGVcIix2YWx1ZTpyYXljYXN0aW5nMi50YW5fcmF5X2FuZ2xlKHtyYXlfYW5nbGVfaW59KX0se25hbWU6XCJpbnZlcnNlX3Rhbl9yYXlfYW5nbGVcIix2YWx1ZTpyYXljYXN0aW5nMi5pbnZlcnNlX3Rhbl9yYXlfYW5nbGUoe3JheV9hbmdsZV9pbn0pfSx7bmFtZTpcInJheV9sb29raW5nX3VwXCIsdmFsdWU6cmF5Y2FzdGluZzIucmF5X2xvb2tpbmdfdXAoe3JheV9hbmdsZV9pbn0pfSx7bmFtZTpcInJheV9sb29raW5nX3JpZ2h0XCIsdmFsdWU6cmF5Y2FzdGluZzIucmF5X2xvb2tpbmdfcmlnaHQoe3JheV9hbmdsZV9pbn0pfSx7bmFtZTpcIm1hcFwiLHZhbHVlOnJheWNhc3RpbmcyLm1hcCh7fSl9LHtuYW1lOlwibWFwX2xvb2t1cFwiLHZhbHVlOnJheWNhc3RpbmcyLm1hcF9sb29rdXAoe3lfaW4seF9pbn0pfSx7bmFtZTpcInJoeFwiLHZhbHVlOnJheWNhc3RpbmcyLnJoeCh7c3RlcF9pbixmX2luLGtleXNfc3RyZWFtX3ZlcnNpb25faW4sa2V5c19zdHJlYW1fZnVuY3Rpb25faW4scmF5X2FuZ2xlX2lufSl9LHtuYW1lOlwicmh5XCIsdmFsdWU6cmF5Y2FzdGluZzIucmh5KHtyYXlfYW5nbGVfaW4sc3RlcF9pbixmX2luLGtleXNfc3RyZWFtX3ZlcnNpb25faW4sa2V5c19zdHJlYW1fZnVuY3Rpb25faW59KX0se25hbWU6XCJyaHZcIix2YWx1ZTpyYXljYXN0aW5nMi5yaHYoe3N0ZXBfaW4sZl9pbixrZXlzX3N0cmVhbV92ZXJzaW9uX2luLGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luLHJheV9hbmdsZV9pbn0pfSx7bmFtZTpcInJoX2hpdF9vYmplY3RcIix2YWx1ZTpyYXljYXN0aW5nMi5yaF9oaXRfb2JqZWN0KHtmX2luLGtleXNfc3RyZWFtX3ZlcnNpb25faW4sa2V5c19zdHJlYW1fZnVuY3Rpb25faW4scmF5X2FuZ2xlX2lufSl9LHtuYW1lOlwicmhfaGl0X3hcIix2YWx1ZTpyYXljYXN0aW5nMi5yaF9oaXRfeCh7Zl9pbixrZXlzX3N0cmVhbV92ZXJzaW9uX2luLGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luLHJheV9hbmdsZV9pbn0pfSx7bmFtZTpcInJoX2hpdF95XCIsdmFsdWU6cmF5Y2FzdGluZzIucmhfaGl0X3koe2ZfaW4sa2V5c19zdHJlYW1fdmVyc2lvbl9pbixrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbixyYXlfYW5nbGVfaW59KX0se25hbWU6XCJyaF9oaXRfdlwiLHZhbHVlOnJheWNhc3RpbmcyLnJoX2hpdF92KHtmX2luLGtleXNfc3RyZWFtX3ZlcnNpb25faW4sa2V5c19zdHJlYW1fZnVuY3Rpb25faW4scmF5X2FuZ2xlX2lufSl9LHtuYW1lOlwicmhfaGl0X3N0ZXBcIix2YWx1ZTpyYXljYXN0aW5nMi5yaF9oaXRfc3RlcCh7Zl9pbixrZXlzX3N0cmVhbV92ZXJzaW9uX2luLGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luLHJheV9hbmdsZV9pbn0pfSx7bmFtZTpcInJoX2hpdF9kaXN0YW5jZVwiLHZhbHVlOnJheWNhc3RpbmcyLnJoX2hpdF9kaXN0YW5jZSh7eV9pbix4X2luLGZfaW4sa2V5c19zdHJlYW1fdmVyc2lvbl9pbixrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbixyYXlfYW5nbGVfaW59KX0se25hbWU6XCJydnhcIix2YWx1ZTpyYXljYXN0aW5nMi5ydngoe3JheV9hbmdsZV9pbixzdGVwX2luLGZfaW4sa2V5c19zdHJlYW1fdmVyc2lvbl9pbixrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbn0pfSx7bmFtZTpcInJ2eVwiLHZhbHVlOnJheWNhc3RpbmcyLnJ2eSh7c3RlcF9pbixmX2luLGtleXNfc3RyZWFtX3ZlcnNpb25faW4sa2V5c19zdHJlYW1fZnVuY3Rpb25faW4scmF5X2FuZ2xlX2lufSl9LHtuYW1lOlwicnZ2XCIsdmFsdWU6cmF5Y2FzdGluZzIucnZ2KHtyYXlfYW5nbGVfaW4sc3RlcF9pbixmX2luLGtleXNfc3RyZWFtX3ZlcnNpb25faW4sa2V5c19zdHJlYW1fZnVuY3Rpb25faW59KX0se25hbWU6XCJydl9oaXRfb2JqZWN0XCIsdmFsdWU6cmF5Y2FzdGluZzIucnZfaGl0X29iamVjdCh7cmF5X2FuZ2xlX2luLGZfaW4sa2V5c19zdHJlYW1fdmVyc2lvbl9pbixrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbn0pfSx7bmFtZTpcInJ2X2hpdF94XCIsdmFsdWU6cmF5Y2FzdGluZzIucnZfaGl0X3goe3JheV9hbmdsZV9pbixmX2luLGtleXNfc3RyZWFtX3ZlcnNpb25faW4sa2V5c19zdHJlYW1fZnVuY3Rpb25faW59KX0se25hbWU6XCJydl9oaXRfeVwiLHZhbHVlOnJheWNhc3RpbmcyLnJ2X2hpdF95KHtyYXlfYW5nbGVfaW4sZl9pbixrZXlzX3N0cmVhbV92ZXJzaW9uX2luLGtleXNfc3RyZWFtX2Z1bmN0aW9uX2lufSl9LHtuYW1lOlwicnZfaGl0X3ZcIix2YWx1ZTpyYXljYXN0aW5nMi5ydl9oaXRfdih7cmF5X2FuZ2xlX2luLGZfaW4sa2V5c19zdHJlYW1fdmVyc2lvbl9pbixrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbn0pfSx7bmFtZTpcInJ2X2hpdF9zdGVwXCIsdmFsdWU6cmF5Y2FzdGluZzIucnZfaGl0X3N0ZXAoe3JheV9hbmdsZV9pbixmX2luLGtleXNfc3RyZWFtX3ZlcnNpb25faW4sa2V5c19zdHJlYW1fZnVuY3Rpb25faW59KX0se25hbWU6XCJydl9oaXRfZGlzdGFuY2VcIix2YWx1ZTpyYXljYXN0aW5nMi5ydl9oaXRfZGlzdGFuY2Uoe3lfaW4seF9pbixyYXlfYW5nbGVfaW4sZl9pbixrZXlzX3N0cmVhbV92ZXJzaW9uX2luLGtleXNfc3RyZWFtX2Z1bmN0aW9uX2lufSl9LHtuYW1lOlwicl9oaXRfaF9vcl92XCIsdmFsdWU6cmF5Y2FzdGluZzIucl9oaXRfaF9vcl92KHt5X2luLHhfaW4scmF5X2FuZ2xlX2luLGZfaW4sa2V5c19zdHJlYW1fdmVyc2lvbl9pbixrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbn0pfSx7bmFtZTpcInJfaGl0X29iamVjdFwiLHZhbHVlOnJheWNhc3RpbmcyLnJfaGl0X29iamVjdCh7eV9pbix4X2luLHJheV9hbmdsZV9pbixmX2luLGtleXNfc3RyZWFtX3ZlcnNpb25faW4sa2V5c19zdHJlYW1fZnVuY3Rpb25faW59KX0se25hbWU6XCJyX2hpdF94XCIsdmFsdWU6cmF5Y2FzdGluZzIucl9oaXRfeCh7eV9pbix4X2luLHJheV9hbmdsZV9pbixmX2luLGtleXNfc3RyZWFtX3ZlcnNpb25faW4sa2V5c19zdHJlYW1fZnVuY3Rpb25faW59KX0se25hbWU6XCJyX2hpdF95XCIsdmFsdWU6cmF5Y2FzdGluZzIucl9oaXRfeSh7eV9pbix4X2luLHJheV9hbmdsZV9pbixmX2luLGtleXNfc3RyZWFtX3ZlcnNpb25faW4sa2V5c19zdHJlYW1fZnVuY3Rpb25faW59KX0se25hbWU6XCJyX2hpdF92XCIsdmFsdWU6cmF5Y2FzdGluZzIucl9oaXRfdih7eV9pbix4X2luLHJheV9hbmdsZV9pbixmX2luLGtleXNfc3RyZWFtX3ZlcnNpb25faW4sa2V5c19zdHJlYW1fZnVuY3Rpb25faW59KX0se25hbWU6XCJyX2hpdF9zdGVwXCIsdmFsdWU6cmF5Y2FzdGluZzIucl9oaXRfc3RlcCh7eV9pbix4X2luLHJheV9hbmdsZV9pbixmX2luLGtleXNfc3RyZWFtX3ZlcnNpb25faW4sa2V5c19zdHJlYW1fZnVuY3Rpb25faW59KX0se25hbWU6XCJmaXNoZXllX2NvcnJlY3Rpb25cIix2YWx1ZTpyYXljYXN0aW5nMi5maXNoZXllX2NvcnJlY3Rpb24oe2Zpc2hleWVfY29ycmVjdGlvbl9pbn0pfSx7bmFtZTpcInJheV9kaXN0YW5jZVwiLHZhbHVlOnJheWNhc3RpbmcyLnJheV9kaXN0YW5jZSh7eV9pbix4X2luLHJheV9hbmdsZV9pbixmX2luLGtleXNfc3RyZWFtX3ZlcnNpb25faW4sa2V5c19zdHJlYW1fZnVuY3Rpb25faW4sZmlzaGV5ZV9jb3JyZWN0aW9uX2lufSl9LHtuYW1lOlwicmF5X2ludmVyc2VfZGlzdGFuY2VcIix2YWx1ZTpyYXljYXN0aW5nMi5yYXlfaW52ZXJzZV9kaXN0YW5jZSh7eV9pbix4X2luLHJheV9hbmdsZV9pbixmX2luLGtleXNfc3RyZWFtX3ZlcnNpb25faW4sa2V5c19zdHJlYW1fZnVuY3Rpb25faW4sZmlzaGV5ZV9jb3JyZWN0aW9uX2lufSl9LHtuYW1lOlwia2V5c19zdHJlYW1fZnVuY3Rpb25cIix2YWx1ZTpyYXljYXN0aW5nMi5rZXlzX3N0cmVhbV9mdW5jdGlvbih7a2V5c19zdHJlYW1fZnVuY3Rpb25faW59KX0se25hbWU6XCJrZXlzX3N0cmVhbV92ZXJzaW9uXCIsdmFsdWU6cmF5Y2FzdGluZzIua2V5c19zdHJlYW1fdmVyc2lvbih7a2V5c19zdHJlYW1fdmVyc2lvbl9pbn0pfSx7bmFtZTpcImtleXNcIix2YWx1ZTpyYXljYXN0aW5nMi5rZXlzKHtrZXlzX3N0cmVhbV92ZXJzaW9uX2luLGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luLGZfaW59KX0se25hbWU6XCJrZXlfdXBcIix2YWx1ZTpyYXljYXN0aW5nMi5rZXlfdXAoe2tleXNfc3RyZWFtX3ZlcnNpb25faW4sa2V5c19zdHJlYW1fZnVuY3Rpb25faW4sZl9pbn0pfSx7bmFtZTpcImtleV9kb3duXCIsdmFsdWU6cmF5Y2FzdGluZzIua2V5X2Rvd24oe2tleXNfc3RyZWFtX3ZlcnNpb25faW4sa2V5c19zdHJlYW1fZnVuY3Rpb25faW4sZl9pbn0pfSx7bmFtZTpcImtleV9sZWZ0XCIsdmFsdWU6cmF5Y2FzdGluZzIua2V5X2xlZnQoe2tleXNfc3RyZWFtX3ZlcnNpb25faW4sa2V5c19zdHJlYW1fZnVuY3Rpb25faW4sZl9pbn0pfSx7bmFtZTpcImtleV9yaWdodFwiLHZhbHVlOnJheWNhc3RpbmcyLmtleV9yaWdodCh7a2V5c19zdHJlYW1fdmVyc2lvbl9pbixrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbixmX2lufSl9LHtuYW1lOlwiZm9yd2FyZG5lc3NcIix2YWx1ZTpyYXljYXN0aW5nMi5mb3J3YXJkbmVzcyh7a2V5c19zdHJlYW1fdmVyc2lvbl9pbixrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbixmX2lufSl9LHtuYW1lOlwibGVmdG5lc3NcIix2YWx1ZTpyYXljYXN0aW5nMi5sZWZ0bmVzcyh7a2V5c19zdHJlYW1fdmVyc2lvbl9pbixrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbixmX2lufSl9LHtuYW1lOlwicGxheWVyX2FuZ2xlXCIsdmFsdWU6cmF5Y2FzdGluZzIucGxheWVyX2FuZ2xlKHtmX2luLGtleXNfc3RyZWFtX3ZlcnNpb25faW4sa2V5c19zdHJlYW1fZnVuY3Rpb25faW59KX0se25hbWU6XCJwbGF5ZXJfeFwiLHZhbHVlOnJheWNhc3RpbmcyLnBsYXllcl94KHtmX2luLGtleXNfc3RyZWFtX3ZlcnNpb25faW4sa2V5c19zdHJlYW1fZnVuY3Rpb25faW59KX0se25hbWU6XCJwbGF5ZXJfeVwiLHZhbHVlOnJheWNhc3RpbmcyLnBsYXllcl95KHtmX2luLGtleXNfc3RyZWFtX3ZlcnNpb25faW4sa2V5c19zdHJlYW1fZnVuY3Rpb25faW59KX0se25hbWU6XCJzcGVlZFwiLHZhbHVlOnJheWNhc3RpbmcyLnNwZWVkKHt9KX0se25hbWU6XCJmXCIsdmFsdWU6cmF5Y2FzdGluZzIuZih7Zl9pbn0pfSx7bmFtZTpcInJheV9hbmdsZVwiLHZhbHVlOnJheWNhc3RpbmcyLnJheV9hbmdsZSh7cmF5X2FuZ2xlX2lufSl9LHtuYW1lOlwic3RlcFwiLHZhbHVlOnJheWNhc3RpbmcyLnN0ZXAoe3N0ZXBfaW59KX0se25hbWU6XCJ4XCIsdmFsdWU6cmF5Y2FzdGluZzIueCh7eF9pbn0pfSx7bmFtZTpcInlcIix2YWx1ZTpyYXljYXN0aW5nMi55KHt5X2lufSl9XV0sXCJzYXZpbmdzXCI6W1t7bmFtZTpcImJhbGFuY2VcIix2YWx1ZTpzYXZpbmdzLmJhbGFuY2Uoe3llYXJfaW4sZHVyYXRpb25faW4sYW5udWFsX3BheW1lbnRfaW4saW50ZXJlc3RfcmF0ZV9pbn0pfSx7bmFtZTpcImRlcG9zaXRzXCIsdmFsdWU6c2F2aW5ncy5kZXBvc2l0cyh7eWVhcl9pbixkdXJhdGlvbl9pbixhbm51YWxfcGF5bWVudF9pbn0pfSx7bmFtZTpcImludGVyZXN0XCIsdmFsdWU6c2F2aW5ncy5pbnRlcmVzdCh7eWVhcl9pbixkdXJhdGlvbl9pbixhbm51YWxfcGF5bWVudF9pbixpbnRlcmVzdF9yYXRlX2lufSl9LHtuYW1lOlwieWVhclwiLHZhbHVlOnNhdmluZ3MueWVhcih7eWVhcl9pbn0pfSx7bmFtZTpcImFubnVhbF9wYXltZW50XCIsdmFsdWU6c2F2aW5ncy5hbm51YWxfcGF5bWVudCh7YW5udWFsX3BheW1lbnRfaW59KX0se25hbWU6XCJkdXJhdGlvblwiLHZhbHVlOnNhdmluZ3MuZHVyYXRpb24oe2R1cmF0aW9uX2lufSl9LHtuYW1lOlwiaW50ZXJlc3RfcmF0ZVwiLHZhbHVlOnNhdmluZ3MuaW50ZXJlc3RfcmF0ZSh7aW50ZXJlc3RfcmF0ZV9pbn0pfV1dLFwic2F2aW5nc19yZWNcIjpbW3tuYW1lOlwieWVhclwiLHZhbHVlOnNhdmluZ3NfcmVjLnllYXIoe3llYXJfaW59KX0se25hbWU6XCJhY3R1YWxfaW50ZXJlc3RfcmF0ZXNcIix2YWx1ZTpzYXZpbmdzX3JlYy5hY3R1YWxfaW50ZXJlc3RfcmF0ZXMoe30pfSx7bmFtZTpcImFjdHVhbF9pbnRlcmVzdF9yYXRlX2NvXCIsdmFsdWU6c2F2aW5nc19yZWMuYWN0dWFsX2ludGVyZXN0X3JhdGVfY28oe2FjdHVhbF9pbnRlcmVzdF9yYXRlX2NvX2lufSl9LHtuYW1lOlwiaW50ZXJlc3RfcmF0ZVwiLHZhbHVlOnNhdmluZ3NfcmVjLmludGVyZXN0X3JhdGUoe3llYXJfaW4sYWN0dWFsX2ludGVyZXN0X3JhdGVfY29faW59KX1dLFt7bmFtZTpcImFubnVhbF9wYXltZW50XCIsdmFsdWU6c2F2aW5nc19yZWMuYW5udWFsX3BheW1lbnQoe30pfSx7bmFtZTpcImR1cmF0aW9uXCIsdmFsdWU6c2F2aW5nc19yZWMuZHVyYXRpb24oe30pfV0sW3tuYW1lOlwiYmFsYW5jZVwiLHZhbHVlOnNhdmluZ3NfcmVjLmJhbGFuY2Uoe3llYXJfaW4sYWN0dWFsX2ludGVyZXN0X3JhdGVfY29faW59KX0se25hbWU6XCJkZXBvc2l0c1wiLHZhbHVlOnNhdmluZ3NfcmVjLmRlcG9zaXRzKHt5ZWFyX2lufSl9LHtuYW1lOlwiaW50ZXJlc3RcIix2YWx1ZTpzYXZpbmdzX3JlYy5pbnRlcmVzdCh7eWVhcl9pbixhY3R1YWxfaW50ZXJlc3RfcmF0ZV9jb19pbn0pfV1dLFwic3RhcmZpZWxkXCI6W1t7bmFtZTpcInJhbmRvbV9zZWVkXCIsdmFsdWU6c3RhcmZpZWxkLnJhbmRvbV9zZWVkKHtyYW5kb21fc2VlZF9pbn0pfSx7bmFtZTpcInNlZWRlZFwiLHZhbHVlOnN0YXJmaWVsZC5zZWVkZWQoe3JhbmRvbV9zZWVkX2lufSl9LHtuYW1lOlwicmFuZG9tXCIsdmFsdWU6c3RhcmZpZWxkLnJhbmRvbSh7cmFuZG9tX3NlZWRfaW59KX0se25hbWU6XCJmcmFtZVwiLHZhbHVlOnN0YXJmaWVsZC5mcmFtZSh7ZnJhbWVfaW59KX0se25hbWU6XCJzdGFyXCIsdmFsdWU6c3RhcmZpZWxkLnN0YXIoe3N0YXJfaW59KX0se25hbWU6XCJ4MFwiLHZhbHVlOnN0YXJmaWVsZC54MCh7cmFuZG9tX3NlZWRfaW4sc3Rhcl9pbn0pfSx7bmFtZTpcInkwXCIsdmFsdWU6c3RhcmZpZWxkLnkwKHtyYW5kb21fc2VlZF9pbixzdGFyX2lufSl9LHtuYW1lOlwiejBcIix2YWx1ZTpzdGFyZmllbGQuejAoe3JhbmRvbV9zZWVkX2luLHN0YXJfaW59KX0se25hbWU6XCJzcGVlZFwiLHZhbHVlOnN0YXJmaWVsZC5zcGVlZCh7c3BlZWRfaW59KX0se25hbWU6XCJ6XCIsdmFsdWU6c3RhcmZpZWxkLnooe2ZyYW1lX2luLHJhbmRvbV9zZWVkX2luLHN0YXJfaW4sc3BlZWRfaW59KX0se25hbWU6XCJ2aXNpYmxlXCIsdmFsdWU6c3RhcmZpZWxkLnZpc2libGUoe2ZyYW1lX2luLHJhbmRvbV9zZWVkX2luLHN0YXJfaW4sc3BlZWRfaW59KX0se25hbWU6XCJ4XCIsdmFsdWU6c3RhcmZpZWxkLngoe2ZyYW1lX2luLHJhbmRvbV9zZWVkX2luLHN0YXJfaW4sc3BlZWRfaW59KX0se25hbWU6XCJ5XCIsdmFsdWU6c3RhcmZpZWxkLnkoe2ZyYW1lX2luLHJhbmRvbV9zZWVkX2luLHN0YXJfaW4sc3BlZWRfaW59KX0se25hbWU6XCJweFwiLHZhbHVlOnN0YXJmaWVsZC5weCh7ZnJhbWVfaW4scmFuZG9tX3NlZWRfaW4sc3Rhcl9pbixzcGVlZF9pbn0pfSx7bmFtZTpcInB5XCIsdmFsdWU6c3RhcmZpZWxkLnB5KHtmcmFtZV9pbixyYW5kb21fc2VlZF9pbixzdGFyX2luLHNwZWVkX2lufSl9XV0sXCJmaXp6YnV6elwiOltbe25hbWU6XCJmaXp6XCIsdmFsdWU6Zml6emJ1enouZml6eih7aV9pbn0pfSx7bmFtZTpcImJ1enpcIix2YWx1ZTpmaXp6YnV6ei5idXp6KHtpX2lufSl9LHtuYW1lOlwiZml6emJ1enpcIix2YWx1ZTpmaXp6YnV6ei5maXp6YnV6eih7aV9pbn0pfSx7bmFtZTpcImlcIix2YWx1ZTpmaXp6YnV6ei5pKHtpX2lufSl9XV0sXCJ5ZWFyX3JlbWFpbmluZ1wiOltbe25hbWU6XCJkYXRlXCIsdmFsdWU6eWVhcl9yZW1haW5pbmcuZGF0ZSh7ZGF0ZV9pbn0pfSx7bmFtZTpcInllYXJcIix2YWx1ZTp5ZWFyX3JlbWFpbmluZy55ZWFyKHtkYXRlX2lufSl9LHtuYW1lOlwiaXNMZWFwXCIsdmFsdWU6eWVhcl9yZW1haW5pbmcuaXNMZWFwKHtkYXRlX2lufSl9LHtuYW1lOlwiZGF5c0luWWVhclwiLHZhbHVlOnllYXJfcmVtYWluaW5nLmRheXNJblllYXIoe2RhdGVfaW59KX0se25hbWU6XCJkYXlzSW50b1llYXJTdGFydFRvbW9ycm93XCIsdmFsdWU6eWVhcl9yZW1haW5pbmcuZGF5c0ludG9ZZWFyU3RhcnRUb21vcnJvdyh7ZGF0ZV9pbn0pfSx7bmFtZTpcImRheXNJbnRvWWVhclN0YXJ0VG9kYXlcIix2YWx1ZTp5ZWFyX3JlbWFpbmluZy5kYXlzSW50b1llYXJTdGFydFRvZGF5KHtkYXRlX2lufSl9LHtuYW1lOlwiZGF5c0ludG9ZZWFyXCIsdmFsdWU6eWVhcl9yZW1haW5pbmcuZGF5c0ludG9ZZWFyKHt0aW1pbmdfaW4sZGF0ZV9pbn0pfSx7bmFtZTpcImZyYWN0aW9uSW50b1llYXJcIix2YWx1ZTp5ZWFyX3JlbWFpbmluZy5mcmFjdGlvbkludG9ZZWFyKHt0aW1pbmdfaW4sZGF0ZV9pbn0pfSx7bmFtZTpcImZyYWN0aW9uTGVmdEluWWVhclwiLHZhbHVlOnllYXJfcmVtYWluaW5nLmZyYWN0aW9uTGVmdEluWWVhcih7dGltaW5nX2luLGRhdGVfaW59KX0se25hbWU6XCJ0aW1pbmdcIix2YWx1ZTp5ZWFyX3JlbWFpbmluZy50aW1pbmcoe3RpbWluZ19pbn0pfV1dLFwic2ltcGxlX2xvYW5cIjpbW3tuYW1lOlwidlwiLHZhbHVlOnNpbXBsZV9sb2FuLnYoe3llYXJfaW4sZF9pX3llYXJfaW4saV9pbixkX2lfaW59KX0se25hbWU6XCJ2X3Bvd190ZXJtX2xlZnRcIix2YWx1ZTpzaW1wbGVfbG9hbi52X3Bvd190ZXJtX2xlZnQoe3llYXJfaW4sZF9pX3llYXJfaW4saV9pbixkX2lfaW4sdGVybV9pbn0pfSx7bmFtZTpcInJlcGF5bWVudF9hbW91bnRcIix2YWx1ZTpzaW1wbGVfbG9hbi5yZXBheW1lbnRfYW1vdW50KHt5ZWFyX2luLHByaW5jaXBhbF9pbixkX2lfeWVhcl9pbixpX2luLGRfaV9pbixtaXNzZWRfcmVwYXltZW50X3llYXJfaW4sc2tpcF9pbnRlcmVzdF9pbix0ZXJtX2lufSl9LHtuYW1lOlwiaW50ZXJlc3RcIix2YWx1ZTpzaW1wbGVfbG9hbi5pbnRlcmVzdCh7eWVhcl9pbixwcmluY2lwYWxfaW4sbWlzc2VkX3JlcGF5bWVudF95ZWFyX2luLHNraXBfaW50ZXJlc3RfaW4sdGVybV9pbixkX2lfeWVhcl9pbixpX2luLGRfaV9pbn0pfSx7bmFtZTpcImNhcGl0YWxfcmVwYXltZW50XCIsdmFsdWU6c2ltcGxlX2xvYW4uY2FwaXRhbF9yZXBheW1lbnQoe3llYXJfaW4sbWlzc2VkX3JlcGF5bWVudF95ZWFyX2luLHNraXBfaW50ZXJlc3RfaW4scHJpbmNpcGFsX2luLGRfaV95ZWFyX2luLGlfaW4sZF9pX2luLHRlcm1faW59KX0se25hbWU6XCJpbnRlcmVzdF9yZXBheW1lbnRcIix2YWx1ZTpzaW1wbGVfbG9hbi5pbnRlcmVzdF9yZXBheW1lbnQoe3llYXJfaW4sbWlzc2VkX3JlcGF5bWVudF95ZWFyX2luLHNraXBfaW50ZXJlc3RfaW4scHJpbmNpcGFsX2luLGRfaV95ZWFyX2luLGlfaW4sZF9pX2luLHRlcm1faW59KX0se25hbWU6XCJyZXBheW1lbnRfZHVlXCIsdmFsdWU6c2ltcGxlX2xvYW4ucmVwYXltZW50X2R1ZSh7eWVhcl9pbix0ZXJtX2lufSl9LHtuYW1lOlwicmVwYXltZW50XCIsdmFsdWU6c2ltcGxlX2xvYW4ucmVwYXltZW50KHt5ZWFyX2luLG1pc3NlZF9yZXBheW1lbnRfeWVhcl9pbixza2lwX2ludGVyZXN0X2luLHByaW5jaXBhbF9pbixkX2lfeWVhcl9pbixpX2luLGRfaV9pbix0ZXJtX2lufSl9LHtuYW1lOlwiYmFsYW5jZVwiLHZhbHVlOnNpbXBsZV9sb2FuLmJhbGFuY2Uoe3llYXJfaW4scHJpbmNpcGFsX2luLGRfaV95ZWFyX2luLGlfaW4sZF9pX2luLG1pc3NlZF9yZXBheW1lbnRfeWVhcl9pbixza2lwX2ludGVyZXN0X2luLHRlcm1faW59KX0se25hbWU6XCJpbnRlcmVzdF9yYXRlXCIsdmFsdWU6c2ltcGxlX2xvYW4uaW50ZXJlc3RfcmF0ZSh7eWVhcl9pbixkX2lfeWVhcl9pbixpX2luLGRfaV9pbn0pfSx7bmFtZTpcInByaW5jaXBhbFwiLHZhbHVlOnNpbXBsZV9sb2FuLnByaW5jaXBhbCh7cHJpbmNpcGFsX2lufSl9LHtuYW1lOlwiaVwiLHZhbHVlOnNpbXBsZV9sb2FuLmkoe2lfaW59KX0se25hbWU6XCJ0ZXJtXCIsdmFsdWU6c2ltcGxlX2xvYW4udGVybSh7dGVybV9pbn0pfSx7bmFtZTpcInllYXJcIix2YWx1ZTpzaW1wbGVfbG9hbi55ZWFyKHt5ZWFyX2lufSl9LHtuYW1lOlwibWlzc2VkX3JlcGF5bWVudF95ZWFyXCIsdmFsdWU6c2ltcGxlX2xvYW4ubWlzc2VkX3JlcGF5bWVudF95ZWFyKHttaXNzZWRfcmVwYXltZW50X3llYXJfaW59KX0se25hbWU6XCJza2lwX2ludGVyZXN0XCIsdmFsdWU6c2ltcGxlX2xvYW4uc2tpcF9pbnRlcmVzdCh7c2tpcF9pbnRlcmVzdF9pbn0pfSx7bmFtZTpcImRfaV95ZWFyXCIsdmFsdWU6c2ltcGxlX2xvYW4uZF9pX3llYXIoe2RfaV95ZWFyX2lufSl9LHtuYW1lOlwiZF9pXCIsdmFsdWU6c2ltcGxlX2xvYW4uZF9pKHtkX2lfaW59KX1dXX1cbil9XG5cblxuXG4vLy8vLy8vLy8vLyBlbmQgY29weSwgZG9uJ3QgZGVsZXRlIHRoZSBmb2xsb3dpbmc6XG5cbmkgPSAwIC8vIGFsbG93cyBmb3IgYnVnIHByb2Nlc3Npbmcgc2ltcGxlX2xvYW5cblxue1xuIHdpbmRvdy5mbnNfd2l0aF9tanNfcV9ldmFsID0gZm5zX3dpdGhfbWpzX3FfZXZhbFxuIHdpbmRvdy5tanNfcV9ldmFsID0gbWpzX3FfZXZhbFxuIC8vIHRyaWdnZXIgYW4gdXBkYXRlIGFuaW1hdGlvbiBoZXJlLCBidXQgaXMgdGhhdCBnb29kIHdpdGhvdXQgY2hlY2tpbmcgaWYgaW5kaXZpZHVhbCBudW1iZXJzIGNoYW5nZWQgP1xuIC8vIHNldHVwIGEgaGlzdG9yeT9cbn1cblxuXG5cbntcbiAgLy8gY2FuIEkgbWFrZSB0aGlzIHJ1biBvbiBlZGl0b3Igc2Nyb2xsPyBvciBtYWtlIENNIGdlbmVyYXRlIGZ1bGwgZG9tP1xuICAgICAgLy9kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYS0nKzMyKS50ZXh0Q29udGVudCA9IGZtdChmbnNfd2l0aF9tanNfcV9ldmFsWzMyXSk7XG4vLyBTZWVtcyBsaWtlIHRoZXNlIGNlbGxzIHN0b3AgaWYgdGhlcmUgaXMgYSBzaW5nbGUgZXJyb3IsXG4vLyBsaWtlIG1vZGlmeWluZyBhbiBlbGVtZW50IHRoYXQgaXNuJ3QgeWV0IGNyZWF0ZWRcbi8vIFF1YXJ0by9PSlMgZ2l2ZXMgbm8gZXJyb3IhXG4vLyBtYXliZSBkdWUgdG8gb3V0cHV0OiBmYWxzZT8gREFOR0VST1VTXG4vL2NvbnNvbGUubG9nKCdVUERBVEUnKVxuXG4gIGZuc193aXRoX21qc19xX2V2YWxbbW9kZWxuYW1lXVtjdWxfc2NvcGVfaWRdLmZvckVhY2goKHYsIGkpID0+IHtcbiAgICBsZXQgZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhLScraSlcbiAgICBpZiAoZClcbiAgICBkLnRleHRDb250ZW50ID0gZm10Mih2Lm5hbWUsIHYudmFsdWUpLy9mbXQodik7XG4gIH0pXG4gIG1qc19xX2V2YWxbbW9kZWxuYW1lXVtjdWxfc2NvcGVfaWRdLmZvckVhY2goKHtuYW1lLCB2YWx1ZX0sIGkpID0+IHtcbiAgICAgICAgbGV0IGQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndy0nK2kpXG4gICAgaWYgKGQpICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3LScraSkudGV4dENvbnRlbnQgPSBmbXQyKG5hbWUsIHZhbHVlKTsgLy8gZG9lcyB0aGlzIGdldCB1c2VkPyBvbiB1cGRhdGU/XG4gIH0pXG59XG5cbi8vIHRvZG8gZm10IGhpbnRzIG9yIHRlbXBsYXRlcz8gbGlrZSBhIHR5cGUgb3IgdW5pdD9cbi8vIGlzIHRoaXMgYSBiaWcgYm90dGxlbmVjaz9cbmZtdDIgPSAobmFtZSwgdmFsdWUpID0+IHtcbiAgbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKTtcbiAgaWYgKG5hbWUgPT0gJ3gnIHx8IG5hbWUgPT0gJ3knKSByZXR1cm4gZDMuZm9ybWF0KCcsLjRmJykodmFsdWUpXG4gIGlmIChuYW1lID09IFwibWFwXCIpIHJldHVybiBcIltbLi5dXVwiXG4gIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkgcmV0dXJuIFwiWy4uXVwiXG4gIGlmIChtb2RlbG5hbWUgPT0gJ2ZpenpidXp6JykgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PSAnbnVtYmVyJyA/IGQzLmZvcm1hdCgnLC4wZicpKHZhbHVlKSA6IHZhbHVlIC8vIHdvcmtzIHdlbGwgZm9yIGZpenpidXp6XG4gICAgICBpZiAobmFtZSA9PSAnbm93JyB8fCBuYW1lID09ICdkYXRlJykgcmV0dXJuIGQzLnRpbWVGb3JtYXQoXCIlWS0lbS0lZFwiKSh2YWx1ZSlcblxuICBpZiAobW9kZWxuYW1lID09ICdlbWlzc2lvbnNfbXlfbGlmZXRpbWUnKSB7XG4gICAgaWYgKG5hbWUgPT0gJ25vdycpIHJldHVybiBkMy50aW1lRm9ybWF0KFwiJVktJW0tJWRcIikodmFsdWUpXG4gICAgaWYgKG5hbWUgPT0gXCJlbWlzc2lvbnNfbXlfbGlmZXRpbWVfcHJvcG9ydGlvblwiKSByZXR1cm4gZDMuZm9ybWF0KFwiLjMlXCIpKHZhbHVlKVxuICAgIGlmICh0eXBlb2YgdmFsdWUgPT0gJ251bWJlcicpXG4gICAgcmV0dXJuIGQzLmZvcm1hdChcIi41a1wiKSh2YWx1ZSlcbiAgfVxuICBpZiAobmFtZSA9PSBcInZcIikgcmV0dXJuIGQzLmZvcm1hdChcIiwuNWZcIikodmFsdWUpXG4gIGlmIChuYW1lID09IFwidl9wb3dfdGVybV9sZWZ0XCIpIHJldHVybiBkMy5mb3JtYXQoXCIsLjVmXCIpKHZhbHVlKVxuICBpZiAobmFtZS5pbmNsdWRlcyhcIl9oaXRfb2JqZWN0XCIpKSByZXR1cm4gXCJ7Li59XCIvL2B7eDogJHt2YWx1ZS54LnRvRml4ZWQoMil9LCB5OiAke3ZhbHVlLnkudG9GaXhlZCgyKX0sIHY6ICR7dmFsdWUudn0sIHN0ZXBfaW46ICR7dmFsdWUuc3RlcF9pbn19YFxuICBpZiAobmFtZS5pbmNsdWRlcyhcIl9jb1wiKSkgcmV0dXJuIGQzLmZvcm1hdChcIiwuMGZcIikodmFsdWUpXG4gIGlmIChuYW1lLmluY2x1ZGVzKFwicmF0ZVwiKSAmJiBuYW1lLmluY2x1ZGVzKFwiaW50ZXJlc3RcIikpIHJldHVybiBkMy5mb3JtYXQoXCIuMyVcIikodmFsdWUpXG4gIGlmIChuYW1lLmluY2x1ZGVzKFwicmF0ZVwiKSB8fCBuYW1lLmluY2x1ZGVzKFwicGVyY2VudFwiKSB8fCBuYW1lLmluY2x1ZGVzKFwiZnJhY3Rpb25cIikpIHJldHVybiBkMy5mb3JtYXQoXCIuMiVcIikodmFsdWUpXG4gIGlmICgobmFtZS5pbmNsdWRlcyhcInllYXJcIikpIHx8IG5hbWUuaW5jbHVkZXMoXCJ0ZXJtXCIpIHx8IG5hbWUuaW5jbHVkZXMoXCJkdXJhdGlvblwiKSB8fCBuYW1lLmluY2x1ZGVzKFwiZnJhbWVcIikpIHJldHVybiBkMy5mb3JtYXQoXCIuMGZcIikodmFsdWUpXG4gIGlmIChuYW1lLmluY2x1ZGVzKFwib2JqZWN0XCIpIHx8IHR5cGVvZiB2YWx1ZSAhPSAnbnVtYmVyJykgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHZhbHVlKVxuXG4gIHJldHVybiBkMy5mb3JtYXQoZm10X2ZtdCkodmFsdWUpXG59XG5cblxuLy8vL1xuXG4vLyBob3cgdG8gY2FsbCBhIGZ1bmN0aW9uXG5cbmZuc193aXRoX21qcyA9IE9iamVjdC52YWx1ZXMoY2FsY3VsYW5nX3NvdXJjZV9pbnRyb3NwZWN0aW9uLmN1bF9mdW5jdGlvbnMpXG4gIC5maWx0ZXIoXG4gICAgKGQpID0+XG4gICAgICBkLnJlYXNvbiA9PSBcImRlZmluaXRpb25cIiAvKmlucHV0IGRlZmluaXRpb24gZG9lc24ndCBoYXZlIGEgbG9jKi8gJiZcbiAgICAgIGQuY3VsX3Njb3BlX2lkID09IGN1bF9zY29wZV9pZFxuICApXG4gIC5tYXAoKGQpID0+ICh7IC4uLmQsIG1qczogYHske2QuaW5wdXRzLmpvaW4oXCIsXCIpfX1gIH0pKSAvLyBhc3N1bWluZyBjb21wbGV0ZWx5IG9uIG9uZSBsaW5lXG5cbi8vIGV4LSBjYWxsc193aXRoX21qcywgcmVsYXRlcyB0byB0aGF0IGluIGdlbmVyYXRvclxuY2FsbHMgPSBjYWxjdWxhbmdfc291cmNlX2ludHJvc3BlY3Rpb24uY3VsX2xpbmtzXG4gIC5maWx0ZXIoZCA9PiAhZC5mcm9tLmluY2x1ZGVzKCd1bmRlZmluZWQnKSkuZmlsdGVyKChkKSA9PiBkLnJlYXNvbiA9PSBcImNhbGxcIiAmJiBjdWxfc2NvcGVfaWQgPT0gK2QudG8uc3BsaXQoXCJfXCIpWzBdKSAvLyBidWdzIGZvciBkb3VibGUgZGlnaXQgc2NvcGVzXG5cblxuLy8gZXggQ2hlY2tib3hXaWRnZXRcbmNsYXNzIEFuc3dlcnNXb3JraW5nc092ZXJsYXlXaWRnZXQgZXh0ZW5kcyBjbUltcG9ydHMudmlldy5XaWRnZXRUeXBlIHtcbiAgY29uc3RydWN0b3IodiwgY2FsbCwgY2FsbF9pLCB0eXBlKSB7XG4gICAgLy9hID0gdjtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMudiA9IHY7XG4gICAgdGhpcy5jYWxsID0gY2FsbDtcbiAgICB0aGlzLmNhbGxfaSA9IGNhbGxfaTtcbiAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICAgIC8vdGhpcy5ldmFscyA9IHR5cGUgPT0gXCJkZWZpbml0aW9uXCIgPyBtanNfcV9ldmFsIDogZm5zX3dpdGhfbWpzX3FfZXZhbDtcbiAgICAvL3RoaXMuaW5mbyA9IHR5cGUgPT0gXCJkZWZpbml0aW9uXCIgPyBmbnNfd2l0aF9tanMgOiBjYWxsc193aXRoX21qc19xdWFsaWZpZWQ7XG4gIH1cblxuICB0b0RPTSgpIHtcbiAgICAvLyBtanNfcV9ldmFsOyB1c2UgdGhpcyB0byB0ZXN0IGZsaWNrZXIvcGFyc2UgaXNzdWVzIGZvciBwbHVnaW5zIHNldHRpbmcgdmFsdWVzIChub3cgc2V0IHNldHBhcmF0ZWx5IGJ5IERPTSBjYWxscylcbiAgICBsZXQgd3JhcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuICAgIC8vd3JhcC5jbGFzc05hbWUgPSBcInRvb2x0aXBcIjtcbiAgICAvL3dyYXAudGV4dENvbnRlbnQgPSBcIjEwMS4xOVwiO1xuICAgIHdyYXAuc2V0QXR0cmlidXRlKFwiYXJpYS1oaWRkZW5cIiwgXCJ0cnVlXCIpOyAvLyBub3QgaW4gYSBnb29kIHBsYWNlLCB0b2RvIGZpeFxuICAgIHdyYXAuY2xhc3NOYW1lID0gXCJjYWxjdWxhbmdfdG9vbHRpcFwiO1xuICAgIGlmICh0aGlzLnR5cGUgPT0gXCJkZWZpbml0aW9uXCIpIHtcbiAgICAgIHJldHVybiBodGwuaHRtbGA8c3BhbiBjbGFzcz1cImNhbGN1bGFuZ190b29sdGlwIGFuc3dlclwiIGlkPVwiYy1hLSR7dGhpcy52fVwiPjwhLS08aW5wdXQgdHlwZT1cImNoZWNrYm94XCI+PC9pbnB1dD4tLT48c3BhbiBpZD1cImEtJHt0aGlzLnZ9XCIgY2xhc3M9XCJ0b29sdGlwdGV4dFwiIGFuY2hvcj1cImMtYS0ke3RoaXMudn1cIj4ke2ZtdDIoXG4gICAgICAgIHdpbmRvdy5mbnNfd2l0aF9tanNfcV9ldmFsW21vZGVsbmFtZV1bY3VsX3Njb3BlX2lkXVt0aGlzLnZdLm5hbWUsIHdpbmRvdy5mbnNfd2l0aF9tanNfcV9ldmFsW21vZGVsbmFtZV1bY3VsX3Njb3BlX2lkXVt0aGlzLnZdLnZhbHVlLy85OTlcbiAgICAgICl9PC9zcGFuPjwvc3Bhbj5gO1xuICAgIH1cbiAgICByZXR1cm4gaHRsLmh0bWxgPHNwYW4gb25jbGljaz0keygpID0+IHtcbiAgICAgIC8qIFRPRE8qLyBzZXQodmlld29mIGZvcm11bGFlX3Zpc2libGUsIFsgLy8gSSdtIHN1cHBvc2VkIHRvIHVzZSBvcHRpb25zLmZvcm11bGFlX3Zpc2libGUgISFcbiAgICAgICAgY2FsbHNbdGhpcy52XS5mcm9tLnNsaWNlKDIpXG4gICAgICBdKTtcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYWxjdWxhbmdfZl8nK2NhbGxzW3RoaXMudl0uZnJvbS5zbGljZSgyKS8qQlVHIGZvciA+OSBzY29wZXMhKi8pLnNjcm9sbEludG9WaWV3KHNjcm9sbEludG9WaWV3T3B0cylcbiAgICAgIGlmICh3aW5kb3cubWpzX3FfZXZhbFttb2RlbG5hbWVdW2N1bF9zY29wZV9pZF1bdGhpcy52XS5oYW5kbGVyKSB3aW5kb3cubWpzX3FfZXZhbFttb2RlbG5hbWVdW2N1bF9zY29wZV9pZF1bdGhpcy52XS5oYW5kbGVyKCk7XG5cbiAgICB9fSBjbGFzcz1cImNhbGN1bGFuZ190b29sdGlwXCIgaWQ9XCJjLXctJHt0aGlzLmNhbGxfaX1cIj48IS0tJm5ic3A7PGlucHV0IHR5cGU9XCJjaGVja2JveFwiPjwvaW5wdXQ+LS0+PHNwYW4gaWQ9XCJ3LSR7dGhpcy5jYWxsX2l9XCIgY2xhc3M9XCJ0b29sdGlwdGV4dFwiIGFuY2hvcj1cImMtdy0ke3RoaXMuY2FsbF9pfVwiPiR7Zm10Miggd2luZG93Lm1qc19xX2V2YWxbbW9kZWxuYW1lXVtjdWxfc2NvcGVfaWRdW3RoaXMuY2FsbF9pXS5uYW1lLFxuICAgICB3aW5kb3cubWpzX3FfZXZhbFttb2RlbG5hbWVdW2N1bF9zY29wZV9pZF1bdGhpcy5jYWxsX2ldLnZhbHVlXG4gICAgKX08L3NwYW4+PC9zcGFuPmA7XG4gICAgcmV0dXJuIHdyYXA7XG4gIH1cblxuICBpZ25vcmVFdmVudCgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuZnVuY3Rpb24gd29ya2luZ3Modmlldykge1xuICByZXR1cm4gRGVjb3JhdGlvbi5zZXQoXG4gICAgW1xuICAgICAgLi4uY2FsbHMubWFwKChkLCBpKSA9PlxuICAgICAgICBEZWNvcmF0aW9uLndpZGdldCh7XG4gICAgICAgICAgd2lkZ2V0OiBuZXcgQW5zd2Vyc1dvcmtpbmdzT3ZlcmxheVdpZGdldChpLCBkLCBpKSxcbiAgICAgICAgICBzaWRlOiAxXG4gICAgICAgIH0pLnJhbmdlKFxuICAgICAgICAgIGQubG9jLnN0YXJ0LmluZGV4ICtcbiAgICAgICAgICAgIGQuZnJvbS5sZW5ndGggLVxuICAgICAgICAgICAgMCAtIE1hdGguZmxvb3IoZC5mcm9tLmxlbmd0aC8yKSAvLyB0aGlzIHNwbGl0IGlzIHdyb25nIGZvciBpbnRlcmVzdF9yYXRlIGZvciBleGFtcGxlIVxuICAgICAgICApXG4gICAgICApXG4gICAgXVxuICApO1xufVxuXG5mdW5jdGlvbiBhbnN3ZXJzKHZpZXcpIHtcbiAgcmV0dXJuIERlY29yYXRpb24uc2V0KFxuICAgIFtcbiAgICAgIC4uLmZuc193aXRoX21qcy5tYXAoKGQsIGkpID0+XG4gICAgICAgIERlY29yYXRpb24ud2lkZ2V0KHtcbiAgICAgICAgICB3aWRnZXQ6IG5ldyBBbnN3ZXJzV29ya2luZ3NPdmVybGF5V2lkZ2V0KGksIGQsIGksIFwiZGVmaW5pdGlvblwiKSxcbiAgICAgICAgICBzaWRlOiAxXG4gICAgICAgIH0pLnJhbmdlKFxuICAgICAgICAgIC8vICAgICAgICAgICAgICAgICAgICB9KS5yYW5nZSh2aWV3LnN0YXRlLmRvYy5saW5lKGUpLmZyb20pXG5cbiAgICAgICAgICB2aWV3LnN0YXRlLmRvYy5saW5lKGQubG9jLnN0YXJ0LmxpbmUpLnRvXG4gICAgICAgICAgLy9kLmZyb20ubGVuZ3RoIC1cbiAgICAgICAgICAvKiB0b2RvIHRha2UgbWlkcG9pbnQgc3RhcnQtZW5kICovXG4gICAgICAgIClcbiAgICAgIClcbiAgICBdIC8qIHRvZG8gdGFrZSBtaWRwb2ludCBzdGFydC1lbmQgKi9cbiAgKTtcbn1cblxuXG5vdmVybGF5X2Fuc3dlcnMgPSB7XG4gIC8vIHByZXZlbnQgaW5wdXQgZXZlbnRzIGNvbWluZyBmcm9tIHRoZSBjb250ZW50ZWRpdGFibGUgZGl2IHRoYXRcbiAgLy8gcHJvcGFnYXRlcyBhbmQgdHJpZ2dlcnMgYSBjZWxsIHJlZnJlc2g7IHdlIHNoYWxsIGhhbmRsZSBpdCBvdXJzZWx2ZXMuXG4gIGNvbnN0IGFuc3dlcnNfZGVjb3JhdGlvbnMgPSBjbUltcG9ydHMudmlldy5WaWV3UGx1Z2luLmZyb21DbGFzcyhcbiAgICBjbGFzcyB7XG4gICAgICBjb25zdHJ1Y3Rvcih2aWV3KSB7XG4gICAgICAgIHRoaXMuZGVjb3JhdGlvbnMgPSBhbnN3ZXJzKHZpZXcpO1xuICAgICAgfVxuICAgICAgdXBkYXRlKHVwZGF0ZSkge1xuICAgICAgICAvLyB1cGRhdGVzIGNhdXNlIGRpZmZpY3VsdHkgY2xpY2tpbmcgbnVtYmVycyAtIHRoYW5rZnVsbHkgbm90IG5lZWRlZFxuXG4gICAgICAgIC8vdGhpcy5kZWNvcmF0aW9ucyA9IGFuc3dlcnModXBkYXRlLnZpZXcpO1xuXG4gICAgICAgIC8vIG5vdCBuZWNlc3NhcnkgZm9yIHJlYWQtb25seVxuICAgICAgfVxuICAgIH0sXG4gICAge1xuICAgICAgZGVjb3JhdGlvbnM6ICh2KSA9PiB2LmRlY29yYXRpb25zLFxuICAgICAgZXZlbnRIYW5kbGVyczoge31cbiAgICB9XG4gICk7XG5cbiAgcmV0dXJuIFthbnN3ZXJzX2RlY29yYXRpb25zXTtcbn1cblxub3ZlcmxheV93b3JraW5ncyA9IHtcbiAgLy8gcHJldmVudCBpbnB1dCBldmVudHMgY29taW5nIGZyb20gdGhlIGNvbnRlbnRlZGl0YWJsZSBkaXYgdGhhdFxuICAvLyBwcm9wYWdhdGVzIGFuZCB0cmlnZ2VycyBhIGNlbGwgcmVmcmVzaDsgd2Ugc2hhbGwgaGFuZGxlIGl0IG91cnNlbHZlcy5cbiAgY29uc3QgY2hlY2tib3hQbHVnaW4gPSBjbUltcG9ydHMudmlldy5WaWV3UGx1Z2luLmZyb21DbGFzcyhcbiAgICBjbGFzcyB7XG4gICAgICBjb25zdHJ1Y3Rvcih2aWV3KSB7XG4gICAgICAgIHRoaXMuZGVjb3JhdGlvbnMgPSB3b3JraW5ncyh2aWV3KTtcbiAgICAgIH1cblxuICAgICAgdXBkYXRlKHVwZGF0ZSkge1xuICAgICAgICAvLyB1cGRhdGVzIGNhdXNlIGRpZmZpY3VsdHkgY2xpY2tpbmcgbnVtYmVycyAtIHRoYW5rZnVsbHkgbm90IG5lZWRlZFxuICAgICAgICAvLyBub3QgbmVjZXNzYXJ5IGZvciByZWFkLW9ubHlcbiAgICAgICAgLy9pZiAodXBkYXRlLmRvY0NoYW5nZWQgfHwgdXBkYXRlLnZpZXdwb3J0Q2hhbmdlZClcbiAgICAgICAgIC8vdGhpcy5kZWNvcmF0aW9ucyA9IHdvcmtpbmdzKHVwZGF0ZS52aWV3KTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHtcbiAgICAgIGRlY29yYXRpb25zOiAodikgPT4gdi5kZWNvcmF0aW9uc1xuICAgIH1cbiAgKTtcblxuICByZXR1cm4gW2NoZWNrYm94UGx1Z2luXTtcbn1cblxuXG5cbmZtdCA9IGQgPT4gKHR5cGVvZiBkID09ICdudW1iZXInKSA/IChNYXRoLmFicyhkKSA8IDIgPyBkMy5mb3JtYXQoJy4yJScpKGQpIDogZDMuZm9ybWF0KGZtdF9mbXQpKGQpKSA6IEpTT04uc3RyaW5naWZ5KGQpXG5cbmVtYmVkXyA9IHJlcXVpcmUoXCJ2ZWdhLWVtYmVkXCIpXG5lbWJlZCA9IChzcGVjLCBvcHRpb25zKSA9PiBlbWJlZF8oc3BlYywge2FjdGlvbnMsIHJlbmRlcmVyOidzdmcnLC4uLm9wdGlvbnN9KVxuXG4vL3RoZW1lID0gJ3Bvd2VyYmknO1xuXG5cblxue1xuICBmX2luO1xuICBtdXRhYmxlIGZyYW1lX3ZhbCA9IGZfaW47XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTgiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJcbnNjcm9sbEludG9WaWV3T3B0cyA9IHsgcmV0dXJuICh7YmVoYXZpb3VyOidzbW9vdGgnLCBibG9jazonY2VudGVyJ30pfVxuXG5JbnB1dHMuYnV0dG9uKFtcbiAgW1wiZXhwYW5kIGFsbFwiLCAoKSA9PiBzZXQodmlld29mIGZvcm11bGFlX3Zpc2libGUsIGZvcm11bGFlX2FsbCldLFxuICBbXCJjb2xsYXBzZSBhbGxcIiwgKCkgPT4gc2V0KHZpZXdvZiBmb3JtdWxhZV92aXNpYmxlLCBbXSldLFxuXSlcblxuXG52aWV3b2Ygb3B0aW9ucyA9IElucHV0cy5jaGVja2JveChbXCJleHBvcnQgY29uc3RzXCIsIFwiaW5wdXRzXCIvKiwgXCJsaXN0cyAodG9kbylcIiovXSwge2xhYmVsOiBcInVuaGlkZT9cIiwgdmFsdWU6IFtcImV4cG9ydCBjb25zdHNcIiwgXCJpbnB1dHNcIl19KVxuXG52aWV3b2Ygb3ZlcmxheSA9IElucHV0cy50b2dnbGUoeyBsYWJlbDogXCJvdmVybGF5P1wiLCB2YWx1ZTogcS5nZXQoJ3ByaW5jaXBhbF9pbicpID8gdHJ1ZSA6IGZhbHNlIH0pXG5cbi8vbWRgLS0tYFxuXG5cbnZpZXdvZiBjdWxfanMgPSBJbnB1dHMucmFkaW8oW1wi8J+TnSBjYWxjdWxhbmcgc291cmNlIPCfkqxcIiwgXCLinKggSlMvRVNNIG91dHB1dCDinKggKG1vZHVsYXIgYW5ub3RhdGlvbnMgYmFkKVwiXSwge2xhYmVsOiBcIvCfq7ZcIiwgdmFsdWU6IFwi8J+TnSBjYWxjdWxhbmcgc291cmNlIPCfkqxcIn0pXG5cbmN1bF9qc19jdWwgPSBjdWxfanMgPT0gXCLwn5OdIGNhbGN1bGFuZyBzb3VyY2Ug8J+SrFwiID8gdHJ1ZSA6IGZhbHNlXG52aWV3b2YgY2FsY3VsYW5nX3NvdXJjZV9ub21lbW8gPSBJbnB1dHMuY2hlY2tib3goW1wibm9tZW1vXCJdLCB7dmFsdWU6IFtcIm5vbWVtb1wiXSwgbGFiZWw6ICdzZWUgbWVtbz8g8J+SgCcsIGRpc2FibGVkOmN1bF9qcz09XCLwn5OdIGNhbGN1bGFuZyBzb3VyY2Ug8J+SrFwifSlcblxudmlld29mIGZvcm11bGFlX3Zpc2libGUgPSBJbnB1dHMuaW5wdXQobW9kZWxuYW1lID09ICdzaW1wbGVfbG9hbicgPyBbJ3JlcGF5bWVudF9hbW91bnQnXSA6IC8qbW9kZWxuYW1lID09ICd5ZWFyX3JlbWFpbmluZycgPyBbJ2ZyYWN0aW9uTGVmdEluWWVhciddIDoqLyBmb3JtdWxhZV9hbGwpLy8gbW9kZWxuYW1lID09ICd5ZWFyX3JlbWFpbmluZycgPyBbJ2ZyYWN0aW9uTGVmdEluWWVhciddIDogbW9kZWxuYW1lID09ICdzYXZpbmdzJyA/IFtcImJhbGFuY2VcIiwgXCJpbnRlcmVzdFwiLCBcImRlcG9zaXRzXCJdIDogbW9kZWxuYW1lID09ICdmaXp6YnV6eicgPyBmb3JtdWxhZV9hbGwgOiBbXSlcblxue1xuICBpZiAobW9kZWxuYW1lID09ICd5ZWFyX3JlbWFpbmluZycpIC8vIGRvZXNuJ3Qgd29yayA/XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhbGN1bGFuZ19mXycrXCJmcmFjdGlvbkxlZnRJblllYXJcIikuc2Nyb2xsSW50b1ZpZXcoc2Nyb2xsSW50b1ZpZXdPcHRzKVxufVxuXG57XG4gIGlmIChtb2RlbG5hbWUgPT0gJ3JheWNhc3RpbmcyJylcbiAgc2V0KHZpZXdvZiBvdmVybGF5LCBmYWxzZSlcbn1cblxudmlld29mIGZtdF9mbXQgPSBJbnB1dHMudGV4dCh7dmFsdWU6XCIsLjJmXCIsIGxhYmVsOiAnZm9ybWF0J30pXG5cbnZpZXdvZiBhY3Rpb25zID0gSW5wdXRzLnRvZ2dsZSh7bGFiZWw6J3ZlZ2EgYWN0aW9ucz8nLCB2YWx1ZTpmYWxzZX0pXG5cblxuXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTkiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJcblxuLy8gaHR0cHM6Ly9vYnNlcnZhYmxlaHEuY29tL2QvODY3ZTE0MjRlMWQwOTNhYlxuXG5tdXRhYmxlIGZyYW1lX3ZhbCA9IDBcblxuXG5tdXRhYmxlIGtleXNfc2hhcmVkID0gW11cblxuLy9JbnB1dHMuYmluZChTY3J1YmJlcihfLnJhbmdlKDAsIDIwMCksIHsgYXV0b3BsYXk6IGZhbHNlLCBkZWxheTogNTAgfSksIHZpZXdvZiBmX2luKVxuXG5cblxuXG5cbnZpZXdvZiBrZXlzX3N0cmVhbSA9IHsgLy8gaHR0cHM6Ly9vYnNlcnZhYmxlaHEuY29tL2QvODY3ZTE0MjRlMWQwOTNhYlxuICBsZXQgZSA9IGh0bWxgPGRpdiBjbGFzcz0ndGFyZ2V0JyBzdHlsZT0nY29sb3I6cGluazsgYmFja2dyb3VuZDojZWVlJyB0YWJJbmRleD0xPktleWJvYXJkIHRhcmdldDwvZGl2PmA7XG4gIGxldCBrZXlzID0gW107XG4gIGUudmFsdWUgPSBrZXlzO1xuICBsZXQgZ2FwID0gbmV3IERhdGUoKTtcbiAgZS5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgKGV2dCkgPT4ge1xuICAgIGtleXMucHVzaCh7XG4gICAgICBrZXk6IGV2dC5rZXksXG4gICAgICBkZWxheTogbmV3IERhdGUoKSAtIGdhcCxcbiAgICAgIGZyYW1lOiBtdXRhYmxlIGZyYW1lX3ZhbCArIDFcbiAgICB9KTtcbiAgICBrZXlzX3NoYXJlZC5wdXNoKHtcbiAgICAgIGtleTogZXZ0LmtleSxcbiAgICAgIGRlbGF5OiBuZXcgRGF0ZSgpIC0gZ2FwLFxuICAgICAgZnJhbWU6IG11dGFibGUgZnJhbWVfdmFsICsgMVxuICAgIH0pO1xuICAgIGdhcCA9IG5ldyBEYXRlKCk7XG4gICAgZS5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChcImlucHV0XCIpKTtcbiAgICBldnQucHJldmVudERlZmF1bHQoKTsgLy8gZm9yIHJldmVhbGpzPyBub3QgZW5vdWdoXG4gICAgICAgICAgc2V0KHZpZXdvZiBmX2luLCB2aWV3b2YgZl9pbi52YWx1ZSsxKVxuXG4gIH0pO1xuXG4gIHJldHVybiBlO1xufVxuXG52aWV3b2Ygc2NlbmUgPSBlbWJlZChzY2VuZV9zcGVjLCB7IHJlbmRlcmVyOiBcInN2Z1wiLCBwYWRkaW5nOiAwLCBhY3Rpb25zLCBjb25maWc6IHsgYXV0b3NpemU6ICdmaXQteScgfSxcbnBhdGNoOiBzID0+IHtzLnNpZ25hbHMucHVzaCh7XG4gIFxuICAgIG5hbWU6IFwiZG91YmxlY2xpY2tcIixcbiAgICB2YWx1ZTogMCxcbiAgICAgIFwib25cIjogW3tcImV2ZW50c1wiOiBcImRibGNsaWNrXCIsIFwidXBkYXRlXCI6IFwiZGF0dW1cIn1dXG4gIFxufSk7XG4gcmV0dXJuIHN9XG59KVxuXG5cblxuXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEwIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG5cbntmX2luO1xuICAgIG11dGFibGUgc2hvd19yYXkgPSBmYWxzZTtcbiAgICBzZXQodmlld29mIHNob3dfcmF5X2gsIGZhbHNlKVxuICAgIHNldCh2aWV3b2Ygc2hvd19yYXlfdiwgZmFsc2UpXG59XG5cbiAge1xuICAgIHNjZW5lLmFkZFNpZ25hbExpc3RlbmVyKCdkb3VibGVjbGljaycsIF8gPT4ge1xuICAgICAgc2V0KHZpZXdvZiBvdmVybGF5LCB0cnVlKVxuICAgIH0pXG4gIH1cblxudmlld29mIHNjZW5lX3NpemUgPSBJbnB1dHMucmFuZ2UoWzAuMSwxXSwge3ZhbHVlOjAuNSwgbGFiZWw6ICdzaXplJ30pXG5cbnZpZXdvZiBzaG93X3JheV9zdGVwcyA9IElucHV0cy50b2dnbGUoe2xhYmVsOiAnc2hvdyByYXkgc3RlcHM/JywgdmFsdWU6IGZhbHNlfSlcblxudmlld29mIHNob3dfcmF5X2ggPSBJbnB1dHMudG9nZ2xlKHtsYWJlbDogJ3Nob3cgaCByYXk/JywgdmFsdWU6IGZhbHNlfSlcbnZpZXdvZiBzaG93X3JheV92ID0gSW5wdXRzLnRvZ2dsZSh7bGFiZWw6ICdzaG93IHYgcmF5PycsIHZhbHVlOiBmYWxzZX0pXG5cbi8vIGhtciB2ZXJzaW9ucyB3b3JrcyBidXQgdGhlIHNldCBmb3IgdmVyc2lvbiBkb2Vzbid0IHdvcmtcblxue1xuICByYXljYXN0aW5nX2xhdGVzdDtcbiAgbXV0YWJsZSBhYWEgPSBbLi4ubXV0YWJsZSBhYWEsIHJheWNhc3RpbmdfbGF0ZXN0XVxuICBzZXQodmlld29mIHZlcnNpb24sIHZpZXdvZiB2ZXJzaW9uLnZhbHVlKzEpXG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTExIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG5cbnNjZW5lLmFkZFNpZ25hbExpc3RlbmVyKFwiZm9ybXVsYVwiLCAoYSwgYikgPT4ge1xuICAvL2RlYnVnZ2VyO1xuICBzZXQodmlld29mIGZvcm11bGFlX3Zpc2libGUsIFtcInJheV9pbnZlcnNlX2Rpc3RhbmNlXCJdKVxuICAvL3NldCh2aWV3b2YgeWVhcl9pbiwgYi55ZWFyX2luWzBdKVxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2FsY3VsYW5nX2ZfJytcInJheV9pbnZlcnNlX2Rpc3RhbmNlXCIpLnNjcm9sbEludG9WaWV3KHNjcm9sbEludG9WaWV3T3B0cylcbiAvL31cbn0pXG5cbmh0bC5odG1sYDxidXR0b24gb25jbGljaz0keygpID0+IChtdXRhYmxlIHNjZW5lX2RhdGEwID0gc2NlbmVfZGF0YSl9Pmluc2VydCBkYXRhIC0+IHZlZ2EgZWRpdG9yIChkZXYpPC9idXR0b24+YFxuSW5wdXRzLmJpbmQoSW5wdXRzLnJhbmdlKFstMTAsMTAwXSwge3N0ZXA6MSwgbGFiZWw6ICdzdGVwJ30pLCB2aWV3b2Ygc3RlcF9pbilcblxue1xuICBzY2VuZTtcbiAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdyZXNpemUnKSlcbn1cblxuXG5cbiAgLy8uaHRtbC1maWxsLWNvbnRhaW5lcj4uaHRtbC1maWxsLWl0ZW0geyAvKiBtZXNzeSEgaW50ZXJhY3RzIHdpdGggb3RoZXIgc3R5bGluZyAqL1xuICAvLyAgZmxleDogbm9uZTtcbiAgLy99XG5odG1sYFxuPHN0eWxlPlxuICAjcmF5Y2FzdGluZzIgLmZpdC15IHN2ZyB7XG4gIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCh0byBib3R0b20sIGxpZ2h0Ymx1ZSwgcGluaywgd2hpdGUpO1xuICB9XG4gICNyZWZsZWN0aW9uIHN2ZyB7XG4gICAgbWFyZ2luLXRvcDogLTEwcHg7XG4gIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudCh0byBib3R0b20sIG9yYW5nZSwgcGluaywgd2hpdGUpO1xuXG4gICAgLypmaWx0ZXI6IGJsdXIoMTBweCk7XG4gICAgICBiYWNrZ3JvdW5kOiB3aGl0ZTsgbGluZWFyLWdyYWRpZW50KHRvIGJvdHRvbSwgbGlnaHRibHVlLCBncmVlbiwgd2hpdGUpOyovXG4gICAgICB0cmFuc2Zvcm06IHNjYWxlWSgtMC43KTsgLyp0cmFuc2xhdGVZKDY1cHgpOyovXG4gICAgICBtYXNrOiBsaW5lYXItZ3JhZGllbnQodG8gYm90dG9tLCB0cmFuc3BhcmVudCwgYmxhY2sgOTglKTtcbiAgfVxuXG48L3N0eWxlPlxuYFxuXG4vL0lucHV0cy50YWJsZShzY2VuZV9kYXRhKVxuXG5zY2VuZV9zcGVjID0geyByZXR1cm4gKHtcbiAgY29uZmlnOiB7YXV0b3NpemU6ICdmaXQnfSxcbiAgICBcImRhdGFcIjoge1wibmFtZVwiOiBcInNvdXJjZVwifSxcblxuICBkYXRhc2V0czogeydzb3VyY2UnOiBzY2VuZV9kYXRhMCB9LFxuICB3aWR0aDogXCJjb250YWluZXJcIixcbiAgaGVpZ2h0OiA1NTAqc2NlbmVfc2l6ZSxcbiAgLy9oZWlnaHQ6IDQwMCxcbiAgLy9oZWlnaHQ6IFwiY29udGFpbmVyXCIsXG4gIC8vYmFja2dyb3VuZDogXCJsaW5lYXItZ3JhZGllbnQoYmx1ZSwgcGluaylcIixcbiAgbWFyazogeyB0eXBlOiBcImJhclwiLCBjbGlwOiB0cnVlIH0sXG4gIC8vdHJhbnNmb3JtOiBbe2NhbGN1bGF0ZTogXCIyKmRhdHVtLnJfaGl0X3YrKDApXCIsIGFzOiBcInJfaGl0X3ZfX3JfaGl0X2hfb3JfdlwifV0sXG4gIGVuY29kaW5nOiB7XG4gICAgeDoge1xuICAgICAgZmllbGQ6IFwicmF5X2FuZ2xlX2luXCIsXG4gICAgICB0eXBlOiBcIm9yZGluYWxcIixcbiAgICAgIGF4aXM6IGd1aWRlcyA/IHsgZm9ybWF0OiBcIiwuMmZcIiwgZ3JpZDogZmFsc2UgfSA6IG51bGwsXG4gICAgICBzb3J0OiBcImRlc2NlbmRpbmdcIlxuICAgIH0sXG4gICAgeToge1xuICAgICAgZmllbGQ6IFwicmF5X2ludmVyc2VfZGlzdGFuY2VcIixcbiAgICAgIHR5cGU6IFwicXVhbnRpdGF0aXZlXCIsXG4gICAgICBzY2FsZTogeyBkb21haW46IFswLCAxXSB9LFxuICAgICAgYXhpczogZ3VpZGVzID8geyBncmlkOiBmYWxzZSB9IDogbnVsbFxuICAgIH0sXG4gICAgc3Ryb2tlOiB7dmFsdWU6ICdibGFjayd9LFxuICAgIHN0cm9rZU9wYWNpdHk6IHsgICAgICBjb25kaXRpb246IHsgcGFyYW06IFwicmF5X2FuZ2xlX2luXCIsIHZhbHVlOiAxIH0sXG4gICAgICB2YWx1ZTogMC4xLFxufSxcbiAgICAvKnN0cm9rZVdpZHRoOiB7XG4gICAgICBjb25kaXRpb246IHsgcGFyYW06IFwicmF5X2FuZ2xlX2luXCIsIHZhbHVlOiAyIH0sXG4gICAgICB2YWx1ZTogMSxcbiAgICB9LCovXG4gICAgY29sb3I6IHtcbiAgICAgIGNvbmRpdGlvbjogeyBwYXJhbTogXCJyYXlfYW5nbGVfaW5cIiwgdmFsdWU6IFwicmVkXCIgfSxcbiAgICAgIC8vXCJkYXR1bVwiOiB7XG4gICAgICAgIC8vXCJ2YWx1ZVwiOiBcIjFcIixcbiAgICAgIC8vfSxcbiAgICAgIHNjYWxlOiB7ZG9tYWluOiBbMiwzLDQsNSw2LDddLHJhbmdlOiBbXCJoc2woMjUwLCA3NiUsIDYwJSlcIixcImhzbCgyNTAsIDc2JSwgNzIlKVwiLFwiaHNsKDIwMCwgNzYlLCA2MCUpXCIsXCJoc2woMjAwLCA3NiUsIDcyJSlcIixcImhzbCgxMDAsIDc2JSwgNjAlKVwiLFwiaHNsKDEwMCwgNzYlLCA3MiUpXCJdfSxcbiAgICAgIGZpZWxkOiBcInJfaGl0X3ZfX3JfaGl0X2hfb3JfdlwiLFxuICAgICAgLy90eXBlOiBcIm5vbWluYWxcIixcbiAgICAgIGxlZ2VuZDogZ3VpZGVzXG4gICAgfSxcbiAgICBvcGFjaXR5OiB7XG4gICAgICBmaWVsZDogJ3JheV9kaXN0YW5jZScsXG4gICAgICBsZWdlbmQ6IGd1aWRlcyxcbiAgICAgIHNjYWxlOiB7ZG9tYWluOiBbMCwxNV0sIHJhbmdlOiBbMSwuMV19LFxuICAgICAgdHlwZTogJ3F1YW50aXRhdGl2ZSdcbiAgICB9XG4gIH0sXG4gIHBhcmFtczogW1xuICAgIHtcbiAgICAgIG5hbWU6IFwicGxheWVyX2FuZ2xlX2luXCIsXG4gICAgICB2YWx1ZTogeyBwbGF5ZXJfYW5nbGVfaW46IDAgfSxcbiAgICAgIHNlbGVjdDoge1xuICAgICAgICB0eXBlOiBcInBvaW50XCIsXG4gICAgICAgIC8vb246IFwibW91c2Vtb3ZlezAsNTB9XCIsXG4gICAgICAgIG9uOiBcIlt0b3VjaGRvd24sIHRvdWNodXBdID4gdG91Y2htb3ZlLCBbbW91c2Vkb3duLCBtb3VzZXVwXSA+IG1vdXNlbW92ZVwiLCAvL3sxMCwgMTAwfVwiLFxuICAgICAgICAvLyAgICAgICAgb246IFwiW21vdXNlZG93biwgbW91c2V1cF0gPiBtb3VzZW1vdmVcIixcbiAgICAgICAgbmVhcmVzdDogdHJ1ZSxcbiAgICAgICAgdG9nZ2xlOiBmYWxzZSxcbiAgICAgICAgY2xlYXI6IGZhbHNlLFxuICAgICAgICBlbmNvZGluZ3M6IFtcInhcIl1cbiAgICAgIH1cbiAgICB9LFxuXG4gICAge1xuICAgICAgbmFtZTogXCJyYXlfYW5nbGVfaW5cIixcbiAgICAgIHZhbHVlOiB7IHJheV9hbmdsZV9pbjogMCB9LFxuICAgICAgc2VsZWN0OiB7XG4gICAgICAgIHR5cGU6IFwicG9pbnRcIixcbiAgICAgICAgLy9vbjogXCJtb3VzZW1vdmV7MCw1MH1cIixcbiAgICAgICAgb246IFwibW91c2Vtb3ZlXCIsIC8vezEwLCAxMDB9XCIsXG4gICAgICAgIC8vICAgICAgICBvbjogXCJbbW91c2Vkb3duLCBtb3VzZXVwXSA+IG1vdXNlbW92ZVwiLFxuICAgICAgICBuZWFyZXN0OiB0cnVlLFxuICAgICAgICB0b2dnbGU6IGZhbHNlLFxuICAgICAgICBjbGVhcjogZmFsc2UsXG4gICAgICAgIGVuY29kaW5nczogW1wieFwiXVxuICAgICAgfVxuICAgIH0sXG5cbiAgICB7XG4gICAgICBuYW1lOiBcImZvcm11bGFcIixcbiAgICAgIC8vdmFsdWU6IHsgcmF5X2FuZ2xlX2luOiAwIH0sXG4gICAgICBzZWxlY3Q6IHtcbiAgICAgICAgdHlwZTogXCJwb2ludFwiLFxuICAgICAgICAvL29uOiBcIm1vdXNlbW92ZXswLDUwfVwiLFxuICAgICAgICBvbjogXCJtb3VzZWRvd25cIiwgLy97MTAsIDEwMH1cIixcbiAgICAgICAgLy8gICAgICAgIG9uOiBcIlttb3VzZWRvd24sIG1vdXNldXBdID4gbW91c2Vtb3ZlXCIsXG4gICAgICAgIG5lYXJlc3Q6IHRydWUsXG4gICAgICAgIHRvZ2dsZTogZmFsc2UsXG4gICAgICAgIGNsZWFyOiBmYWxzZSxcbiAgICAgICAgZW5jb2RpbmdzOiBbXCJ5XCJdXG4gICAgICB9XG4gICAgfVxuICBdXG59KSB9XG5cbnBsYXllcl9hbmdsZV9pbiA9IHJheWNhc3RpbmcyLnBsYXllcl9hbmdsZSh7a2V5c19zdHJlYW1fZnVuY3Rpb25faW4sXG5rZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBmX2lufSlcblxuLy8gYWRkIGFkZGl0aW9uYWwgZm9yIHNpZ25hbGxlZCByYXkgYW5nbGUgZXhhY3RseT8/XG5zY2VuZV9kYXRhID0gY2FsY3V2ZWdhZGF0YSh7XG4gICRzY2hlbWE6IFwiaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby9zY2hlbWEvdmVnYS1saXRlL3Y1Lmpzb25cIixcbiAgbW9kZWxzOiBbcmF5Y2FzdGluZzIyMl0sXG4gIHNwZWM6ICh7Li4uc2NlbmVfc3BlYywgYToge2ZpZWxkOiAncl9oaXRfdicsIGI6IHtmaWVsZDoncl9oaXRfaF9vcl92J319fSksXG4gIGRvbWFpbnM6IHtcbiAgICAvL3N0ZXBfaW46IF8ucmFuZ2UoMCwgOC4xLCAxKSxcbiAgICByYXlfYW5nbGVfaW46IF8ucmFuZ2UoLTEgLyAyLCAxLjAxIC8gMiwgcmF5X2FuZ2xlX3N0ZXBfc2l6ZSkubWFwKChkKSA9PiBkICsgcGxheWVyX2FuZ2xlX2luKSAvL1tyYXlfYW5nbGVfaW4sIHJheV9hbmdsZV9pbiArIDAuNCwgcmF5X2FuZ2xlX2luIC0gMC40XVxuICB9LFxuICBpbnB1dF9jdXJzb3JzOiBbXG4gICAge1xuICAgICAgZmlzaGV5ZV9jb3JyZWN0aW9uX2luLFxua2V5c19zdHJlYW1fZnVuY3Rpb25faW4sXG5rZXlzX3N0cmVhbV92ZXJzaW9uX2luLCBmX2luLFxuLy9wbGF5ZXJfYW5nbGVfaW4gLyogbmVlZGVkIGZvciBmaXNoZXllICovXG4gICAgfVxuICBdXG59KS5tYXAoZCA9PiAoey4uLmQsIHJfaGl0X3ZfX3JfaGl0X2hfb3JfdjogMipkLnJfaGl0X3YrKGQucl9oaXRfaF9vcl92ID09ICdoJyA/IDEgOiAwKX0pKVxuLy98IG91dHB1dDogZmFsc2Vcbi8vfCBcbnNjZW5lX3VwZGF0ZXMgPSB7XG4gIC8vc2NlbmUuc2lnbmFsKFwicmF5X2FuZ2xlX2luXCIsIHJheV9hbmdsZV9pbik7IGNhdXNlcyBpbmZpbml0ZSByZS1ydW5zXG4gIHNjZW5lLmRhdGEoXCJzb3VyY2VcIiwgc2NlbmVfZGF0YSkucmVzaXplKCkucnVuKCk7XG4gIC8vc2NlbmUyLmRhdGEoXCJzb3VyY2VcIiwgc2NlbmVfZGF0YSkucmVzaXplKCkucnVuKCk7XG59XG5cbnNjZW5lLmFkZFNpZ25hbExpc3RlbmVyKFwicmF5X2FuZ2xlX2luXCIsIChhLCBiKSA9PiB7XG4gIG11dGFibGUgc2hvd19yYXkgPSB0cnVlO1xuICBzZXQodmlld29mIHJheV9hbmdsZV9pbiwgYi5yYXlfYW5nbGVfaW5bMF0pXG59KVxuXG5yYXlfYW5nbGVfaW5cblxuc2NlbmVfZGF0YVxuXG5tanNfcV9ldmFsXG5cbmZuc193aXRoX21qc19xX2V2YWxcblxuSW5wdXRzLmJpbmQoSW5wdXRzLnJhbmdlKFstMTAwLDEwMF0sIHtzdGVwOiAwLjF9KSwgdmlld29mIHJheV9hbmdsZV9pbilcbi8vSW5wdXRzLmJpbmQoSW5wdXRzLnJhbmdlKFstMTAwLDEwMF0sIHtzdGVwOiAwLjF9KSwgdmlld29mIHBsYXllcl9hbmdsZV9pbilcbklucHV0cy5iaW5kKElucHV0cy5yYW5nZShbLTEwLDEwXSwge3N0ZXA6MX0pLCB2aWV3b2YgeWVhcl9pbilcblxudmlld29mIG9wYWNpdHlfdmVydGljYWwgPSBJbnB1dHMucmFuZ2UoWzAsIDFdLCB7XG4gIHN0ZXA6IDAuMSxcbiAgdmFsdWU6IDAuNSxcbiAgbGFiZWw6IFwidmVydFwiXG59KVxuXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG5cbi8vLy8vLy8vLy8gbGV2ZWwgdmlzdWFsXG5cbi8vIGNvb3JkaW5hdGUgc2hvd19yYXlfc3RlcHNcbntcbiAgZm9ybXVsYWVfdmlzaWJsZS5mb3JFYWNoKGYgPT4ge1xuICAgIC8vaWYgKE9iamVjdC52YWx1ZXMoaW50cm9zcGVjdGlvbl9ub21lbW8uY3VsX2Z1bmN0aW9ucykuZmluZChkID0+IGQubmFtZSA9PSBmICYmIGQuaW5wdXRzLmluY2x1ZGVzKCdzdGVwX2luJykpKVxuICAgICAgLy9zZXQodmlld29mIHNob3dfcmF5X3N0ZXBzLCB0cnVlKVxuICB9KVxufVxuXG4vKntcbiAgaWYgKCFzaG93X3JheSkgc2V0KHZpZXdvZiBzaG93X3JheV9zdGVwcywgZmFsc2UpXG59Ki9cblxuc2hvd19yYXlfc3RlcHNcblxuLy8gY29vcmRpbmF0ZSBzaG93X3JheVxubXV0YWJsZSBzaG93X3JheSA9IGZhbHNlXG5cbnNob3dfcmF5XG5cbmxldmVsLmFkZFNpZ25hbExpc3RlbmVyKCdzdGVwX2luJywgKF8sYikgPT4ge1xuICBzZXQodmlld29mIHN0ZXBfaW4sIGJbMF0pXG4gIC8vIFRPRE8gcHJvY2VzcyB0aGUgZm9ybXVsYSBwYXJ0IFsxXVxuICBjb25zb2xlLmxvZyhiKTtcbn0pXG5cblxubGV2ZWwuYWRkU2lnbmFsTGlzdGVuZXIoXCJyaHZcIiwgKGEsIGIpID0+IHtcbiAgc2V0KHZpZXdvZiBmb3JtdWxhZV92aXNpYmxlLCBbXCJyaHZcIl0pXG4gIHNldCh2aWV3b2Ygc3RlcF9pbiwgYilcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhbGN1bGFuZ19mXycrXCJyaHZcIikuc2Nyb2xsSW50b1ZpZXcoc2Nyb2xsSW50b1ZpZXdPcHRzKVxuIC8vfVxufSlcblxubGV2ZWwuYWRkU2lnbmFsTGlzdGVuZXIoXCJydnZcIiwgKGEsIGIpID0+IHtcbiAgc2V0KHZpZXdvZiBmb3JtdWxhZV92aXNpYmxlLCBbXCJydnZcIl0pXG4gIHNldCh2aWV3b2Ygc3RlcF9pbiwgYilcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhbGN1bGFuZ19mXycrXCJydnZcIikuc2Nyb2xsSW50b1ZpZXcoc2Nyb2xsSW50b1ZpZXdPcHRzKVxuIC8vfVxufSlcblxuXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEzIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG5cbnZpZXdvZiBsZXZlbCA9IGVtYmVkKGxldmVsX3NwZWMsIHtyZW5kZXJlcjogJ3N2ZycsIGFjdGlvbnN9KVxuXG5cblxuXG5yYXlfc3RlcHNfZGF0YWZmID0gIGNhbGN1dmVnYWRhdGEoe1xuICBtb2RlbHM6IFtyYXljYXN0aW5nMl0sXG4gIHNwZWM6IHJheV9zdGVwc19zcGVjLFxuICBkb21haW5zOiB7XG4gICAgc3RlcF9pbjogXy5yYW5nZSgwLDguMSlcbiAgfSxcbiAgaW5wdXRfY3Vyc29yczogW3tmaXNoZXllX2NvcnJlY3Rpb25faW4sXG4gICAga2V5c19zdHJlYW1fZnVuY3Rpb25faW4sXG4gICAga2V5c19zdHJlYW1fdmVyc2lvbl9pbixcbiAgICBmX2luLFxuICAgIHJheV9hbmdsZV9pbiwgZmlzaGV5ZV9jb3JyZWN0aW9uX2luXG4gIH1dXG59KVxuXG5jID0ge3JldHVybiAoe2tleXNfc3RyZWFtX2Z1bmN0aW9uX2luLFxuICAgIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sXG4gICAgZl9pbixcbiAgICByYXlfYW5nbGVfaW4sIGZpc2hleWVfY29ycmVjdGlvbl9pbiAvKiBpcnJlbGV2YW50IGJ1dC4uICovfSl9XG5cblxuXG5yYXlfaF9kYXRhID0gXy5yYW5nZSgwLHJheWNhc3RpbmcyLnJoX2hpdF9zdGVwKHsuLi5jfSkrMC4xKS5tYXAoc3RlcF9pbiA9PiAoe1xuICByaHg6IHJheWNhc3RpbmcyLnJoeCh7Li4uYywgc3RlcF9pbn0pLFxuICByaHk6IHJheWNhc3RpbmcyLnJoeSh7Li4uYywgc3RlcF9pbn0pLFxuICBzdGVwX2luLCBmaXNoZXllX2NvcnJlY3Rpb25faW5cbn0pKVxuXG5cbnJheV92X2RhdGEgPSBfLnJhbmdlKDAscmF5Y2FzdGluZzIucnZfaGl0X3N0ZXAoey4uLmN9KSswLjEpLm1hcChzdGVwX2luID0+ICh7XG4gIHJ2eDogcmF5Y2FzdGluZzIucnZ4KHsuLi5jLCBzdGVwX2lufSksXG4gIHJ2eTogcmF5Y2FzdGluZzIucnZ5KHsuLi5jLCBzdGVwX2lufSksXG4gIHN0ZXBfaW4sIGZpc2hleWVfY29ycmVjdGlvbl9pblxufSkpXG5cblxuXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE0IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG5tdXRhYmxlIGFhYSA9IFtdXG5cbnZpZXdvZiByZWZyZXNoID0gSW5wdXRzLmJ1dHRvbihcImhvdCByZWxvYWRcIilcblxucmF5Y2FzdGluZzIyMiA9IGFhYVt2ZXJzaW9uXVxuXG5yYXljYXN0aW5nX2xhdGVzdCA9IGF3YWl0IHJlcXVpcmUoYGh0dHA6Ly9sb2NhbGhvc3Q6ODA4MC9yYXljYXN0aW5nL3JheWNhc3RpbmcuanM/JHtyZWZyZXNofSR7RGF0ZS5ub3coKX1gKTtcbnJheWNhc3RpbmcyID0gYXdhaXQgcmVxdWlyZShgaHR0cDovL2xvY2FsaG9zdDo4MDgwL3JheWNhc3RpbmcvcmF5Y2FzdGluZy5qcz8ke3JlZnJlc2h9JHtEYXRlLm5vdygpfWApO1xuc2ltcGxlX2xvYW4gPSBhd2FpdCByZXF1aXJlKGBodHRwczovL2NhbGN1bGFuZy5kZXYvbW9kZWxzL3NpbXBsZS1sb2FuL3NpbXBsZS1sb2FuLmpzYCk7XG4vL2VtaXNzaW9uc19teV9saWZldGltZSA9IC8vYXdhaXQgcmVxdWlyZShgaHR0cDovL2xvY2FsaG9zdDo4MDgwL2VtaXNzaW9ucy1teS1saWZldGltZS9lbWlzc2lvbnMtbXktbGlmZXRpbWUuanM/JHtyZWZyZXNofSR7RGF0ZS5ub3coKX1gKTtcblxuXG4vL2h0bC5odG1sYDxidXR0b24gb25jbGljaz0keygpID0+IChtdXRhYmxlIGFhYSA9IFsuLi5tdXRhYmxlIGFhYSwgcmF5Y2FzdGluZ19sYXRlc3RdKX0+cmVmcmVzaCAyPC9idXR0b24+YFxuXG52aWV3b2YgdmVyc2lvbiA9IElucHV0cy5yYW5nZShbLTEsMTBdLCB7bGFiZWw6ICdob3QgcmVsb2FkIHZlcnNpb24nLCB2YWx1ZTogLTEsIHN0ZXA6MX0pXG5cblxuLy9odGwuaHRtbGA8YnV0dG9uIG9uY2xpY2s9JHsoKSA9PiAobXV0YWJsZSBzY2VuZV9kYXRhMCA9IHNjZW5lX2RhdGEpfT5pbnNlcnQgZGF0YSAtPiB2ZWdhIGVkaXRvciAoZGV2KTwvYnV0dG9uPmBcblxudmlld29mIGd1aWRlcyA9IElucHV0cy50b2dnbGUoeyBsYWJlbDogXCJndWlkZXNcIiwgdmFsdWU6IGZhbHNlIH0pXG5cbi8vdmlld29mIG1vZGVsX3ggPSBJbnB1dHMucmFuZ2UoWzAsMTBdLCB7c3RlcDoxLCBsYWJlbDogJ21vZGVsIHZlcnNpb24nfSlcblxudmlld29mIHJheV9hbmdsZV9zdGVwX3NpemUgPSBJbnB1dHMuc2VsZWN0KFswLjAyLDAuMDEsMC4wMDVdLCB7bGFiZWw6ICdzdGVwIHNpemUgKHJlc29sdXRpb24pJywgdmFsdWU6IDAuMDF9KVxuXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE1IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG5pbXBvcnQgeyBjYWxjdXZlZ2FkYXRhIH0gZnJvbSBcImJhYWZhNGIwNzFhNWI2NmFcIlxuXG5pbXBvcnQge1NjcnViYmVyfSBmcm9tIFwiQG1ib3N0b2NrL3NjcnViYmVyXCJcblxua2V5c19zdHJlYW1fZnVuY3Rpb25faW4gPSAoYSkgPT4gW1xuICAgICAgICAuLi5rZXlzX3NoYXJlZF1cblxubGV2ZWxfZGF0YSA9IGNhbGN1dmVnYWRhdGEoe1xuICBtb2RlbHM6IFtyYXljYXN0aW5nMl0sXG4gIHNwZWM6IHJheXMsXG4gIGRvbWFpbnM6IHtcbiAgICBzdGVwX2luOiBfLnJhbmdlKDAsIDguMSwgMSksXG4gICAgcmF5X2FuZ2xlX2luOiBbcmF5X2FuZ2xlX2luLCBdLC8vXy5yYW5nZSgtMSAvIDIsIDEuMDEgLyAyLCAvKjAuMDI1KjIwIFJPVU5ESU5HIENBVVNFUyBCVUcgVE8gTk9UIFNIT1cqLykubWFwKChkKSA9PiBkICsgcmF5X2FuZ2xlX2luKSAvL1tyYXlfYW5nbGVfaW4sIHJheV9hbmdsZV9pbiArIDAuNCwgcmF5X2FuZ2xlX2luIC0gMC40XVxuICB9LFxuICBpbnB1dF9jdXJzb3JzOiBbeyAgICAgICBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbixcbmtleXNfc3RyZWFtX3ZlcnNpb25faW4sIGZfaW4sIGZpc2hleWVfY29ycmVjdGlvbl9pblxuLy9wbGF5ZXJfYW5nbGUwX2luLy86IHJheV9hbmdsZV9pblxuXG5cbn1dXG59KVxuXG5cbmZvdl9jdXJzb3IgPSB7IHJldHVybiAoeyAgICBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbixcbiAgICBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLFxuICAgIGZfaW4sXG59KX1cbmZvdl9kYXRhID0gW3tpZDowLCB4OnJheWNhc3RpbmcyLnBsYXllcl94KGZvdl9jdXJzb3IpLCB5OnJheWNhc3RpbmcyLnBsYXllcl95KGZvdl9jdXJzb3IpfSx7aWQ6MSwgeDpyYXljYXN0aW5nMi5ydngoey4uLmZvdl9jdXJzb3IsIHN0ZXBfaW46IDEwLCByYXlfYW5nbGVfaW46IHBsYXllcl9hbmdsZV9pbi0uNX0pLCB5OnJheWNhc3RpbmcyLnJ2eSh7Li4uZm92X2N1cnNvciwgc3RlcF9pbjogMTAsIHJheV9hbmdsZV9pbjogcGxheWVyX2FuZ2xlX2luLS41fSl9LHtpZDoxLCB4OnJheWNhc3RpbmcyLnJ2eCh7Li4uZm92X2N1cnNvciwgc3RlcF9pbjogMTAsIHJheV9hbmdsZV9pbjogcGxheWVyX2FuZ2xlX2luKy41fSksIHk6cmF5Y2FzdGluZzIucnZ5KHsuLi5mb3ZfY3Vyc29yLCBzdGVwX2luOiAxMCwgcmF5X2FuZ2xlX2luOiBwbGF5ZXJfYW5nbGVfaW4rLjV9KX1dXG5cbnBsYXllcl9kYXRhID0gIGNhbGN1dmVnYWRhdGEoe1xuICBtb2RlbHM6IFtyYXljYXN0aW5nMl0sXG4gIHNwZWM6IHBsYXllcl9zcGVjLFxuICBkb21haW5zOiB7XG4gIH0sXG4gIGlucHV0X2N1cnNvcnM6IFt7XG4gICAga2V5c19zdHJlYW1fZnVuY3Rpb25faW4sXG4gICAga2V5c19zdHJlYW1fdmVyc2lvbl9pbixcbiAgICBmX2luLCBmaXNoZXllX2NvcnJlY3Rpb25faW5cbiAgfV1cbn0pXG5cbnJheV9zdGVwc19kYXRhID0gIGNhbGN1dmVnYWRhdGEoe1xuICBtb2RlbHM6IFtyYXljYXN0aW5nMl0sXG4gIHNwZWM6IHJheV9zdGVwc19zcGVjLFxuICBkb21haW5zOiB7XG4gICAgc3RlcF9pbjogXy5yYW5nZSgwLDguMSlcbiAgfSxcbiAgaW5wdXRfY3Vyc29yczogW3tcbiAgICBrZXlzX3N0cmVhbV9mdW5jdGlvbl9pbixcbiAgICBrZXlzX3N0cmVhbV92ZXJzaW9uX2luLFxuICAgIGZfaW4sXG4gICAgcmF5X2FuZ2xlX2luLCBmaXNoZXllX2NvcnJlY3Rpb25faW5cbiAgfV1cbn0pXG5cbmNcblxucmF5c19odl9kYXRhID0gIGNhbGN1dmVnYWRhdGEoe1xuICBtb2RlbHM6IFtyYXljYXN0aW5nMl0sXG4gIHNwZWM6ICAgICAgW3tmaWVsZDogJ3J2X2hpdF94J30sIHtmaWVsZDogJ3J2X2hpdF95J30se2ZpZWxkOiAncmhfaGl0X3gnfSwge2ZpZWxkOiAncmhfaGl0X3knfSwgICB7ZmllbGQ6ICdwbGF5ZXJfeCd9LCB7ZmllbGQ6ICdwbGF5ZXJfeSd9XVxuLFxuICBkb21haW5zOiB7XG4gICAgLy9zdGVwX2luOiBfLnJhbmdlKDAsOC4xKVxuICB9LFxuICBpbnB1dF9jdXJzb3JzOiBbe1xuICAgIGtleXNfc3RyZWFtX2Z1bmN0aW9uX2luLFxuICAgIGtleXNfc3RyZWFtX3ZlcnNpb25faW4sXG4gICAgZl9pbixcbiAgICByYXlfYW5nbGVfaW4sIGZpc2hleWVfY29ycmVjdGlvbl9pblxuICB9XVxufSlcblxuXG5tYXBfZGF0YSA9IF8ucmFuZ2UoMC41LDgpLm1hcCh4X2luID0+IF8ucmFuZ2UoMC41LDgpLm1hcCh5X2luID0+ICh7eF9pbiwgeV9pbiwgbWFwX2xvb2t1cDogcmF5Y2FzdGluZzIubWFwX2xvb2t1cCh7eF9pbix5X2lufSl9KSkpLmZsYXQoKVxuXG51cGRhdGVzX2xldmVsID0ge1xuICBpZiAocmF5X2FuZ2xlX2luICE9IG51bGwpXG4gIC8vbGV2ZWwuc2lnbmFsKFwicmF5X2FuZ2xlX2luXCIsIHJheV9hbmdsZV9pbik7XG4gIGxldmVsXG4gICAgLmRhdGEoXCJzb3VyY2VcIiwgbGV2ZWxfZGF0YSkgLyoucmVzaXplKCkqL1xuICAgIC5ydW4oKTtcbn1cblxubGV2ZWwuZGF0YSgncGxheWVyX2RhdGEnLCBwbGF5ZXJfZGF0YSkucnVuKClcbmxldmVsLmRhdGEoJ3JheV9zdGVwc19kYXRhJywgcmF5X3N0ZXBzX2RhdGEpLnJ1bigpXG5sZXZlbC5kYXRhKCdyYXlfaF9kYXRhJywgcmF5X2hfZGF0YSkucnVuKClcbmxldmVsLmRhdGEoJ3JheV92X2RhdGEnLCByYXlfdl9kYXRhKS5ydW4oKVxubGV2ZWwuZGF0YSgncmF5c19odl9kYXRhJywgcmF5c19odl9kYXRhKS5ydW4oKVxuXG5sZXZlbC5zaWduYWwoJ3BsYXllcl9hbmdsZV9pbicsIHBsYXllcl9hbmdsZV9pbikucnVuKClcblxuXG5cbnVwZGF0ZXNfZm92ID0ge1xuICBsZXZlbFxuICAgIC5kYXRhKFwiZm92XCIsIGZvdl9kYXRhKSAvKi5yZXNpemUoKSovXG4gICAgLnJ1bigpO1xufVxuXG5cbm11dGFibGUgc2NlbmVfZGF0YTAgPSBbXVxubXV0YWJsZSBsZXZlbF9kYXRhMCA9IFtdIC8vIGluY2x1ZGVzIGRhdGEgaW4gc3BlYyBmb3Igd2hlbiBJIE9wZW4gaW4gVmVnYSBFZGl0b3Jcbm11dGFibGUgZm92X2RhdGEwID0gW10gXG5cbnJheXMgPSB7cmV0dXJuIFtcbntcbiAgICAgIGZyb206IHsgZGF0YTogXCJzb3VyY2VcIiB9LFxuICAgICAgdHlwZTogXCJzeW1ib2xcIixcbiAgICAgIGVuY29kZToge1xuICAgICAgICBlbnRlcjoge1xuICAgICAgICAgIHg6IHsgZmllbGQ6IFwicl9oaXRfeFwiLCBzY2FsZTogXCJ4XCIgfSxcbiAgICAgICAgICB5OiB7IGZpZWxkOiBcInJfaGl0X3lcIiwgc2NhbGU6IFwieVwiIH0sXG4gICAgICAgICAgc2l6ZTogeyBmaWVsZDogXCJyYXlfZGlzdGFuY2VcIiwgc2NhbGU6IFwibGVuZ3RoXCIgfSxcbiAgICAgICAgICBmaWxsOiB7IHZhbHVlOiBcIm9yYW5nZVwiIH0sXG4gICAgICAgICAgLy9vcGFjaXR5OiB7dmFsdWU6IDAuNH0sXG4gICAgICAgICAgZmlsbE9wYWNpdHk6IHt2YWx1ZTogMC4xfSxcbiAgICAgICAgICBzdHJva2U6IHsgdmFsdWU6IFwiYmxhY2tcIiB9LFxuICAgICAgICAgIHNoYXBlOiB7IHZhbHVlOiBcIk0gLTAuMSAtMC40IEwgMC4zIC0wLjcgTCAwLjIgLTAuMSBMIDAuOCAwIEwgMC4yIDAuNSBMIDAuMiAwLjkgTCAtMC4xIDAuMSBMIC0wLjMgMC42IEwgLTAuNCAtMC42XCIgfSAvLyBtYWRlIHdpdGggaHR0cHM6Ly95cW5uLmdpdGh1Yi5pby9zdmctcGF0aC1lZGl0b3IvXG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZToge1xuICAgICAgICAgIHg6IHsgZmllbGQ6IFwicl9oaXRfeFwiLCBzY2FsZTogXCJ4XCIgfSxcbiAgICAgICAgICB5OiB7IGZpZWxkOiBcInJfaGl0X3lcIiwgc2NhbGU6IFwieVwiIH0sXG4gICAgICAgICAgc2l6ZTogeyBmaWVsZDogXCJyYXlfZGlzdGFuY2VcIiwgc2NhbGU6IFwibGVuZ3RoXCIgfSxcbiAgICAgICAgfVxuICAgICAgfVxuXG59LFxuKHtcbiAgZnJvbTogeyBkYXRhOiBcInNvdXJjZVwiIH0sXG4gIC8vbWFyazoge3R5cGU6IFwicnVsZVwiLCBjbGlwOiB0cnVlfSxcbiAgdHlwZTogJ3J1bGUnLFxuICBlbmNvZGU6IHtcbiAgICBlbnRlcjoge1xuICAgICAgc3Ryb2tlOiB7IHZhbHVlOiBcInJlZFwiIH0sXG4gICAgICBzdHJva2VXaWR0aDogeyB2YWx1ZTogMyB9LFxuICAgICAgc3Ryb2tlT3BhY2l0eTogeyB2YWx1ZTogMC41IH0sXG4gICAgICBzdHJva2VEYXNoOiB7dmFsdWU6IFs4LDhdfVxuICAgIH0sXG4gICAgdXBkYXRlOiB7XG4gICAgICB4OiB7IGZpZWxkOiBcInBsYXllcl94XCIsIHNjYWxlOiBcInhcIiB9LFxuICAgICAgeTogeyBmaWVsZDogXCJwbGF5ZXJfeVwiLCBzY2FsZTogXCJ5XCIgfSxcbiAgICAgIHgyOiB7IGZpZWxkOiBcInJfaGl0X3hcIiwgc2NhbGU6IFwieFwiIH0sXG4gICAgICB5MjogeyBmaWVsZDogXCJyX2hpdF95XCIsIHNjYWxlOiBcInlcIiB9XG4gICAgICAvL3N0cm9rZTogeyBmaWVsZDogXCJyYXlfYW5nbGVfaW5cIiB9XG4gICAgfVxuICB9XG59KV19XG5cblxuaGl0cyA9IHtyZXR1cm4gKHtcbiAgICAgIC8vXG4gICAgfSl9XG5cblxuZm92X3NwZWMgPSB7cmV0dXJuICh7XG4gIGZyb206IHsgZGF0YTogXCJmb3ZcIiB9LFxuICB0eXBlOiBcImxpbmVcIixcbiAgZW5jb2RlOiB7XG4gICAgZW50ZXI6IHtcbiAgICAgIHN0cm9rZTogeyB2YWx1ZTogXCIjMEZGRjUwXCIgfSxcbiAgICAgIHN0cm9rZVdpZHRoOiB7IHZhbHVlOiA1LjAxIH0sXG4gICAgICBzdHJva2VPcGFjaXR5OiB7IHZhbHVlOiAxIH0sXG4gICAgICBpbnRlcnBvbGF0ZToge3ZhbHVlOiAnbGluZWFyLWNsb3NlZCd9XG4gICAgfSxcbiAgICB1cGRhdGU6IHtcbiAgICAgIHg6IHsgZmllbGQ6IFwieFwiLCBzY2FsZTogXCJ4XCIgfSxcbiAgICAgIHk6IHsgZmllbGQ6IFwieVwiLCBzY2FsZTogXCJ5XCIgfSxcbiAgICAgIGZpbGw6IHsgdmFsdWU6IFwiZ3JlZW5cIiB9LFxuICAgICAgZmlsbE9wYWNpdHk6IHt2YWx1ZTogMC4yfVxuICAgICAgLy94MjogeyBmaWVsZDogXCJydnhcIiwgc2NhbGU6IFwieFwiIH0sXG4gICAgICAvL3kyOiB7IGZpZWxkOiBcInJ2eVwiLCBzY2FsZTogXCJ5XCIgfVxuICAgICAgLy9zdHJva2U6IHsgZmllbGQ6IFwicmF5X2FuZ2xlX2luXCIgfVxuICAgIH1cbiAgfVxufSl9XG5cbm1hcF9zcGVjID0ge3JldHVybiAoe1xuICBmcm9tOiB7IGRhdGE6IFwibWFwX2RhdGFcIiB9LFxuICB0eXBlOiBcInJlY3RcIixcbiAgZW5jb2RlOiB7XG4gICAgZW50ZXI6IHtcbiAgICAgIHg6IHsgc2lnbmFsOiBcImZsb29yKGRhdHVtLnhfaW4pXCIsIHNjYWxlOiAneCcgfSxcbiAgICAgIHgyOiB7IHNpZ25hbDogXCJmbG9vcihkYXR1bS54X2luKSsxLTAuMDVcIiwgc2NhbGU6ICd4JyB9LFxuICAgICAgeTogeyBzaWduYWw6IFwiZmxvb3IoZGF0dW0ueV9pbilcIiAsIHNjYWxlOiAneSd9LFxuICAgICAgeTI6IHsgc2lnbmFsOiBcImZsb29yKGRhdHVtLnlfaW4pKzEtMC4wNVwiLCBzY2FsZTogJ3knIH0sXG4gICAgICBmaWxsOiB7IGZpZWxkOiAnbWFwX2xvb2t1cCcsIHNjYWxlOiAnbWFwX2xvb2t1cCd9XG4gICAgICAvL2NvbG9yOiB7IGZpZWxkOiBcImZsb29yKGRhdHVtLnlfaW4pKzFcIiB9LFxuXG4gICAgfSxcbiAgfVxufSl9XG5cblxucGxheWVyX3NwZWMgPSB7cmV0dXJuICh7XG4gICAgICAvLyBQTEFZRVJcbiAgICAgIGZyb206IHsgZGF0YTogXCJwbGF5ZXJfZGF0YVwiIH0sXG4gICAgICB0eXBlOiBcInN5bWJvbFwiLFxuICAgICAgZW5jb2RlOiB7XG4gICAgICAgIGVudGVyOiB7XG4gICAgICAgICAgeDogeyBmaWVsZDogXCJwbGF5ZXJfeFwiLCBzY2FsZTogXCJ4XCIgfSxcbiAgICAgICAgICB5OiB7IGZpZWxkOiBcInBsYXllcl95XCIsIHNjYWxlOiBcInlcIiB9LFxuICAgICAgICAgIHNpemU6IHsgdmFsdWU6IDUwMCB9LFxuICAgICAgICAgIGZpbGw6IHsgdmFsdWU6IFwieWVsbG93XCIgfSxcbiAgICAgICAgICBzdHJva2U6IHsgdmFsdWU6IFwiYmxhY2tcIiB9LFxuICAgICAgICAgIHNoYXBlOiB7IHZhbHVlOiBcImFycm93XCIgfVxuICAgICAgICB9LFxuICAgICAgICB1cGRhdGU6IHtcbiAgICAgICAgICB4OiB7IGZpZWxkOiBcInBsYXllcl94XCIsIHNjYWxlOiBcInhcIiB9LFxuICAgICAgICAgIHk6IHsgZmllbGQ6IFwicGxheWVyX3lcIiwgc2NhbGU6IFwieVwiIH0sXG4gICAgICAgICAgYW5nbGU6IHsgc2lnbmFsOiBcIi0xODAgLSA5MCAtIHBsYXllcl9hbmdsZV9pbiAqIDE4MCAvIFBJXCIgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSl9XG5cbiAgICBcblxuXG5yYXlfc3RlcHNfc3BlYyA9IHtyZXR1cm4gKFtcbntcbiAgICAgIC8vIEhPUklaT05UQUwgUkVEU1xuICAgICAgZnJvbTogeyBkYXRhOiBcInJheV9zdGVwc19kYXRhXCIgfSxcbiAgICAgIG5hbWU6ICdoJyxcbiAgICAgIHR5cGU6IFwic3ltYm9sXCIsXG4gICAgICBlbmNvZGU6IHtcbiAgICAgICAgZW50ZXI6IHtcbiAgICAgICAgICAvL29wYWNpdHk6IHsgdmFsdWU6IG9wYWNpdHlfdmVydGljYWwgfSxcbiAgICAgICAgICAvL29wYWNpdHk6IHsgZmllbGQ6IFwiaWZfcmF5X2hpdF9ob3Jpem9udGFsXCIsIHNjYWxlOiBcImhpdFwiIH0sXG4gICAgICAgICAgeDogeyBmaWVsZDogXCJyaHhcIiwgc2NhbGU6IFwieFwiIH0sXG4gICAgICAgICAgeTogeyBmaWVsZDogXCJyaHlcIiwgc2NhbGU6IFwieVwiIH0sXG4gICAgICAgICAgc2l6ZTogeyB2YWx1ZTogMzAwIH0sXG4gICAgICAgICAgZmlsbDogeyB2YWx1ZTogXCJyZWRcIiB9LFxuICAgICAgICAgIHNoYXBlOiB7IHZhbHVlOiBcImNpcmNsZVwiIH0sXG4gICAgICAgICAgc3Ryb2tlV2lkdGg6IHt2YWx1ZTogNX0sXG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZToge1xuICAgICAgICAgIHN0cm9rZTogeyBzaWduYWw6IFwiKGRhdHVtLnN0ZXBfaW4gPT0gc3RlcF9pblswXSAmJiBzdGVwX2luWzFdID09ICdoJykgPyAneWVsbG93JyA6IG51bGxcIn0sLy8sIHNjYWxlOiBcImhpdFwiIH0sXG4gICAgICAgICAgeDogeyBmaWVsZDogXCJyaHhcIiwgc2NhbGU6IFwieFwiIH0sXG4gICAgICAgICAgeTogeyBmaWVsZDogXCJyaHlcIiwgc2NhbGU6IFwieVwiIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAge1xuICAgICAgLy8gVkVSVElDQUwgR1JFRU5TXG4gICAgICBmcm9tOiB7IGRhdGE6IFwicmF5X3N0ZXBzX2RhdGFcIiB9LFxuICAgICAgdHlwZTogXCJzeW1ib2xcIixcbiAgICAgIG5hbWU6ICd2JyxcbiAgICAgIGVuY29kZToge1xuICAgICAgICBlbnRlcjoge1xuICAgICAgICAgIC8vb3BhY2l0eTogeyB2YWx1ZTogb3BhY2l0eV92ZXJ0aWNhbCB9LFxuICAgICAgICAgIC8vb3BhY2l0eTogeyBmaWVsZDogXCJpZl9yYXlfaGl0X3ZlcnRpY2FsXCIsIHNjYWxlOiBcImhpdFwiIH0sXG4gICAgICAgICAgeDogeyBmaWVsZDogXCJydnhcIiwgc2NhbGU6IFwieFwiIH0sXG4gICAgICAgICAgeTogeyBmaWVsZDogXCJydnlcIiwgc2NhbGU6IFwieVwiIH0sXG4gICAgICAgICAgc2l6ZTogeyB2YWx1ZTogMjAwIH0sXG4gICAgICAgICAgZmlsbDogeyB2YWx1ZTogXCJncmVlblwiIH0sXG4gICAgICAgICAgc2hhcGU6IHsgdmFsdWU6IFwiY2lyY2xlXCIgfSxcbiAgICAgICAgICBzdHJva2VXaWR0aDoge3ZhbHVlOiA1fSxcblxuICAgICAgICB9LFxuICAgICAgICB1cGRhdGU6IHtcbiAgICAgICAgICAvL29wYWNpdHk6IHsgdmFsdWU6IG9wYWNpdHlfdmVydGljYWwgfSxcbiAgICAgICAgICBzdHJva2U6IHsgc2lnbmFsOiBcIihkYXR1bS5zdGVwX2luID09IHN0ZXBfaW5bMF0gJiYgc3RlcF9pblsxXSA9PSAndicpID8gJ3llbGxvdycgOiBudWxsXCJ9LC8vLCBzY2FsZTogXCJoaXRcIiB9LFxuICAgICAgICAgIHg6IHsgZmllbGQ6IFwicnZ4XCIsIHNjYWxlOiBcInhcIiB9LFxuICAgICAgICAgIHk6IHsgZmllbGQ6IFwicnZ5XCIsIHNjYWxlOiBcInlcIiB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XSl9XG5cblxuXG5yYXlfdl9zcGVjID0ge3JldHVybiBbXG57XG4gICAgICBmcm9tOiB7IGRhdGE6IFwicmF5c19odl9kYXRhXCIgfSxcbiAgICAgIHR5cGU6IFwic3ltYm9sXCIsXG4gICAgICBlbmNvZGU6IHtcbiAgICAgICAgZW50ZXI6IHtcbiAgICAgICAgICB4OiB7IGZpZWxkOiBcInJ2X2hpdF94XCIsIHNjYWxlOiBcInhcIiB9LFxuICAgICAgICAgIHk6IHsgZmllbGQ6IFwicnZfaGl0X3lcIiwgc2NhbGU6IFwieVwiIH0sXG4gICAgICAgICAgc2l6ZTogeyBmaWVsZDogXCJyYXlfZGlzdGFuY2VcIiwgc2NhbGU6IFwibGVuZ3RoXCIgfSxcbiAgICAgICAgICBmaWxsOiB7IHZhbHVlOiBcImdyZWVuXCIgfSxcbiAgICAgICAgICAvL29wYWNpdHk6IHt2YWx1ZTogMC40fSxcbiAgICAgICAgICBmaWxsT3BhY2l0eToge3ZhbHVlOiAxfSxcbiAgICAgICAgICBzdHJva2U6IHsgdmFsdWU6IFwiYmxhY2tcIiB9LFxuICAgICAgICAgIHNoYXBlOiB7IHZhbHVlOiBcImNpcmNsZVwiIH1cbiAgICAgICAgfSxcbiAgICAgICAgdXBkYXRlOiB7XG4gICAgICAgICAgeDogeyBmaWVsZDogXCJydl9oaXRfeFwiLCBzY2FsZTogXCJ4XCIgfSxcbiAgICAgICAgICB5OiB7IGZpZWxkOiBcInJ2X2hpdF95XCIsIHNjYWxlOiBcInlcIiB9LFxuICAgICAgICAgIHNpemU6IHsgZmllbGQ6IFwicmF5X2Rpc3RhbmNlXCIsIHNjYWxlOiBcImxlbmd0aFwiIH0sXG4gICAgICAgIH1cbiAgICAgIH1cblxufSxcbih7XG4gIGZyb206IHsgZGF0YTogXCJyYXlzX2h2X2RhdGFcIiB9LFxuICAvL21hcms6IHt0eXBlOiBcInJ1bGVcIiwgY2xpcDogdHJ1ZX0sXG4gIHR5cGU6ICdydWxlJyxcbiAgZW5jb2RlOiB7XG4gICAgZW50ZXI6IHtcbiAgICAgIHN0cm9rZTogeyB2YWx1ZTogXCJncmVlblwiIH0sXG4gICAgICBzdHJva2VXaWR0aDogeyB2YWx1ZTogMTAgfSxcbiAgICAgIHN0cm9rZU9wYWNpdHk6IHsgdmFsdWU6IDEgfSxcbiAgICAgIC8vc3Ryb2tlRGFzaDoge3ZhbHVlOiBbOCw4XX1cbiAgICB9LFxuICAgIHVwZGF0ZToge1xuICAgICAgeDogeyBzaWduYWw6IFwiZGF0dW0ucGxheWVyX3grMC4wNVwiLCBzY2FsZTogXCJ4XCIgfSxcbiAgICAgIHk6IHsgc2lnbmFsOiBcImRhdHVtLnBsYXllcl95KzAuMDVcIiwgc2NhbGU6IFwieVwiIH0sXG4gICAgICB4MjogeyBzaWduYWw6IFwiZGF0dW0ucnZfaGl0X3grMC4wNVwiLCBzY2FsZTogXCJ4XCIgfSwgLy8gY2FsY3V2ZWdhZGF0YSBkb2Vzbid0IHByb2Nlc3Mgc2lnbmFsIGV4cHJlc3Npb25zIVxuICAgICAgeTI6IHsgc2lnbmFsOiBcImRhdHVtLnJ2X2hpdF95KzAuMDVcIiwgc2NhbGU6IFwieVwiIH0sXG4gICAgICBmYWtlOiB7ZmllbGQ6ICdydl9oaXRfeCd9LCBmYWtlMjoge2ZpZWxkOiAncnZfaGl0X3knfSwgICAgICBmYWtlMzoge2ZpZWxkOiAncGxheWVyX3gnfSwgZmFrZTQ6IHtmaWVsZDogJ3BsYXllcl95J31cblxuXG4gICAgICAvKng6IHsgc2lnbmFsOiBcImRhdHVtLnBsYXllcl94KzFcIiwgc2NhbGU6IFwieFwiIH0sXG4gICAgICB5OiB7IHNpZ25hbDogXCJkYXR1bS5wbGF5ZXJfeSswLjVcIiwgc2NhbGU6IFwieVwiIH0sXG4gICAgICB4MjogeyBzaWduYWw6IFwiZGF0dW0ucnZfaGl0X3grMC41XCIsIHNjYWxlOiBcInhcIiB9LFxuICAgICAgeTI6IHsgc2lnbmFsOiBcImRhdHVtLnJ2X2hpdF95KzAuNVwiLCBzY2FsZTogXCJ5XCIgfSovXG4gICAgICAvL3N0cm9rZTogeyBmaWVsZDogXCJyYXlfYW5nbGVfaW5cIiB9XG4gICAgfVxuICB9XG59KV19XG5cbnJheV9oX3NwZWMgPSB7IHJldHVybiBbXG57XG4gICAgICBmcm9tOiB7IGRhdGE6IFwicmF5c19odl9kYXRhXCIgfSxcbiAgICAgIHR5cGU6IFwic3ltYm9sXCIsXG4gICAgICBlbmNvZGU6IHtcbiAgICAgICAgZW50ZXI6IHtcbiAgICAgICAgICB4OiB7IGZpZWxkOiBcInJoX2hpdF94XCIsIHNjYWxlOiBcInhcIiB9LFxuICAgICAgICAgIHk6IHsgZmllbGQ6IFwicmhfaGl0X3lcIiwgc2NhbGU6IFwieVwiIH0sXG4gICAgICAgICAgc2l6ZTogeyBmaWVsZDogXCJyYXlfZGlzdGFuY2VcIiwgc2NhbGU6IFwibGVuZ3RoXCIgfSxcbiAgICAgICAgICBmaWxsOiB7IHZhbHVlOiBcIm9yYW5nZVwiIH0sXG4gICAgICAgICAgLy9vcGFjaXR5OiB7dmFsdWU6IDAuNH0sXG4gICAgICAgICAgZmlsbE9wYWNpdHk6IHt2YWx1ZTogMX0sXG4gICAgICAgICAgc3Ryb2tlOiB7IHZhbHVlOiBcImJsYWNrXCIgfSxcbiAgICAgICAgICBzaGFwZTogeyB2YWx1ZTogXCJjaXJjbGVcIiB9XG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZToge1xuICAgICAgICAgIHg6IHsgZmllbGQ6IFwicmhfaGl0X3hcIiwgc2NhbGU6IFwieFwiIH0sXG4gICAgICAgICAgeTogeyBmaWVsZDogXCJyaF9oaXRfeVwiLCBzY2FsZTogXCJ5XCIgfSxcbiAgICAgICAgICBzaXplOiB7IGZpZWxkOiBcInJheV9kaXN0YW5jZVwiLCBzY2FsZTogXCJsZW5ndGhcIiB9LFxuICAgICAgICB9XG4gICAgICB9XG5cbn0sKHtcbiAgZnJvbTogeyBkYXRhOiBcInJheXNfaHZfZGF0YVwiIH0sXG4gIC8vbWFyazoge3R5cGU6IFwicnVsZVwiLCBjbGlwOiB0cnVlfSxcbiAgdHlwZTogJ3J1bGUnLFxuICBlbmNvZGU6IHtcbiAgICBlbnRlcjoge1xuICAgICAgc3Ryb2tlOiB7IHZhbHVlOiBcIm9yYW5nZVwiIH0sXG4gICAgICBzdHJva2VXaWR0aDogeyB2YWx1ZTogMTAgfSxcbiAgICAgIHN0cm9rZU9wYWNpdHk6IHsgdmFsdWU6IDEgfSxcbiAgICAgIC8vc3Ryb2tlRGFzaDoge3ZhbHVlOiBbOCw4XX1cbiAgICB9LFxuICAgIHVwZGF0ZToge1xuICAgICAgeDogeyBzaWduYWw6IFwiZGF0dW0ucGxheWVyX3gtLjA1XCIsIHNjYWxlOiBcInhcIiB9LFxuICAgICAgeTogeyBzaWduYWw6IFwiZGF0dW0ucGxheWVyX3ktLjA1XCIsIHNjYWxlOiBcInlcIiB9LFxuICAgICAgeDI6IHsgc2lnbmFsOiBcImRhdHVtLnJoX2hpdF94LS4wNVwiLCBzY2FsZTogXCJ4XCIgfSxcbiAgICAgIHkyOiB7IHNpZ25hbDogXCJkYXR1bS5yaF9oaXRfeS0uMDVcIiwgc2NhbGU6IFwieVwiIH0sXG4gICAgICAgICAgICBmYWtlOiB7ZmllbGQ6ICdyaF9oaXRfeCd9LCBmYWtlMjoge2ZpZWxkOiAncmhfaGl0X3knfVxuXG4gICAgICAvL3N0cm9rZTogeyBmaWVsZDogXCJyYXlfYW5nbGVfaW5cIiB9XG4gICAgfVxuICB9XG59KSxcblxuXX1cblxuXG5cblxubGV2ZWxfc3BlYyA9IHsgcmV0dXJuICh7XG4gIGRhdGE6IFtcbiAgICB7IG5hbWU6IFwic291cmNlXCIsIHZhbHVlczogbGV2ZWxfZGF0YTAgfSwgLy8gbGF5ZXIgNSBmb3IgcmF5cyBieSBzdGVwXG4gICAgeyBuYW1lOiBcImZvdlwiLCB2YWx1ZXM6IGZvdl9kYXRhMCB9LFxuICAgIHsgbmFtZTogXCJtYXBfZGF0YVwiLCB2YWx1ZXM6IG1hcF9kYXRhIH0sXG4gICAgeyBuYW1lOiBcInBsYXllcl9kYXRhXCIsIHZhbHVlczogW10gfSxcbiAgICB7IG5hbWU6IFwiaGl0c19kYXRhXCIsIHZhbHVlczogW10gfSxcbiAgICB7IG5hbWU6IFwicmF5X3N0ZXBzX2RhdGFcIiwgdmFsdWVzOiBbXSB9LFxuICAgIHsgbmFtZTogXCJyYXlfaF9kYXRhXCIsIHZhbHVlczogW10gfSxcbiAgICB7IG5hbWU6IFwicmF5X3ZfZGF0YVwiLCB2YWx1ZXM6IFtdIH0sXG4gICAgeyBuYW1lOiBcInJheXNfaHZfZGF0YVwiLCB2YWx1ZXM6IFtdIH0sXG4gIF0sXG4gIC8vYmFja2dyb3VuZDogXCJncmV5XCIsXG4gIC8vd2lkdGg6ICdjb250YWluZXInLFxuICB3aWR0aDogNDAwLFxuICBoZWlnaHQ6IDMwMCxcbiAgYmFja2dyb3VuZDogJyNjY2MnLFxuICBzaWduYWxzOiBbXG4gICAgeyBuYW1lOiBcInBsYXllcl9hbmdsZV9pblwiIH0sXG5cblxuICAgIHtcbiAgICAgIFwibmFtZVwiOiBcInN0ZXBfaW5cIixcbiAgICAgIHZhbHVlOiBbLTEwLCc/J10sXG4gICAgICBcIm9uXCI6IFt7XCJldmVudHNcIjogXCJAaDI6bW91c2VvdmVyXCIsIFwidXBkYXRlXCI6IFwiW2RhdHVtLnN0ZXBfaW5dXCJ9LHtcImV2ZW50c1wiOiBcIkB2Mjptb3VzZW92ZXJcIiwgXCJ1cGRhdGVcIjogXCJbZGF0dW0uc3RlcF9pbl1cIix9XVxuICAgIH0sXG4gICAge1xuICAgICAgXCJuYW1lXCI6IFwicmh2XCIsXG4gICAgICB2YWx1ZTogLTEwLFxuICAgICAgXCJvblwiOiBbe1wiZXZlbnRzXCI6IFwiQGgyOmNsaWNrXCIsIFwidXBkYXRlXCI6IFwiZGF0dW0uc3RlcF9pblwifV1cbiAgICB9LFxuICAgIHtcbiAgICAgIFwibmFtZVwiOiBcInJ2dlwiLFxuICAgICAgdmFsdWU6IC0xMCxcbiAgICAgIFwib25cIjogW3tcImV2ZW50c1wiOiBcIkB2MjpjbGlja1wiLCBcInVwZGF0ZVwiOiBcImRhdHVtLnN0ZXBfaW5cIn1dXG4gICAgfVxuICBdLFxuICBzY2FsZXM6IFtcbiAgICB7IG5hbWU6IFwieFwiLCB0eXBlOiBcImxpbmVhclwiLCBkb21haW46IFswLCA4XSwgcmFuZ2U6IFwid2lkdGhcIiB9LFxuICAgIHsgbmFtZTogXCJ5XCIsIHR5cGU6IFwibGluZWFyXCIsIGRvbWFpbjogWzAsIDhdLCByYW5nZTogXCJoZWlnaHRcIiwgcmV2ZXJzZTogdHJ1ZSB9LFxuICAgIHsgbmFtZTogXCJoaXRcIiwgdHlwZTogXCJvcmRpbmFsXCIsIGRvbWFpbjogWzAsIDFdLCByYW5nZTogWzAuMDEsIDAuMV0gfSxcbiAgICB7IG5hbWU6IFwibGVuZ3RoXCIsIHR5cGU6IFwibGluZWFyXCIsIGRvbWFpbjogWzIsIDhdLCByYW5nZTogWzEwMDAsIDEwXSAgfSxcbiAgICB7IG5hbWU6IFwibGVuZ3RoMlwiLCB0eXBlOiBcImxpbmVhclwiLCBkb21haW46IFsyLCA2XSwgcmFuZ2U6IFsxMDAwLCAwXSAgfSxcbiAgICB7IG5hbWU6IFwibWFwX2xvb2t1cFwiLCB0eXBlOiBcIm9yZGluYWxcIiwgZG9tYWluOiBbMCwgMSwgMiwgM10sIHJhbmdlOiBbXCJ3aGl0ZVwiLCBcImhzbCgyNTAsIDc2JSwgNjAlKVwiLFwiaHNsKDIwMCwgNzYlLCA2MCUpXCIsXCJoc2woMTAwLCA3NiUsIDYwJSlcIl0gfVxuICBdLFxuICBtYXJrczogW1xuICAgIG1hcF9zcGVjLFxuXG4gICAgZm92X3NwZWMsXG4gICAgLi4uKHNob3dfcmF5ICYmIHNob3dfcmF5X2ggPyByYXlfaF9zcGVjIDogW10pLFxuICAgIC4uLihzaG93X3JheSAmJiBzaG93X3JheV92ID8gcmF5X3Zfc3BlYyA6IFtdKSxcbiAgICAuLi4oc2hvd19yYXkgPyByYXlzIDogW10pLFxuICAgIHBsYXllcl9zcGVjLFxuICAgIC4uLihzaG93X3JheSAmJiBzaG93X3JheV9zdGVwcyA/IHJheV9zdGVwc19zcGVjIDogW10pLFxuXG5cbi4uLihzaG93X3JheSAmJiBzaG93X3JheV9oID8gW3tcbiAgICAgIC8vIEhPUklaT05UQUwgUkVEU1xuICAgICAgZnJvbTogeyBkYXRhOiBcInJheV9oX2RhdGFcIiB9LFxuICAgICAgbmFtZTogJ2gyJyxcbiAgICAgIHR5cGU6IFwic3ltYm9sXCIsXG4gICAgICBlbmNvZGU6IHtcbiAgICAgICAgZW50ZXI6IHtcbiAgICAgICAgICBvcGFjaXR5OiB7IHZhbHVlOiAwLjEgfSxcbiAgICAgICAgICAvL29wYWNpdHk6IHsgZmllbGQ6IFwiaWZfcmF5X2hpdF9ob3Jpem9udGFsXCIsIHNjYWxlOiBcImhpdFwiIH0sXG4gICAgICAgICAgeDogeyBzaWduYWw6IFwiZGF0dW0ucmh4LTAuMDUqMFwiLCBzY2FsZTogXCJ4XCIgfSxcbiAgICAgICAgICB5OiB7IHNpZ25hbDogXCJkYXR1bS5yaHktMC4wNSowXCIsIHNjYWxlOiBcInlcIiB9LFxuICAgICAgICAgIHNpemU6IHsgdmFsdWU6IDYwMCB9LFxuICAgICAgICAgIC8vZmlsbDogeyB2YWx1ZTogXCJyZWRcIiB9LFxuICAgICAgICAgIGFuZ2xlOiB7dmFsdWU6IDQ1fSxcbiAgICAgICAgICBzaGFwZTogeyB2YWx1ZTogXCJjcm9zc1wiIH0sXG4gICAgICAgICAgc3Ryb2tlOiB7IHZhbHVlOiBcImJsYWNrXCJ9LFxuICAgICAgICAgIHN0cm9rZVdpZHRoOiB7dmFsdWU6IDJ9LFxuICAgICAgICB9LFxuICAgICAgICB1cGRhdGU6IHtcbiAgICAgICAgICBmaWxsOiB7IHNpZ25hbDogXCIoZGF0dW0uc3RlcF9pbiA9PSBzdGVwX2luWzBdKSA/ICdwaW5rJyA6IG51bGxcIn0sLy8sIHNjYWxlOiBcImhpdFwiIH0sXG4gICAgICAgICAgb3BhY2l0eTogeyBzaWduYWw6IFwiKGRhdHVtLnN0ZXBfaW4gPT0gc3RlcF9pblswXSkgPyAxIDogMC4xXCJ9LC8vLCBzY2FsZTogXCJoaXRcIiB9LFxuICAgICAgICAgIC8vc3Ryb2tlOiB7IHNpZ25hbDogXCIoZGF0dW0uc3RlcF9pbiA9PSBzdGVwX2luWzBdKSA/ICdibGFjaycgOiBudWxsXCJ9LC8vLCBzY2FsZTogXCJoaXRcIiB9LFxuICAgICAgICAgIHg6IHsgc2lnbmFsOiBcImRhdHVtLnJoeC0wLjA1KjBcIiwgc2NhbGU6IFwieFwiIH0sXG4gICAgICAgICAgeTogeyBzaWduYWw6IFwiZGF0dW0ucmh5LTAuMDUqMFwiLCBzY2FsZTogXCJ5XCIgfSxcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1dIDogW10pLFxuXG4uLi4oc2hvd19yYXkgJiYgc2hvd19yYXlfdiA/IFt7XG4gICAgICAvLyBWRVJUSUNBTCBHUkVFTlNcbiAgICAgIGZyb206IHsgZGF0YTogXCJyYXlfdl9kYXRhXCIgfSxcbiAgICAgIG5hbWU6ICd2MicsXG4gICAgICB0eXBlOiBcInN5bWJvbFwiLFxuICAgICAgZW5jb2RlOiB7XG4gICAgICAgIGVudGVyOiB7XG4gICAgICAgICAgb3BhY2l0eTogeyB2YWx1ZTogMC4xIH0sXG4gICAgICAgICAgLy9vcGFjaXR5OiB7IGZpZWxkOiBcImlmX3JheV9oaXRfaG9yaXpvbnRhbFwiLCBzY2FsZTogXCJoaXRcIiB9LFxuICAgICAgICAgIHg6IHsgc2lnbmFsOiBcImRhdHVtLnJ2eCswLjA1KjBcIiwgc2NhbGU6IFwieFwiIH0sXG4gICAgICAgICAgeTogeyBzaWduYWw6IFwiZGF0dW0ucnZ5KzAuMDUqMFwiLCBzY2FsZTogXCJ5XCIgfSxcbiAgICAgICAgICBzaXplOiB7IHZhbHVlOiA2MDAgfSxcbiAgICAgICAgICAvL2ZpbGw6IHsgdmFsdWU6IFwicmVkXCIgfSxcbiAgICAgICAgICBhbmdsZToge3ZhbHVlOiA0NX0sXG4gICAgICAgICAgc2hhcGU6IHsgdmFsdWU6IFwiY3Jvc3NcIiB9LFxuICAgICAgICAgIHN0cm9rZTogeyB2YWx1ZTogXCJibGFja1wifSxcbiAgICAgICAgICBzdHJva2VXaWR0aDoge3ZhbHVlOiAyfSxcbiAgICAgICAgfSxcbiAgICAgICAgdXBkYXRlOiB7XG4gICAgICAgICAgZmlsbDogeyBzaWduYWw6IFwiKGRhdHVtLnN0ZXBfaW4gPT0gc3RlcF9pblswXSkgPyAncGluaycgOiBudWxsXCJ9LC8vLCBzY2FsZTogXCJoaXRcIiB9LFxuICAgICAgICAgIG9wYWNpdHk6IHsgc2lnbmFsOiBcIihkYXR1bS5zdGVwX2luID09IHN0ZXBfaW5bMF0pID8gMSA6IDAuMVwifSwvLywgc2NhbGU6IFwiaGl0XCIgfSxcbiAgICAgICAgICAvL3N0cm9rZTogeyBzaWduYWw6IFwiKGRhdHVtLnN0ZXBfaW4gPT0gc3RlcF9pblswXSkgPyAnYmxhY2snIDogbnVsbFwifSwvLywgc2NhbGU6IFwiaGl0XCIgfSxcbiAgICAgICAgICB4OiB7IHNpZ25hbDogXCJkYXR1bS5ydngrMC4wNSowXCIsIHNjYWxlOiBcInhcIiB9LFxuICAgICAgICAgIHk6IHsgc2lnbmFsOiBcImRhdHVtLnJ2eSswLjA1KjBcIiwgc2NhbGU6IFwieVwiIH0sXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XSA6IFtdKVxuICBdLFxuICBheGVzOiBbXG4gICAgeyBvcmllbnQ6IFwidG9wXCIsIHNjYWxlOiBcInhcIiwgbGFiZWxGb250U2l6ZTogMjAsIGxhYmVsQ29sb3I6ICdibHVlJ30sXG4gICAgeyBvcmllbnQ6IFwibGVmdFwiLCBzY2FsZTogXCJ5XCIsIGxhYmVsRm9udFNpemU6IDIwLCBsYWJlbENvbG9yOiAnYmx1ZSd9XG4gIF0sXG59KVxufVxuXG5cbmh0bWxgPHN0eWxlPlxuXG4ubW9kZWxkZXB0IHtcbiAgZGlzcGxheTogbm9uZTtcbn1cblxuIyR7bW9kZWxuYW1lfS5tb2RlbGRlcHQge1xuICBkaXNwbGF5OiBibG9jaztcbn1cbjwvc3R5bGU+YFxuXG5cblxuICB7XG4gICAgc2F2aW5nc192aXouYWRkU2lnbmFsTGlzdGVuZXIoJ2RvdWJsZWNsaWNrJywgXyA9PiB7XG4gICAgICBzZXQodmlld29mIG92ZXJsYXksIHRydWUpXG4gICAgfSlcbiAgfVxuXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE2IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG5tdXRhYmxlIHNhdmluZ3NfZGF0YTAgPSBbXVxuXG5cbnNhdmluZ3Nfc3BlYyA9IHsgcmV0dXJuICh7XG4gIC8vd2lkdGg6ICdjb250YWluZXInLCBoZWlnaHQ6J2NvbnRhaW5lcicsIGJhZCBmb3IgbW9iaWxlXG4gIHdpZHRoOiAnY29udGFpbmVyJywgaGVpZ2h0OiAzNTAsXG4gIFwiZGF0YVwiOiB7XCJuYW1lXCI6IFwic291cmNlXCJ9LFxuICBkYXRhc2V0czogeydzb3VyY2UnOiBzYXZpbmdzX2RhdGEwIH0sXG4gIG1hcms6IHsgdHlwZTogJ3RleHQnLCBmb250U2l6ZTogMjAsIHRvb2x0aXA6IHRydWUsIFwiZm9udFdlaWdodFwiOiBcImJvbGRcIn0sXG5cbiAgZW5jb2Rpbmc6IHtcbiAgICBcInhcIjoge1xuICAgICAgXCJmaWVsZFwiOiBcImZvcm11bGFcIixcbiAgICAgIFwidHlwZVwiOiBcIm5vbWluYWxcIixcbiAgICAgIFwiYXhpc1wiOiB7XCJsYWJlbEFuZ2xlXCI6IDAsIFwib3JpZW50XCI6IFwidG9wXCIsIHRpdGxlOm51bGwsIFwibGFiZWxMaW1pdFwiOiAzMDAsIGxhYmVsRm9udFNpemU6IDMwfVxuICAgIH0sXG4gICAgICAgIGNvbG9yOiB7ZmllbGQ6ICdmb3JtdWxhJywgbGVnZW5kOiBmYWxzZX0sXG4gICAgeToge2ZpZWxkOiAneWVhcl9pbicsIGF4aXM6IHt0aXRsZUZvbnRTaXplOjIwLCBsYWJlbEZvbnRTaXplOiAzMCwgfX0sXG4gICAgdGV4dDoge2ZpZWxkOiAndmFsdWUnLyosIGZvcm1hdDonLC4yZicqL31cbiAgfSxcblxuICBwYXJhbXM6IFtcbiAgICB7XG4gICAgICBuYW1lOiBcImZvcm11bGFcIixcbiAgICAgIC8vdmFsdWU6IHsgcmF5X2FuZ2xlX2luOiAwIH0sXG4gICAgICBzZWxlY3Q6IHtcbiAgICAgICAgdHlwZTogXCJwb2ludFwiLFxuICAgICAgICAvL29uOiBcIm1vdXNlbW92ZXswLDUwfVwiLFxuICAgICAgICBvbjogXCJtb3VzZXVwLCB0b3VjaHVwLCBbbW91c2Vkb3duLCBtb3VzZXVwXSA+IG1vdXNlbW92ZVwiLFxuICAgICAgICAvL29uOiBcIlt0b3VjaGRvd24sIHRvdWNodXBdID4gdG91Y2htb3ZlLCBbbW91c2Vkb3duLCBtb3VzZXVwXSA+IG1vdXNlbW92ZVwiLCAvL3sxMCwgMTAwfVwiLFxuICAgICAgICAvLyAgICAgICAgb246IFwiW21vdXNlZG93biwgbW91c2V1cF0gPiBtb3VzZW1vdmVcIixcbiAgICAgICAgbmVhcmVzdDogdHJ1ZSxcbiAgICAgICAgdG9nZ2xlOiBmYWxzZSxcbiAgICAgICAgY2xlYXI6IGZhbHNlLFxuICAgICAgICBlbmNvZGluZ3M6IFtcInhcIiwgXCJ5XCJdXG4gICAgICB9XG4gICAgfVxuICBdXG59KSB9XG5cbnNhdmluZ3NfZGF0YSA9IGNhbGN1dmVnYWRhdGEoe1xuICBtb2RlbHM6IFtzYXZpbmdzXSxcbiAgc3BlYzogc2F2aW5nc19zcGVjLFxuICBkb21haW5zOiB7XG4gICAgeWVhcl9pbjogXy5yYW5nZSgwLGR1cmF0aW9uX2luKzAuMSksXG4gICAgZm9ybXVsYTogWydiYWxhbmNlJywgJ2ludGVyZXN0JywgJ2RlcG9zaXRzJ11cbiAgfSxcbiAgaW5wdXRfY3Vyc29yczogW3tkdXJhdGlvbl9pbixpbnRlcmVzdF9yYXRlX2luLGFubnVhbF9wYXltZW50X2lufV1cbn0pLm1hcChkID0+ICh7Li4uZCwgdmFsdWU6IGZtdDIoZC5mb3JtdWxhLCBkLnZhbHVlKX0pKSAvLyBmbXQyIGRvZXNuJ3QgbWF0dGVyIGluIHRoaXMgY2FzZVxuXG4vL0lucHV0cy50YWJsZShzYXZpbmdzX2RhdGEpXG5cbnZpZXdvZiBzYXZpbmdzX3ZpeiA9IGVtYmVkKHNhdmluZ3Nfc3BlYywge3JlbmRlcmVyOidzdmcnLCBhY3Rpb25zLFxucGF0Y2g6IHMgPT4ge3Muc2lnbmFscy5wdXNoKHtcbiAgXG4gICAgbmFtZTogXCJkb3VibGVjbGlja1wiLFxuICAgIHZhbHVlOiAwLFxuICAgICAgXCJvblwiOiBbe1wiZXZlbnRzXCI6IFwiZGJsY2xpY2tcIiwgXCJ1cGRhdGVcIjogXCJkYXR1bVwifV1cbiAgXG59KTtcbiByZXR1cm4gc31cblxuICB9KVxuXG5cblxuLy9JbnB1dHMudGFibGUoc2F2aW5nc19kYXRhKVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxuaHRsLmh0bWxgPGJ1dHRvbiBvbmNsaWNrPSR7KCkgPT4gKG11dGFibGUgc2F2aW5nc19kYXRhMCA9IHNhdmluZ3NfZGF0YSl9Pmluc2VydCBkYXRhIC0+IHZlZ2EgZWRpdG9yIChkZXYpPC9idXR0b24+YFxuXG5cbntcbiAgc2F2aW5nc192aXo7IC8vIGZvcmNlIHJlc2l6ZSBldmVudCBvbiBsb2FkIG9yIHVzZXIgc2VlcyBub3RoaW5nXG4gIC8vIHNlZSBsaW1pdGF0aW9ucyBoZXJlOiBodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NpemUuaHRtbCNzcGVjaWZ5aW5nLXJlc3BvbnNpdmUtd2lkdGgtYW5kLWhlaWdodFxuICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoJ3Jlc2l6ZScpKVxufVxuXG5cbnNhdmluZ3Nfdml6LmFkZFNpZ25hbExpc3RlbmVyKFwiZm9ybXVsYVwiLCAoYSwgYikgPT4ge1xuICAvKnZpZXdvZiBhYS52YWx1ZSA9IGIucmF5X2FuZ2xlX2luOyAvL3NjZW5lLnNpZ25hbChcInJheV9hbmdsZV9pblwiKTtcbiAgdmlld29mIGFhLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KFwiaW5wdXRcIiwgeyBidWJibGVzOiB0cnVlIH0pKTtcbiAgKi9cbiAvL2lmIChiLnJheV9hbmdsZV9pblswXSAhPT0gcmF5X2FuZ2xlX2luKSB7XG4gIC8vY29uc29sZS5sb2coYi5yYXlfYW5nbGVfaW5bMF0sIHJheV9hbmdsZV9pbiwgYi5yYXlfYW5nbGVfaW5bMF0gIT09IHJheV9hbmdsZV9pbilcbiAvL3ZpZXdvZiByYXlfYW5nbGVfaW4udmFsdWUgPSBiLnJheV9hbmdsZV9pblswXTsgLy9zY2VuZS5zaWduYWwoXCJyYXlfYW5nbGVfaW5cIik7XG4gLy8gdmlld29mIHJheV9hbmdsZV9pbi5kaXNwYXRjaEV2ZW50KFxuIC8vICAgbmV3IEN1c3RvbUV2ZW50KFwiaW5wdXRcIiwgeyBidWJibGVzOiB0cnVlIH0pXG4gIC8vKTtcbiAgc2V0KHZpZXdvZiBmb3JtdWxhZV92aXNpYmxlLCBbYi5mb3JtdWxhWzBdXSlcbiAgc2V0KHZpZXdvZiB5ZWFyX2luLCBiLnllYXJfaW5bMF0pXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYWxjdWxhbmdfZl8nK2IuZm9ybXVsYVswXSkuc2Nyb2xsSW50b1ZpZXcoc2Nyb2xsSW50b1ZpZXdPcHRzKVxuIC8vfVxufSlcblxuXG5zYXZpbmdzX2FjdHVhbGF0b3IuYWRkU2lnbmFsTGlzdGVuZXIoXCJmb3JtdWxhXCIsIChhLCBiKSA9PiB7XG4gIC8qdmlld29mIGFhLnZhbHVlID0gYi5yYXlfYW5nbGVfaW47IC8vc2NlbmUuc2lnbmFsKFwicmF5X2FuZ2xlX2luXCIpO1xuICB2aWV3b2YgYWEuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoXCJpbnB1dFwiLCB7IGJ1YmJsZXM6IHRydWUgfSkpO1xuICAqL1xuIC8vaWYgKGIucmF5X2FuZ2xlX2luWzBdICE9PSByYXlfYW5nbGVfaW4pIHtcbiAgLy9jb25zb2xlLmxvZyhiLnJheV9hbmdsZV9pblswXSwgcmF5X2FuZ2xlX2luLCBiLnJheV9hbmdsZV9pblswXSAhPT0gcmF5X2FuZ2xlX2luKVxuIC8vdmlld29mIHJheV9hbmdsZV9pbi52YWx1ZSA9IGIucmF5X2FuZ2xlX2luWzBdOyAvL3NjZW5lLnNpZ25hbChcInJheV9hbmdsZV9pblwiKTtcbiAvLyB2aWV3b2YgcmF5X2FuZ2xlX2luLmRpc3BhdGNoRXZlbnQoXG4gLy8gICBuZXcgQ3VzdG9tRXZlbnQoXCJpbnB1dFwiLCB7IGJ1YmJsZXM6IHRydWUgfSlcbiAgLy8pO1xuICBjb25zb2xlLmxvZyhiKVxuICBzZXQodmlld29mIGZvcm11bGFlX3Zpc2libGUsIFtiLmZvcm11bGFbMF1dKVxuICBzZXQodmlld29mIHllYXJfaW4sIGIueWVhcl9pblswXSlcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNhbGN1bGFuZ19mXycrYi5mb3JtdWxhWzBdKS5zY3JvbGxJbnRvVmlldyhzY3JvbGxJbnRvVmlld09wdHMpXG4gLy99XG59KVxuXG4vKnNhdmluZ3Nfdml6LmFkZFNpZ25hbExpc3RlbmVyKFwieWVhcl9pblwiLCAoYSwgYikgPT4ge1xuICBjb25zb2xlLmxvZyhiKTtcbiAgc2V0KHZpZXdvZiB5ZWFyX2luLCBiLnllYXJfaW5bMF0pXG59KSovXG5cblxuXG5cbntcbiAgLy9zY2VuZS5zaWduYWwoXCJyYXlfYW5nbGVfaW5cIiwgcmF5X2FuZ2xlX2luKTsgY2F1c2VzIGluZmluaXRlIHJlLXJ1bnNcbiAgc2F2aW5nc192aXouZGF0YShcInNvdXJjZVwiLCBzYXZpbmdzX2RhdGEpLnJlc2l6ZSgpLnJ1bigpO1xufVxuXG5cblxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xOCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxuSW5wdXRzLmJpbmQoU2NydWJiZXIoXy5yYW5nZSgwLDYwKjUpLCB7YXV0b3BsYXk6IGZhbHNlLCBkZWxheTo1MCwgbGFiZWw6J2ZyYW1lJywgaW5pdGlhbDogMn0pLCB2aWV3b2YgZnJhbWVfaW4pXG5cbi8vdmlld29mIHNwZWVkX2luID0gSW5wdXRzLnJhbmdlKFstMywxNV0sIHt2YWx1ZTozLCBsYWJlbDogJ3NwZWVkJywgc3RlcDowLjAxfSlcblxuc3RhcmZpZWxkX3NwZWMgPSB7IHJldHVybiAoe1xuICBiYWNrZ3JvdW5kOiAnYmxhY2snLC8vJ2xpZ2h0Ymx1ZScsXG4gIFwiZGF0YVwiOiB7XCJuYW1lXCI6IFwiZGF0YVwifSxcbiAgXCJkYXRhc2V0c1wiOiB7IFwiZGF0YVwiOiBzdGFyZmllbGRfZGF0YTB9LFxuICAgIFwiaGVpZ2h0XCI6IDUwMCwgd2lkdGg6IDUwMCxcbiAgICBsYXllcjogW3tcbiAgICBcIm1hcmtcIjoge3R5cGU6IFwicG9pbnRcIiwgZmlsbGVkOiB0cnVlLCB0b29sdGlwOiBmYWxzZSwgY2xpcDogZmFsc2V9LFxuXG4gIHBhcmFtczogW1xuICAgIHtcbiAgICAgIG5hbWU6IFwic3Rhcl9zZWxlY3RcIixcbiAgICAgIC8vdmFsdWU6IHsgcmF5X2FuZ2xlX2luOiAwIH0sXG4gICAgICBzZWxlY3Q6IHtcbiAgICAgICAgdHlwZTogXCJwb2ludFwiLFxuICAgICAgICAvL29uOiBcIm1vdXNlbW92ZXswLDUwfVwiLFxuICAgICAgICBvbjogXCJtb3VzZXVwLCB0b3VjaHVwLCBbbW91c2Vkb3duLCBtb3VzZXVwXSA+IG1vdXNlbW92ZVwiLFxuICAgICAgICAvL29uOiBcIlt0b3VjaGRvd24sIHRvdWNodXBdID4gdG91Y2htb3ZlLCBbbW91c2Vkb3duLCBtb3VzZXVwXSA+IG1vdXNlbW92ZVwiLCAvL3sxMCwgMTAwfVwiLFxuICAgICAgICAvLyAgICAgICAgb246IFwiW21vdXNlZG93biwgbW91c2V1cF0gPiBtb3VzZW1vdmVcIixcbiAgICAgICAgbmVhcmVzdDogdHJ1ZSxcbiAgICAgICAgdG9nZ2xlOiBmYWxzZSxcbiAgICAgICAgY2xlYXI6IGZhbHNlLFxuICAgICAgICAvL2VuY29kaW5nczogW1wieFwiLCBcInlcIl1cbiAgICAgICAgZmllbGRzOiBbXCJzdGFyX2luXCJdXG4gICAgICB9XG4gICAgfVxuICBdLFxuICAgIC8qXCJwYXJhbXNcIjogW3tcbiAgICAgIFwibmFtZVwiOiBcImJydXNoXCIsXG4gICAgICAgdmFsdWU6IHsgeDogW2xlYXBfeWVhcl9zdGFydCwgbGVhcF95ZWFyX3N0YXJ0KzUwXX0sIC8vIGluaXRpYWwgdmFsdWUgaGVyZSBmYWlscyB3aGVuZXZlciBJIHN3aXRjaCB0byB0aGlzIG1vZGVsIGFmdGVyIGxvYWRpbmcgYSBkaWZmZXJlbnQgb25lIC4uLiB1bmRlcnN0YW5kXG4gICAgICAvL1widmFsdWVcIjoge1wieWVhcl9pblwiOiBbMjAwMCwgMjAxMF19LFxuICAgICAgXCJzZWxlY3RcIjoge1widHlwZVwiOiBcImludGVydmFsXCIsIFwiZW5jb2RpbmdzXCI6IFtcInhcIl19XG4gICAgfV0sKi9cbiAgICBcImVuY29kaW5nXCI6IHtcbiAgICAgIFwieFwiOiB7XG4gICAgICAgIFwiZmllbGRcIjogXCJ4XCIsXG4gICAgICAgIFwidHlwZVwiOiBcInF1YW50aXRhdGl2ZVwiLFxuICAgICAgICBzY2FsZToge3plcm86ZmFsc2UsIG5pY2U6IGZhbHNlLCBkb21haW46Wy01MCw1MF19LFxuICAgICAgICBheGlzOiB7Zm9ybWF0OlwiLjBmXCIsIGdyaWRPcGFjaXR5OjAuMSwgdGlja0NvdW50OjEyLCB0aWNrczp0cnVlIH1cbiAgICAgIH0sXG4gICAgICBcInlcIjoge1xuICAgICAgICBcImZpZWxkXCI6IFwieVwiLFxuICAgICAgICBcInR5cGVcIjogXCJxdWFudGl0YXRpdmVcIixcbiAgICAgICAgc2NhbGU6IHt6ZXJvOmZhbHNlLCBuaWNlOiBmYWxzZSwgZG9tYWluOlstNTAsNTBdfSxcbiAgICAgICAgXCJheGlzXCI6IHsgXCJncmlkXCI6IGZhbHNlLCBncmlkT3BhY2l0eTowLjEsIHRpY2tDb3VudDoxMiwgdGlja3M6dHJ1ZSwgZm9ybWF0OiAnLjBmJ31cbiAgICAgIH0sXG4gICAgICBcInNpemVcIjoge1xuICAgICAgICBcImZpZWxkXCI6IFwielwiLFxuICAgICAgICBcInR5cGVcIjogXCJxdWFudGl0YXRpdmVcIixcbiAgICAgICAgc2NhbGU6IHtyZXZlcnNlOnRydWV9LFxuICAgICAgICBsZWdlbmQ6ZmFsc2VcbiAgICAgICAgLy9zY2FsZToge3plcm86ZmFsc2UsIG5pY2U6IGZhbHNlLCBkb21haW46Wy01MCw1MF19LFxuICAgICAgICAvL1wiYXhpc1wiOiB7IFwiZ3JpZFwiOiBmYWxzZSwgdmFsdWVzOiBbMCwxXSwgZm9ybWF0OiAnLjBmJ31cbiAgICAgIH0sXG4gICAgICBjb2xvcjoge3ZhbHVlOid3aGl0ZSd9LCBvcGFjaXR5OiB7dmFsdWU6MX1cbiAgICB9XG4gICAgfSxcbiAgICB7XG4gICAgICBtYXJrOiAncnVsZScsXG4gICAgICBlbmNvZGluZzoge1xuXG4gICAgICBcInhcIjoge1xuICAgICAgICBcImZpZWxkXCI6IFwieFwiLFxuICAgICAgICBcInR5cGVcIjogXCJxdWFudGl0YXRpdmVcIixcbiAgICAgICAgc2NhbGU6IHt6ZXJvOmZhbHNlLCBuaWNlOiBmYWxzZSwgZG9tYWluOlstNTAsNTBdfSxcbiAgICAgICAgLy9heGlzOiB7Zm9ybWF0OlwiLjBmXCIsIGdyaWQ6IGZhbHNlLCB0aWNrQ291bnQ6MTIsIHRpY2tzOnRydWUgfVxuICAgICAgfSxcbiAgICAgIFwieVwiOiB7XG4gICAgICAgIFwiZmllbGRcIjogXCJ5XCIsXG4gICAgICAgIFwidHlwZVwiOiBcInF1YW50aXRhdGl2ZVwiLFxuICAgICAgICBzY2FsZToge3plcm86ZmFsc2UsIG5pY2U6IGZhbHNlLCBkb21haW46Wy01MCw1MF19LFxuICAgICAgICAvL1wiYXhpc1wiOiB7IFwiZ3JpZFwiOiBmYWxzZSwgdmFsdWVzOiBbMCwxXSwgZm9ybWF0OiAnLjBmJ31cbiAgICAgIH0sXG4gICAgICBcIngyXCI6IHtcbiAgICAgICAgXCJmaWVsZFwiOiBcInB4XCIsXG4gICAgICAgIFwidHlwZVwiOiBcInF1YW50aXRhdGl2ZVwiLFxuICAgICAgICBzY2FsZToge3plcm86ZmFsc2UsIG5pY2U6IGZhbHNlLCBkb21haW46Wy01MCw1MF19LFxuICAgICAgICAvL2F4aXM6IHtmb3JtYXQ6XCIuMGZcIiwgZ3JpZDogZmFsc2UsIHRpY2tDb3VudDoxMiwgdGlja3M6dHJ1ZSB9XG4gICAgICB9LFxuICAgICAgXCJ5MlwiOiB7XG4gICAgICAgIFwiZmllbGRcIjogXCJweVwiLFxuICAgICAgICBcInR5cGVcIjogXCJxdWFudGl0YXRpdmVcIixcbiAgICAgICAgc2NhbGU6IHt6ZXJvOmZhbHNlLCBuaWNlOiBmYWxzZSwgZG9tYWluOlstNTAsNTBdfSxcbiAgICAgICAgLy9cImF4aXNcIjogeyBcImdyaWRcIjogZmFsc2UsIHZhbHVlczogWzAsMV0sIGZvcm1hdDogJy4wZid9XG4gICAgICB9LFxuICAgICAgY29sb3I6IHt2YWx1ZTond2hpdGUnfVxuXG5cbiAgICAgIH1cbiAgICB9XVxufSl9XG5cbnN0YXJmaWVsZF9kYXRhID0gY2FsY3V2ZWdhZGF0YSh7XG4gIG1vZGVsczogW3N0YXJmaWVsZF0sLy9tb2RlbG5hbWUgPT0gJ3N0YXJmaWVsZCcgPyBbc3RhcmZpZWxkXSA6IFtdLFxuICBzcGVjOiBzdGFyZmllbGRfc3BlYyxcbiAgZG9tYWluczogeyBzdGFyX2luOiBfLnJhbmdlKDAsIDEwMCkgfSxcbiAgaW5wdXRfY3Vyc29yczogW3tzcGVlZF9pbiwgZnJhbWVfaW4sIHJhbmRvbV9zZWVkX2lufV1cbn0pXG5cblxudmlld29mIHN0YXJmaWVsZF92aXogPSBlbWJlZChzdGFyZmllbGRfc3BlYywge2FjdGlvbnN9KVxuLypcbntcbiAgbGVhcF95ZWFyX3Zpei5zaWduYWwoJ2JydXNoJywgeyB4OiBbMjAwMCwgMTk5MCs1MF19KS5ydW4oKTtcbn0qL1xuXG4vKlxuLy8gbm8gaWRlYSB3aHkgdGhpcyBkb2Vzbid0IHdvcmtcbmh0bC5odG1sYDxidXR0b24gb25jbGljaz0keygpID0+IHtsZWFwX3llYXJfdml6LnNpZ25hbCgnYnJ1c2gnLCB7IHg6IFsyMDAwLCAxOTkwKzUwXX0pLnJ1bigpfSB9PnNpZzwvYnV0dG9uPmBcbmh0bC5odG1sYDxidXR0b24gb25jbGljaz0keygpID0+IHtsZWFwX3llYXJfdml6LnNpZ25hbCgnYnJ1c2gnLCB7IHllYXJfaW46IFsyMDAwLCAxOTkwKzUwXX0pLnJ1bigpfSB9PnNpZzwvYnV0dG9uPmAqL1xuXG5tdXRhYmxlIHN0YXJmaWVsZF9kYXRhMCA9IFtdIC8vIGluY2x1ZGVzIGRhdGEgaW4gc3BlYyBmb3Igd2hlbiBJIE9wZW4gaW4gVmVnYSBFZGl0b3JcblxuLy9odGwuaHRtbGA8YnV0dG9uIG9uY2xpY2s9JHsoKSA9PiAobXV0YWJsZSBzdGFyZmllbGRfZGF0YTAgPSBzdGFyZmllbGRfZGF0YSl9Pmluc2VydCBkYXRhIC0+IHZlZ2EgZWRpdG9yIChkZXYpPC9idXR0b24+YFxuXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE5IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG5cblxue1xuICBzdGFyZmllbGRfdml6LmRhdGEoXCJkYXRhXCIsIHN0YXJmaWVsZF9kYXRhKS8qLnJlc2l6ZSgpKi8ucnVuKCk7XG59XG5cbntcbiAgc3RhcmZpZWxkX3Zpei5hZGRTaWduYWxMaXN0ZW5lcignc3Rhcl9zZWxlY3QnLCAoXywgYikgPT4ge1xuICAgIHNldCh2aWV3b2Ygc3Rhcl9pbiwgYi5zdGFyX2luWzBdKVxuICAgIC8vY29uc29sZS5sb2coYilcbiAgfSlcbn1cblxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yMCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxuXG57XG4gIHNhdmluZ3NfYWN0dWFsYXRvcjtcbiAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KCdyZXNpemUnKSlcbn1cblxuXG5cbnNhdmluZ3NfYWN0dWFsYXRvci5hZGRTaWduYWxMaXN0ZW5lcihcInlcIiwgKF8sIHIpID0+IHsgLy8gdGhpcyBkaWRuJ3QgaW1wcm92ZSBwZXJmIGEgbG90IHZzIGV2ZW50IGxpc3RlbmVyOiBuZWFybHkgZXZlcnkgbW91c2Vtb3ZlIGlzIGEgc2lnbmFsIGNoYW5nZSwgSSBzdXBwb3NlXG4gIC8vaWYgKG9ic2VydmFibGVfd29ybGQgPT0gMCkgcmV0dXJuO1xuICB2aWV3b2YgYWN0dWFsX2ludGVyZXN0X3JhdGVfY29faW4udmFsdWUgPSByLnllYXJfaW5bMF07XG4gIHZpZXdvZiBhY3R1YWxfaW50ZXJlc3RfcmF0ZV9jb19pbi5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnaW5wdXQnKSwge2J1YmJsZXM6dHJ1ZX0pO1xufSkgJiYgMVxuXG5cbntcbiAgc2F2aW5nc19hY3R1YWxhdG9yLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2ZW50LCBpdGVtKSA9PiB7IGNvbnNvbGUubG9nKGl0ZW0pIH0pIFxuICAvLyBkaWZmaWN1bHQgZm9yIGxheWVycz9cbn1cblxuXG5cbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjEiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJcbmltcG9ydCB7Y2FsY3VkYXRhLCBjYWxjdXZpenNwZWN9IGZyb20gJ0BkZWNsYW5uL2xpdHRsZS1jYWxjdWxhbmctaGVscGVycy1wZXJmJ1xuXG5cbnNhdmluZ3NfcmVjX2RhdGEgPSBjYWxjdWRhdGEoe1xuICBtb2RlbHM6IFtzYXZpbmdzX3JlY10sXG4gIGlucHV0X2RvbWFpbnM6IHt5ZWFyX2luOl8ucmFuZ2UoMCxkdXJhdGlvbl9pbiswLjEpLCBhY3R1YWxfaW50ZXJlc3RfcmF0ZV9jb19pbjogW2FjdHVhbF9pbnRlcmVzdF9yYXRlX2NvX2luLTEsYWN0dWFsX2ludGVyZXN0X3JhdGVfY29faW5dfSxcbiAgaW5wdXRfY3Vyc29yczogW3thbm51YWxfcGF5bWVudF9pbn1dLCBcbiAgb3V0cHV0czogWydiYWxhbmNlJywnaW50ZXJlc3QnLCdkZXBvc2l0cycsJ2ludGVyZXN0X3JhdGUnXVxufSlcblxudmlld29mIHNhdmluZ3NfYWN0dWFsYXRvciA9IGVtYmVkKFxuICB7XG4gIFwiZGF0YVwiOiB7XCJuYW1lXCI6IFwiZGF0YVwifSxcbiAgd2lkdGg6IFwiY29udGFpbmVyXCIsXG4gIGhlaWdodDogMzUwLFxuICBcInRyYW5zZm9ybVwiOiBbXG4gICAge1xuICAgICAgXCJ3aW5kb3dcIjogW3tcIm9wXCI6IFwibGFnXCIsIFwiZmllbGRcIjogXCJ2YWx1ZVwiLCBcImFzXCI6IFwiQV92YWx1ZVwifV0sXG4gICAgICBcImdyb3VwYnlcIjogW1wiZm9ybXVsYVwiLFwieWVhcl9pblwiXSxcbiAgICAgIFwic29ydFwiOiBbe1wiZmllbGRcIjogXCJhY3R1YWxfaW50ZXJlc3RfcmF0ZV9jb19pblwifV0sXG4gICAgICBcImZyYW1lXCI6IFstMSwgMF1cbiAgICB9LFxuICAgIHtcImNhbGN1bGF0ZVwiOiBcImRhdHVtLnZhbHVlLWRhdHVtLkFfdmFsdWVcIiwgXCJhc1wiOiBcImltcGFjdFwifSxcbiAgXSxcbiAgXCJlbmNvZGluZ1wiOiB7XG4gICAgXCJ5XCI6IHtcImZpZWxkXCI6IFwieWVhcl9pblwiLCBcInR5cGVcIjogXCJub21pbmFsXCIsIFwic29ydFwiOiBcImFzY2VuZGluZ1wiLCBheGlzOiB7bGFiZWxGb250U2l6ZTogMzB9fSxcbiAgICBcImNvbG9yXCI6IHtcImZpZWxkXCI6IFwiZm9ybXVsYVwiLCBcInR5cGVcIjogXCJub21pbmFsXCJ9LFxuICAgIFwieFwiOiB7XG4gICAgICBcImZpZWxkXCI6IFwiZm9ybXVsYVwiLFxuICAgICAgXCJ0eXBlXCI6IFwibm9taW5hbFwiLFxuICAgICAgXCJheGlzXCI6IHtcImxhYmVsQW5nbGVcIjogMCwgXCJvcmllbnRcIjogXCJ0b3BcIiwgXCJsYWJlbExpbWl0XCI6IDkwLCB0aXRsZTpudWxsLCBcImxhYmVsTGltaXRcIjogMzAwLCBsYWJlbEZvbnRTaXplOiAzMH1cbiAgICB9XG4gIH0sXG4gIGxheWVyOiBbe1xuICAgICAgICAgICAgXCJwYXJhbXNcIjogW3tcIm5hbWVcIjogXCJ5XCIsIFwic2VsZWN0XCI6IHsgXCJ0eXBlXCI6IFwicG9pbnRcIiwgXCJvblwiOiBcIm1vdXNlb3ZlclwiLCBcIm5lYXJlc3RcIjogdHJ1ZSwgXCJlbmNvZGluZ3NcIjogW1wieVwiXSwgXCJ0b2dnbGVcIjpmYWxzZX19LFxuICAgICAgICAgICAgICAgICAvLyBwYXJhbXMgZm9yIGxheWVycyBub3Qgd29ya2luZyBnb29kICF7XCJuYW1lXCI6IFwiZm9ybXVsYVwiLCBcInNlbGVjdFwiOiB7IFwidHlwZVwiOiBcInBvaW50XCIsIFwib25cIjogXCJtb3VzZXVwLCB0b3VjaHVwLCBbbW91c2Vkb3duLCBtb3VzZXVwXSA+IG1vdXNlbW92ZVwiLCBcIm5lYXJlc3RcIjogdHJ1ZSwgXCJlbmNvZGluZ3NcIjogW1wieFwiLCBcInlcIl19fVxuICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICxcbiAgXCJtYXJrXCI6IHtcbiAgICBcInR5cGVcIjogXCJ0ZXh0XCIsXG4gICAgXCJmb250U2l6ZVwiOiAzMCxcbiAgICBcImZvbnRXZWlnaHRcIjogXCJib2xkXCIsXG4gICAgXCJ0b29sdGlwXCI6IGZhbHNlXG4gIH0sXG4gICAgICAgIFwidHJhbnNmb3JtXCI6IFt7XCJmaWx0ZXJcIjogYGRhdHVtLmFjdHVhbF9pbnRlcmVzdF9yYXRlX2NvX2luICE9ICR7YWN0dWFsX2ludGVyZXN0X3JhdGVfY29faW4tMX1gfSxcbiAgICAgICAgLy97XCJjYWxjdWxhdGVcIjogXCJkYXR1bS55ZWFyX2luID4gZGF0dW0uYWN0dWFsX2ludGVyZXN0X3JhdGVfY29faW5cIiwgXCJhc1wiOiBcImZ1dFwifVxuICAgICAgICBdLFxuXG4gIGVuY29kaW5nOiB7XG4gICAgXCJvcGFjaXR5XCI6ICAgICAgICAgICAgIHtcImNvbmRpdGlvblwiOiB7XCJ0ZXN0XCI6IFwiZGF0dW0ueWVhcl9pbiA+IGRhdHVtLmFjdHVhbF9pbnRlcmVzdF9yYXRlX2NvX2luXCIsIFwidmFsdWVcIjogMC41fSwgXCJ2YWx1ZVwiOiAxfSxcbi8vIHtcImZpZWxkXCI6IFwiZnV0XCIsIFwidHlwZVwiOiBcIm5vbWluYWxcIiwgXCJzb3J0XCI6IFwiZGVzY2VuZGluZ1wifSxcbiAgICAgICAgXCJ0ZXh0XCI6IHtcbiAgICAgIFwiZmllbGRcIjogXCJ2YWx1ZVwiLFxuICAgICAgXCJ0eXBlXCI6IFwicXVhbnRpdGF0aXZlXCIsXG4gICAgICBcImZvcm1hdFwiOiBcIiwuMmZcIiwgLy8gSSBjYW4ndCBkbyBhIGNvbmRpdGlvbmFsIGZvcm1hdCBoZXJlIHlldFxuICAgICAgXCJheGlzXCI6IHtcImZvcm1hdFwiOiBcIiwuMmZcIn1cbiAgICB9LFxuXG4gIH1cbiAgfSx7XG4gIFwibWFya1wiOiB7XG4gICAgXCJ0eXBlXCI6IFwidGV4dFwiLCBkeDo5NSwgZHk6IC0xMCxcbiAgICBcImZvbnRTaXplXCI6IDIyLFxuICAgIFwiZm9udFdlaWdodFwiOiBcImJvbGRcIiwvL1xuICAgIFwidG9vbHRpcFwiOiBmYWxzZVxuICB9LFxuICAgICAgICBcInRyYW5zZm9ybVwiOiBbe1wiZmlsdGVyXCI6IGBhYnMoZGF0dW0uaW1wYWN0KSA+PSAwLjAwMDAxICYmIGRhdHVtLmFjdHVhbF9pbnRlcmVzdF9yYXRlX2NvX2luICE9ICR7YWN0dWFsX2ludGVyZXN0X3JhdGVfY29faW4tMX1gfV0sXG5cbiAgZW5jb2Rpbmc6IHtcbiAgICAgICAgICAgIFwiY29sb3JcIjoge1widmFsdWVcIjogXCJncmVlblwiLCBcImNvbmRpdGlvblwiOiB7XCJ0ZXN0XCI6IFwiZGF0dW0uaW1wYWN0IDwgMFwiLCBcInZhbHVlXCI6IFwicmVkXCJ9fSxcbiAgICAgICAgICAgICAgICBcIm9wYWNpdHlcIjogICAgICAgICAgICAge1wiY29uZGl0aW9uXCI6IHtcInRlc3RcIjogXCJkYXR1bS55ZWFyX2luID4gZGF0dW0uYWN0dWFsX2ludGVyZXN0X3JhdGVfY29faW5cIiwgXCJ2YWx1ZVwiOiAwLjV9LCBcInZhbHVlXCI6IDF9LFxuXG4gICAgICAgIFwidGV4dFwiOiB7XG4gICAgICBcImZpZWxkXCI6IFwiaW1wYWN0XCIsXG4gICAgICBcInR5cGVcIjogXCJxdWFudGl0YXRpdmVcIixcbiAgICAgIFwiZm9ybWF0XCI6IFwiLC4yZlwiLFxuICAgICAgXCJheGlzXCI6IHtcImZvcm1hdFwiOiBcIiwuMmZcIn1cbiAgICB9LFxuXG4gIH1cbiAgfV0sXG4gIFwiY29uZmlnXCI6IHtcImxlZ2VuZFwiOiB7XCJkaXNhYmxlXCI6IHRydWV9fSxcbiAgXCJkYXRhc2V0c1wiOiB7IGRhdGE6IHNhdmluZ3NfcmVjX2RhdGFcbiAgfSxcbn0pXG5cblxuXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIyIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG5lbWJlZChcbiAgY2FsY3V2aXpzcGVjKHtcbiAgICBtb2RlbHM6IFtmaXp6YnV6el0sXG4gICAgaW5wdXRfY3Vyc29yczogW3t9XSxcbiAgICBtYXJrOiB7dHlwZTogJ3RleHQnLCBmb250U2l6ZToxNSwgZm9udFdlaWdodDogJ2JvbGQnfSxcbiAgICBlbmNvZGluZ3M6IHtcbiAgICAgIHg6IHtuYW1lOiAnZm9ybXVsYScsIHR5cGU6J25vbWluYWwnLCBkb21haW46IFsnZml6eicsJ2J1enonLCdmaXp6YnV6eiddLCBheGlzOiB7bGFiZWxGb250U2l6ZTogNjB9LCBzb3J0OiBbJ2ZpenpidXp6J119LFxuICAgICAgeToge25hbWU6ICdpX2luJywgdHlwZTonbm9taW5hbCcsIGRvbWFpbjogXy5yYW5nZShpX2luLCBpX2luKzIwKSwgZ3JpZDogdHJ1ZX0sXG4gICAgICB0ZXh0OiB7bmFtZTogJ3ZhbHVlJywgdHlwZTogJ25vbWluYWwnfSxcbiAgICAgIGNvbG9yOiB7bmFtZTogJ3ZhbHVlJywgdHlwZTogJ25vbWluYWwnLCBsZWdlbmQ6ZmFsc2V9LFxuICAgIH0sXG4gICAgd2lkdGg6IDI1MH0pKVxuXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIzIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiXG5tZGAqKiR7KGQzLmZvcm1hdCgnLjIlJykoeWVhcl9yZW1haW5pbmcuZnJhY3Rpb25MZWZ0SW5ZZWFyKHtkYXRlX2luOiBuZXcgRGF0ZSgpLCB0aW1pbmdfaW59KSkpfSoqIG9mIHllYXIgcmVhbWluaW5nLCBvciB2aXN1YWxseTpgXG5cblBsb3QucGxvdCh7XG4gIC8vbWFyZ2luTGVmdDogOTAsXG4gIGhlaWdodDo4MCxcbiAgLy93aWR0aDo1MDAwLFxuICBjb2xvcjogeyBsZWdlbmQ6IHRydWUgfSxcbiAgbWFya3M6IFsgICAgUGxvdC5heGlzWCh7YW5jaG9yOiBcInRvcFwifSksXG4sUGxvdC5iYXJYKFxuICAgIFt7c29ydDogMSwgc3RhdHVzOidyZW1haW5pbmcnLHBlcmNlbnQ6MTAwKnllYXJfcmVtYWluaW5nLmZyYWN0aW9uTGVmdEluWWVhcih7ZGF0ZV9pbjogbmV3IERhdGUoKSwgdGltaW5nX2lufSl9LFxuICAgIHtzb3J0OiAwLCBzdGF0dXM6J2NvbXBsZXRlJyxwZXJjZW50OjEwMCp5ZWFyX3JlbWFpbmluZy5mcmFjdGlvbkludG9ZZWFyKHtkYXRlX2luOiBuZXcgRGF0ZSgpLCB0aW1pbmdfaW59KVxufV1cbix7IHg6IFwicGVyY2VudFwiLCBmaWxsOiBcInN0YXR1c1wiLCBzb3J0Oidzb3J0JyB9KV1cbn0pXG5cbi8vIGp1c3QgdG8gZ2V0IHNvbWUgd2lkdGggIVxuLy9JbnB1dHMucmFuZ2UoWzAsMV0sIHtkaXNhYmxlZDp0cnVlfSlcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMjQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJcblxuXG57XG4gIGxvYW5fdml6LmRhdGEoXCJzb3VyY2VcIiwgbG9hbl9kYXRhKS5yZXNpemUoKS5ydW4oKTtcbn1cblxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yNSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxubG9hbl9kYXRhID0gY2FsY3VkYXRhKHtcbiAgbW9kZWxzOiBbc2ltcGxlX2xvYW5dLFxuICBpbnB1dF9kb21haW5zOiB7eWVhcl9pbjpfLnJhbmdlKC0xLHRlcm1faW4rMC4xKX0sXG4gIGlucHV0X2N1cnNvcnM6IFt7cHJpbmNpcGFsX2luLCBpX2luLCBkX2lfaW4sIGRfaV95ZWFyX2luLCB0ZXJtX2lufV0sXG4gIG91dHB1dHM6IFtcImNhcGl0YWxfcmVwYXltZW50XCIsIFwiaW50ZXJlc3RfcmVwYXltZW50XCIsIFwiYmFsYW5jZVwiXSxcbiAgcGl2b3Q6IGZhbHNlXG59KVxuXG5cbmxvYW5fc3BlYyA9IHsgcmV0dXJuICh7XG4gIFwiJHNjaGVtYVwiOiBcImh0dHBzOi8vdmVnYS5naXRodWIuaW8vc2NoZW1hL3ZlZ2EtbGl0ZS92NS5qc29uXCIsXG4gIFwid2lkdGhcIjogXCJjb250YWluZXJcIixcbiAgZGF0YXNldHM6IHsnc291cmNlJzogW10gfSxcbiAgXCJlbmNvZGluZ1wiOiB7XG4gICAgICAgIFwieFwiOiB7XCJmaWVsZFwiOiBcInllYXJfaW5cIn0sXG4gICAgICAgIFwieVwiOiB7XCJmaWVsZFwiOiBcInZhbHVlXCIsIFwidHlwZVwiOiBcInF1YW50aXRhdGl2ZVwifSxcbiAgfSxcbiAgXCJsYXllclwiOiBbXG4gICAge1xuICAgICAgXCJ0cmFuc2Zvcm1cIjogW3tcImZpbHRlclwiOiBcImRhdHVtLmZvcm11bGEgIT0gJ2JhbGFuY2UnXCJ9XSxcbiAgICAgIFwibWFya1wiOiB7XCJ0eXBlXCI6IFwiYmFyXCIsIFwidG9vbHRpcFwiOiB0cnVlfSxcbiAgICAgIFwiZW5jb2RpbmdcIjoge1xuICAgICAgICBcImNvbG9yXCI6IHtcImZpZWxkXCI6IFwiZm9ybXVsYVwiLCBcInR5cGVcIjogXCJub21pbmFsXCIsIGxlZ2VuZDoge29yaWVudDogJ3RvcCd9fVxuICAgICAgfVxuICAgIH0sXG4gICAge1xuICAgICAgXCJ0cmFuc2Zvcm1cIjogW3tcImZpbHRlclwiOiBcImRhdHVtLmZvcm11bGEgPT0gJ2JhbGFuY2UnXCJ9XSxcbiAgICAgIFwibWFya1wiOiB7XCJ0eXBlXCI6IFwibGluZVwiLCBcInRvb2x0aXBcIjogdHJ1ZSwgXCJwb2ludFwiOiBmYWxzZX0sXG4gICAgICBcImVuY29kaW5nXCI6IHtcbiAgICAgICAgXCJjb2xvclwiOiB7XCJ2YWx1ZVwiOiBcInJlZFwifSxcbiAgICAgICAgXCJ5XCI6IHtcImZpZWxkXCI6IFwidmFsdWVcIiwgXCJ0eXBlXCI6IFwicXVhbnRpdGF0aXZlXCIsIFwidGl0bGVcIjogXCJiYWxhbmNlXCJ9XG4gICAgICB9XG4gICAgfSxcbiAgICB7XG4gICAgICBcInRyYW5zZm9ybVwiOiBbe1wiZmlsdGVyXCI6IFwiZGF0dW0uZm9ybXVsYSA9PSAnYmFsYW5jZSdcIn1dLFxuICAgICAgXCJtYXJrXCI6IHtcInR5cGVcIjogXCJwb2ludFwiLCBcInRvb2x0aXBcIjogdHJ1ZSwgZmlsbGVkOnRydWUsIG9wYWNpdHk6IDAuN30sXG4gICAgICBcImVuY29kaW5nXCI6IHtcbiAgICAgICAgXCJjb2xvclwiOiB7XCJ2YWx1ZVwiOiBcInJlZFwiLCBsZWdlbmQ6IHRydWV9LFxuICAgICAgICBzaXplOiB7dmFsdWU6IDIwMH0sXG4gICAgICAgIFwieVwiOiB7XCJmaWVsZFwiOiBcInZhbHVlXCIsIFwidHlwZVwiOiBcInF1YW50aXRhdGl2ZVwiLCBcInRpdGxlXCI6IFwiYmFsYW5jZVwiLCB6ZXJvOiB0cnVlfVxuICAgICAgfVxuICAgIH1cbiAgXSxcbiAgXCJyZXNvbHZlXCI6IHtcInNjYWxlXCI6IHtcInlcIjogXCJpbmRlcGVuZGVudFwifX1cbn0pfVxuXG52aWV3b2YgbG9hbl92aXogPSBlbWJlZChsb2FuX3NwZWMpXG4vL21kYCoqJHsoZDMuZm9ybWF0KCcuMiUnKSh5ZWFyX3JlbWFpbmluZy5mcmFjdGlvbkxlZnRJblllYXIoe2RhdGVfaW46IG5ldyBEYXRlKCksIHRpbWluZ19pbn0pKSl9Kiogb2YgeWVhciByZWFtaW5pbmcsIG9yIHZpc3VhbGx5OmBcblxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yNiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxuXG5cbntcbiAgbG9hbl92aXouZGF0YShcInNvdXJjZVwiLCBsb2FuX2RhdGEpLnJlc2l6ZSgpLnJ1bigpO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yNyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IlxuaHRtbGBcbjxzdHlsZT5cblxuLmZ1aS1GbHVlbnRQcm92aWRlcntcbiAgZGlzcGxheTogbm9uZTtcbn1cblxuLnZlZ2EtZW1iZWQge1xuICB3aWR0aDogMTAwJTtcbiAgaGVpZ2h0OiAxMDAlO1xufVxuICBcbiAgLmFuc3dlciB7XG4gICAgY29sb3I6IGJsdWUgIWltcG9ydGFudDtcbiAgICBmb250LXdlaWdodDogYm9sZDtcbiAgICBmb250LXNpemU6IDEuNWVtICFpbXBvcnRhbnQ7XG4gICAgbGVmdDogODBweCAhaW1wb3J0YW50O1xuICAgIHRvcDogMTBweDtcbn1cbiAgLmFuc3dlciAudG9vbHRpcHRleHQgIHtcbiAgICAvKmJvcmRlcjogMnB4IGRhc2hlZCBibGFjazsqL1xuICAgIGJhY2tncm91bmQ6ICNhZjVhO1xuICAgIHBhZGRpbmc6IDEwcHg7XG4gICAgYm9yZGVyLXJhZGl1czogMTVweDtcbiAgXG4gIH1cblxuICAuYW5zd2VyIC50b29sdGlwdGV4dDo6YWZ0ZXIge1xuICAgIC8qY29sb3I6IHJlZDsqL1xuICAgIGJvcmRlcjogbm9uZTtcbiAgfVxuICBcbi5hbnN3ZXI6aG92ZXIge1xuICAvKmZvbnQtc2l6ZToyZW0gIWltcG9ydGFudDsqL1xufVxuICBcbiAgYm9keSB7XG4gIGZvbnQtZmFtaWx5OiBzeXN0ZW0tdWk7XG59XG5cbnByZSB7XG4gIGxpbmUtaGVpZ2h0OiAyNXB4O1xufVxuXG4uY2FsY3VsYW5nX3Rvb2x0aXAge1xuICBjb2xvcjogIzE5ZjtcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xuXG59XG5cbi50b29sdGlwdGV4dCB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgYm90dG9tOiBjYWxjKDEwMCUgLSAxNXB4KTtcbiAgbGVmdDogYW5jaG9yKGNlbnRlcik7XG4gIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTtcbiAgd2lkdGg6IG1heC1jb250ZW50O1xufVxuXG4udG9vbHRpcHRleHQge1xuICBjdXJzb3I6IHpvb20taW47XG59XG5cblxuLmNhbGN1bGFuZ190b29sdGlwLmFuc3dlciAudG9vbHRpcHRleHQge1xuICBib3R0b206IDA7XG59IFxuXG5jYWxjdWxhbmdfdG9vbHRpcC5hbnN3ZXIge1xuICAgIGJhY2tncm91bmQtY29sb3I6IGxpZ2h0b3JhbmdlO1xufVxuXG5cbnByZSB7XG4gIGN1cnNvcjpkZWZhdWx0XG59XG4gIDwvc3R5bGU+XG5gXG5cbnZpZXdvZiBjb2xvciA9IElucHV0cy50ZXh0KHsgbGFiZWw6IFwiY29sb3JcIiwgdmFsdWU6IFwiIzBEMFwiIH0pXG5cbi8vaW1wb3J0IHtUYW5nbGV9IGZyb20gXCJAZGVjbGFubi9jb2xvcmVkLXRhbmdsZVwiIC8vIHRvZG8gdXNlIGh0dHBzOi8vanNmaWRkbGUubmV0L2FwaS9wb3N0L2xpYnJhcnkvcHVyZS8gP1xuLy8gaHR0cHM6Ly93d3cucmVkYmxvYmdhbWVzLmNvbS9tYWtpbmctb2YvZHJhZ2dhYmxlL2V4YW1wbGVzLmh0bWxcblxuXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3BsYXllcl94X2luJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3BsYXllcl95X2luJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3JheV9hbmdsZV9pbicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdmaXNoZXllX2NvcnJlY3Rpb25faW4nKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc3RlcF9pbicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCd4X2luJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3lfaW4nKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnZl9pbicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdrZXlfc3RyZWFtX3ZlcnNpb25faW4nKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgna2V5c19zdHJlYW1fdmVyc2lvbl9pbicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdlbWlzc2lvbnNfeWVhcl9pbicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdhbm51YWxfcGF5bWVudF9pbicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdkdXJhdGlvbl9pbicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdpbnRlcmVzdF9yYXRlX2luJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3llYXJfaW4nKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnaV9pbicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdkYXRlX2luJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ25vd19pbicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCd0aW1pbmdfaW4nKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc3Rhcl9pbicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdzcGVlZF9pbicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdmcmFtZV9pbicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdyYW5kb21fc2VlZF9pbicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdkX2lfaW4nKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnZF9pX3llYXJfaW4nKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnbWlzc2VkX3JlcGF5bWVudF95ZWFyX2luJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3NraXBfaW50ZXJlc3RfaW4nKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgncHJpbmNpcGFsX2luJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3Rlcm1faW4nKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnaGVpZ2h0X2luJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3BfaW4nKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnd19pbicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCd3aWR0aF9pbicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdhZ2VfaW4nKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnYWN0dWFsX2ludGVyZXN0X3JhdGVfY29faW4nKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnaG92ZXInKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgneCcpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdjdWxfc2NvcGVfaWQnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnZm9ybScpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdlZGl0b3InKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnb3B0aW9ucycpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdvdmVybGF5JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2N1bF9qcycpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdjYWxjdWxhbmdfc291cmNlX25vbWVtbycpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdmb3JtdWxhZV92aXNpYmxlJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2ZtdF9mbXQnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnYWN0aW9ucycpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdrZXlzX3N0cmVhbScpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdzY2VuZScpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdzY2VuZV9zaXplJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3Nob3dfcmF5X3N0ZXBzJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3Nob3dfcmF5X2gnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnc2hvd19yYXlfdicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdvcGFjaXR5X3ZlcnRpY2FsJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ2xldmVsJykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3JlZnJlc2gnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgndmVyc2lvbicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdndWlkZXMnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgncmF5X2FuZ2xlX3N0ZXBfc2l6ZScpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdzYXZpbmdzX3ZpeicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdzdGFyZmllbGRfdml6JykifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXRRdWlldCIsInNvdXJjZSI6InNoaW55SW5wdXQoJ3NhdmluZ3NfYWN0dWFsYXRvcicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdsb2FuX3ZpeicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdjb2xvcicpIn1dfQ==
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../..";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script defer="" src="./resources/cookieconsent-2.9.1/dist/cookieconsent.js"></script> <script defer="" src="./cookieconsent-init.js"></script> <script defer="" type="text/plain" data-cookiecategory="analytics" data-domain="calculang-at-fosdem.pages.dev" src="https://plausible.io/js/script.js"></script>

<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (_event) {
  if (window.bslib.Card) {
    window.bslib.Card.initializeAllCards();
  }
}); 
</script>
  



</body></html>